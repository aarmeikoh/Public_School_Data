/*
 *+------------------------------------------------------------------------+
 *| Licensed Materials - Property of IBM
 *| IBM Cognos Products: Viewer
 *| (C) Copyright IBM Corp. 2014
 *|
 *| US Government Users Restricted Rights - Use, duplication or
 *| disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
 *|
 *+------------------------------------------------------------------------+
 */
 function CViewerHelper(){
this.m_oCV=null;
};
CViewerHelper.prototype.getCVObjectRef=function(){
return this.getCV().getObjectId();
};
CViewerHelper.prototype.getCV=function(){
if(this.m_oCV){
return this.m_oCV;
}
return window;
};
CViewerHelper.prototype.getCVId=function(){
var _1="";
if(this.m_oCV){
_1=this.m_oCV.getId();
}
return _1;
};
CViewerHelper.prototype.setCV=function(_2){
this.m_oCV=_2;
};
function CObserver(_3){
this.m_subject=_3;
this.m_observers=[];
};
function CObserver_attach(_4,_5,_6){
if(_4==null||typeof _4.update!="function"){
alert("Notification Frame Work Error : attach failed");
return false;
}
var _7=new CState(this.m_subject,_4,_5?_5:null,_6?_6:null);
this.m_observers[this.m_observers.length]=_7;
return true;
};
function CObserver_detach(_8){
};
function CObserver_hasObserver(_9){
var _a=false;
for(var _b=0;_b<this.m_observers.length;_b++){
if(this.m_observers[_b].getObserver()==_9){
_a=true;
break;
}
}
return _a;
};
function CObserver_notify(_c){
var i=0;
if(typeof _c!="undefined"&&_c!=null){
for(i=0;i<this.m_observers.length;++i){
if(this.m_observers[i].getEvt()==_c){
var _e=this.m_observers[i].getObserver();
var _f=this.m_observers[i].getCallback();
var _10=_e.update;
_e.update=_f;
_e.update(this.m_observers[i]);
_e.update=_10;
}
}
}else{
for(i=0;i<this.m_observers.length;++i){
this.m_observers[i].getObserver().update(this.m_observers[i].getSubject());
}
}
};
CObserver.prototype.attach=CObserver_attach;
CObserver.prototype.detach=CObserver_detach;
CObserver.prototype.notify=CObserver_notify;
CObserver.prototype.hasObserver=CObserver_hasObserver;
function CState(_11,_12,_13,evt){
this.m_subject=_11;
this.m_observer=_12;
this.m_callback=_13;
this.m_evt=evt;
};
function CState_getObserver(){
return this.m_observer;
};
function CState_getCallback(){
return this.m_callback;
};
function CState_getSubject(){
return this.m_subject;
};
function CState_getEvt(){
return this.m_evt;
};
CState.prototype.getObserver=CState_getObserver;
CState.prototype.getCallback=CState_getCallback;
CState.prototype.getSubject=CState_getSubject;
CState.prototype.getEvt=CState_getEvt;
function CParameterValueStringOperators(_15,_16,_17,_18){
this.m_sBetween=_15;
this.m_sNotBetween=_16;
this.m_sLessThan=_17;
this.m_sGreaterThan=_18;
};
function CParameterValues(){
this.m_parameterValues=new CDictionary();
};
CParameterValues.prototype.length=function(){
var _19=this.m_parameterValues.keys();
if(typeof _19=="undefined"||_19==null){
return 0;
}
return _19.length;
};
CParameterValues.prototype.getParameterValue=function(_1a){
if(typeof _1a!="string"||_1a==""){
return null;
}
if(this.m_parameterValues.exists(_1a)){
return this.m_parameterValues.get(_1a);
}
return null;
};
CParameterValues.prototype.getAt=function(_1b){
if(_1b<this.length()){
var _1c=this.m_parameterValues.keys();
if(this.m_parameterValues.exists(_1c[_1b])){
return this.m_parameterValues.get(_1c[_1b]);
}
}
return null;
};
CParameterValues.prototype.addParameterValue=function(_1d,_1e){
var _1f=this.getParameterValue(_1d);
if(_1f==null){
_1f=new CParameterValue();
_1f.setName(_1d);
}
_1f.addParmValueItem(_1e);
this.m_parameterValues.add(_1d,_1f);
};
CParameterValues.prototype.removeParameterValue=function(_20){
return (this.m_parameterValues.remove(_20)!=null);
};
CParameterValues.prototype.removeSimpleParmValueItem=function(_21,_22){
var _23=this.getParameterValue(_21);
if(_23==null){
return false;
}
return _23.removeSimpleParmValueItem(_22);
};
CParameterValues.prototype.addSimpleParmValueItem=function(_24,_25,_26,_27){
if(typeof _24!="string"||_24==""){
return null;
}
if(typeof _25!="string"||_25==""){
return null;
}
if(typeof _26!="string"){
return null;
}
if(typeof _27!="string"||(_27!="false"&&_27!="true")){
return null;
}
var _28=null;
if(this.m_parameterValues.exists(_24)==false){
_28=new CParameterValue(_24);
this.m_parameterValues.add(_24,_28);
}
_28=this.m_parameterValues.get(_24);
if(typeof _28=="undefined"||_28==null){
return null;
}
var _29=_28.getParmValueItems();
for(var _2a=0;_2a<_29.length;++_2a){
var _2b=_29[_2a];
if(_2b.getDisplayValue()==_26&&_2b.getUseValue()==_25){
return;
}
}
return _28.addSimpleParmValueItem(_25,_26,_27);
};
CParameterValues.prototype.getSimpleParmValueItem=function(_2c,_2d){
var _2e=this.getParameterValue(_2c);
if(_2e!=null){
return _2e.getSimpleParmValueItem(_2d);
}
return null;
};
CParameterValues.prototype.load=function(_2f){
return this.loadWithOptions(_2f,true);
};
CParameterValues.prototype.loadWithOptions=function(_30,_31){
try{
var _32=_30.childNodes;
for(var _33=0;_33<_32.length;++_33){
var _34=_32[_33];
if(_34.nodeType==3){
continue;
}
var _35=new CParameterValue();
if(_35.load(_34)){
var _36=_35.name();
if(_36!=""){
if(_31==true||_36.indexOf("credential:")!=0){
this.m_parameterValues.add(_36,_35);
}
}
}else{
delete _35;
}
}
}
catch(e){
return false;
}
return true;
};
CParameterValues.prototype.buildXML=function(_37,_38,_39){
var _3a=_38.createElement(_39);
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:xs","http://www.w3.org/2001/XMLSchema");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:bus","http://developer.cognos.com/schemas/bibus/3/");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:xsd","http://www.w3.org/2001/XMLSchema");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");
_37.XMLBuilderSetAttributeNodeNS(_3a,"SOAP-ENC:arrayType","bus:parameterValue[]","http://schemas.xmlsoap.org/soap/encoding/");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_38.documentElement.appendChild(_3a);
var _3b=this.m_parameterValues.keys();
for(var _3c=0;_3c<_3b.length;++_3c){
if(this.m_parameterValues.exists(_3b[_3c])){
var _3d=this.m_parameterValues.get(_3b[_3c]);
_3d.generateXML(_37,_3a);
}
}
return _3a;
};
CParameterValues.prototype.generateXML=function(_3e,_3f,_40){
var _41="parameterValues";
if(typeof _40!="undefined"&&_40!=null){
_41=_40;
}
XMLBuilderSerializeNode(this.buildXML(_3e,_3f,_41));
return XMLBuilderSerializeNode(_3f);
};
function CParameterValue(_42){
this.m_name=_42;
this.m_parmValueItems=[];
};
CParameterValue.prototype.name=function(){
return this.m_name;
};
CParameterValue.prototype.setName=function(_43){
this.m_name=_43;
};
CParameterValue.prototype.getParmValueItems=function(){
return this.m_parmValueItems;
};
CParameterValue.prototype.length=function(){
return this.m_parmValueItems.length;
};
CParameterValue.prototype.addParmValueItem=function(_44){
this.m_parmValueItems.push(_44);
};
CParameterValue.prototype.addSimpleParmValueItem=function(_45,_46,_47){
if(typeof _45!="string"||_45==""){
return null;
}
if(typeof _46!="string"){
return null;
}
if(typeof _47!="string"||(_47!="false"&&_47!="true")){
return null;
}
var _48=new CSimpleParmValueItem(_45,_46,_47);
this.m_parmValueItems.push(_48);
return _48;
};
CParameterValue.prototype.removeSimpleParmValueItem=function(_49){
if(typeof _49!="string"||_49==""){
return false;
}
var _4a=[];
var _4b=false;
for(var _4c=0;_4c<this.length();++_4c){
var _4d=this.m_parmValueItems[_4c];
if(_4d instanceof CSimpleParmValueItem){
if(_4d.getUseValue()==_49){
_4b=true;
continue;
}
}
_4a.push(_4d);
}
this.m_parmValueItems=_4a;
return _4b;
};
CParameterValue.prototype.getSimpleParmValueItem=function(_4e){
if(typeof _4e!="string"||_4e==""){
return null;
}
for(var _4f=0;_4f<this.length();++_4f){
var _50=this.m_parmValueItems[_4f];
if(_50 instanceof CSimpleParmValueItem){
if(_50.getUseValue()==_4e){
return _50;
}
}
}
return null;
};
CParameterValue.prototype.load=function(_51){
var _52=_51.getAttributeNode("xsi:type");
if(_52==null||_52.nodeValue!="bus:parameterValue"){
return false;
}
var _53=XMLHelper_FindChildByTagName(_51,"name",false);
if(_53==null){
return false;
}
this.m_name=XMLHelper_GetText(_53);
if(this.m_name==""){
return false;
}
var _54=XMLHelper_FindChildByTagName(_51,"value",false);
if(_54==null){
return false;
}
var _55=_54.getAttributeNode("xsi:type");
if(_55==null||_55.nodeValue!="SOAP-ENC:Array"){
return false;
}
var _56=_54.getAttributeNode("SOAP-ENC:arrayType");
if(_56==null||_56.nodeValue.indexOf("bus:parmValueItem[")==-1){
return false;
}
var _57=_54.childNodes;
for(var _58=0;_58<_57.length;++_58){
var _59=_57[_58];
if(_59.nodeType==3){
continue;
}
var _5a=_59.getAttributeNode("xsi:type");
if(_5a!=null){
var _5b;
var _5c;
switch(_5a.nodeValue){
case "bus:simpleParmValueItem":
_5b=new CSimpleParmValueItem("","","");
break;
case "bus:boundRangeParmValueItem":
_5b=new CBoundRangeParmValueItem();
break;
case "bus:unboundedEndRangeParmValueItem":
_5b=new CUnboundedEndRangeParmValueItem();
break;
case "bus:unboundedStartRangeParmValueItem":
_5b=new CUnboundedStartRangeParmValueItem();
break;
case "bus:hierarchicalParmValueItem":
_5b=new CHierarchicalParmValueItem();
break;
default:
return false;
}
_5c=_5b.load(_59);
if(_5c){
this.m_parmValueItems.push(_5b);
}else{
delete _5b;
}
}
}
return true;
};
CParameterValue.prototype.generateXML=function(_5d,_5e){
var _5f=_5e.ownerDocument;
var _60=_5f.createElement("item");
_5d.XMLBuilderSetAttributeNodeNS(_60,"xsi:type","bus:parameterValue","http://www.w3.org/2001/XMLSchema-instance");
_5e.appendChild(_60);
var _61=_5d.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:name",_5f);
_5d.XMLBuilderSetAttributeNodeNS(_61,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_61.appendChild(_5f.createTextNode(this.m_name));
_60.appendChild(_61);
var _62=_5d.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:value",_5f);
_5d.XMLBuilderSetAttributeNodeNS(_62,"SOAP-ENC:arrayType","bus:parmValueItem[]","http://schemas.xmlsoap.org/soap/encoding/");
_5d.XMLBuilderSetAttributeNodeNS(_62,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_60.appendChild(_62);
for(var _63=0;_63<this.m_parmValueItems.length;++_63){
if(typeof this.m_parmValueItems[_63].generateXML!="undefined"){
this.m_parmValueItems[_63].generateXML(_5d,_62);
}
}
};
CParameterValue.prototype.toString=function(_64){
var _65="";
for(var _66=0;_66<this.m_parmValueItems.length;++_66){
if(_65!=""){
_65+=", ";
}
if(typeof this.m_parmValueItems[_66].toString!="undefined"){
_65+=this.m_parmValueItems[_66].toString(_64);
}
}
return _65;
};
function CParmValueItem(){
this.initialize("true");
};
CParmValueItem.prototype.getInclusiveValue=function(){
return this.m_inclusiveValue;
};
CParmValueItem.prototype.setInclusiveValue=function(_67){
this.m_inclusiveValue=_67;
};
CParmValueItem.prototype.initialize=function(_68){
this.m_inclusiveValue=_68;
};
CParmValueItem.prototype.load=function(_69){
this.m_inclusiveValue="true";
var _6a=XMLHelper_FindChildByTagName(_69,"inclusive",false);
if(_6a!=null){
var _6b=XMLHelper_GetText(_6a);
if(_6b=="true"||_6b=="false"){
this.m_inclusiveValue=_6b;
}
}
};
CParmValueItem.prototype.generateXML=function(_6c,_6d){
var _6e=_6d.ownerDocument;
var _6f=_6c.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:inclusive",_6e);
_6c.XMLBuilderSetAttributeNodeNS(_6f,"xsi:type","xs:boolean","http://www.w3.org/2001/XMLSchema-instance");
_6f.appendChild(_6e.createTextNode(this.m_inclusiveValue));
_6d.appendChild(_6f);
};
function CSimpleParmValueItem(_70,_71,_72){
CSimpleParmValueItem.baseclass.initialize.call(this,_72);
this.m_useValue=_70;
this.m_displayValue=_71;
};
CSimpleParmValueItem.prototype=new CParmValueItem();
CSimpleParmValueItem.prototype.constructor=CSimpleParmValueItem;
CSimpleParmValueItem.baseclass=CParmValueItem.prototype;
CSimpleParmValueItem.prototype.getUseValue=function(){
return this.m_useValue;
};
CSimpleParmValueItem.prototype.getDisplayValue=function(){
return this.m_displayValue;
};
CSimpleParmValueItem.prototype.getParmValueItem=function(){
return this.m_parmValueItem;
};
CSimpleParmValueItem.prototype.setDisplayValue=function(_73){
this.m_displayValue=_73;
};
CSimpleParmValueItem.prototype.setUseValue=function(_74){
this.m_useValue=_74;
};
CSimpleParmValueItem.prototype.toString=function(_75){
return this.getDisplayValue();
};
CSimpleParmValueItem.prototype.load=function(_76){
CSimpleParmValueItem.baseclass.load.call(this,_76);
var _77=XMLHelper_FindChildByTagName(_76,"use",false);
if(_77==null){
return false;
}
var _78=XMLHelper_GetText(_77);
if(_78==""){
return false;
}
this.m_useValue=_78;
var _79=XMLHelper_FindChildByTagName(_76,"display",false);
if(_79!=null){
this.m_displayValue=XMLHelper_GetText(_79);
}
return true;
};
CSimpleParmValueItem.prototype.generateXML=function(_7a,_7b){
var _7c=_7b.ownerDocument;
var _7d=_7c.createElement("item");
_7a.XMLBuilderSetAttributeNodeNS(_7d,"xsi:type","bus:simpleParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_7b.appendChild(_7d);
CSimpleParmValueItem.baseclass.generateXML.call(this,_7a,_7d);
var _7e=_7a.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:use",_7c);
_7a.XMLBuilderSetAttributeNodeNS(_7e,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_7e.appendChild(_7c.createTextNode(this.m_useValue));
_7d.appendChild(_7e);
var _7f=_7a.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:display",_7c);
_7a.XMLBuilderSetAttributeNodeNS(_7f,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_7f.appendChild(_7c.createTextNode(this.m_displayValue));
_7d.appendChild(_7f);
};
function CBoundRangeParmValueItem(){
CBoundRangeParmValueItem.baseclass.initialize.call(this,"true");
this.m_start=null;
this.m_end=null;
};
CBoundRangeParmValueItem.prototype=new CParmValueItem();
CBoundRangeParmValueItem.prototype.constructor=CBoundRangeParmValueItem;
CBoundRangeParmValueItem.baseclass=CParmValueItem.prototype;
CBoundRangeParmValueItem.prototype.setStart=function(_80){
this.m_start=_80;
};
CBoundRangeParmValueItem.prototype.getStart=function(){
return this.m_start;
};
CBoundRangeParmValueItem.prototype.setEnd=function(end){
this.m_end=end;
};
CBoundRangeParmValueItem.prototype.getEnd=function(){
return this.m_end;
};
CBoundRangeParmValueItem.prototype.toString=function(_82){
return CViewerCommon.getMessage(_82.m_sBetween,[this.m_start.getDisplayValue(),this.m_end.getDisplayValue()]);
};
CBoundRangeParmValueItem.prototype.load=function(_83){
CBoundRangeParmValueItem.baseclass.load.call(this,_83);
this.m_start=new CSimpleParmValueItem("","","");
this.m_start.load(XMLHelper_FindChildByTagName(_83,"start",false));
this.m_end=new CSimpleParmValueItem("","","");
this.m_end.load(XMLHelper_FindChildByTagName(_83,"end",false));
return true;
};
CBoundRangeParmValueItem.prototype.generateXML=function(_84,_85){
var _86=_85.ownerDocument;
var _87=_86.createElement("item");
_84.XMLBuilderSetAttributeNodeNS(_87,"xsi:type","bus:boundRangeParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_85.appendChild(_87);
CBoundRangeParmValueItem.baseclass.generateXML.call(this,_84,_87);
var _88=_84.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:start",_86);
_87.appendChild(_88);
this.m_start.generateXML(_84,_88);
var _89=_84.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:end",_86);
_87.appendChild(_89);
this.m_end.generateXML(_84,_89);
};
function CUnboundedStartRangeParmValueItem(){
CUnboundedStartRangeParmValueItem.baseclass.initialize.call(this,"true");
this.m_end=null;
};
CUnboundedStartRangeParmValueItem.prototype=new CParmValueItem();
CUnboundedStartRangeParmValueItem.prototype.constructor=CUnboundedStartRangeParmValueItem;
CUnboundedStartRangeParmValueItem.baseclass=CParmValueItem.prototype;
CUnboundedStartRangeParmValueItem.prototype.setEnd=function(end){
this.m_end=end;
};
CUnboundedStartRangeParmValueItem.prototype.getEnd=function(){
return this.m_end;
};
CUnboundedStartRangeParmValueItem.prototype.load=function(_8b){
CUnboundedStartRangeParmValueItem.baseclass.load.call(this,_8b);
this.m_end=new CSimpleParmValueItem("","","");
this.m_end.load(XMLHelper_FindChildByTagName(_8b,"end",false));
return true;
};
CUnboundedStartRangeParmValueItem.prototype.generateXML=function(_8c,_8d){
var _8e=_8d.ownerDocument;
var _8f=_8e.createElement("item");
_8c.XMLBuilderSetAttributeNodeNS(_8f,"xsi:type","bus:unboundedStartRangeParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_8d.appendChild(_8f);
CUnboundedStartRangeParmValueItem.baseclass.generateXML.call(this,_8c,_8f);
var _90=_8c.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:end",_8e);
_8f.appendChild(_90);
this.m_end.generateXML(_8c,_90);
};
CUnboundedStartRangeParmValueItem.prototype.toString=function(_91){
return _91.m_sLessThan+" "+this.m_end.getDisplayValue();
};
function CUnboundedEndRangeParmValueItem(){
CUnboundedEndRangeParmValueItem.baseclass.initialize.call(this,"true");
this.m_start=null;
};
CUnboundedEndRangeParmValueItem.prototype=new CParmValueItem();
CUnboundedEndRangeParmValueItem.prototype.constructor=CUnboundedEndRangeParmValueItem;
CUnboundedEndRangeParmValueItem.baseclass=CParmValueItem.prototype;
CUnboundedEndRangeParmValueItem.prototype.setStart=function(_92){
this.m_start=_92;
};
CUnboundedEndRangeParmValueItem.prototype.getStart=function(){
return this.m_start;
};
CUnboundedEndRangeParmValueItem.prototype.load=function(_93){
CUnboundedEndRangeParmValueItem.baseclass.load.call(this,_93);
this.m_start=new CSimpleParmValueItem("","","");
this.m_start.load(XMLHelper_FindChildByTagName(_93,"start",false));
return true;
};
CUnboundedEndRangeParmValueItem.prototype.generateXML=function(_94,_95){
var _96=_95.ownerDocument;
var _97=_96.createElement("item");
_94.XMLBuilderSetAttributeNodeNS(_97,"xsi:type","bus:unboundedEndRangeParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_95.appendChild(_97);
CUnboundedEndRangeParmValueItem.baseclass.generateXML.call(this,_94,_97);
var _98=_94.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:start",_96);
_97.appendChild(_98);
this.m_start.generateXML(_94,_98);
};
CUnboundedEndRangeParmValueItem.prototype.toString=function(_99){
return _99.m_sGreaterThan+" "+this.m_start.getDisplayValue();
};
function CHierarchicalParmValueItem(){
CHierarchicalParmValueItem.baseclass.initialize.call(this,"true");
this.m_value=null;
this.m_subNodes=[];
};
CHierarchicalParmValueItem.prototype=new CParmValueItem();
CHierarchicalParmValueItem.prototype.constructor=CHierarchicalParmValueItem;
CHierarchicalParmValueItem.baseclass=CParmValueItem.prototype;
CHierarchicalParmValueItem.prototype.getValue=function(){
return this.m_value;
};
CHierarchicalParmValueItem.prototype.getSubNodes=function(){
return this.m_subNodes;
};
CHierarchicalParmValueItem.prototype.setValue=function(_9a){
this.m_value=_9a;
};
CHierarchicalParmValueItem.prototype.setSubNodes=function(_9b){
this.m_subNodes=_9b;
};
CHierarchicalParmValueItem.prototype.load=function(_9c){
CHierarchicalParmValueItem.baseclass.load.call(this,_9c);
this.m_value=new CSimpleParmValueItem("","","");
this.m_value.load(XMLHelper_FindChildByTagName(_9c,"value",false));
var _9d=XMLHelper_FindChildByTagName(_9c,"subNodes",false);
if(_9d==null){
return false;
}
var _9e=_9d.getAttributeNode("xsi:type");
if(_9e==null||_9e.nodeValue!="SOAP-ENC:Array"){
return false;
}
var _9f=_9d.getAttributeNode("SOAP-ENC:arrayType");
if(_9f==null||_9f.nodeValue!="bus:hierarchicalParmValueItem[]"){
return false;
}
var _a0=_9d.childNodes;
for(var _a1=0;_a1<_a0.length;++_a1){
var _a2=new CHierarchicalParmValueItem();
_a2.load(_a0[_a1]);
this.m_subNodes.push(_a2);
}
return true;
};
CHierarchicalParmValueItem.prototype.generateXML=function(_a3,_a4){
var _a5=_a4.ownerDocument;
var _a6=_a5.createElement("item");
_a3.XMLBuilderSetAttributeNodeNS(_a6,"xsi:type","bus:hierarchicalParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_a4.appendChild(_a6);
CHierarchicalParmValueItem.baseclass.generateXML.call(this,_a3,_a6);
var _a7=_a3.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:value",_a5);
_a6.appendChild(_a7);
this.m_value.generateXML(_a3,_a7);
var _a8=_a3.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:subNodes",_a5);
_a3.XMLBuilderSetAttributeNodeNS(_a8,"SOAP-ENC:arrayType","bus:hierarchicalParmValueItem[]","http://schemas.xmlsoap.org/soap/encoding/");
_a3.XMLBuilderSetAttributeNodeNS(_a8,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_a6.appendChild(_a8);
for(var _a9=0;_a9<this.m_subNodes.length;++_a9){
this.m_subNodes[_a9].generateXML(_a3,_a8);
}
};
CHierarchicalParmValueItem.prototype.toString=function(){
return "";
};
function XMLParser(s,_ab){
if(s==null){
return null;
}
if(/^\s*</.test(s)){
s=s.replace(/^\s*/,"");
if(s.charAt(1)=="/"){
var _ac=new RegExp("^</"+_ab.getName()+"\\s*>","gi");
if(!_ac.test(s)){
alert("invalid XML "+_ab.getName()+"\n"+s);
return null;
}
return XMLParser(s.replace(RegExp.lastMatch,""),_ab.parentNode);
}else{
var _ad=/^\s*<([\w:\-_\.]+)/;
if(_ad.test(s)){
var _ae=RegExp.$1;
var e=new XMLElement(_ae,_ab);
var _b0=new RegExp("^<"+_ae+"[^>]*>");
s=s.replace(_b0,"");
var _b1=RegExp.lastMatch;
var _b2=/([\w:\-_\.]+)="([^"]*)"/gi;
var _b3=_b1.match(_b2);
if(_b3!=null){
for(var i=0;i<_b3.length;i++){
var _b5=_b3[i];
(/([\w:\-_\.]+)\s*=\s*"(.*)"/).test(_b5);
e.setAttribute(RegExp.$1,RegExp.$2);
}
}
if(!(/\/>$/).test(_b1)){
XMLParser(s,e);
return e;
}else{
XMLParser(s,_ab);
return e;
}
}
}
}else{
if(s&&_ab){
var _b6=new RegExp("([^<]*)</"+_ab.getName()+"\\s*[^>]*>","gi");
_b6.test(s);
var _b7=RegExp.$1;
_ab.setValue(_b7);
return (XMLParser(s.replace(_b7,""),_ab));
}
}
return null;
};
function XMLElement(s,_b9){
this.nodeName=s;
this.nodeValue="";
this.attributes=[];
this.childNodes=[];
this.parentNode=_b9;
if(this.parentNode){
this.parentNode.appendChild(this);
}
};
XMLElement.prototype.appendChild=function(e){
this.childNodes[this.childNodes.length]=e;
};
XMLElement.prototype.hasChildNodes=function(){
if(this.childNodes.length>0){
return true;
}else{
return false;
}
};
XMLElement.prototype.findChildByName=function(n,_bc){
if(this.getName()==n){
return (this);
}
for(var i=0;i<this.childNodes.length;i++){
if(this.childNodes[i].getName()==n){
return this.childNodes[i];
}
}
if(_bc!=false){
for(i=0;i<this.childNodes.length;i++){
var _be=this.childNodes[i].findChildByName(n,_bc);
if(_be){
return _be;
}
}
}
return null;
};
XMLElement.prototype.findChildWithAttribute=function(_bf,val){
for(var i=0;i<this.childNodes.length;i++){
if(this.childNodes[i].getAttribute(_bf)==val){
return this.childNodes[i];
}
}
return null;
};
XMLElement.prototype.getElementsByTagName=function(s,_c3){
var a=[];
for(var i=0;i<this.childNodes.length;i++){
if(this.childNodes[i].getName()==s){
a[a.length]=this.childNodes[i];
}
}
if(_c3!=false){
for(i=0;i<this.childNodes.length;i++){
var _c6=this.childNodes[i].getElementsByTagName(s);
for(var j=0;j<_c6.length;j++){
a[a.length]=_c6[j];
}
}
}
return a;
};
XMLElement.prototype.getName=function(){
return this.nodeName;
};
XMLElement.prototype.getValue=function(){
return this.nodeValue;
};
XMLElement.prototype.setAttribute=function(a,v){
this.attributes["_"+a]=v;
};
XMLElement.prototype.setValue=function(v){
this.nodeValue=v;
};
XMLElement.prototype.getAttribute=function(a){
var _cc="";
if(typeof sXmlDecode=="function"){
_cc=sXmlDecode(this.attributes["_"+a]);
}else{
_cc=this.attributes["_"+a];
}
return (_cc==null?"":_cc);
};
XMLElement.prototype.toString=function(){
var s="<"+this.getName();
for(var i in this.attributes){
s+=" "+i.substring(1)+"=\""+this.attributes[i]+"\"";
}
s+=">"+this.getValue();
for(var j=0;j<this.childNodes.length;j++){
s+=this.childNodes[j].toString();
}
s+="</"+this.getName()+">";
return s;
};
function XMLBuilderLoadXMLFromString(_d0,_d1){
var _d2=null;
if(typeof DOMParser!="undefined"){
_d2=new DOMParser().parseFromString(_d0,"application/xml");
}else{
if(typeof ActiveXObject!="undefined"){
try{
_d2=new ActiveXObject("Microsoft.XMLDOM");
_d2.loadXML(_d0);
}
catch(e){
}
}
}
return _d2;
};
function XMLBuilderCreateXMLDocument(_d3,_d4,_d5){
var _d6=null;
_d4=_d4||"";
_d5=_d5||null;
if(document.implementation&&document.implementation.createDocument){
if(typeof _d4=="undefined"){
_d4="http://www.w3.org/2000/xmlns/";
}
_d6=document.implementation.createDocument(_d4,_d3,_d5);
}else{
if(typeof ActiveXObject!="undefined"){
try{
_d6=new ActiveXObject("Microsoft.XMLDOM");
var _d7=_d6.createNode(1,_d3,_d4);
_d6.appendChild(_d7);
}
catch(e){
}
}
}
return _d6;
};
function XMLBuilderCreateElementNS(_d8,_d9,_da){
var _db=null;
if(typeof _da.createElementNS!="undefined"){
if(typeof _d8=="undefined"){
_d8="http://www.w3.org/2000/xmlns/";
}
_db=_da.createElementNS(_d8,_d9);
}else{
if(typeof _da.createNode!="undefined"){
_db=_da.createNode(1,_d9,_d8);
}
}
return _db;
};
function XMLBuilderSetAttributeNodeNS(_dc,_dd,_de,_df){
if(typeof _dc.setAttributeNS!="undefined"){
if(typeof _df=="undefined"){
_df="http://www.w3.org/2000/xmlns/";
}
_dc.setAttributeNS(_df,_dd,_de);
}else{
if(typeof _dc.ownerDocument!="undefined"&&typeof _dc.ownerDocument.createNode!="undefined"){
var _e0=_dc.ownerDocument.createNode(2,_dd,_df);
_e0.nodeValue=_de;
_dc.setAttributeNode(_e0);
}
}
};
function XMLBuilderSerializeNode(_e1){
var _e2="";
if(typeof XMLSerializer!="undefined"){
try{
_e2=new XMLSerializer().serializeToString(_e1);
}
catch(e){
}
}else{
if(typeof _e1=="object"&&typeof _e1.xml!="undefined"){
_e2=_e1.xml;
}
}
return _e2.replace(/^\s+/g,"").replace(/\s+$/g,"");
};
function XMLHelper_GetText(_e3,_e4){
var _e5="";
var _e6=_e3.childNodes;
for(var i=0;i<_e6.length;++i){
if(_e6[i].nodeType==3){
_e5+=_e6[i].nodeValue;
}else{
if(_e6[i].nodeName=="Value"){
_e5+=_e6[i].getAttribute("display");
}else{
if(_e4){
_e5+=XMLHelper_GetText(_e6[i],true);
}
}
}
}
return _e5;
};
function XMLHelper_GetLocalName(_e8){
if(typeof _e8.baseName!="undefined"){
return _e8.baseName;
}
return _e8.localName;
};
function XMLHelper_FindChildByTagName(_e9,_ea,_eb){
if(typeof _eb=="undefined"||(_eb!=true&&_eb!=false)){
_eb=true;
}
if(XMLHelper_GetLocalName(_e9)==_ea){
return (_e9);
}
var i;
for(i=0;i<_e9.childNodes.length;i++){
if(XMLHelper_GetLocalName(_e9.childNodes[i])==_ea){
return _e9.childNodes[i];
}
}
if(_eb!=false){
for(i=0;i<_e9.childNodes.length;i++){
var _ed=XMLHelper_FindChildByTagName(_e9.childNodes[i],_ea,_eb);
if(_ed){
return _ed;
}
}
}
return null;
};
function XMLHelper_FindChildrenByTagName(_ee,_ef,_f0){
if(typeof _f0=="undefined"||(_f0!=true&&_f0!=false)){
_f0=true;
}
var _f1=[];
var _f2=_ee.childNodes;
for(var _f3=0;_f3<_f2.length;_f3++){
if(XMLHelper_GetLocalName(_f2[_f3])==_ef){
_f1[_f1.length]=_f2[_f3];
}
if(_f0===true){
var _f4=XMLHelper_FindChildrenByTagName(_f2[_f3],_ef,_f0);
if(_f4.length>0){
_f1=_f1.concat(_f4);
}
}
}
return _f1;
};
function XMLHelper_GetFirstChildElement(oEl){
var _f6=null;
if(oEl&&oEl.childNodes&&oEl.childNodes.length){
for(var i=0;i<oEl.childNodes.length;i++){
if(oEl.childNodes[i].nodeType==1){
_f6=oEl.childNodes[i];
break;
}
}
}
return _f6;
};
function XMLHelper_FindChildrenByAttribute(_f8,_f9,_fa,_fb,_fc){
if(typeof _fb=="undefined"||(_fb!=true&&_fb!=false)){
_fb=true;
}
if(typeof _fa!="string"&&typeof _fa!="number"){
_fa=null;
}else{
_fa=_fa.toString();
}
var _fd=[];
var _fe=_f8.childNodes;
for(var _ff=0;_ff<_fe.length;_ff++){
var _100=_fe[_ff];
if(_100.nodeType==1){
var _101=_100.getAttribute(_f9);
if(_101!==null){
if(_fa===null||_101==_fa){
if(_fc){
return [_100];
}else{
_fd[_fd.length]=_100;
}
}
}
if(_fb===true){
var _102=XMLHelper_FindChildrenByAttribute(_100,_f9,_fa,_fb,_fc);
if(_102.length>0){
if(_fc){
if(_102.length==1){
return _102;
}else{
return [_102[0]];
}
}else{
_fd=_fd.concat(_102);
}
}
}
}
}
return _fd;
};
var DICTIONARY_INVALID_KEY=-1;
var DICTIONARY_SUCCESS=1;
function CDictionary(){
this.m_aValues={};
};
function CDictionary_add(sKey,_104){
if(typeof sKey!="string"&&typeof sKey!="number"){
return DICTIONARY_INVALID_KEY;
}
this.m_aValues[sKey]=_104;
return DICTIONARY_SUCCESS;
};
function CDictionary_exists(sKey){
if(typeof sKey!="string"&&typeof sKey!="number"){
return false;
}
return (typeof this.m_aValues[sKey]!="undefined");
};
function CDictionary_get(sKey){
if(typeof sKey!="string"&&typeof sKey!="number"){
return null;
}
if(this.exists(sKey)===true){
return this.m_aValues[sKey];
}else{
return null;
}
};
function CDictionary_keys(){
var _107=[];
for(var _108 in this.m_aValues){
_107.push(_108);
}
return _107.sort();
};
function CDictionary_remove(sKey){
if(typeof sKey!="string"&&typeof sKey!="number"){
return DICTIONARY_INVALID_KEY;
}
var _10a=this.get(sKey);
delete this.m_aValues[sKey];
return _10a;
};
function CDictionary_removeAll(){
this.m_aValues=[];
return DICTIONARY_SUCCESS;
};
function CDictionary_append(_10b){
if(_10b instanceof CDictionary&&_10b.keys().length>0){
var _10c=_10b.keys();
for(var _10d=0;_10d<_10c.length;_10d++){
this.add(_10c[_10d],_10b.get(_10c[_10d]));
}
}
};
CDictionary.prototype.add=CDictionary_add;
CDictionary.prototype.exists=CDictionary_exists;
CDictionary.prototype.get=CDictionary_get;
CDictionary.prototype.keys=CDictionary_keys;
CDictionary.prototype.remove=CDictionary_remove;
CDictionary.prototype.removeAll=CDictionary_removeAll;
CDictionary.prototype.append=CDictionary_append;
function CognosTabControl(_10e,_10f){
this._init();
this._outsideContainer=_10e;
this._callback=_10f;
};
CognosTabControl.prototype._init=function(){
this._tabs=null;
this._tabControlNode=null;
this._scrollButtonsVisible=false;
this._scrollLeftButton=null;
this._scrollRightButton=null;
this._selectedTab=null;
this._wrapperDiv=null;
this._topContainer=null;
this._seperator=null;
this._isSavedOutput=false;
this._isHighContrast=false;
};
CognosTabControl.prototype.destroy=function(){
if(this._wrapperDiv){
this._wrapperDiv.parentNode.removeChild(this._wrapperDiv);
delete this._wrapperDiv;
this._wrapperDiv=null;
}
};
CognosTabControl.prototype.setHighContrast=function(_110){
this._isHighContrast=_110;
};
CognosTabControl.prototype.isHighContrast=function(){
return this._isHighContrast;
};
CognosTabControl.prototype.setSpaceSaverContainer=function(node){
this._spaceSaverContainer=node;
};
CognosTabControl.prototype.useAbsolutePosition=function(_112){
this._useAbsolutePosition=_112;
};
CognosTabControl.prototype.setScrollAttachNode=function(node){
this._scrollAttachNode=node;
};
CognosTabControl.prototype.setIsSavedOutput=function(_114){
this._isSavedOutput=_114;
};
CognosTabControl.prototype.isSavedOutput=function(){
return this._isSavedOutput;
};
CognosTabControl.prototype.getSelectedTabId=function(){
if(this._selectedTab){
return this._selectedTab.getId();
}
return null;
};
CognosTabControl.prototype.getSelectedTab=function(){
return this._selectedTab?this._selectedTab:null;
};
CognosTabControl.prototype.isTopAligned=function(){
return this._isTopAligned;
};
CognosTabControl.prototype.getWrapperDiv=function(){
return this._wrapperDiv;
};
CognosTabControl.prototype.getVisibleWidth=function(){
var _115=this._scrollRightButton?this._scrollRightButton.getWidth()+11:0;
return this._wrapperDiv.clientWidth-_115;
};
CognosTabControl.prototype.getMaxRightScroll=function(){
var _116=this._scrollRightButton?this._scrollRightButton.getWidth()+11:0;
return this._totalWrapperWidth+_116+8-this._wrapperDiv.clientWidth;
};
CognosTabControl.prototype.hide=function(){
this._topContainer.style.display="none";
};
CognosTabControl.prototype.resetPosition=function(){
if(this._useAbsolutePosition===true){
this._outsideContainer.srollLeft="0px";
this._outsideContainer.scrollTop="0px";
this._topContainer.style.top="";
this._topContainer.style.bottom="";
this._topContainer.style.left="0px";
if(this._isTopAligned){
this._topContainer.style.top="0px";
}else{
this._topContainer.style.bottom="0px";
}
}
};
CognosTabControl.prototype.render=function(_117){
this._updateTabInfo(_117);
if(!this._tabControlNode){
var _118=this;
var _119=this._scrollAttachNode?this._scrollAttachNode:this._outsideContainer;
if(window.attachEvent){
window.attachEvent("onresize",function(){
_118.onResize();
});
if(this._useAbsolutePosition===true){
_119.attachEvent("onscroll",function(){
_118.onContainerScroll();
});
}
}else{
window.addEventListener("resize",function(){
_118.onResize();
},false);
if(this._useAbsolutePosition===true){
_119.addEventListener("scroll",function(){
_118.onContainerScroll();
},false);
}
}
this._outsideContainer.originalClassName=this._outsideContainer.className;
this._outsideContainer.className=this._outsideContainer.className+(this._isTopAligned?" ct_controlTop":" ct_controlBottom");
this._topContainer=document.createElement("div");
this._topContainer.className="ct_wrapperDiv";
if(this._useAbsolutePosition===true){
this._topContainer.style.width="100%";
this._topContainer.style.position="absolute";
this._topContainer.style.left="0px";
if(this._isTopAligned){
this._topContainer.style.top="0px";
}else{
this._topContainer.style.bottom="0px";
}
}
if(this._isTopAligned&&this._outsideContainer.firstChild){
this._outsideContainer.insertBefore(this._topContainer,this._outsideContainer.firstChild);
}else{
this._outsideContainer.appendChild(this._topContainer);
}
this._wrapperDiv=document.createElement("div");
this._wrapperDiv.setAttribute("role","presentation");
this._wrapperDiv.className="ct_wrapperDiv";
this._topContainer.appendChild(this._wrapperDiv);
this._tabControlNode=document.createElement("div");
this._tabControlNode.setAttribute("role","tablist");
this._tabControlNode.className="ct_control";
this._wrapperDiv.appendChild(this._tabControlNode);
this._totalWrapperWidth=0;
for(var i=0;i<this._tabs.length;i++){
var tab=this._tabs[i];
tab.render(this._tabControlNode);
this._totalWrapperWidth+=this._tabs[i].getWidth();
}
var _11c=0;
if(this._tabs[0]){
_11c=this._tabs[0].getHeight();
}
this._wrapperDiv.style.height=_11c+5+"px";
if(this._spaceSaverContainer){
this.spaceSaverDiv=document.createElement("div");
this.spaceSaverDiv.style.height=_11c+5+"px";
this.spaceSaverDiv.style.position="relative";
this.spaceSaverDiv.style.display="block";
this._spaceSaverContainer.appendChild(this.spaceSaverDiv);
}
this._createSeperator();
}else{
this.resetPosition();
}
this._topContainer.style.display="";
this.onResize();
this.selectTab(_117.currentTabId,false);
if(this._selectedTab){
this._selectedTab.scrollIntoView();
this.updateScrollButtons();
}
};
CognosTabControl.prototype.onContainerScroll=function(){
var _11d=this._scrollAttachNode?this._scrollAttachNode:this._topContainer;
this._topContainer.style.left=_11d.scrollLeft+"px";
if(this._isTopAligned){
this._topContainer.style.top=_11d.scrollTop+"px";
}else{
this._topContainer.style.bottom=(-_11d.scrollTop)+"px";
}
};
CognosTabControl.prototype._resetTabControl=function(){
if(this._outsideContainer.originalClassName){
this._outsideContainer.className=this._outsideContainer.originalClassName;
}else{
this._outsideContainer.className="";
}
if(this._topContainer){
var node=this._outsideContainer.removeChild(this._topContainer);
node=null;
}
this._init();
};
CognosTabControl.prototype._updateTabInfo=function(_11f){
this._isTopAligned=_11f.position=="topLeft"?true:false;
var tabs=_11f.tabs;
if(this._tabs){
if(this._tabs.length!=tabs.length){
this._resetTabControl();
}else{
for(var i=0;i<this._tabs.length;i++){
if(tabs[i].id!=this._tabs[i].getId()){
this._resetTabControl();
break;
}
}
}
}
if(!this._tabs){
this._tabs=[];
if(!tabs){
return;
}
for(var ii=0;ii<tabs.length;ii++){
var tab=new CognosTab(tabs[ii],this,ii);
this._tabs.push(tab);
}
}
};
CognosTabControl.prototype.getScrollPos=function(){
return this._wrapperDiv.scrollLeft;
};
CognosTabControl.prototype.scrollTo=function(_124){
this._wrapperDiv.scrollLeft=_124;
this.updateScrollButtons();
};
CognosTabControl.prototype.onResize=function(evt){
if(this._wrapperDiv.offsetWidth<this._totalWrapperWidth){
this._showScrollButtons();
this.updateScrollButtons();
if(this._selectedTab){
this._selectedTab.scrollIntoView();
}
if(this._scrollRightButton.isDisabled()){
this.scrollTo(this.getMaxRightScroll());
}
}else{
this._hideScrollButtons();
this.scrollTo(0);
}
};
CognosTabControl.prototype._showScrollButtons=function(){
if(this._scrollButtonsVisible){
return;
}
if(!this._scrollLeftButton){
var _126=0;
if(this._tabs[0]){
_126=this._tabs[0].getHeight();
}
this._scrollLeftButton=new CognosScrollButton("left",_126,this);
this._scrollLeftButton.render(this._topContainer);
this._scrollRightButton=new CognosScrollButton("right",_126,this);
this._scrollRightButton.render(this._topContainer);
}
this._scrollButtonsVisible=true;
this._scrollLeftButton.show();
this._scrollRightButton.show();
this._tabControlNode.style.left=this._scrollLeftButton.getWidth()-2+"px";
};
CognosTabControl.prototype.updateScrollButtons=function(){
if(this._scrollLeftButton){
this._scrollLeftButton.update();
}
if(this._scrollRightButton){
this._scrollRightButton.update();
}
};
CognosTabControl.prototype._hideScrollButtons=function(){
if(!this._scrollButtonsVisible){
return;
}
this._scrollButtonsVisible=false;
this._tabControlNode.style.left="0px";
this._scrollLeftButton.hide();
this._scrollRightButton.hide();
};
CognosTabControl.prototype._createSeperator=function(){
this._seperator=document.createElement("div");
this._seperator.setAttribute("role","presendation");
this._seperator.setAttribute("style","");
this._seperator.className="ct_verticalLine";
this._seperator.setAttribute("role","presentation");
this._tabControlNode.appendChild(this._seperator);
};
CognosTabControl.prototype.selectTab=function(_127,_128,evt){
if(!evt){
evt=window.event;
}
for(var i=0;i<this._tabs.length;i++){
var tab=this._tabs[i];
var _12c=tab.getId()==_127;
tab.select(_12c);
if(_12c){
this._selectedTab=tab;
if(_128&&this._callback){
this._callback(_127);
}
}
if(_128){
tab.focus(_12c);
}
}
if(evt&&window.stopEventBubble){
window.stopEventBubble(evt);
}
return false;
};
CognosTabControl.prototype.handleKeyDown=function(evt,_12e){
if(!evt){
evt=window.event;
}
if(!evt){
return;
}
if(evt.keyCode=="39"||evt.keyCode=="37"){
if(evt.keyCode=="39"){
_12e++;
if(_12e>=this._tabs.length){
_12e=0;
}
}else{
_12e--;
if(_12e<0){
_12e=this._tabs.length-1;
}
}
this._tabs[_12e].focus();
this._tabs[_12e].scrollIntoView();
}else{
if(evt.keyCode=="32"||evt.keyCode=="13"){
var _12f=this._tabs[_12e].getId();
this.selectTab(_12f,true);
}
}
};
function CognosTab(_130,_131,_132){
if(!_130){
return;
}
this._id=_130.id;
this._label=_130.label;
this._position=_132;
this._contentClassName=_130.className;
this._imgURL=_130.img;
this._selected=false;
this._tabControl=_131;
this._outerTabDiv=null;
this._focusDiv=null;
};
CognosTab.prototype.getWidth=function(){
return this._outerTabDiv.offsetWidth+1;
};
CognosTab.prototype.getHeight=function(){
return this._outerTabDiv.clientHeight;
};
CognosTab.prototype.getId=function(){
return this._id;
};
CognosTab.prototype.select=function(_133){
if(_133!=this._selected){
this._selected=_133;
if(_133){
this.scrollIntoView();
}
if(this._outerTabDiv){
this._updateSelectedClass();
this._updateAriaSelected();
}
}
};
CognosTab.prototype.scrollIntoView=function(){
var _134=this._outerTabDiv.offsetLeft+this._outerTabDiv.clientWidth;
var _135=this._tabControl.getVisibleWidth();
var _136=this._tabControl.getScrollPos();
var _137=this._outerTabDiv.offsetLeft;
if(_137===0){
this._tabControl.scrollTo(0);
}else{
if((_137>=_136)&&(_134<=(_136+_135))){
}else{
if(_137<_136){
var _138=_137<3?0:_137-3;
this._tabControl.scrollTo(_138);
}else{
if(_134-_135>0||_134<_136){
this._tabControl.scrollTo(_134-_135+10);
}
}
}
}
};
CognosTab.prototype.render=function(_139){
if(!this._outerTabDiv){
var _13a=this._id;
var _13b=this._tabControl;
var tab=this;
this._outerTabDiv=document.createElement("div");
this._outerTabDiv.onmousedown=function(_13d){
_13b.selectTab(_13a,true,_13d);
};
this._outerTabDiv.onmouseover=function(){
this.className=this.className+" ct_highlight";
};
this._outerTabDiv.onmouseout=function(){
tab._updateSelectedClass();
};
this._outerTabDiv.setAttribute("style","");
this._outerTabDiv.setAttribute("role","presentation");
this._updateSelectedClass();
_139.appendChild(this._outerTabDiv);
var _13e=document.createElement("div");
_13e.className="ct_content";
_13e.setAttribute("role","presentation");
this._outerTabDiv.appendChild(_13e);
this._focusDiv=document.createElement("span");
this._focusDiv.innerHTML=this._label?this._label:"&nbsp;";
this._focusDiv.className="ct_text";
this._focusDiv.setAttribute("tabIndex",this._position===0?"0":"-1");
this._focusDiv.setAttribute("role","tab");
this._focusDiv.onkeydown=function(_13f){
_13b.handleKeyDown(_13f,tab._position);
};
this._updateAriaSelected();
_13e.appendChild(this._focusDiv);
if(this.isIE()&&this.getWidth()<75){
this._outerTabDiv.style.width="75px";
}
}else{
this._updateSelectedClass();
this._updateAriaSelected();
}
};
CognosTab.prototype.isIE=function(){
return (navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1);
};
CognosTab.prototype.getFocusableDiv=function(){
return this._focusDiv;
};
CognosTab.prototype.focus=function(_140){
if(typeof _140==="undefined"){
_140=true;
}
this._focusDiv.setAttribute("tabIndex",_140?"0":"-1");
if(_140&&this._focusDiv.focus){
this._focusDiv.focus();
}
};
CognosTab.prototype._updateSelectedClass=function(){
this._outerTabDiv.className=this._selected?"ct_outerDiv ct_highlight ct_selected":"ct_outerDiv";
};
CognosTab.prototype._updateAriaSelected=function(){
this._focusDiv.setAttribute("aria-selected",this._selected?"true":"false");
};
function CognosScrollButton(_141,_142,_143){
this._direction=_141;
this._height=_142;
this._tabControl=_143;
this._disabled=true;
this._scrolling=false;
};
CognosScrollButton.prototype.getWidth=function(){
return this._scrollButtonDiv.offsetWidth+1;
};
CognosScrollButton.prototype.show=function(){
this._wrapperDiv.style.display="block";
};
CognosScrollButton.prototype.hide=function(){
this._wrapperDiv.style.display="none";
};
CognosScrollButton.prototype.update=function(){
var _144=this._tabControl.getWrapperDiv();
var _145=false;
if(this._direction=="left"){
if(_144.scrollLeft===0){
_145=true;
}
}else{
if(_144.scrollLeft>=(this._tabControl.getMaxRightScroll()-2)){
_145=true;
}
}
if(_145){
this._disable();
}else{
this._enable();
}
};
CognosScrollButton.prototype.isDisabled=function(){
return this._disabled;
};
CognosScrollButton.prototype._disable=function(){
this._disabled=true;
this._outerDiv.className="ct_outerDiv ct_scrollDisabled";
};
CognosScrollButton.prototype._enable=function(){
this._disabled=false;
this._outerDiv.className="ct_outerDiv ct_scrollEnabled";
};
CognosScrollButton.prototype.scroll=function(){
if(!this._scrolling){
this._scrolling=true;
var _146=this._tabControl.getWrapperDiv().clientWidth;
this._doAnimateScroll(_146,this._tabControl.getMaxRightScroll());
}
};
CognosScrollButton.prototype._doAnimateScroll=function(_147,_148){
if(_147>0){
var _149=10;
var _14a=this._tabControl.getWrapperDiv();
if(this._direction=="left"){
if(_14a.scrollLeft>_149){
this._tabControl.scrollTo(_14a.scrollLeft-_149);
}else{
this._tabControl.scrollTo(0);
this._scrolling=false;
return;
}
}else{
if(_14a.scrollLeft+_149<_148){
this._tabControl.scrollTo(_14a.scrollLeft+_149);
}else{
this._scrolling=false;
this._tabControl.scrollTo(_148);
this._tabControl.updateScrollButtons();
return;
}
}
_147-=_149;
var _14b=this;
setTimeout(function(){
_14b._doAnimateScroll(_147,_148);
},3);
}else{
this._scrolling=false;
this._tabControl.updateScrollButtons();
}
};
CognosScrollButton.prototype.isIE=function(){
return (navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1);
};
CognosScrollButton.prototype.render=function(_14c){
this._scrollButtonDiv=document.createElement("div");
this._scrollButtonDiv.className="ct_scrollButton";
var _14d=-1;
if(this.isIE()&&document.compatMode!="CSS1Compat"){
_14d=1;
}
this._scrollButtonDiv.style.height=this._height+_14d+"px";
if(this._tabControl.isHighContrast()){
this._scrollButtonDiv.innerHTML=this._direction=="left"?"&laquo;":"&raquo;";
}
this._outerDiv=document.createElement("div");
this._outerDiv.className="ct_scrollDisabled";
this._outerDiv.appendChild(this._scrollButtonDiv);
this._outerDiv.style.height=this._height+"px";
var _14e=this;
this._outerDiv.onclick=function(){
_14e.scroll();
};
this._wrapperDiv=document.createElement("div");
this._wrapperDiv.style.height=this._height+"px";
this._wrapperDiv.className="ct_scroll "+(this._direction=="left"?"ct_left":"ct_right")+(this._tabControl.isHighContrast()?" a11y":"");
this._wrapperDiv.appendChild(this._outerDiv);
if(this._direction=="left"){
_14c.insertBefore(this._wrapperDiv,_14c.firstChild);
this._wrapperDiv.style.left="0px";
}else{
_14c.appendChild(this._wrapperDiv);
this._wrapperDiv.style.right="0px";
}
};
function ActionFactory(_14f){
this.m_cognosViewer=_14f;
};
ActionFactory.prototype.load=function(_150){
this.m_cognosViewer.loadExtra();
var _151=null;
try{
var _152=_150+"Action";
_151=eval("(typeof "+_152+"=='function'? new "+_152+"():null);");
if(_151){
_151.setCognosViewer(this.m_cognosViewer);
}
}
catch(exception){
_151=null;
}
return _151;
};
function ActionFactory_loadActionHandler(evt,_154){
var _155=getCtxNodeFromEvent(evt);
var _156=_154.getSelectionController();
var _157=null;
if(_155!==null){
var _158=_155.getAttribute("ctx");
_158=_158.split("::")[0].split(":")[0];
var _159=_155.getAttribute("type")!=null?_155:_155.parentNode;
var type=_159.getAttribute("type");
switch(type){
case "columnTitle":
var _15b=(_155.getAttribute("dttargets")!=null);
var _15c=(_159.getAttribute("CTNM")!=null&&_156.getMun(_158)!=""&&_156.getUsageInfo(_158)!="2");
if(_15b||_15c){
_157=_154.getAction("DrillUpDownOrThrough");
_157.init(_15b,_15c);
_157.updateDrillabilityInfo(_154,_155);
}else{
_157=_154.getAction("RenameDataItem");
}
break;
case "datavalue":
case "chartElement":
case "ordinalAxisLabel":
case "legendLabel":
case "legendTitle":
case "ordinalAxisTitle":
var _15b=(_155.getAttribute("dttargets")!=null);
var _15c=(_156.getHun(_158)!="");
if(_15b||_15c){
_157=_154.getAction("DrillUpDownOrThrough");
_157.init(_15b,_15c);
_157.updateDrillabilityInfo(_154,_155);
}
break;
}
}
if(_157===null){
_157=_154.getAction("Selection");
}
_157.setCognosViewer(_154);
return _157;
};
ActionFactory.prototype.destroy=function(){
delete this.m_cognosViewer;
};
function CUIStyle(_15d,_15e,_15f,_160,_161){
this.m_active=_15d;
this.m_normal=_15d;
this.m_rollover=_15e;
this.m_activeRollover=_15e;
this.m_depressed=_15f;
this.m_depressed_rollover=_160;
this.m_disabled=_161;
};
function CUIStyle_getActiveState(){
return this.m_active;
};
function CUIStyle_setActiveState(_162){
switch(_162){
case "normal":
this.m_active=this.m_normal;
break;
case "depressed":
this.m_active=this.m_depressed;
break;
case "disabled":
this.m_active=this.m_disabled;
break;
default:
this.m_active=this.m_normal;
}
};
function CUIStyle_getActiveRolloverState(){
return this.m_activeRollover;
};
function CUIStyle_setActiveRolloverState(_163){
switch(_163){
case "normal":
this.m_activeRollover=this.m_rollover;
break;
case "depressed":
this.m_activeRollover=this.m_depressed_rollover;
break;
case "disabled":
this.m_activeRollover=this.m_disabled;
break;
default:
this.m_activeRollover=this.m_rollover;
}
};
function CUIStyle_getNormalState(){
return this.m_normal;
};
function CUIStyle_getRolloverState(){
return this.m_rollover;
};
function CUIStyle_getDepressedState(){
return this.m_depressed;
};
function CUIStyle_getDepressedRolloverState(){
return this.m_depressed_rollover;
};
function CUIStyle_getDisabledState(){
return this.m_disabled;
};
function CUIStyle_setNormalState(_164){
this.m_normal=_164;
};
function CUIStyle_setRolloverState(_165){
this.m_rollover=_165;
};
function CUIStyle_setDepressedState(_166){
this.m_depressed=_166;
};
function CUIStyle_setDepressedRolloverState(_167){
this.m_depressed_rollover=_167;
};
function CUIStyle_setDisabledState(_168){
this.m_disabled=_168;
};
CUIStyle.prototype.getNormalState=CUIStyle_getNormalState;
CUIStyle.prototype.getRolloverState=CUIStyle_getRolloverState;
CUIStyle.prototype.getDepressedState=CUIStyle_getDepressedState;
CUIStyle.prototype.getDepressedRolloverState=CUIStyle_getDepressedRolloverState;
CUIStyle.prototype.getDisabledState=CUIStyle_getDisabledState;
CUIStyle.prototype.setNormalState=CUIStyle_setNormalState;
CUIStyle.prototype.setRolloverState=CUIStyle_setRolloverState;
CUIStyle.prototype.setDepressedState=CUIStyle_setDepressedState;
CUIStyle.prototype.setDepressedRolloverState=CUIStyle_setDepressedRolloverState;
CUIStyle.prototype.setDisabledState=CUIStyle_setDisabledState;
CUIStyle.prototype.setActiveState=CUIStyle_setActiveState;
CUIStyle.prototype.getActiveState=CUIStyle_getActiveState;
CUIStyle.prototype.getActiveRolloverState=CUIStyle_getActiveRolloverState;
CUIStyle.prototype.setActiveRolloverState=CUIStyle_setActiveRolloverState;
function CToolbarSelect(_169,name,_16b,_16c,_16d){
this.m_parent=_169;
this.m_name=name;
this.m_command=_16b;
this.m_label=_16c;
this.m_toolTip=_16d;
this.m_items=[];
if(typeof this.m_parent=="object"&&typeof this.m_parent.add=="function"){
this.m_parent.add(this);
}
if(_16c){
this.add("",_16c);
}
};
function CToolbarSelect_draw(){
var html="<select id=\""+this.m_name+"\" name=\""+this.m_name+"\" onchange=\""+this.m_command+"\"";
if(this.m_toolTip!=""){
html+=" title=\""+this.m_toolTip+"\"";
}
html+=">";
html+=this.drawItems();
html+="</select>";
return html;
};
function CToolbarSelect_drawItems(){
var html="";
for(var i=0;i<this.m_items.length;i++){
html+="<option value=\""+this.m_items[i].getUse()+"\">"+this.m_items[i].getDisplay()+"</option>";
}
return html;
};
function CToolbarSelect_add(sUse,_172){
var _173=new CSelectItem(sUse,_172);
this.m_items=this.m_items.concat(_173);
};
function CToolbarSelect_isVisible(){
return true;
};
CToolbarSelect.prototype.draw=CToolbarSelect_draw;
CToolbarSelect.prototype.drawItems=CToolbarSelect_drawItems;
CToolbarSelect.prototype.isVisible=CToolbarSelect_isVisible;
CToolbarSelect.prototype.add=CToolbarSelect_add;
function CSelectItem(sUse,_175){
this.m_sUse=sUse;
this.m_sDisplay=_175;
};
function CSelectItem_getUse(){
return this.m_sUse;
};
function CSelectItem_getDisplay(){
return this.m_sDisplay;
};
CSelectItem.prototype.getUse=CSelectItem_getUse;
CSelectItem.prototype.getDisplay=CSelectItem_getDisplay;
function CToolbarPicker(_176,_177,_178,sRef,_17a){
this.m_parent=_176;
this.m_command=_177;
this.m_oPicker=null;
this.m_sPromptId=_178;
this.m_sRef=sRef;
this.m_sType=_17a;
if(typeof this.m_parent=="object"&&typeof this.m_parent.add=="function"){
this.m_parent.add(this);
}
};
function CToolbarPicker_draw(){
var html="<div id=\""+this.m_sType+this.m_sPromptId+"\" onclick=\""+this.m_sRef+".preventBubbling(event);\"></div>";
return html;
};
function CToolbarPicker_init(){
this.m_oPicker=eval(this.m_command);
g_pickerObservers=g_pickerObservers.concat(this.m_sRef);
};
function CToolbarPicker_isVisible(){
return true;
};
function CToolbarPicker_togglePicker(){
this.m_oPicker.togglePicker();
};
function CToolbarPicker_setActiveColor(s){
this.m_oPicker.setActiveColor(s);
};
function CToolbarPicker_setColor(s){
this.m_oPicker.setColor(s);
};
function CToolbarPicker_setAlignment(s){
this.m_oPicker.setAlignment(s);
};
function CToolbarPicker_setActiveAlignment(s){
this.m_oPicker.setActiveAlignment(s);
};
function CToolbarPicker_setPalette(s){
this.m_oPicker.setPalette(s);
};
function CToolbarPicker_applyCustomStyle(){
this.m_oPicker.applyCustomStyle();
};
function CToolbarPicker_updateCustomStyle(){
this.m_oPicker.updateCustomStyle();
};
function CToolbarPicker_hide(){
this.m_oPicker.hide();
};
function CToolbarPicker_preventBubbling(e){
this.m_oPicker.preventBubbling(e);
};
function CToolbarPicker_buttonMouseHandler(_182,_183){
this.m_oPicker.buttonMouseHandler(_182,_183);
};
CToolbarPicker.prototype.draw=CToolbarPicker_draw;
CToolbarPicker.prototype.isVisible=CToolbarPicker_isVisible;
CToolbarPicker.prototype.init=CToolbarPicker_init;
CToolbarPicker.prototype.togglePicker=CToolbarPicker_togglePicker;
CToolbarPicker.prototype.setColor=CToolbarPicker_setColor;
CToolbarPicker.prototype.setAlignment=CToolbarPicker_setAlignment;
CToolbarPicker.prototype.setActiveAlignment=CToolbarPicker_setActiveAlignment;
CToolbarPicker.prototype.setActiveColor=CToolbarPicker_setActiveColor;
CToolbarPicker.prototype.setPalette=CToolbarPicker_setPalette;
CToolbarPicker.prototype.applyCustomStyle=CToolbarPicker_applyCustomStyle;
CToolbarPicker.prototype.updateCustomStyle=CToolbarPicker_updateCustomStyle;
CToolbarPicker.prototype.hide=CToolbarPicker_hide;
CToolbarPicker.prototype.preventBubbling=CToolbarPicker_preventBubbling;
CToolbarPicker.prototype.buttonMouseHandler=CToolbarPicker_buttonMouseHandler;
var tbUniqueId=0;
function makeId(){
return tbUniqueId++;
};
gDropDownButtonStyle=new CUIStyle("dropDownArrow","dropDownArrowOver","","","");
gHeaderDropDownButtonStyle=new CUIStyle("bannerDropDownArrow","bannerDropDownArrowOver","","","");
function CToolbarButton(_184,_185,_186,_187,_188,_189,_18a,_18b,_18c){
this.m_id="tbbutton"+makeId();
this.m_bVisible=true;
this.m_action=_185;
this.m_toolTip=_187;
if(typeof _18c!="undefined"&&_18c!=""){
this.m_webContentRoot=_18c;
}else{
this.m_webContentRoot="..";
}
this.m_icon=(_186)?new CIcon(_186,_187,this.webContentRoot):null;
this.m_parent=_184;
this.m_menu=null;
if(typeof _189=="boolean"){
this.m_bHideDropDown=_189;
}else{
this.m_bHideDropDown=false;
}
this.m_style=new CUIStyle(_188.getNormalState(),_188.getRolloverState(),_188.getDepressedState(),_188.getDepressedRolloverState(),_188.getDisabledState());
this.m_observers=new CObserver(this);
if(typeof this.m_parent=="object"&&typeof this.m_parent.add=="function"){
this.m_parent.add(this);
}
this.m_label=(_18a)?_18a:null;
this.m_dropDownToolTip=(_18b)?_18b:this.m_toolTip;
this.m_dropDownStyle=gDropDownButtonStyle;
};
function CToolbarButton_getId(){
return this.m_id;
};
function CToolbarButton_draw(){
var html="";
html+="<div style=\"margin-right:3px;\"><button type=\"button\" id=\"";
html+=this.m_id;
html+="\"";
if(typeof this.getStyle()=="object"){
html+=" class=\""+this.getStyle().getActiveState()+"\"";
if(this.getStyle().getActiveState()!=this.getStyle().getDisabledState()){
if(this.isEnabled()){
html+=" tabIndex=\"1\"";
}
html+=" hideFocus=\"true\"";
}
}
if(this.m_toolTip!=""){
html+=" title=\""+this.m_toolTip+"\"";
}
html+=">";
if(this.m_icon!=null){
html+=this.m_icon.draw();
}
if(this.m_label!=null){
html+=this.m_label;
}
html+="</button>";
if(this.m_menu!=null&&!this.m_bHideDropDown){
html+="<button type=\"button\" id=\"";
html+=("menu"+this.getId());
html+="\"";
if(typeof this.getStyle()=="object"){
html+=" class=\""+this.getDropDownStyle().getActiveState()+"\"";
if(this.getStyle().getActiveState()!=this.getStyle().getDisabledState()){
if(this.isEnabled()){
html+=" tabIndex=\"1\"";
}
html+=" hideFocus=\"true\"";
}
}
if(this.m_dropDownToolTip!=""){
html+=" title=\""+this.m_dropDownToolTip+"\"";
}
html+="><img style=\"vertical-align:middle;\" border=\"0\" src=\""+this.m_webContentRoot+"/common/images/toolbar_drop_arrow.gif\"";
if(this.m_dropDownToolTip!=""){
html+=" alt=\""+this.m_dropDownToolTip+"\"";
html+=" title=\""+this.m_dropDownToolTip+"\"";
}else{
html+=" alt=\"\"";
}
html+=" width=\"7\" height=\"16\"/></button>";
}
html+="</div>";
return html;
};
function CToolbarButton_attachEvents(){
if(typeof this.getParent().getHTMLContainer!="function"){
return;
}
var _18e=this.getParent().getHTMLContainer();
if(_18e==null){
return;
}
var _18f=eval(_18e.document?_18e.document.getElementById(this.m_id):_18e.ownerDocument.getElementById(this.m_id));
if(_18f==null){
return;
}
_18f.onmouseover=this.onmouseover;
_18f.onmouseout=this.onmouseout;
_18f.onclick=this.onclick;
_18f.onkeypress=this.onkeypress;
_18f.onfocus=this.onfocus;
_18f.onblur=this.onblur;
_18f.tbItem=eval(this);
if(this.m_menu!=null&&!this.m_bHideDropDown){
var _190=eval(_18e.document?_18e.document.getElementById("menu"+this.getId()):_18e.ownerDocument.getElementById("menu"+this.getId()));
_190.onmouseover=this.onmouseover;
_190.onmouseout=this.onmouseout;
_190.onclick=this.onclick;
_190.onkeypress=this.onkeypress;
_190.onfocus=this.onfocus;
_190.onblur=this.onblur;
_190.tbItem=eval(this);
}
};
function CToolbarButton_createDropDownMenu(_191,_192){
this.m_dropDownToolTip=(_192)?_192:this.m_toolTip;
this.m_menu=new CMenu("dropDown"+this.getId(),_191,this.m_webContentRoot);
this.m_menu.setParent(this);
return this.m_menu;
};
function CToolbarButton_addOwnerDrawControl(_193){
this.m_menu=_193;
if(typeof _193.setParent!="undefined"){
this.m_menu.setParent(this);
}
};
function CToolbarButton_getParent(){
return this.m_parent;
};
function CToolbarButton_setParent(_194){
this.m_parent=_194;
};
function CToolbarButton_getAction(){
return this.m_action;
};
function CToolbarButton_setAction(_195){
this.m_action=_195;
};
function CToolbarButton_getToolTip(){
return this.m_toolTip;
};
function CToolbarButton_setToolTip(_196){
this.m_toolTip=_196;
};
function CToolbarButton_getDropDownToolTip(){
return this.m_dropDownToolTip;
};
function CToolbarButton_setDropDownToolTip(_197){
this.m_dropDownToolTip=_197;
};
function CToolbarButton_getIcon(){
return this.m_icon;
};
function CToolbarButton_setIcon(_198){
this.m_icon.setPath(_198);
};
function CToolbarButton_onmouseover(evt){
var _19a=this.tbItem;
if(typeof _19a=="object"){
if(!_19a.isEnabled()){
return;
}
if(_19a.getMenu()!=null&&!_19a.m_bHideDropDown&&("menu"+_19a.getId())==this.id){
this.className=_19a.getDropDownStyle().getActiveRolloverState();
}else{
if(typeof _19a.getStyle()=="object"){
this.className=_19a.getStyle().getActiveRolloverState();
}
if(_19a.getMenu()!=null&&!_19a.m_bHideDropDown){
var _19b=this.document?this.document.getElementById("menu"+_19a.getId()):this.ownerDocument.getElementById("menu"+_19a.getId());
if(typeof _19b=="object"){
_19b.className=_19a.getDropDownStyle().getActiveRolloverState();
}
}
}
if(_19a.getParent()!=null&&typeof _19a.getParent().onmouseover=="function"){
_19a.getParent().onmouseover(evt);
}
_19a.getObservers().notify(CToolbarButton_onmouseover);
}
};
function CToolbarButton_onmouseout(evt){
var _19d=this.tbItem;
if(typeof _19d=="object"){
if(!_19d.isEnabled()){
return;
}
if(_19d.getMenu()!=null&&!_19d.m_bHideDropDown&&("menu"+_19d.getId())==this.id){
this.className=_19d.getDropDownStyle().getActiveState();
}else{
if(typeof _19d.getStyle()=="object"){
this.className=_19d.getStyle().getActiveState();
}
if(_19d.getMenu()!=null&&!_19d.m_bHideDropDown){
var _19e=this.document?this.document.getElementById("menu"+_19d.getId()):this.ownerDocument.getElementById("menu"+_19d.getId());
if(typeof _19e=="object"){
_19e.className=_19d.getDropDownStyle().getActiveState();
}
}
}
if(_19d.getParent()!=null&&typeof _19d.getParent().onmouseout=="function"){
_19d.getParent().onmouseout(evt);
}
_19d.getObservers().notify(CToolbarButton_onmouseout);
}
};
function CToolbarButton_onclick(evt){
evt=(evt)?evt:((event)?event:null);
var _1a0=this.tbItem;
if(_1a0!=null){
if(!_1a0.isEnabled()){
return;
}
var menu=_1a0.getMenu();
if(menu!=null&&((this.id==("menu"+_1a0.getId()))||(_1a0.m_bHideDropDown&&this.id==_1a0.getId()))){
if(menu.isVisible()){
menu.remove();
}else{
if(typeof menu.setHTMLContainer!="undefined"){
menu.setHTMLContainer(this.document?this.document.body:this.ownerDocument.body);
}
if(typeof _1a0.m_parent.closeMenus=="function"){
_1a0.m_parent.closeMenus();
}
menu.draw();
menu.show();
}
}else{
eval(this.tbItem.m_action);
}
if(_1a0.getParent()!=null&&typeof _1a0.getParent().onclick=="function"){
_1a0.getParent().onclick(evt);
}
_1a0.getObservers().notify(CToolbarButton_onclick);
}
if(this.blur){
this.blur();
}
evt.cancelBubble=true;
return false;
};
function CToolbarButton_onkeypress(evt){
evt=(evt)?evt:((event)?event:null);
if(evt.keyCode==13||evt.keyCode==0){
var _1a3=this.tbItem;
if(_1a3!=null){
if(!_1a3.isEnabled()){
return;
}
var menu=_1a3.getMenu();
if(menu!=null&&((this.id==("menu"+_1a3.getId()))||(_1a3.m_bHideDropDown&&this.id==_1a3.getId()))){
if(menu.isVisible()){
menu.remove();
}else{
if(typeof menu.setHTMLContainer!="undefined"){
menu.setHTMLContainer(this.document?this.document.body:this.ownerDocument.body);
}
menu.draw();
menu.show();
}
}else{
eval(this.tbItem.m_action);
}
if(_1a3.getParent()!=null&&typeof _1a3.getParent().onkeypress=="function"){
_1a3.getParent().onkeypress(evt);
}
_1a3.getObservers().notify(CToolbarButton_onkeypress);
}
return false;
}
evt.cancelBubble=true;
return true;
};
function CToolbarButton_getMenu(){
return this.m_menu;
};
function CToolbarButton_getMenuType(){
return "dropDown";
};
function CToolbarButton_setStyle(_1a5){
this.m_style=_1a5;
};
function CToolbarButton_getStyle(){
return this.m_style;
};
function CToolbarButton_getDropDownStyle(){
return this.m_dropDownStyle;
};
function CToolbarButton_setDropDownStyle(_1a6){
this.m_dropDownStyle=_1a6;
};
function CToolbarButton_isVisible(){
return this.m_bVisible;
};
function CToolbarButton_hide(){
this.m_bVisible=false;
};
function CToolbarButton_show(){
this.m_bVisible=true;
};
function CToolbarButton_enable(){
this.getStyle().setActiveState("normal");
this.getStyle().setActiveRolloverState("normal");
if(this.getIcon()){
this.getIcon().enable();
}
this.updateHTML();
};
function CToolbarButton_disable(){
this.getStyle().setActiveState("disabled");
this.getStyle().setActiveRolloverState("disabled");
if(this.getIcon()){
this.getIcon().disable();
}
this.updateHTML();
};
function CToolbarButton_isEnabled(){
if(this.getIcon()){
return this.getIcon().isEnabled();
}else{
return true;
}
};
function CToolbarButton_pressed(){
this.getStyle().setActiveState("depressed");
this.getStyle().setActiveRolloverState("depressed");
this.updateHTML();
};
function CToolbarButton_reset(){
this.getStyle().setActiveState("normal");
this.getStyle().setActiveRolloverState("normal");
this.updateHTML();
};
function CToolbarButton_updateHTML(){
if(typeof this.getStyle()=="object"){
if(typeof this.getParent().getHTMLContainer=="function"){
var _1a7=this.getParent().getHTMLContainer();
if(_1a7!=null){
var _1a8=_1a7.document?_1a7.document.getElementById(this.getId()):_1a7.ownerDocument.getElementById(this.getId());
if(_1a8!=null){
var _1a9=_1a8.getElementsByTagName("img");
if(typeof _1a9!="undefined"&&_1a9 instanceof Array&&_1a9.length>0){
if(this.getIcon()){
if(this.getIcon().isEnabled()){
_1a9[0].src=this.getIcon().getPath();
}else{
_1a9[0].src=this.getIcon().getDisabledImagePath();
}
}
if(this.getToolTip()){
_1a8.title=this.getToolTip();
_1a9[0].title=this.getToolTip();
}
}
var _1aa;
if(this.getStyle().getActiveState()!=this.getStyle().getDisabledState()){
_1a8.tabIndex=1;
if(this.getMenu()!=null&&!this.m_bHideDropDown){
_1a8.nextSibling.tabIndex=1;
_1a8.nextSibling.title=this.getToolTip();
_1aa=_1a8.nextSibling.getElementsByTagName("img");
if(_1aa!=null){
_1aa[0].title=this.getToolTip();
}
}
}else{
if(_1a8.tabIndex!="undefined"){
_1a8.removeAttribute("tabIndex");
if(this.getMenu()!=null){
_1a8.nextSibling.removeAttribute("tabIndex");
_1a8.nextSibling.title=this.getToolTip();
_1aa=_1a8.nextSibling.getElementsByTagName("img");
if(_1aa!=null){
_1aa[0].title=this.getToolTip();
}
}
}
}
_1a8.className=this.getStyle().getActiveState();
}
}
}
}
};
function CToolbarButton_getObservers(){
return this.m_observers;
};
function CToolbarButton_setFocus(){
if(this.m_menu!=null&&!this.m_bHideDropDown){
document.getElementById(this.m_id).nextSibling.focus();
}else{
document.getElementById(this.m_id).focus();
}
};
CToolbarButton.prototype.draw=CToolbarButton_draw;
CToolbarButton.prototype.attachEvents=CToolbarButton_attachEvents;
CToolbarButton.prototype.onblur=CToolbarButton_onmouseout;
CToolbarButton.prototype.onfocus=CToolbarButton_onmouseover;
CToolbarButton.prototype.onkeypress=CToolbarButton_onkeypress;
CToolbarButton.prototype.onmouseover=CToolbarButton_onmouseover;
CToolbarButton.prototype.onmouseout=CToolbarButton_onmouseout;
CToolbarButton.prototype.onclick=CToolbarButton_onclick;
CToolbarButton.prototype.setParent=CToolbarButton_setParent;
CToolbarButton.prototype.getParent=CToolbarButton_getParent;
CToolbarButton.prototype.getAction=CToolbarButton_getAction;
CToolbarButton.prototype.setAction=CToolbarButton_setAction;
CToolbarButton.prototype.getToolTip=CToolbarButton_getToolTip;
CToolbarButton.prototype.setToolTip=CToolbarButton_setToolTip;
CToolbarButton.prototype.getDropDownToolTip=CToolbarButton_getDropDownToolTip;
CToolbarButton.prototype.setDropDownToolTip=CToolbarButton_setDropDownToolTip;
CToolbarButton.prototype.getIcon=CToolbarButton_getIcon;
CToolbarButton.prototype.setIcon=CToolbarButton_setIcon;
CToolbarButton.prototype.getMenu=CToolbarButton_getMenu;
CToolbarButton.prototype.getMenuType=CToolbarButton_getMenuType;
CToolbarButton.prototype.getId=CToolbarButton_getId;
CToolbarButton.prototype.setStyle=CToolbarButton_setStyle;
CToolbarButton.prototype.getStyle=CToolbarButton_getStyle;
CToolbarButton.prototype.getDropDownStyle=CToolbarButton_getDropDownStyle;
CToolbarButton.prototype.setDropDownStyle=CToolbarButton_setDropDownStyle;
CToolbarButton.prototype.createDropDownMenu=CToolbarButton_createDropDownMenu;
CToolbarButton.prototype.addOwnerDrawControl=CToolbarButton_addOwnerDrawControl;
CToolbarButton.prototype.getObservers=CToolbarButton_getObservers;
CToolbarButton.prototype.update=new Function("return true");
CToolbarButton.prototype.isVisible=CToolbarButton_isVisible;
CToolbarButton.prototype.hide=CToolbarButton_hide;
CToolbarButton.prototype.show=CToolbarButton_show;
CToolbarButton.prototype.isEnabled=CToolbarButton_isEnabled;
CToolbarButton.prototype.enable=CToolbarButton_enable;
CToolbarButton.prototype.disable=CToolbarButton_disable;
CToolbarButton.prototype.pressed=CToolbarButton_pressed;
CToolbarButton.prototype.reset=CToolbarButton_reset;
CToolbarButton.prototype.setFocus=CToolbarButton_setFocus;
CToolbarButton.prototype.updateHTML=CToolbarButton_updateHTML;
var CMODAL_ID="CMODAL_FRAME";
var CMODAL_BLUR="CMODAL_BLUR";
var CMODAL_CONTENT_ID="CMODAL_CONTENT";
var CMODAL_HEADER="CMODAL_HEADER";
var CMODAL_BACKGROUND_LAYER_ID="CMODAL_BK";
var CMODAL_BACK_IFRAME_ID="CMODAL_BK_IFRAME";
var CMODAL_ZINDEX=111;
var CMODAL_dragEnabled=false;
var CMODAL_resizeDirection=null;
var CMODAL_startLeft=null;
var CMODAL_startTop=null;
var CMODAL_startWidth=null;
var CMODAL_startHeight=null;
var CMODAL_deltaX=null;
var CMODAL_deltaY=null;
function CModal(_1ab,_1ac,_1ad,t,l,h,w,_1b2,_1b3,_1b4,_1b5,_1b6){
this.m_hideButtonBar=false;
if(typeof _1b2!="undefined"){
this.m_hideButtonBar=_1b2;
}
this.m_hideHeader=false;
if(typeof _1b3!="undefined"){
this.m_hideHeader=_1b3;
}
this.m_title=_1ab;
this.m_sCloseToolTip=_1ac;
if(_1ad){
this.m_parent=_1ad;
}else{
this.m_parent=(document.body?document.body:document.documentElement);
}
var oBL=document.getElementById(CMODAL_BACKGROUND_LAYER_ID);
if(oBL){
oBL.parentNode.removeChild(oBL);
}
if(typeof _1b6!="undefined"&&_1b6!=""){
this.m_webContentRoot=_1b6;
}else{
this.m_webContentRoot="..";
}
oBL=document.createElement("div");
oBL.id=CMODAL_BACKGROUND_LAYER_ID;
oBL.style.display="none";
oBL.style.position="absolute";
oBL.style.top="0px";
oBL.style.left="0px";
oBL.style.zIndex=(CMODAL_ZINDEX-2);
oBL.style.width="100%";
oBL.style.height="100%";
if(typeof _1b5!="undefined"&&_1b5){
oBL.style.backgroundColor="rgb(238, 238, 238)";
oBL.style.opacity="0.6";
oBL.style.filter="alpha(opacity:60)";
}
oBL.innerHTML="<table width=\"100%\" height=\"100%\" role=\"presentation\"><tr><td role=\"presentation\" onmousemove=\"CModalEvent_mousemoving(event)\" onmouseup=\"CModalEvent_disableDrag(event)\"></td></tr></table>";
this.m_parent.appendChild(oBL);
this.m_backLayer=oBL;
this.m_top=(t==null?0:t);
this.m_left=(l==null?0:l);
this.m_height=(h==null?0:h);
this.m_width=(w==null?0:w);
if(typeof _1b4!="undefined"&&_1b4==true){
this.m_height=CModal_dynamicHeight();
this.m_width=CModal_dynamicWidth();
}
if(window.attachEvent){
window.attachEvent("onresize",CModalEvent_onWindowResize);
window.attachEvent("onscroll",CModalEvent_onWindowResize);
}else{
window.addEventListener("resize",CModalEvent_onWindowResize,false);
window.addEventListener("scroll",CModalEvent_onWindowResize,false);
}
var f=document.getElementById(CMODAL_ID);
if(f){
f.parentNode.removeChild(f);
}
f=document.createElement("span");
f.id=CMODAL_ID;
f.CModal=this;
f.className="CModal_frame";
f.style.zIndex=CMODAL_ZINDEX;
f.style.border="#99aacc 1px solid";
var div=this.createHiddenDiv("CMODAL_TAB_LOOP_BEFORE",0);
div.onfocus=function(){
document.getElementById("CMODAL_AFTER_PLACEHOLDER").focus();
};
this.m_parent.appendChild(f);
div=this.createHiddenDiv("CMODAL_AFTER_PLACEHOLDER",-1);
div=this.createHiddenDiv("CMODAL_TAB_LOOP_AFTER",0);
div.onfocus=function(){
document.getElementById(CMODAL_CONTENT_ID).contentWindow.focus();
};
this.m_back_iframe=document.getElementById(CMODAL_BACK_IFRAME_ID);
if(this.m_back_iframe){
this.m_back_iframe.parentNode.removeChild(this.m_back_iframe);
}
this.m_back_iframe=document.createElement("iframe");
this.m_back_iframe.id=CMODAL_BACK_IFRAME_ID;
this.m_back_iframe.frameBorder=0;
this.m_back_iframe.src=this.m_webContentRoot+"/common/blank.html";
this.m_back_iframe.style.position="absolute";
this.m_back_iframe.style.zIndex=CMODAL_ZINDEX-1;
this.m_back_iframe.onfocus=function(){
document.getElementById(CMODAL_BACKGROUND_LAYER_ID).focus();
};
this.m_back_iframe.tabIndex=1;
this.m_back_iframe.title="Empty frame";
this.m_back_iframe.role="presentation";
this.m_parent.appendChild(this.m_back_iframe);
f.innerHTML=this.renderDialogFrame();
this.m_frame=f;
};
function CModal_createHiddenDiv(_1ba,_1bb){
var div=document.getElementById(_1ba);
if(div){
div.parentNode.removeChild(div);
}
div=document.createElement("div");
div.id=_1ba;
div.tabIndex=_1bb;
div.style.position="absolute";
div.style.overflow="hidden";
div.style.width="0px";
div.style.height="0px";
this.m_parent.appendChild(div);
return div;
};
function CModal_hide(){
this.m_top=parseInt(this.m_frame.offsetTop,10);
this.m_left=parseInt(this.m_frame.offsetLeft,10);
this.m_height=parseInt(this.m_frame.offsetHeight,10);
this.m_width=parseInt(this.m_frame.offsetWidth,10);
this.m_backLayer.style.display="none";
this.m_frame.style.display="none";
if(this.m_back_iframe){
this.m_back_iframe.style.display="none";
}
};
function CModal_reCenter(){
this.m_left=(document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientWidth-this.m_width)/2;
this.m_top=(document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientHeight-this.m_height)/2;
};
function CModal_renderDialogFrame(){
var _1bd="summary=\"\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" role=\"presentation\"";
var out="<table role=\"presentation\" style=\"width:100%; height:99%; padding-top:2px;\" "+_1bd+" onmouseup=\"CModalEvent_disableDrag(event)\" onmousemove=\"CModalEvent_mousemoving(event)\">";
if(!this.m_hideHeader){
out+=""+"<tr>"+"<td role=\"presentation\" onmousedown=\"CModalEvent_enableDrag(event);\">"+"<table class=\"dialogHeader\" width=\"100%\" "+_1bd+">"+"<tr>"+"<td id=\""+CMODAL_HEADER+"\" valign=\"top\" class=\"dialogHeaderTitle\" width=\"100%\" nowrap=\"nowrap\">"+getConfigFrame().htmlencode(this.m_title)+"</td><td align=\"right\" valign=\"middle\">"+"<a onclick=\"hideCModal()\" style=\"cursor:pointer;\">"+"<img height=\"16\" width=\"16\" vspace=\"2\" border=\"0\" class=\"dialogClose\" onmouseover=\"this.className = 'dialogCloseOver'\" onmouseout=\"this.className = 'dialogClose'\" onmouseup=\"this.className = 'dialogClose'\" src=\""+p_sSkinFolder+"/portal/images/close.gif\" alt=\""+getConfigFrame().htmlencode(this.m_sCloseToolTip)+"\" title=\""+getConfigFrame().htmlencode(this.m_sCloseToolTip)+"\">"+"</a>"+"</td>"+"</tr>"+"</table>"+"</td>"+"</tr>";
}
out+="<tr><td role=\"presentation\" width=\"100%\" height=\"100%\" class=\"body_dialog_modal\" onmousemove=\"CModalEvent_mousemoving(event)\" onmouseup=\"CModalEvent_disableDrag(event)\">"+"<iframe title=\"modal dialog\" id=\""+CMODAL_CONTENT_ID+"\" name=\""+CMODAL_CONTENT_ID+"\" class=\"body_dialog_modal\" src=\""+this.m_webContentRoot+"/"+"qs"+"/blankNewWin.html\" style=\"padding:0px;margin:0px;width:100%;height:100%;\" frameborder=\"0\">no iframe support?</iframe>"+"</td></tr>";
if(!this.m_hideButtonBar){
out+="<tr><td>"+"<table "+_1bd+" class=\"dialogButtonBar\" style=\"padding:0px\">"+"<tr>"+"<td width=\"2\" valign=\"middle\"><img width=\"2\" alt=\"\" src=\""+this.m_webContentRoot+"/ps/images/space.gif\"></td>"+"<td valign=\"middle\"><table border=\"0\" cellpadding=\"1\" cellspacing=\"0\" role=\"presentation\">"+"<tr>"+"<td><img height=\"1\" width=\"8\" alt=\"\" src=\""+this.m_webContentRoot+"/ps/images/space.gif\"></td>"+"<td>"+CModal_renderButton(msgQS["OK"],"okCModal()")+"</td>"+"<td><img height=\"1\" width=\"8\" alt=\"\" src=\""+this.m_webContentRoot+"/ps/images/space.gif\"></td>"+"<td>"+CModal_renderButton(msgQS["CANCEL"],"cancelCModal()")+"</td>"+"<td><img height=\"1\" width=\"8\" alt=\"\" src=\""+this.m_webContentRoot+"/ps/images/space.gif\"></td>"+"</tr></table>"+"</td><td width=\"100%\">&nbsp;</td>"+"<td style=\"padding:3px;\" valign=\"bottom\" class=\"CModal_sideSE\" onmousedown=\"CModalEvent_enableResize(event)\">"+"<img role=\"presentation\" class=\"CModal_sideSE\" style=\"cursor:se-resize;\" alt=\"\" height=\"12\" width=\"12\" border=\"0\" src=\""+this.m_webContentRoot+"/common/images/dialog_resize.gif\" onmousedown=\"CModalEvent_enableResize(event);return false;\" onmouseup=\"CModalEvent_disableDrag(event);return false;\" onmousemove=\"CModalEvent_mousemoving(event);return false;\">"+"</td>"+"</tr></table></td></tr>";
}
out+="</table>";
return out;
};
function CModal_renderButton(_1bf,_1c0){
var out="<table cellpadding=\"0\" cellspacing=\"0\" style=\"padding: 2px 10px 3px;\" class=\"commandButton\" onmouseover=\"this.className='commandButtonOver'\""+" onmouseout=\"this.className = 'commandButton'\" onmousedown=\"this.className='commandButtonDown'\">"+"<tr>"+"<td style=\"cursor:pointer;\" valign=\"middle\" align=\"center\" nowrap id=\"btnAnchor\" onclick=\""+_1c0+"\">"+" <img height=\"1\" width=\"60\" alt=\"\" src=\""+this.m_webContentRoot+"/ps/images/space.gif\"><br>"+_1bf+"</td></tr></table>";
return out;
};
function CModal_show(){
this.m_backLayer.style.display="";
this.reCenter();
var _1c2=CMenu_getScrollingPosition();
this.m_frame.style.top=(_1c2.y+this.m_top)+"px";
this.m_frame.style.left=(_1c2.x+this.m_left)+"px";
this.m_frame.style.height=this.m_height+"px";
this.m_frame.style.width=this.m_width+"px";
this.m_frame.style.display="inline";
this.m_frame.focus();
if(this.m_back_iframe){
this.m_back_iframe.style.top=this.m_frame.offsetTop+"px";
this.m_back_iframe.style.left=this.m_frame.offsetLeft+"px";
this.m_back_iframe.style.height=this.m_frame.offsetHeight+"px";
this.m_back_iframe.style.width=this.m_frame.offsetWidth+"px";
this.m_back_iframe.style.display="block";
}
};
CModal.prototype.hide=CModal_hide;
CModal.prototype.createHiddenDiv=CModal_createHiddenDiv;
CModal.prototype.reCenter=CModal_reCenter;
CModal.prototype.renderDialogFrame=CModal_renderDialogFrame;
CModal.prototype.show=CModal_show;
function hideCModal(){
var cdlg=document.getElementById(CMODAL_ID);
if(cdlg&&cdlg.CModal){
cdlg.CModal.hide();
}
};
function destroyCModal(){
var oBL=document.getElementById(CMODAL_BACKGROUND_LAYER_ID);
if(oBL){
oBL.style.display="none";
}
var _1c5=document.getElementById(CMODAL_ID);
if(_1c5){
_1c5.style.display="none";
}
var _1c6=document.getElementById(CMODAL_BACK_IFRAME_ID);
if(_1c6){
_1c6.style.display="none";
}
if(window.detachEvent){
window.detachEvent("onresize",CModalEvent_onWindowResize);
window.detachEvent("onscroll",CModalEvent_onWindowResize);
}else{
window.removeEventListener("resize",CModalEvent_onWindowResize,false);
window.removeEventListener("scroll",CModalEvent_onWindowResize,false);
}
};
function cancelCModal(){
var _1c7=document.getElementById(CMODAL_CONTENT_ID);
if(_1c7&&_1c7.contentWindow&&typeof _1c7.contentWindow.cancelDialog=="function"){
_1c7.contentWindow.cancelDialog();
}else{
hideCModal();
}
};
function okCModal(){
var _1c8=document.getElementById(CMODAL_CONTENT_ID);
if(_1c8&&_1c8.contentWindow&&typeof _1c8.contentWindow.execute=="function"){
_1c8.contentWindow.execute();
}else{
hideCModal();
}
};
function CModal_dynamicWidth(){
return (window.innerWidth!=null?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body!=null?document.body.clientWidth:null)-150;
};
function CModal_dynamicHeight(){
return (window.innerHeight!=null?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body!=null?document.body.clientHeight:null)-150;
};
function CModal_setModalHeight(_1c9){
var _1ca=_1c9.getAttribute("storedHeight");
if(_1c9.offsetHeight>document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientHeight){
if(_1ca==null){
_1c9.setAttribute("storedHeight",_1c9.offsetHeight);
}
_1c9.style.height=document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientHeight+"px";
}else{
if(_1ca!=null){
if(_1ca<document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientHeight){
_1c9.style.height=_1ca+"px";
}else{
_1c9.style.height=document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientHeight+"px";
}
}
}
};
function CModal_setModalWidth(_1cb){
var _1cc=_1cb.getAttribute("storedWidth");
if(_1cb.offsetWidth>document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientWidth){
if(_1cc==null){
_1cb.setAttribute("storedWidth",_1cb.offsetWidth);
}
_1cb.style.width=document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientWidth+"px";
}else{
if(_1cc!=null){
if(_1cc<document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientWidth){
_1cb.removeAttribute("storedWidth");
_1cb.style.width=_1cc+"px";
}else{
_1cb.style.width=document.getElementById(CMODAL_BACKGROUND_LAYER_ID).clientWidth+"px";
}
}
}
};
function CModalEvent_onWindowResize(e){
var _1ce=document.getElementById(CMODAL_ID);
var _1cf=document.getElementById(CMODAL_BACKGROUND_LAYER_ID);
var _1d0=document.getElementById(CMODAL_BACK_IFRAME_ID);
if(_1ce&&_1cf&&_1d0){
CModal_setModalWidth(_1ce);
CModal_setModalHeight(_1ce);
var _1d1=CMenu_getScrollingPosition();
var _1d2=(_1d1.y+((_1cf.clientHeight-_1ce.offsetHeight)/2));
var _1d3=(_1d1.x+((_1cf.clientWidth-_1ce.offsetWidth)/2));
_1ce.style.top=_1d2+"px";
_1ce.style.left=_1d3+"px";
_1d0.style.top=_1d2+"px";
_1d0.style.width=_1ce.style.width;
_1d0.style.height=_1ce.style.height;
_1d0.style.left=_1d3+"px";
}
};
function CModalEvent_mousemoving(e){
var oDlg=null;
var _1d6=null;
if(CMODAL_dragEnabled){
if(e==null&&(typeof event=="object")&&event.clientX!=null){
e=event;
}
oDlg=document.getElementById(CMODAL_ID);
if(CMODAL_startLeft==null){
CMODAL_startLeft=parseInt(oDlg.style.left,10)-e.clientX;
CMODAL_startTop=parseInt(oDlg.style.top,10)-e.clientY;
}
oDlg.style.left=CMODAL_startLeft+e.clientX;
oDlg.style.top=CMODAL_startTop+e.clientY;
_1d6=document.getElementById(CMODAL_BACK_IFRAME_ID);
if(_1d6){
_1d6.style.left=oDlg.style.left;
_1d6.style.top=oDlg.style.top;
}
}
if(CMODAL_resizeDirection){
if(e==null&&(typeof event=="object")&&event.clientX!=null){
e=event;
}
oDlg=document.getElementById(CMODAL_ID);
if(CMODAL_startLeft==null){
CMODAL_startLeft=parseInt(oDlg.style.left,10);
CMODAL_startTop=parseInt(oDlg.style.top,10);
CMODAL_startHeight=parseInt(oDlg.style.height,10);
CMODAL_startWidth=parseInt(oDlg.style.width,10);
}
var h=0,w=0;
switch(CMODAL_resizeDirection){
case "NE":
case "E":
case "SE":
w=(e.clientX-CMODAL_startLeft+CMODAL_deltaX);
if(w<100){
w=100;
}
oDlg.style.width=w+"px";
}
switch(CMODAL_resizeDirection){
case "SW":
case "S":
case "SE":
h=(e.clientY-CMODAL_startTop+CMODAL_deltaY);
if(h<100){
h=100;
}
oDlg.style.height=h+"px";
}
switch(CMODAL_resizeDirection){
case "NW":
case "N":
case "NE":
oDlg.style.top=e.clientY;
h=(CMODAL_startHeight+(CMODAL_startTop-e.clientY)+CMODAL_deltaY);
if(h<100){
h=100;
}
oDlg.style.height=h+"px";
}
switch(CMODAL_resizeDirection){
case "NW":
case "W":
case "SW":
oDlg.style.left=e.clientX;
w=(CMODAL_startWidth+(CMODAL_startLeft-e.clientX)+CMODAL_deltaX);
if(w<100){
w=100;
}
oDlg.style.width=w+"px";
}
_1d6=document.getElementById(CMODAL_BACK_IFRAME_ID);
if(_1d6){
_1d6.style.left=oDlg.offsetLeft;
_1d6.style.top=oDlg.offsetTop;
_1d6.style.height=oDlg.offsetHeight;
_1d6.style.width=oDlg.offsetWidth;
}
}
if(e.returnValue){
e.returnValue=false;
}else{
if(e.preventDefault){
e.preventDefault();
}else{
return false;
}
}
};
function CModalEvent_disableDrag(e){
CMODAL_dragEnabled=false;
CMODAL_resizeDirection=null;
CMODAL_startLeft=null;
CMODAL_startTop=null;
CMODAL_deltaX=0;
CMODAL_deltaY=0;
var cn=document.getElementById(CMODAL_ID).className;
var _1db=document.getElementById(CMODAL_HEADER);
if(_1db!=null){
_1db.style.cursor="default";
}
document.getElementById(CMODAL_ID).className=cn.replace(/\s*\bCModal_dragging\b/g,"");
document.getElementById(CMODAL_CONTENT_ID).style.visibility="visible";
if(typeof document.getElementById(CMODAL_CONTENT_ID).contentWindow.refreshContent=="function"){
document.getElementById(CMODAL_CONTENT_ID).contentWindow.refreshContent();
}
if(e.returnValue){
e.returnValue=false;
}else{
if(e.preventDefault){
e.preventDefault();
}else{
return false;
}
}
};
function CModalEvent_enableDrag(e){
CMODAL_dragEnabled=true;
CMODAL_startLeft=null;
CMODAL_startTop=null;
if(e==null&&(typeof event=="object")&&event.clientX!=null){
e=event;
}
document.getElementById(CMODAL_ID).className+=" CModal_dragging";
document.getElementById(CMODAL_HEADER).style.cursor="move";
document.getElementById(CMODAL_CONTENT_ID).style.visibility="hidden";
if(e.returnValue){
e.returnValue=false;
}else{
if(e.preventDefault){
e.preventDefault();
}else{
return false;
}
}
};
function CModalEvent_enableResize(e){
CMODAL_startLeft=null;
CMODAL_startTop=null;
CMODAL_startWidth=null;
CMODAL_startHeight=null;
CMODAL_deltaX=0;
CMODAL_deltaY=0;
if(e==null&&(typeof event=="object")&&event.clientX!=null){
e=event;
}
var oDlg=document.getElementById(CMODAL_ID);
CMODAL_startLeft=parseInt(oDlg.style.left,10);
CMODAL_startTop=parseInt(oDlg.style.top,10);
CMODAL_startHeight=parseInt(oDlg.style.height,10);
CMODAL_startWidth=parseInt(oDlg.style.width,10);
CMODAL_deltaX=(CMODAL_startLeft+CMODAL_startWidth-e.clientX);
CMODAL_deltaY=(CMODAL_startTop+CMODAL_startHeight-e.clientY);
var src=(e.srcElement?e.srcElement:e.target);
if((/\bCModal_side(\w+)\b/).test(src.className)){
CMODAL_resizeDirection=RegExp.$1;
document.getElementById(CMODAL_ID).className+=" CModal_dragging";
document.getElementById(CMODAL_CONTENT_ID).style.visibility="hidden";
}
if(e.returnValue){
e.returnValue=false;
}else{
if(e.preventDefault){
e.preventDefault();
}else{
return false;
}
}
};
function CMenuEntry(){
this.m_menu=null;
this.m_menuType="";
this.m_action=null;
this.m_bEnabled=true;
};
function CMenuEntry_setParent(_1e0){
this.m_parent=_1e0;
};
function CMenuEntry_getParent(){
return this.m_parent;
};
function CMenuEntry_setWebContentRoot(_1e1){
this.m_webContentRoot=_1e1;
};
function CMenuEntry_setId(id){
this.m_id=id;
};
function CMenuEntry_getId(){
return this.m_id;
};
function CMenuEntry_getObservers(){
return this.m_observers;
};
function CMenuEntry_onkeydown(evt){
evt=(evt)?evt:((event)?event:null);
if(typeof evt!="object"||evt==null){
return;
}
var i=0,ii,_1e6,_1e7,_1e8;
var _1e9=true;
var _1ea=evt.currentTarget||evt.srcElement;
if(evt.keyCode==9&&evt.shiftKey){
_1e8=this.getParent();
for(i=0;i<_1e8.getNumItems();i++){
if(_1e8.get(i)==this){
_1e8.hide();
this.getObservers().notify("CMenuItem_closeMenuTabEvent");
var _1eb=_1e8.getMenuType?_1e8.getMenuType():null;
if(_1eb!==cHorizonalBar&&_1eb!==cVerticalBar){
if(isIE()){
evt.preventDefault();
}else{
evt.returnValue=false;
}
}
break;
}else{
if(this.getParent().get(i).m_bEnabled==true){
break;
}
}
}
}else{
if(evt.keyCode==9){
if(this.isInMenu()){
for(i=(this.getParent().getNumItems()-1);i>=0;i++){
if(this.getParent().get(i)==this){
if(this.getMenu()){
this.getMenu().hide();
}
this.getParent().hide();
this.getObservers().notify("CMenuItem_closeMenuTabEvent");
if(isIE()){
evt.preventDefault();
}else{
evt.returnValue=false;
}
break;
}else{
if(this.getParent().get(i).m_bEnabled==true){
break;
}
}
}
}else{
if(typeof this.getParent().closeAllMenus=="function"){
this.getParent().closeAllMenus();
}else{
if(typeof this.getParent().closeMenus=="function"){
this.getParent().closeMenus();
}
}
}
}else{
if(evt.keyCode==40){
if(this.isInMenu()){
_1e6=this.getParent().getNumItems();
for(i=0;i<_1e6;i++){
if(this===this.getParent().get(i)){
var _1ec=0;
var _1ed=true;
if(i!=(_1e6-1)){
_1ec=i+1;
_1ed=false;
}
for(ii=_1ec;ii<_1e6;ii++){
_1e7=this.getParent().get(ii);
if(typeof _1e7.isVisible=="function"&&_1e7.isVisible()&&typeof _1e7.setFocus=="function"){
_1e7.setFocus();
break;
}
if(ii==(_1e6-1)&&!_1ed){
ii=0;
_1ed=true;
}
}
break;
}
}
}else{
if(this.isEnabled()){
_1e9=false;
var menu=this.getMenu();
if(this.getMenuType()=="dropDown"){
if(menu.isVisible()==false){
menu.setHTMLContainer(_1ea.document?_1ea.document.body:_1ea.ownerDocument.body);
menu.draw();
menu.show();
}else{
menu.remove();
}
}
}
}
}else{
if(evt.keyCode==38&&this.isInMenu()){
_1e6=this.getParent().getNumItems();
for(i=0;i<_1e6;i++){
if(this===this.getParent().get(i)){
var _1ec=i-1;
var _1ef=false;
if(i<=0){
_1ec=_1e6-1;
_1ef=true;
}
for(ii=_1ec;ii>=0;ii--){
_1e7=this.getParent().get(ii);
if(typeof _1e7.isVisible=="function"&&_1e7.isVisible()&&typeof _1e7.setFocus=="function"){
_1e7.setFocus();
break;
}
if(ii==0&&!_1ef){
_1ef=true;
ii=_1e6;
}
}
break;
}
}
}else{
if(evt.keyCode==37||evt.keyCode==39){
if(this.isEnabled()&&this.getMenu()!=null){
var menu=this.getMenu();
if(this.getMenuType()=="cascaded"){
_1e9=false;
if(menu.isVisible()==false){
menu.setHTMLContainer(_1ea.document?_1ea.document.body:_1ea.ownerDocument.body);
menu.draw();
menu.show();
}
}
}else{
_1e9=false;
_1e8=this.getParent();
if(_1e8&&_1e8.getParent()&&_1e8.getParent().getMenuType()=="cascaded"){
_1e8.hide();
}
}
}
}
}
}
}
if(_1e9&&this.getParent()!=null&&typeof this.getParent().onkeydown=="function"){
this.getParent().onkeydown(evt);
}
this.getObservers().notify(CMenuItem_onkeydown);
};
function CMenuEntry_onkeypress(evt){
evt=(evt)?evt:((event)?event:null);
var _1f1=evt.keyCode;
if(_1f1==0&&typeof evt.charCode!="undefined"){
_1f1=evt.charCode;
}
if(typeof evt=="object"&&evt!=null){
var _1f2=evt.currentTarget||evt.srcElement;
var _1f3=true;
if(_1f1==9||_1f1==37||_1f1==38||_1f1==39||_1f1==40){
_1f3=false;
}else{
if(_1f1==13||_1f1==32){
if(!this.isEnabled()){
return;
}
if(this.getMenu()!=null){
var menu=this.getMenu();
if(this.getMenuType()=="cascaded"){
_1f3=false;
if(menu.isVisible()==false){
menu.setHTMLContainer(_1f2.document?_1f2.document.body:_1f2.ownerDocument.body);
menu.draw();
menu.show();
}else{
menu.remove();
}
}else{
if(this.getMenuType()=="dropDown"){
if(menu.isVisible()==false){
menu.setHTMLContainer(_1f2.document?_1f2.document.body:_1f2.ownerDocument.body);
menu.draw();
menu.show();
}else{
menu.remove();
}
}
}
}else{
eval(this.getAction());
}
}else{
if(_1f1==27){
this.getParent().hide();
return;
}
}
}
if(_1f3){
if(this.getParent()!=null&&typeof this.getParent().onkeypress=="function"){
this.getParent().onkeypress(evt);
}
this.getObservers().notify(CMenuItem_onkeypress);
}
}
if(_1f1==13||_1f1==0||_1f1==40||_1f1==38){
if(evt!=null){
evt.cancelBubble=true;
}
return false;
}
return true;
};
function CMenuEntry_getMenu(){
return this.m_menu;
};
function CMenuEntry_getMenuType(){
return this.m_menuType;
};
function CMenuEntry_isEnabled(){
return this.m_bEnabled;
};
function CMenuEntry_isInMenu(){
return this.getParent() instanceof CMenu;
};
function CMenuEntry_getAction(){
return this.m_action;
};
function CMenuEntry_setAction(_1f5){
this.m_action=_1f5;
};
CMenuEntry.prototype.getObservers=CMenuEntry_getObservers;
CMenuEntry.prototype.setId=CMenuEntry_setId;
CMenuEntry.prototype.getId=CMenuEntry_getId;
CMenuEntry.prototype.onkeypress=CMenuEntry_onkeypress;
CMenuEntry.prototype.onkeydown=CMenuEntry_onkeydown;
CMenuEntry.prototype.getMenu=CMenuEntry_getMenu;
CMenuEntry.prototype.getMenuType=CMenuEntry_getMenuType;
CMenuEntry.prototype.setParent=CMenuEntry_setParent;
CMenuEntry.prototype.getParent=CMenuEntry_getParent;
CMenuEntry.prototype.setWebContentRoot=CMenuEntry_setWebContentRoot;
CMenuEntry.prototype.isEnabled=CMenuEntry_isEnabled;
CMenuEntry.prototype.isInMenu=CMenuEntry_isInMenu;
CMenuEntry.prototype.getAction=CMenuEntry_getAction;
CMenuEntry.prototype.setAction=CMenuEntry_setAction;
var theMenuCnt=1;
function CMenuItem(_1f6,_1f7,_1f8,_1f9,_1fa,_1fb,skin){
this.m_label=_1f7;
if(this.m_label){
this.m_label=this.m_label.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
}
this.setId(escape(_1f7)+theMenuCnt++);
this.m_bVisible=true;
this.setAction(_1f8);
this.setWebContentRoot(_1fb);
var _1fd=_1f9;
if((typeof gCognosViewer!="undefined")&&(gCognosViewer.envParams["isTitan"])&&(gCognosViewer.envParams["isTitan"]==true)){
_1fd="blankIcon";
}
this.m_icon=new CIcon(_1fd,"",this.m_webContentRoot);
this.setParent(_1f6);
this.m_style=_1fa;
this.m_observers=new CObserver(this);
if(typeof skin!="undefined"&&skin!=""){
this.m_sSkin=skin;
}else{
this.m_sSkin=(typeof getPromptSkin!="undefined"?getPromptSkin():this.m_webContentRoot+"/skins/corporate");
}
if(typeof this.m_parent=="object"&&typeof this.m_parent.add=="function"){
this.m_parent.add(this);
}
this.m_sDropDownArrow="dropdown_arrow_banner.gif";
};
CMenuItem.prototype=new CMenuEntry();
CMenuItem.prototype.setDropDownArrow=function(_1fe){
this.m_sDropDownArrow=_1fe;
};
CMenuItem.prototype.getDropDownArrow=function(){
return this.m_sDropDownArrow;
};
function CMenuItem_setId(id){
this.m_id=id;
};
function CMenuItem_setIcon(_200){
this.m_icon.setPath(_200);
};
function CMenuItem_setToolTip(_201){
this.m_icon.m_toolTip=_201;
};
function CMenuItem_getToolTip(){
return this.m_icon.m_toolTip;
};
function CMenuItem_setAltText(_202){
this.m_sAltText=_202;
};
function CMenuItem_getAltText(){
if(this.m_sAltText){
return this.m_sAltText;
}else{
return "";
}
};
function CMenuItem_genARIATags(){
var html="";
if(this.isInMenu()){
html+=" role=\"menuitem\" ";
}else{
html+=" role=\"button\" ";
}
if(this.m_menuType=="dropDown"||this.m_menuType=="cascaded"){
html+=" aria-haspopup=\"true\" ";
}
if(this.getAltText().length==0){
this.setAltText(this.m_label);
}
if((this.getAltText()&&this.getAltText().length>0)||(this.m_icon&&this.m_icon.getToolTip())){
html+=" aria-labelledby=\""+this.m_id+"label\" ";
}
if(!this.isEnabled()){
html+=" aria-disabled=\"true\" ";
}
return html;
};
function CMenuItem_genMenuItemAltText(){
var html="";
if((this.getAltText()&&this.getAltText().length>0)||(this.m_icon&&this.m_icon.getToolTip())){
html+="<div style=\"position: absolute; overflow: hidden; width: 0; height: 0;\" id=\""+this.m_id+"label\">";
if(this.getAltText()&&this.getAltText().length>0){
html+=this.getAltText();
}else{
html+=this.m_icon.getToolTip();
}
html+="</div>";
}
return html;
};
function CMenuItem_draw(){
var html="<div>";
var _206=false,_207=null,_208=null,_209=0;
if(this.m_menu==null||this.m_menuType=="dropDown"){
html+="<table ";
html+=this.genARIATags();
if(this.isInMenu()){
if(this.isEnabled()){
html+=" hideFocus=\"true\" ";
}
html+=" tabIndex=\"0\" ";
}else{
if(this.isEnabled()){
html+=" tabIndex=\"0\"";
}
}
html+=" width=\"100%\" ";
html+="class=\"";
if(typeof this.getStyle()=="object"){
if(this.isEnabled()){
html+=this.getStyle().getNormalState();
}else{
html+=this.getStyle().getDisabledState();
}
}
html+="\" id=\"";
html+=this.getId();
html+="\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin-bottom:1px;\"><tr>";
_206=false;
if(this.m_icon.getPath()==""&&this.m_parent instanceof CMenu){
_207=this.m_parent.getNumItems();
for(_209=0;_209<_207;++_209){
_208=this.m_parent.get(_209);
if(typeof _208.getIcon=="function"&&_208.getIcon().getPath()){
_206=true;
break;
}
}
}
if(_206||this.m_icon.getPath()!=""){
var f="";
if(getViewerDirection()=="rtl"){
f=" float: right;";
}
html+="<td width=\"16\" style=\"padding-right: 2px; padding-left: 2px;"+f+"\">";
if(this.m_icon.getPath()!=""){
html+=this.m_icon.draw();
}else{
html+="<img alt=\"\" src=\""+this.m_webContentRoot+"/common/images/spacer.gif\" width=\"16\"/>";
}
html+="</td>";
}
if(getViewerDirection()=="rtl"){
html+="<td nowrap=\"nowrap\" align=\"right\">";
}else{
html+="<td nowrap=\"nowrap\" align=\"left\">";
}
html+=this.m_label;
html+=this.genMenuItemAltText();
html+="</td>";
if(this.m_menuType=="dropDown"){
html+="<td width=\"10%\" align=\"right\" style=\"padding-right: 3px;padding-left: 3px\">";
html+="<img alt=\"\" src=\""+this.m_sSkin;
if(this.getDropDownArrow()=="dropdown_arrow_banner.gif"){
html+="/shared/images/";
}else{
html+="/portal/images/";
}
html+=this.getDropDownArrow()+"\" WIDTH=\"7\" HEIGHT=\"16\" style=\"vertical-align:middle;\"/>";
html+="</td>";
}
html+="</tr></table></div>";
}else{
html+="<table";
html+=this.genARIATags();
if(this.isEnabled()||this.isInMenu()){
html+=" tabIndex=\"0\" hideFocus=\"true\"";
}
html+=" width=\"100%\" class=\"";
if(typeof this.getStyle()=="object"){
if(this.isEnabled()){
html+=this.getStyle().getNormalState();
}else{
html+=this.getStyle().getDisabledState();
}
}
html+="\" id=\"";
html+=this.getId();
html+="\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin-bottom:1px;\"><tr>";
html+="<td";
_206=false;
if(this.m_icon.getPath()==""){
_207=this.m_parent.getNumItems();
for(_209=0;_209<_207;++_209){
_208=this.m_parent.get(_209);
if(typeof _208.getIcon=="function"&&_208.getIcon().getPath()){
_206=true;
break;
}
}
}
if(_206||this.m_icon.getPath()!=""){
html+=" width=\"16\" style=\"padding-right: 2px; padding-left: 2px;\">";
}else{
html+=" width=\"1\">";
}
html+=this.m_icon.draw();
html+="</td>";
if(getViewerDirection()=="rtl"){
html+="<td nowrap=\"nowrap\" align=\"right\">";
}else{
html+="<td nowrap=\"nowrap\" align=\"left\">";
}
html+=this.m_label;
html+=this.genMenuItemAltText();
html+="</td>";
if(getViewerDirection()=="rtl"){
html+="<td width=\"10%\" align=\"left\">";
html+="<img style=\"vertical-align:middle;\" alt=\"\" src=\""+this.m_sSkin+"/viewer/images/menu_expand_rtl.gif\" WIDTH=\"13\" HEIGHT=\"13\"/>";
}else{
html+="<td width=\"10%\" align=\"right\">";
html+="<img style=\"vertical-align:middle;\" alt=\"\" src=\""+this.m_sSkin+"/viewer/images/menu_expand.gif\" WIDTH=\"13\" HEIGHT=\"13\"/>";
}
html+="</td>";
html+="</tr></table>";
html+="</div>";
}
return html;
};
function CMenuItem_onmouseover(evt){
evt=(evt)?evt:((event)?event:null);
var _20c=null;
if(typeof this.menuItem!="undefined"){
_20c=this.menuItem;
}else{
if(this instanceof CMenuItem){
_20c=this;
}
}
if(_20c==null||!(_20c instanceof CMenuItem)||!_20c.isEnabled()){
return;
}
var menu=_20c.getMenu();
if(typeof _20c.getStyle()=="object"&&(menu!=null||typeof _20c.getIcon().getPath()!="undefined")){
this.className=_20c.getStyle().getRolloverState();
}
if(menu!=null){
var _20e=0;
var _20f=0;
if(typeof window.innerWidth!="undefined"){
_20e=window.innerWidth;
}else{
_20e=document.body.clientWidth;
}
if(typeof window.innerHeight!="undefined"){
_20f=window.innerHeight;
}else{
_20f=document.body.clientHeight;
}
if(_20c.getMenuType()=="cascaded"){
if(menu.isVisible()==false){
menu.setHTMLContainer(this.document?this.document.body:this.ownerDocument.body);
menu.draw();
menu.show();
}
}else{
if(_20c.getMenuType()=="dropDown"){
var _210=_20c.getParent();
var _211=_210.getNumItems();
for(var i=0;i<_211;++i){
var _213=_210.get(i);
if(_213!=_20c&&typeof _213.getMenu=="function"&&_213.getMenu()&&_213.getMenu().isVisible()){
menu.setHTMLContainer(this.document?this.document.body:this.ownerDocument.body);
menu.draw();
menu.show();
break;
}
}
}
}
}
if(_20c.getParent()!=null&&typeof _20c.getParent().onmouseover=="function"){
_20c.getParent().onmouseover(evt);
}
_20c.getObservers().notify(CMenuItem_onmouseover);
};
function CMenuItem_onfocus(evt){
evt=(evt)?evt:((event)?event:null);
var _215=null;
if(typeof this.menuItem!="undefined"){
_215=this.menuItem;
}else{
if(this instanceof CMenuItem){
_215=this;
}
}
if(_215==null||!(_215 instanceof CMenuItem)||!_215.isEnabled()){
return;
}
if(typeof _215.getStyle()=="object"){
this.className=_215.getStyle().getRolloverState();
}
if(_215.getParent()!=null&&typeof _215.getParent().onmouseover=="function"){
_215.getParent().onmouseover(evt);
}
_215.getObservers().notify(CMenuItem_onfocus);
};
function CMenuItem_onmouseout(evt){
evt=(evt)?evt:((event)?event:null);
var _217=null;
if(typeof this.menuItem!="undefined"){
_217=this.menuItem;
}else{
if(this instanceof CMenuItem){
_217=this;
}
}
if(_217==null||!(_217 instanceof CMenuItem)||!_217.isEnabled()){
return;
}
if(typeof _217.getStyle()=="object"){
this.className=_217.getStyle().getNormalState();
}
if(_217.getParent()!=null&&typeof _217.getParent().onmouseout=="function"){
_217.getParent().onmouseout(evt);
}
_217.getObservers().notify(CMenuItem_onmouseout);
};
function CMenuItem_onclick(evt){
evt=(evt)?evt:((event)?event:null);
if(evt!=null){
evt.cancelBubble=true;
}
return false;
};
function CMenuItem_onmouseup(evt){
evt=(evt)?evt:((event)?event:null);
var _21a=null;
if(typeof this.menuItem!="undefined"){
_21a=this.menuItem;
}else{
if(this instanceof CMenuItem){
_21a=this;
}
}
if(_21a!=null&&_21a instanceof CMenuItem){
if(!_21a.isEnabled()){
return;
}
if(_21a.getMenu()!=null){
if(_21a.getMenuType()=="cascaded"){
}else{
if(_21a.getMenuType()=="dropDown"){
var menu=_21a.getMenu();
if(menu.isVisible()==false){
if(!this.document&&!this.ownerDocument){
return;
}
menu.setHTMLContainer(this.document?this.document.body:this.ownerDocument.body);
menu.draw();
menu.show();
}else{
menu.remove();
}
}
}
}else{
eval(_21a.getAction());
}
if(typeof getReportFrame!="undefined"&&typeof getReportFrame().clearTextSelection!="undefined"){
getReportFrame().clearTextSelection();
}else{
if(typeof clearTextSelection!="undefined"){
clearTextSelection();
}
}
if(_21a.getMenuType()!="cascaded"){
if(_21a.getParent()!=null&&typeof _21a.getParent().onmouseup=="function"){
_21a.getParent().onmouseup(evt);
}
_21a.getObservers().notify(CMenuItem_onmouseup);
}
if(typeof this.menuItem!="undefined"&&_21a.getMenu()!=null&&_21a.getMenuType()=="cascaded"&&_21a.getAction()!=""){
eval(_21a.getAction());
}
}
if(evt!=null){
evt.cancelBubble=true;
}
return false;
};
function CMenuItem_onkeydown(evt){
var _21d=null;
if(typeof this.menuItem!="undefined"){
_21d=this.menuItem;
}else{
if(this instanceof CMenuItem){
_21d=this;
}
}
if(_21d==null||!(_21d instanceof CMenuItem)){
return;
}
return CMenuEntry_onkeydown.call(_21d,evt);
};
function CMenuItem_onkeypress(evt){
evt=(evt)?evt:((event)?event:null);
var _21f=null;
if(typeof this.menuItem!="undefined"){
_21f=this.menuItem;
}else{
if(this instanceof CMenuItem){
_21f=this;
}
}
if(_21f!=null&&_21f instanceof CMenuItem){
return CMenuEntry_onkeypress.call(_21f,evt);
}
};
function CMenuItem_createDropDownMenu(_220){
this.m_menu=new CMenu("dropDownMenu_"+this.getId(),_220,this.m_webContentRoot);
this.m_menu.setParent(this);
this.m_menuType="dropDown";
return this.m_menu;
};
function CMenuItem_createCascadedMenu(_221){
this.m_menu=new CMenu("cascadedMenu_"+this.getId(),_221,this.m_webContentRoot);
this.m_menu.setParent(this);
this.m_originalMenuType=this.m_menuType;
this.m_menuType="cascaded";
return this.m_menu;
};
function CMenuItem_clearCascadedMenu(){
if(this.m_menu){
this.m_menu.remove();
this.m_menu=null;
}
if(this.m_originalMenuType){
this.m_menuType=this.m_originalMenuType;
}
};
function CMenuItem_addOwnerDrawControl(_222,type){
this.m_menu=_222;
this.m_menuType=type;
if(typeof _222.setParent!="undefined"){
this.m_menu.setParent(this);
}
};
function CMenuItem_attachEvents(){
if(typeof this.getParent().getHTMLContainer!="function"){
return;
}
var _224=this.getParent().getHTMLContainer();
if(_224==null){
return;
}
var _225=eval(_224.document?_224.document.getElementById(this.getId()):_224.ownerDocument.getElementById(this.getId()));
if(_225==null){
return;
}
_225.onmouseover=this.onmouseover;
_225.onmouseout=this.onmouseout;
_225.onmouseup=this.onmouseup;
_225.onkeypress=this.onkeypress;
_225.onfocus=this.onfocus;
_225.onblur=this.onblur;
_225.onkeydown=this.onkeydown;
_225.onclick=this.onclick;
_225.menuItem=eval(this);
};
function CMenuItem_remove(){
};
function CMenuItem_getStyle(){
return this.m_style;
};
function CMenuItem_setStyle(_226){
this.m_style=_226;
};
function CMenuItem_hide(){
this.m_bVisible=false;
};
function CMenuItem_show(){
this.m_bVisible=true;
};
function CMenuItem_enable(){
if(typeof this.getStyle()=="object"){
if(typeof this.getParent().getHTMLContainer=="function"){
var _227=this.getParent().getHTMLContainer();
if(_227!=null){
var _228=_227.document?_227.document.getElementById(this.getId()):_227.ownerDocument.getElementById(this.getId());
if(_228!=null){
_228.className=this.getStyle().getNormalState();
}
}
}
this.m_bEnabled=true;
this.getIcon().enable();
this.updateHTML();
}
};
function CMenuItem_updateHTML(){
if(typeof this.getStyle()=="object"){
if(typeof this.getParent().getHTMLContainer=="function"){
var _229=this.getParent().getHTMLContainer();
if(_229!=null){
var _22a=_229.document?_229.document.getElementById(this.getId()):_229.ownerDocument.getElementById(this.getId());
if(_22a!=null){
var _22b=_22a.getElementsByTagName("img");
if(typeof _22b!="undefined"){
if(this.getIcon()){
if(this.getIcon().isEnabled()){
_22b[0].src=this.getIcon().getPath();
}else{
_22b[0].src=this.getIcon().getDisabledImagePath();
}
}
if(this.getToolTip()){
_22a.title=this.getToolTip();
_22b[0].title=this.getToolTip();
}
}
if(this.isEnabled()){
if(_22a.getAttribute("aria-disabled")){
_22a.removeAttribute("aria-disabled");
}
}else{
_22a.setAttribute("aria-disabled","true");
}
var _22c;
if(this.getStyle().getActiveState()!=this.getStyle().getDisabledState()){
_22a.tabIndex=0;
if(this.getMenu()!=null&&!this.m_bHideDropDown&&_22a.nextSibling){
_22a.nextSibling.tabIndex=0;
_22a.nextSibling.title=this.getToolTip();
_22c=_22a.nextSibling.getElementsByTagName("img");
if(_22c!=null){
_22c[0].title=this.getToolTip();
}
}
}else{
if(_22a.tabIndex!="undefined"){
_22a.removeAttribute("tabIndex");
if(this.getMenu()!=null){
_22a.nextSibling.removeAttribute("tabIndex");
_22a.nextSibling.title=this.getToolTip();
_22c=_22a.nextSibling.getElementsByTagName("img");
if(_22c!=null){
_22c[0].title=this.getToolTip();
}
}
}
}
_22a.className=this.getStyle().getActiveState();
}
}
}
}
};
function CMenuItem_disable(){
if(typeof this.getStyle()=="object"){
if(typeof this.getParent().getHTMLContainer=="function"){
var _22d=this.getParent().getHTMLContainer();
if(_22d!=null){
var _22e=_22d.document?_22d.document.getElementById(this.getId()):_22d.ownerDocument.getElementById(this.getId());
if(_22e!=null){
_22e.className=this.getStyle().getDisabledState();
}
}
}
this.m_bEnabled=false;
this.getIcon().disable();
this.updateHTML();
}
};
function CMenuItem_isVisible(){
return this.m_bVisible;
};
function CMenuItem_getIcon(){
return this.m_icon;
};
function CMenuItem_getLabel(){
return this.m_label;
};
function CMenuItem_setFocus(){
var e=document.getElementById(this.m_id);
if(e){
e.focus();
return true;
}
return false;
};
CMenuItem.prototype.draw=CMenuItem_draw;
CMenuItem.prototype.onmouseover=CMenuItem_onmouseover;
CMenuItem.prototype.onmouseout=CMenuItem_onmouseout;
CMenuItem.prototype.onmouseup=CMenuItem_onmouseup;
CMenuItem.prototype.onkeypress=CMenuItem_onkeypress;
CMenuItem.prototype.onkeydown=CMenuItem_onkeydown;
CMenuItem.prototype.onfocus=CMenuItem_onfocus;
CMenuItem.prototype.onblur=CMenuItem_onmouseout;
CMenuItem.prototype.onclick=CMenuItem_onclick;
CMenuItem.prototype.attachEvents=CMenuItem_attachEvents;
CMenuItem.prototype.remove=CMenuItem_remove;
CMenuItem.prototype.setStyle=CMenuItem_setStyle;
CMenuItem.prototype.getStyle=CMenuItem_getStyle;
CMenuItem.prototype.createDropDownMenu=CMenuItem_createDropDownMenu;
CMenuItem.prototype.createCascadedMenu=CMenuItem_createCascadedMenu;
CMenuItem.prototype.clearCascadedMenu=CMenuItem_clearCascadedMenu;
CMenuItem.prototype.addOwnerDrawControl=CMenuItem_addOwnerDrawControl;
CMenuItem.prototype.isVisible=CMenuItem_isVisible;
CMenuItem.prototype.hide=CMenuItem_hide;
CMenuItem.prototype.show=CMenuItem_show;
CMenuItem.prototype.enable=CMenuItem_enable;
CMenuItem.prototype.disable=CMenuItem_disable;
CMenuItem.prototype.getIcon=CMenuItem_getIcon;
CMenuItem.prototype.setIcon=CMenuItem_setIcon;
CMenuItem.prototype.getLabel=CMenuItem_getLabel;
CMenuItem.prototype.setFocus=CMenuItem_setFocus;
CMenuItem.prototype.setToolTip=CMenuItem_setToolTip;
CMenuItem.prototype.getToolTip=CMenuItem_getToolTip;
CMenuItem.prototype.updateHTML=CMenuItem_updateHTML;
CMenuItem.prototype.update=new Function("return true");
CMenuItem.prototype.genARIATags=CMenuItem_genARIATags;
CMenuItem.prototype.setAltText=CMenuItem_setAltText;
CMenuItem.prototype.getAltText=CMenuItem_getAltText;
CMenuItem.prototype.genMenuItemAltText=CMenuItem_genMenuItemAltText;
function CSeperator(type,size,_232,_233){
this.m_type=type;
this.m_size=size;
this.m_bVisible=true;
if(_232!==null&&typeof _232=="object"){
this.m_style=new CUIStyle(_232.getNormalState(),_232.getRolloverState(),_232.getDepressedState(),_232.getDepressedRolloverState(),_232.getDisabledState());
}else{
this.m_style=new CUIStyle("","","","","");
}
if(typeof _233!="undefined"&&_233!=""){
this.m_webContentRoot=_233;
}else{
this.m_webContentRoot="..";
}
this.m_toolbarSeperatorClass="bannerDivider";
};
CSeperator.prototype.setToolbarSeperatorClass=function(_234){
this.m_toolbarSeperatorClass=_234;
};
CSeperator.prototype.getToolbarSeperatorClass=function(){
return this.m_toolbarSeperatorClass;
};
CSeperator.prototype.setWebContentRoot=function(_235){
this.m_webContentRoot=_235;
};
function CSeperator_draw(){
if(this.m_style==""){
return;
}
var html="";
switch(this.m_type){
case "horizonal_blank":
html+="<td style=\"padding:0px;\"><img border=\"0\" alt=\"\" src=\""+this.m_webContentRoot+"/common/images/spacer.gif\" height=\"1\" width=\"";
html+=this.m_size;
html+="\"/></td>";
break;
case "horizontal_line":
html+="<div class=\""+this.getStyle().getActiveState()+"\"></div>";
break;
case "vertical_blank":
html+="<tr>";
html+="<td style=\"padding:0px;\"><img border=\"0\" alt=\"\" src=\""+this.m_webContentRoot+"/common/images/spacer.gif\" width=\"1\" height=\"";
html+=this.m_size;
html+="\"/></td></tr>";
break;
case "vertical_line":
html+="<td class=\"toolbarVerticalSeperator\"><div class=\""+this.getToolbarSeperatorClass()+"\"/></td>";
break;
}
return html;
};
function CSeperator_getSize(){
return this.m_size;
};
function CSeperator_setSize(size){
this.m_size=size;
};
function CSeperator_setStyle(_238){
this.m_style=_238;
};
function CSeperator_getStyle(){
return this.m_style;
};
function CSeperator_setType(type){
this.m_type=type;
};
function CSeperator_getType(){
return this.m_type;
};
function CSeperator_hide(){
this.m_bVisible=false;
};
function CSeperator_show(){
this.m_bVisible=true;
};
function CSeperator_isVisible(){
return this.m_bVisible;
};
CSeperator.prototype.draw=CSeperator_draw;
CSeperator.prototype.setSize=CSeperator_setSize;
CSeperator.prototype.getSize=CSeperator_getSize;
CSeperator.prototype.setStyle=CSeperator_setStyle;
CSeperator.prototype.getStyle=CSeperator_getStyle;
CSeperator.prototype.getType=CSeperator_getType;
CSeperator.prototype.setType=CSeperator_setType;
CSeperator.prototype.isVisible=CSeperator_isVisible;
CSeperator.prototype.show=CSeperator_show;
CSeperator.prototype.hide=CSeperator_hide;
function CInfoPanel(size,_23b,id){
this.m_size=size;
this.m_bVisible=true;
this.m_properties=[];
this.setId(id);
this.m_observers=new CObserver(this);
this.setWebContentRoot(_23b);
};
CInfoPanel.prototype=new CMenuEntry();
CInfoPanel.prototype.setWebContentRoot=function(_23d){
this.m_webContentRoot=_23d;
};
function CInfoPanel_addCheckedProperty(name,_23f){
var o={"name":name,"value":_23f,"type":"checkBox","spacer":false};
this.m_properties[this.m_properties.length]=o;
};
function CInfoPanel_addProperty(name,_242){
var o={"name":name,"value":_242,"spacer":false};
this.m_properties[this.m_properties.length]=o;
};
function CInfoPanel_addSpacer(_244){
var o={"spacer":true,"height":_244};
this.m_properties[this.m_properties.length]=o;
};
function CInfoPanel_draw(){
var i=0;
var html="<table CELLPADDING=\"0\" CELLSPACING=\"0\" role=\"presentation\">";
if(this.m_properties.length>0){
var _248="<tr><td>";
var _249="";
for(i=0;i<this.m_properties.length;i++){
if(this.m_properties[i].spacer){
}else{
if(this.m_properties[i].type!=null&&this.m_properties[i].type=="checkBox"){
_248+="<tr><td><span><span class=\"formText\">";
if(this.m_properties[i].value=="true"){
_248+="<input type=\"checkbox\" disabled=\"true\" checked>";
}else{
_248+="<input type=\"checkbox\" disabled=\"true\">";
}
_248+=this.m_properties[i].name;
_248+="</span>&nbsp;</input>";
_248+="<span></td></tr>";
}else{
_248+="<tr><td><span><span class=\"menuItem_normal\" style=\"font-weight:bold\">";
_248+=this.m_properties[i].name;
_248+="</span>&nbsp;<span class=\"menuItem_normal\">";
_248+=this.m_properties[i].value;
_248+="</span></span></td></tr>";
}
_249+=this.m_properties[i].name+" "+this.m_properties[i].value+", ";
}
}
var id=this.getId()?"id=\""+this.getId()+"\" ":"";
var _24b="<table summary=\""+_249+"\" role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" "+id+" tabindex=\"0\" style=\"margin-bottom:1px;";
if(typeof this.m_size!="undefined"&&this.m_size!=""){
_24b+="width:"+this.m_size;
}
_24b+="\"\t>";
html+=_24b+_248+"</table></td></tr>";
}
html+="</table>";
return html;
};
function CInfoPanel_getSize(){
return this.m_size;
};
function CInfoPanel_setSize(size){
this.m_size=size;
};
function CInfoPanel_hide(){
this.m_bVisible=false;
};
function CInfoPanel_show(){
this.m_bVisible=true;
};
function CInfoPanel_isVisible(){
return this.m_bVisible;
};
function CInfoPanel_isEnabled(){
return true;
};
function CInfoPanel_onkeydown(evt){
var _24e=null;
if(typeof this.infoPanel!="undefined"){
_24e=this.infoPanel;
}else{
if(this instanceof CInfoPanel){
_24e=this;
}
}
if(_24e==null||!(_24e instanceof CInfoPanel)){
return;
}
return CMenuEntry_onkeydown.call(_24e,evt);
};
function CInfoPanel_onkeypress(evt){
evt=(evt)?evt:((event)?event:null);
var _250=null;
if(typeof this.infoPanel!="undefined"){
_250=this.infoPanel;
}else{
if(this instanceof CInfoPanel){
_250=this;
}
}
if(_250!=null&&_250 instanceof CInfoPanel){
return CMenuEntry_onkeypress.call(_250,evt);
}
};
function CInfoPanel_setFocus(){
if(this.getId()){
document.getElementById(this.getId()).focus();
}
};
function CInfoPanel_attachEvents(){
if(typeof this.getParent().getHTMLContainer!="function"){
return;
}
var _251=this.getParent().getHTMLContainer();
if(_251==null){
return;
}
var _252=eval(_251.document?_251.document.getElementById(this.getId()):_251.ownerDocument.getElementById(this.getId()));
if(_252==null){
return;
}
_252.onkeypress=this.onkeypress;
_252.onkeydown=this.onkeydown;
_252.infoPanel=eval(this);
};
CInfoPanel.prototype.draw=CInfoPanel_draw;
CInfoPanel.prototype.onkeypress=CInfoPanel_onkeypress;
CInfoPanel.prototype.onkeydown=CInfoPanel_onkeydown;
CInfoPanel.prototype.addProperty=CInfoPanel_addProperty;
CInfoPanel.prototype.addCheckedProperty=CInfoPanel_addCheckedProperty;
CInfoPanel.prototype.addSpacer=CInfoPanel_addSpacer;
CInfoPanel.prototype.setSize=CInfoPanel_setSize;
CInfoPanel.prototype.getSize=CInfoPanel_getSize;
CInfoPanel.prototype.isVisible=CInfoPanel_isVisible;
CInfoPanel.prototype.show=CInfoPanel_show;
CInfoPanel.prototype.hide=CInfoPanel_hide;
CInfoPanel.prototype.isEnabled=CInfoPanel_isEnabled;
CInfoPanel.prototype.setFocus=CInfoPanel_setFocus;
CInfoPanel.prototype.attachEvents=CInfoPanel_attachEvents;
var g_ownerDocument=null;
function CMenu(id,_254,_255){
this.m_htmlContainer=document.body;
this.m_bVisible=false;
this.m_id=id;
this.m_htmlDivElement=null;
this.m_parent=null;
this.m_menuItems=[];
this.m_style=_254;
this.m_callback=null;
this.m_observers=new CObserver(this);
this.m_bForceCallback=false;
this.m_loadingMenuItem=false;
this.m_oCV=null;
if(typeof _255!="undefined"&&_255!=""){
this.m_webContentRoot=_255;
}else{
this.m_webContentRoot="..";
}
};
function CMenu_setHTMLContainer(_256){
this.m_htmlContainer=_256;
g_ownerDocument=this.m_htmlContainer.document?this.m_htmlContainer.document:this.m_htmlContainer.ownerDocument;
};
function CMenu_getHTMLContainer(){
return this.m_htmlContainer;
};
function CMenu_setParent(_257){
this.m_parent=_257;
};
function CMenu_getParent(){
return this.m_parent;
};
function CMenu_getId(){
return this.m_id;
};
function CMenu_getHTMLDiv(){
return this.m_htmlDivElement;
};
function CMenu_create(){
var _258=this.m_htmlContainer.document?this.m_htmlContainer.document.createElement("div"):this.m_htmlContainer.ownerDocument.createElement("div");
if(typeof this.getStyle()=="object"){
_258.className=this.getStyle().getNormalState();
}
_258.style.display="none";
_258.style.visibility="hidden";
_258.style.position="absolute";
_258.style.left="0px";
_258.style.top="0px";
_258.id=this.m_id;
_258.setAttribute("role","region");
if(window.RV_RES){
_258.setAttribute("aria-label",RV_RES.IDS_JS_A11Y_DYNAMIC_MENU);
}
this.m_htmlContainer.appendChild(_258);
this.m_htmlDivElement=_258;
};
function CMenu_setAltText(_259){
this.m_altText=_259;
};
function CMenu_getAltText(){
if(this.m_altText){
return this.m_altText;
}else{
return "";
}
};
function CMenu_genARIATags(){
var html=" role=\"menu\"";
if(this.getAltText()&&this.getAltText().length>0){
html+=" aria-labelledby=\""+this.m_id+"label\" ";
}else{
if(window.RV_RES){
html+=" aria-label=\""+RV_RES.IDS_JS_A11Y_DYNAMIC_MENU+"\" ";
}
}
return html;
};
function CMenu_genMenuAltText(){
var html="";
if(this.getAltText()&&this.getAltText().length>0){
html+="<tr><td><div style=\"position: absolute; overflow: hidden; width: 0; height: 0;\" id=\""+this.m_id+"label\">"+this.getAltText()+"</div></td></tr>";
}
return html;
};
function CMenu_draw(){
if(this.m_htmlContainer==null){
return;
}
if(this.m_htmlDivElement==null){
this.create();
}
var html="";
if(this.m_menuItems.length==0||this.m_bForceCallback==true){
this.setForceCallback(false);
if(this.m_callback!=null){
this.setLoadingMenuItem(true);
var menu=this;
var _25e=function(){
if(menu&&menu.executeCallback){
menu.executeCallback();
}
};
setTimeout(_25e,1000);
html="<table class=\"menuItem_normal\" CELLPADDING=\"0\" CELLSPACING=\"0\" tabindex=\"0\" hidefocus=\"true\"";
html+=this.genARIATags();
html+=">";
html+=this.genMenuAltText();
html+="<tr>";
var _25f="";
if(this.m_oCV&&RV_RES.GOTO_LOADING){
_25f=RV_RES.GOTO_LOADING;
}else{
if(typeof gUIFrameWorkMenuLoadingMessage!="undefined"){
_25f=gUIFrameWorkMenuLoadingMessage;
}else{
_25f="...";
}
}
html+="<td>";
html+="<img style=\"vertical-align:middle;\" alt=\""+_25f+"\" width=\"16\" height=\"16\" src=\""+this.m_webContentRoot+"/common/images/tv_loading.gif\"/>";
html+="</td>";
html+="<td nowrap=\"nowrap\" align=\"left\">";
html+=_25f;
html+="</td>";
html+="</tr>";
html+="</table>";
}
}else{
this.setLoadingMenuItem(false);
var i=0;
html="<table CELLPADDING=\"0\" CELLSPACING=\"0\" tabindex=\"0\" style=\"outline: none;\" hidefocus=\"true\"";
html+=this.genARIATags();
html+=">";
html+=this.genMenuAltText();
var _261=false;
for(i=0;i<this.m_menuItems.length;i++){
if(this.m_menuItems[i].isVisible()){
_261=true;
html+="<tr><td>";
html+=this.m_menuItems[i].draw();
html+="</td></tr>";
}
}
if(!_261){
this.remove();
return;
}
html+="</table>";
}
try{
this.m_htmlDivElement.innerHTML=html;
this.attachEvents();
}
catch(e){
}
this.updateCoords();
var _262="uiFrameworkHiddenIframe"+this.m_id;
var _263=((!isIE())&&(document.getElementById))?true:false;
setTimeout("updateIframeCoords(\""+_262+"\", \""+this.m_htmlDivElement.id+"\", "+_263+")",50);
if((typeof gCognosViewer!="undefined")&&(gCognosViewer.envParams["cv.responseFormat"])&&(gCognosViewer.envParams["cv.responseFormat"]=="fragment")){
AdjustPortalFont(this.m_htmlDivElement);
}
};
function CMenu_setLoadingMenuItem(_264){
this.m_loadingMenuItem=_264;
};
function CMenu_getLoadingMenuItem(){
return this.m_loadingMenuItem;
};
function CMenu_getScrollingPosition(){
var _265={"x":0,"y":0};
if(typeof window.pageYOffset!="undefined"){
_265={"x":window.pageXOffset,"y":window.pageYOffset};
}else{
if(typeof document.documentElement.scrollTop!="undefined"&&document.documentElement.scrollTop>0){
_265={"x":document.documentElement.scrollLeft,"y":document.documentElement.scrollTop};
}else{
if(typeof document.body.scrollTop!="undefined"){
_265={"x":document.body.scrollLeft,"y":document.body.scrollTop};
}
}
}
return _265;
};
function AdjustPortalFont(div){
var _267=fragments;
if(_267){
div.className+=" PortalFontFix";
var _268=null;
for(var frag in _267){
if(frag.indexOf("rvCanvas")>-1){
_268=$(_267[frag].div);
if(_268!=null){
break;
}
}
}
if(_268!=null){
div.style.fontSize=xGetComputedStyle(_268,"font-size");
}
}
};
function CMenu_updateCoords(){
var _26a=this.getParent();
var mnu=this.m_htmlDivElement;
if(mnu!=null){
var _26c=this.m_htmlContainer.document?this.m_htmlContainer.document:this.m_htmlContainer.ownerDocument;
var _26d=mnu.style.visibility;
var _26e=mnu.style.display;
mnu.style.visibility="hidden";
mnu.style.display="block";
if(mnu.firstChild!=null){
mnu.style.width=mnu.firstChild.offsetWidth;
}
var x=0,y=0;
var db=mnu.parentNode;
var _272=db.clientWidth;
var _273=db.clientHeight;
var _274=CMenu_getScrollingPosition();
var _275=_274.x;
var _276=_274.y;
if(_26a==null){
x=mnu.style.left;
y=mnu.style.top;
if(x.substr(x.length-2,2)=="px"){
x=parseInt(x.substring(0,x.length-2),10);
y=parseInt(y.substring(0,y.length-2),10);
}
if(y+mnu.offsetHeight>=(_273)){
if(y-mnu.offsetHeight>0){
y=y+_276-mnu.offsetHeight;
}else{
y=Math.max(_273-mnu.offsetHeight,0);
}
}else{
y=y+_276;
}
if(x+mnu.offsetWidth>=(_272)){
if(x-mnu.offsetWidth>0){
x=x+_275-mnu.offsetWidth;
}else{
x=Math.max(_272-mnu.offsetWidth,0);
}
}else{
x=x+_275;
}
}else{
if(!(_26a instanceof CToolbarButton)&&!(_26a instanceof CMenuItem)){
return;
}
if(typeof _26a.getMenuType!="function"){
return;
}
var _277=_26c.getElementById(this.getParent().getId());
var _278=_26c.getElementById("menu"+this.getParent().getId());
if(_277==null){
return;
}
var _279=_277;
if(_26a.getMenuType()=="dropDown"){
x=0;
y=_277.offsetHeight;
while(_279!=null){
x+=_279.offsetLeft;
y+=_279.offsetTop;
_279=_279.offsetParent;
}
if(getViewerDirection()=="rtl"){
var _27a=x-(mnu.offsetWidth-_277.offsetWidth);
if(_27a>_275){
x=_27a;
}
}
if((typeof gCognosViewer!="undefined")&&(gCognosViewer.envParams["cv.responseFormat"])&&(gCognosViewer.envParams["cv.responseFormat"]=="fragment")){
var _27b=_277;
while((_27b!=document.body)&&(_27b=_27b.parentNode)){
x-=_27b.scrollLeft||0;
y-=_27b.scrolltop||0;
}
}
if((x+mnu.offsetWidth)>(_272+_275)){
x=x+_277.offsetWidth-mnu.offsetWidth;
if(_278!=null){
x=x+_278.offsetWidth;
}
}
if(((y+mnu.offsetHeight)>(_273+_276))&&(y-(mnu.offsetHeight+_277.clientHeight)>=0)){
y-=(mnu.offsetHeight+_277.clientHeight);
}
}else{
if(_26a.getMenuType()=="cascaded"){
x=_277.offsetWidth;
while(_279!=null){
x+=_279.offsetLeft;
y+=_279.offsetTop;
_279=_279.offsetParent;
}
if(getViewerDirection()=="rtl"){
var _27a=x-(mnu.offsetWidth+_277.offsetWidth);
if(_27a>_275){
x=_27a;
}
}
if((x+mnu.offsetWidth)>(_272+_275)){
x-=(_277.offsetWidth+mnu.offsetWidth);
}
if((y+mnu.offsetHeight)>(_273+_276)){
y-=(mnu.offsetHeight-_277.clientHeight);
}
}
}
}
mnu.style.visibility=_26d;
mnu.style.display=_26e;
this.setXCoord(x);
this.setYCoord(y);
this.setZIndex(500);
}
};
function CMenu_add(_27c){
if(typeof _27c.getObservers=="function"&&typeof _27c.getObservers()=="object"){
_27c.getObservers().attach(this,this.closeSubMenus,_27c.onmouseover);
_27c.getObservers().attach(this,this.closeAllMenus,_27c.onmouseup);
_27c.getObservers().attach(this,this.closeSubMenus,_27c.onfocus);
_27c.getObservers().attach(this,this.closeAllMenus,_27c.onkeypress);
}
this.m_menuItems[this.m_menuItems.length]=_27c;
};
function CMenu_get(_27d){
if(_27d>=0&&_27d<this.getNumItems()){
return this.m_menuItems[_27d];
}
return null;
};
CMenu.prototype.getItem=function(_27e){
var sId=_27e;
if(this.m_oCV){
sId=this.m_oCV.getId()+_27e;
}
for(var _280=0;_280<this.getNumItems();_280++){
var _281=this.get(_280);
if(typeof _281.getId=="function"&&_281.getId()==sId){
return _281;
}
}
};
function CMenu_getNumItems(){
return this.m_menuItems.length;
};
function CMenu_hide(){
this.hideHiddenIframe();
if(this.m_htmlDivElement!=null){
this.m_htmlDivElement.style.visibility="hidden";
}
this.m_bVisible=false;
var _282=this.getParent();
if(_282!=null&&typeof _282.setFocus=="function"){
_282.setFocus();
}else{
if(_282!=null&&typeof _282.focus=="function"){
_282.focus();
}else{
if(typeof this.m_focusCell=="object"&&typeof this.m_focusCell.focus=="function"){
this.m_focusCell.focus();
}
}
}
};
function CMenu_setFocus(){
try{
var _283=null;
for(var _284=0;_284<this.getNumItems()&&!_283;_284++){
var _285=this.get(_284);
if(_285.isVisible&&_285.isVisible()){
_283=_285;
}
}
if(!_283||!_283.setFocus()){
this.m_htmlDivElement.childNodes[0].focus();
}
}
catch(e){
}
};
function CMenu_show(){
if(this.m_htmlDivElement!=null){
this.m_bVisible=true;
this.updateCoords();
var _286=((!isIE())&&(document.getElementById))?true:false;
var _287="uiFrameworkHiddenIframe"+this.m_id;
var _288=this.m_htmlContainer.document?this.m_htmlContainer.document.getElementById(_287):this.m_htmlContainer.ownerDocument.getElementById(_287);
if(_288==null){
_288=this.createHiddenIFrame(_287);
}
if(_288){
_288.style.display="block";
_288.style.left="0px";
_288.style.top="0px";
updateIframeCoords(_287,this.m_htmlDivElement.id,_286);
setTimeout("updateIframeCoords(\""+_287+"\", \""+this.m_htmlDivElement.id+"\", "+_286+")",50);
}
this.m_htmlDivElement.style.display="block";
this.m_htmlDivElement.style.visibility="visible";
this.setFocus();
if(!window.isIOS()){
var _289=this;
if(window.attachEvent){
window.attachEvent("onresize",function(){
_289.remove();
});
window.attachEvent("onscroll",function(){
_289.remove();
});
}else{
window.addEventListener("resize",function(){
_289.remove();
},false);
window.addEventListener("scroll",function(){
_289.remove();
},false);
}
var _28a=null;
if(this.m_oCV!=null){
_28a=document.getElementById(this.m_oCV.getId()+"content");
}
if(_28a){
if(_28a.parentNode.parentNode.attachEvent){
_28a.parentNode.parentNode.attachEvent("onscroll",function(){
_289.remove();
});
}else{
_28a.parentNode.parentNode.addEventListener("scroll",function(){
_289.remove();
},false);
}
}
}
}
};
function CMenu_createHiddenIFrame(_28b){
var _28c=this.getHTMLContainer();
var _28d=_28c.document?_28c.document.createElement("iframe"):_28c.ownerDocument.createElement("iframe");
_28d.setAttribute("id",_28b);
_28d.setAttribute("src",this.m_webContentRoot+"/common/images/spacer.gif");
_28d.setAttribute("scrolling","no");
_28d.setAttribute("frameborder","0");
_28d.style.position="absolute";
_28d.style.minWidth="0px";
_28d.style.minHeight="0px";
_28d.style.left="0px";
_28d.style.top="0px";
_28d.style.zIndex=499;
_28d.style.display="none";
_28d.setAttribute("title","Empty frame");
_28d.setAttribute("role","presentation");
_28c.appendChild(_28d);
return _28d;
};
function CMenu_isVisible(){
return this.m_bVisible;
};
function CMenu_remove(){
this.removeHiddenIframe();
for(var i=0;i<this.getNumItems();++i){
var _28f=this.get(i);
if(typeof _28f.getMenu=="function"&&_28f.getMenu()!=null){
_28f.getMenu().remove();
}
}
if(this.m_htmlContainer!=null&&this.m_htmlDivElement!=null){
this.m_htmlContainer.removeChild(this.m_htmlDivElement);
}
this.m_htmlDivElement=null;
this.m_bVisible=false;
};
function CMenu_removeHiddenIframe(){
try{
if(g_ownerDocument){
var _290=g_ownerDocument.getElementById("uiFrameworkHiddenIframe"+this.m_id);
if(_290!=null){
_290.style.display="none";
if(_290.parentNode&&_290.parentNode.removeChild){
_290.parentNode.removeChild(_290);
}
}
}
}
catch(e){
}
};
function CMenu_hideHiddenIframe(){
try{
if(g_ownerDocument){
var _291=g_ownerDocument.getElementById("uiFrameworkHiddenIframe"+this.m_id);
if(_291){
_291.style.display="none";
}
}
}
catch(e){
}
};
function CMenu_enable(){
};
function CMenu_disable(){
};
function CMenu_getState(){
};
function CMenu_clear(){
if(this.m_htmlDivElement!=null){
this.m_htmlDivElement.innerHTML="";
}
this.m_menuItems.splice(0,this.m_menuItems.length);
};
function CMenu_attachEvents(){
for(var i=0;i<this.m_menuItems.length;i++){
if(typeof this.m_menuItems[i].attachEvents=="function"){
this.m_menuItems[i].attachEvents();
}
}
this.m_htmlDivElement.onkeypress=this.onkeypress;
this.m_htmlDivElement.tbMenu=eval(this);
};
function CMenu_closeSubMenus(_293){
for(var i=0;i<this.m_menuItems.length;i++){
var _295=this.m_menuItems[i];
var _296=_293.getSubject();
if(_295!=_296&&typeof _295.getMenu=="function"&&_295.getMenu()!=null&&_295.getMenu().isVisible()){
_295.getMenu().remove();
}
}
};
function CMenu_closeAllMenus(_297){
var _298=this;
var _299=null;
while(_298){
if(_298 instanceof CMenu){
_299=_298;
}
_298=_298.getParent();
}
if(_299!=null){
_299.remove();
}
};
function CMenu_setStyle(_29a){
this.m_style=_29a;
};
function CMenu_getStyle(){
return this.m_style;
};
function CMenu_setXCoord(x){
var _29c=this.getHTMLDiv();
if(_29c!=null){
_29c.style.left=x+"px";
}
};
function CMenu_setYCoord(y){
var _29e=this.getHTMLDiv();
if(_29e!=null){
_29e.style.top=y+"px";
}
};
function CMenu_setZIndex(_29f){
var _2a0=this.getHTMLDiv();
if(_2a0!=null){
_2a0.style.zIndex=_29f;
}
};
function CMenu_registerCallback(_2a1){
this.m_callback=_2a1;
};
function CMenu_executeCallback(){
if(typeof this.m_callback=="function"){
this.m_callback();
}else{
if(typeof this.m_callback=="string"){
eval(this.m_callback);
}
}
};
function CMenu_getObservers(){
return this.m_observers;
};
function CMenu_onmouseover(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onmouseover=="function"){
this.getParent().onmouseover(evt);
}
this.getObservers().notify(CMenu_onmouseover);
};
function CMenu_onmouseout(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onmouseout=="function"){
this.getParent().onmouseout(evt);
}
this.getObservers().notify(CMenu_onmouseout);
};
function CMenu_onmouseup(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onmouseup=="function"){
this.getParent().onmouseup(evt);
}
this.getObservers().notify(CMenu_onmouseup);
};
function CMenu_onkeypress(evt){
evt=(evt)?evt:((event)?event:null);
var menu=this.tbMenu;
if(typeof menu=="object"){
if(evt.keyCode==40){
var _2a7=false;
for(var i=0;i<menu.m_menuItems.length;i++){
var _2a9=menu.m_menuItems[i];
if(typeof _2a9.isVisible=="function"&&_2a9.isVisible()&&typeof _2a9.setFocus=="function"){
_2a9.setFocus();
_2a7=true;
break;
}
}
if(!_2a7){
menu.hide();
}
}
if(evt.keyCode==38){
menu.hide();
}
}
if(typeof this.getParent=="function"&&this.getParent()!=null&&typeof this.getParent().onkeypress=="function"){
this.getParent().onkeypress(evt);
}
if(typeof this.getObservers=="function"){
this.getObservers().notify(CMenu_onkeypress);
}
};
function CMenu_getForceCallback(){
return this.m_bForceCallback;
};
function CMenu_setForceCallback(_2aa){
this.m_bForceCallback=_2aa;
};
CMenu.prototype.draw=CMenu_draw;
CMenu.prototype.updateCoords=CMenu_updateCoords;
CMenu.prototype.add=CMenu_add;
CMenu.prototype.get=CMenu_get;
CMenu.prototype.getNumItems=CMenu_getNumItems;
CMenu.prototype.hide=CMenu_hide;
CMenu.prototype.hideHiddenIframe=CMenu_hideHiddenIframe;
CMenu.prototype.removeHiddenIframe=CMenu_removeHiddenIframe;
CMenu.prototype.show=CMenu_show;
CMenu.prototype.enable=CMenu_enable;
CMenu.prototype.disable=CMenu_disable;
CMenu.prototype.getState=CMenu_getState;
CMenu.prototype.clear=CMenu_clear;
CMenu.prototype.attachEvents=CMenu_attachEvents;
CMenu.prototype.setParent=CMenu_setParent;
CMenu.prototype.getParent=CMenu_getParent;
CMenu.prototype.getHTMLContainer=CMenu_getHTMLContainer;
CMenu.prototype.setHTMLContainer=CMenu_setHTMLContainer;
CMenu.prototype.getHTMLDiv=CMenu_getHTMLDiv;
CMenu.prototype.create=CMenu_create;
CMenu.prototype.remove=CMenu_remove;
CMenu.prototype.getId=CMenu_getId;
CMenu.prototype.isVisible=CMenu_isVisible;
CMenu.prototype.setStyle=CMenu_setStyle;
CMenu.prototype.getStyle=CMenu_getStyle;
CMenu.prototype.closeSubMenus=CMenu_closeSubMenus;
CMenu.prototype.closeAllMenus=CMenu_closeAllMenus;
CMenu.prototype.setXCoord=CMenu_setXCoord;
CMenu.prototype.setYCoord=CMenu_setYCoord;
CMenu.prototype.setZIndex=CMenu_setZIndex;
CMenu.prototype.update=new Function("return true");
CMenu.prototype.registerCallback=CMenu_registerCallback;
CMenu.prototype.executeCallback=CMenu_executeCallback;
CMenu.prototype.getObservers=CMenu_getObservers;
CMenu.prototype.onmouseover=CMenu_onmouseover;
CMenu.prototype.onmouseout=CMenu_onmouseout;
CMenu.prototype.onmouseup=CMenu_onmouseup;
CMenu.prototype.onkeypress=CMenu_onkeypress;
CMenu.prototype.createHiddenIFrame=CMenu_createHiddenIFrame;
CMenu.prototype.setForceCallback=CMenu_setForceCallback;
CMenu.prototype.getForceCallback=CMenu_getForceCallback;
CMenu.prototype.setFocus=CMenu_setFocus;
CMenu.prototype.genARIATags=CMenu_genARIATags;
CMenu.prototype.setAltText=CMenu_setAltText;
CMenu.prototype.getAltText=CMenu_getAltText;
CMenu.prototype.genMenuAltText=CMenu_genMenuAltText;
CMenu.prototype.setLoadingMenuItem=CMenu_setLoadingMenuItem;
CMenu.prototype.getLoadingMenuItem=CMenu_getLoadingMenuItem;
function updateIframeCoords(id,_2ac,_2ad){
if(g_ownerDocument==null){
return;
}
var _2ae=g_ownerDocument.getElementById(_2ac);
var _2af=g_ownerDocument.getElementById(id);
if(_2af&&_2ae){
if(_2ad==true){
_2af.style.left=_2ae.offsetLeft+"px";
_2af.style.top=_2ae.offsetTop+"px";
_2af.style.width=_2ae.offsetWidth+"px";
_2af.style.height=_2ae.offsetHeight+"px";
}else{
_2af.style.pixelLeft=_2ae.offsetLeft;
_2af.style.pixelTop=_2ae.offsetTop;
_2af.style.pixelWidth=_2ae.offsetWidth;
_2af.style.pixelHeight=_2ae.offsetHeight;
}
}
};
function CIcon(_2b0,_2b1,_2b2){
this.m_iconPath=_2b0;
this.m_toolTip=_2b1;
this.m_enabled=true;
this.m_height=16;
this.m_width=16;
if(typeof _2b2!="undefined"&&_2b2!=""){
this.m_webContentRoot=_2b2;
}else{
this.m_webContentRoot="..";
}
};
function CIcon_draw(){
var html="";
html+="<img style=\"vertical-align:middle;\" src=\"";
if(typeof this.m_iconPath!="undefined"&&this.m_iconPath!==""&&this.m_iconPath!="blankIcon"){
if(this.m_enabled==true){
html+=this.m_iconPath;
}else{
html+=this.getDisabledImagePath();
}
html+="\" title=\"";
if(typeof this.m_toolTip=="string"&&this.m_toolTip.length>0){
html+=this.m_toolTip;
}
html+="\" alt=\"";
if(typeof this.m_toolTip=="string"&&this.m_toolTip.length>0){
html+=this.m_toolTip;
}
html+="\" width=\"";
html+=this.m_width;
html+="\" height=\"";
html+=this.m_height;
html+="\"/>";
}else{
html+=this.m_webContentRoot+"/common/images/spacer.gif";
html+="\" alt=\"\"";
if(this.m_iconPath=="blankIcon"){
html+=" width=\"";
html+=this.m_width;
html+="\" height=\"";
html+=this.m_height;
html+="\"/>";
}else{
html+=" width=\"1\" height=\"1\"/>";
}
}
return html;
};
function CIcon_getDisabledImagePath(){
var _2b4=this.m_iconPath.split("/");
var _2b5="";
for(var i=0;i<(_2b4.length-1);++i){
_2b5+=_2b4[i]+"/";
}
_2b5+="dis_"+_2b4[_2b4.length-1];
return _2b5;
};
function CIcon_getPath(){
return this.m_iconPath;
};
function CIcon_setPath(path){
this.m_iconPath=path;
};
function CIcon_getToolTip(){
return this.m_toolTip;
};
function CIcon_setToolTip(_2b8){
this.m_toolTip=_2b8;
};
function CIcon_enable(){
this.m_enabled=true;
};
function CIcon_disable(){
this.m_enabled=false;
};
function CIcon_isEnabled(){
return this.m_enabled;
};
function CIcon_setHeight(_2b9){
this.m_height=_2b9;
};
function CIcon_getHeight(){
return this.m_height;
};
function CIcon_setWidth(_2ba){
this.m_width=_2ba;
};
function CIcon_getWidth(){
return this.m_width;
};
CIcon.prototype.draw=CIcon_draw;
CIcon.prototype.enable=CIcon_enable;
CIcon.prototype.disable=CIcon_disable;
CIcon.prototype.isEnabled=CIcon_isEnabled;
CIcon.prototype.getDisabledImagePath=CIcon_getDisabledImagePath;
CIcon.prototype.getPath=CIcon_getPath;
CIcon.prototype.setPath=CIcon_setPath;
CIcon.prototype.setHeight=CIcon_setHeight;
CIcon.prototype.getHeight=CIcon_getHeight;
CIcon.prototype.setWidth=CIcon_setWidth;
CIcon.prototype.getWidth=CIcon_getWidth;
CIcon.prototype.getToolTip=CIcon_getToolTip;
CIcon.prototype.setToolTip=CIcon_setToolTip;
var cHorizonalBar=0;
var cVerticalBar=1;
function CBar(_2bb,_2bc,sId,_2be,_2bf,_2c0,_2c1,_2c2){
this.m_align="left";
this.m_items=[];
this.m_htmlContainerId=_2bb;
this.m_htmlContainer=null;
this.m_id="cbar"+_2bb;
this.m_menuType=cVerticalBar;
this.m_style=_2bc;
this.m_parent=null;
this.m_observers=new CObserver(this);
this.m_cookieVar=_2c1;
this.m_cookieName=_2c2;
this.m_sId=(sId)?sId:null;
this.m_display=DISPLAY_INLINE;
this.m_imagePath=(_2be)?_2be:"../common/images/toolbar/";
this.m_imgCollapseSrc=this.m_imagePath+"toolbar_collapse.gif";
this.m_imgExpandSrc=this.m_imagePath+"toolbar_expand.gif";
this.m_showTooltip=_2bf?_2bf:null;
this.m_hideTooltip=_2c0?_2c0:null;
};
function CBar_hideBar(){
var bar=document.getElementById("bar"+this.m_id);
var _2c4=document.getElementById("barIcon"+this.m_id);
if(_2c4){
_2c4.src=this.m_imgExpandSrc;
if(this.m_showTooltip!=null){
_2c4.alt=this.m_showTooltip;
_2c4.title=this.m_showTooltip;
}
}
if(bar){
bar.style.display=DISPLAY_NONE;
if(typeof setQSCookie=="function"){
setQSCookie(this.m_cookieVar,this.m_cookieName,0);
}
}
};
function CBar_showBar(){
var bar=document.getElementById("bar"+this.m_id);
var _2c6=document.getElementById("barIcon"+this.m_id);
if(_2c6){
_2c6.src=this.m_imgCollapseSrc;
if(this.m_hideTooltip!=null){
_2c6.alt=this.m_hideTooltip;
_2c6.title=this.m_hideTooltip;
}
}
if(bar){
bar.style.display=this.m_display;
if(typeof setQSCookie=="function"){
setQSCookie(this.m_cookieVar,this.m_cookieName,1);
}
}
};
function CBar_toggleBar(){
var bar=document.getElementById("bar"+this.m_id);
var _2c8=bar.style.display;
if((_2c8==this.m_display)||(_2c8=="")){
this.hideBar();
}else{
this.showBar();
}
};
function CBar_getParent(){
return this.m_parent;
};
function CBar_setParent(_2c9){
this.m_parent=_2c9;
};
function CBar_draw(){
if(this.m_htmlContainer==null){
this.m_htmlContainer=document.getElementById(this.m_htmlContainerId);
if(this.m_htmlContainer==null){
return;
}
}
var html="";
html+="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" role=\"presentation\"";
if(this.m_sId!=null){
html+="style=\"display: inline;\"><tr>";
html+="<td"+(isFF()?" style=\"vertical-align:bottom\"":"")+" style=\"height:26px\"><img id=\"barIcon"+this.m_id+"\" border=\"0\" src=\""+this.m_imgCollapseSrc+"\"";
if(this.m_hideTooltip!=null){
html+=" alt=\""+this.m_hideTooltip+"\" title=\""+this.m_hideTooltip+"\"";
}
html+=" onclick=\""+this.m_sId+".toggleBar();\" style=\"cursor:pointer;cursor:hand;\"></td>";
}else{
var _2cb="";
if(this.m_htmlContainer.style.textAlign=="right"){
_2cb="margin-left:auto; margin-right: 0;";
}else{
if(this.m_htmlContainer.style.textAlign=="left"){
_2cb="margin-left:0; margin-right: auto;";
}else{
if(this.m_htmlContainer.style.textAlign=="center"){
_2cb="margin-left:auto; margin-right: auto;";
}
}
}
if(_2cb!=""){
html+=" style=\""+_2cb+"\"";
}
html+="><tr>";
}
html+="<td id=\"bar"+this.m_id+"\">";
html+="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" role=\"presentation\" class=\"";
if(this.getStyle()!=null){
html+=this.getStyle().getNormalState();
}
html+="\" id=\"";
html+=this.m_id;
html+="\" style=\""+this.m_style+"\"><tr>";
html+=this.drawItems();
html+="</tr></table></td>";
html+="</tr></table>";
this.m_htmlContainer.innerHTML=html;
this.m_htmlContainer.style.textAlign=this.m_align;
for(var i=0;i<this.m_items.length;++i){
if(typeof this.m_items[i].init=="function"){
this.m_items[i].init();
}
}
this.attachEvents();
};
function CBar_drawItems(){
var html="";
for(var i=0;i<this.m_items.length;++i){
if(typeof this.m_items[i].draw=="function"){
if(this.m_menuType==cHorizonalBar&&!(this.m_items[i] instanceof CSeperator)){
html+="<td style=\"white-space:nowrap;";
if(this.m_items[i] instanceof CMenuItem){
html+=";padding-left:1px; padding-right: 1px;";
}
html+="\">";
}
if(this.m_items[i].isVisible()){
html+=this.m_items[i].draw();
}
if(this.m_menuType==cHorizonalBar&&!(this.m_items[i] instanceof CSeperator)){
html+="</td>";
}
}
}
return html;
};
function CBar_attachEvents(){
for(var i=0;i<this.m_items.length;++i){
if(typeof this.m_items[i].attachEvents=="function"&&this.m_items[i].isVisible()){
this.m_items[i].attachEvents();
}
}
};
function CBar_add(item){
if(typeof item.getObservers=="function"&&typeof item.getObservers()=="object"&&typeof item.onmouseover=="function"&&item instanceof CMenuItem){
item.getObservers().attach(this,this.closeMenus,item.onmouseover);
}
this.m_items[this.m_items.length]=item;
};
function CBar_getNumItems(){
return this.m_items.length;
};
function CBar_getId(){
return this.m_id;
};
function CBar_get(_2d1){
if(_2d1>=0&&_2d1<this.getNumItems()){
return this.m_items[_2d1];
}
return null;
};
function CBar_hide(_2d2){
if(_2d2>0&&_2d2<this.getNumItems()){
if(typeof this.m_items[i].hide=="function"){
this.m_items[i].hide();
}
}
};
function CBar_show(_2d3){
if(_2d3>0&&_2d3<this.getNumItems()){
if(typeof this.m_items[i].show=="function"){
this.m_items[i].show();
}
}
};
function CBar_enable(_2d4){
if(_2d4>0&&_2d4<this.getNumItems()){
if(typeof this.m_items[i].enable=="function"){
this.m_items[i].enable();
}
}
};
function CBar_disable(_2d5){
if(_2d5>0&&_2d5<this.getNumItems()){
if(typeof this.m_items[i].disable=="function"){
this.m_items[i].disable();
}
}
};
function CBar_getState(_2d6){
if(_2d6>0&&_2d6<this.getNumItems()){
if(typeof this.m_items[i].getState=="function"){
this.m_items[i].getState();
}
}
};
function CBar_setMenuType(_2d7){
this.m_menuType=_2d7;
};
function CBar_getMenuType(){
return this.m_menuType;
};
function CBar_setStyle(_2d8){
this.m_style=_2d8;
};
function CBar_setAlign(_2d9){
this.m_align=_2d9;
};
function CBar_getStyle(){
return this.m_style;
};
function CBar_closeMenus(_2da){
for(var i=0;i<this.getNumItems();i++){
var _2dc=this.get(i);
if(typeof _2da=="object"){
if(_2da.getSubject()==_2dc){
continue;
}
}
if(typeof _2dc.getMenu=="function"&&_2dc.getMenu()!=null&&_2dc.getMenu().isVisible()){
_2dc.getMenu().remove();
}
}
};
function CBar_getHTMLContainer(){
return this.m_htmlContainer;
};
function CBar_getObservers(){
return this.m_observers;
};
function CBar_onmouseover(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onmouseover=="function"){
this.getParent().onmouseover(evt);
}
this.getObservers().notify(CBar_onmouseover);
};
function CBar_onmouseout(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onmouseout=="function"){
this.getParent().onmouseout(evt);
}
this.getObservers().notify(CBar_onmouseout);
};
function CBar_onmouseup(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onmouseup=="function"){
this.getParent().onmouseup(evt);
}
this.getObservers().notify(CBar_onmouseup);
};
function CBar_onkeypress(evt){
evt=(evt)?evt:((event)?event:null);
if(this.getParent()!=null&&typeof this.getParent().onkeypress=="function"){
this.getParent().onkeypress(evt);
}
this.getObservers().notify(CBar_onkeypress);
};
CBar.prototype.draw=CBar_draw;
CBar.prototype.add=CBar_add;
CBar.prototype.get=CBar_get;
CBar.prototype.hide=CBar_hide;
CBar.prototype.show=CBar_show;
CBar.prototype.enable=CBar_enable;
CBar.prototype.disable=CBar_disable;
CBar.prototype.getState=CBar_getState;
CBar.prototype.attachEvents=CBar_attachEvents;
CBar.prototype.drawItems=CBar_drawItems;
CBar.prototype.getId=CBar_getId;
CBar.prototype.setMenuType=CBar_setMenuType;
CBar.prototype.getMenuType=CBar_getMenuType;
CBar.prototype.getNumItems=CBar_getNumItems;
CBar.prototype.setStyle=CBar_setStyle;
CBar.prototype.getStyle=CBar_getStyle;
CBar.prototype.setAlign=CBar_setAlign;
CBar.prototype.closeMenus=CBar_closeMenus;
CBar.prototype.setParent=CBar_setParent;
CBar.prototype.getParent=CBar_getParent;
CBar.prototype.getHTMLContainer=CBar_getHTMLContainer;
CBar.prototype.getObservers=CBar_getObservers;
CBar.prototype.update=new Function("return true");
CBar.prototype.getObservers=CBar_getObservers;
CBar.prototype.onmouseover=CBar_onmouseover;
CBar.prototype.onmouseout=CBar_onmouseout;
CBar.prototype.onmouseup=CBar_onmouseup;
CBar.prototype.onkeypress=CBar_onkeypress;
CBar.prototype.hideBar=CBar_hideBar;
CBar.prototype.showBar=CBar_showBar;
CBar.prototype.toggleBar=CBar_toggleBar;
function CStaticText(text,_2e2){
this.m_text=text;
this.m_style=_2e2;
this.m_bVisible=true;
this.m_sId="";
};
CStaticText.prototype.setId=function(sId){
this.m_sId=sId;
};
CStaticText.prototype.getId=function(){
return this.m_sId;
};
CStaticText.prototype.setText=function(text){
this.m_text=text;
};
CStaticText.prototype.setLabelledBy=function(text){
this.m_labelledBy=text;
};
CStaticText.prototype.draw=function(){
var html="";
html+="<td style=\"white-space: nowrap;\" class=\"";
html+=this.m_style.getNormalState()+"\"";
if(this.getId()!=""){
html+=" id=\""+this.getId()+"\"";
}
html+=">";
var _2e7=this.m_labelledBy?"aria-labelledby=\""+this.getId()+"label\"":"";
html+="<div role=\"presentation\" tabIndex=\"0\" "+_2e7+">";
html+=this.m_text;
html+="</div>";
if(this.m_labelledBy){
html+="<div style=\"position: absolute; overflow: hidden; width: 0; height: 0;\" id=\""+this.getId()+"label\">";
html+=this.m_labelledBy;
html+="</div>";
}
html+="</td>";
return html;
};
CStaticText.prototype.isVisible=function(){
return this.m_bVisible;
};
CStaticText.prototype.hide=function(){
this.m_bVisible=false;
};
CStaticText.prototype.hide.show=function(){
this.m_bVisible=true;
};
var DISPLAY_INLINE="inline";
var DISPLAY_NONE="none";
var DISPLAY_BLOCK="block";
var __excel_win=null;
var __pdf_win=null;
if(window.attachEvent){
window.attachEvent("onkeydown",viewerMainKeyPress);
window.attachEvent("onresize",onResizeViewerEvent);
}else{
if(window.addEventListener){
window.addEventListener("keypress",viewerMainKeyPress,false);
window.addEventListener("resize",onResizeViewerEvent,false);
}
}
function attachLeavingRV(){
if(window.attachEvent){
window.attachEvent("onbeforeunload",leavingRV);
}else{
if(window.addEventListener){
window.addEventListener("beforeunload",leavingRV,false);
}else{
try{
var _2e8=window.onunload;
if(!(""+_2e8).match(/leavingRV/gi)){
window.oLeavingRV_onunload=window.onunload;
window.onunload=function(){
window.oLeavingRV_onunload();
leavingRV();
};
}
}
catch(e){
}
}
}
};
function detachLeavingRV(){
if(window.detachEvent){
window.detachEvent("onbeforeunload",leavingRV);
}else{
window.removeEventListener("beforeunload",leavingRV,false);
}
};
window.attachLeavingRV();
function CContextMenu(_2e9){
if(_2e9==null){
return;
}
this.m_mainWnd=_2e9;
this.setCV(this.m_mainWnd.getCV());
var _2ea=this.m_mainWnd.getCV().getWebContentRoot();
var _2eb=this.m_mainWnd.getCV().getSkin();
var _2ec=this.m_mainWnd.getUIHide();
this.m_contextMenu=new CMenu("rvContextMenu"+this.getCVId(),gMenuStyle,_2ea);
this.m_contextMenu.m_oCV=this.getCV();
this.m_downloadChart=new CMenuItem(this.m_contextMenu,RV_RES.RV_DOWNLOAD_CHART,"if(typeof "+getCognosViewerSCObjectRefAsString(this.getCVId())+" != 'undefined') "+getCognosViewerSCObjectRefAsString(this.getCVId())+".downloadSelectedChartImage('"+this.getCVId()+"');",_2ea+"/rv/images/action_chart.gif",gMenuItemStyle,_2ea,_2eb);
this.m_downloadChart.hide();
this.m_downloadChartSeperator=new CSeperator("horizontal_line"+this.getCVId(),"1",gMenuSeperatorStyle,_2ea);
this.m_downloadChartSeperator.hide();
this.m_contextMenu.add(this.m_downloadChartSeperator);
var _2ed=this.getCV().getDrillMgr();
if(_2ed){
if(this.getCV().envParams["ui.action"]=="view"){
if(this.getCV().bCanUseCognosViewerIndexSearch&&_2ec.indexOf(" RV_CONTEXT_MENU_GOTO ")==-1){
this.m_goto=new CMenuItem(this.m_contextMenu,RV_RES.RV_GO_TO,this.getCVObjectRef()+".getDrillMgr().launchGoToPage(null,true);",_2ea+"/rv/images/action_go_to.gif",gMenuItemStyle,_2ea,_2eb);
var _2ee=this.m_goto.createCascadedMenu(gMenuStyle);
}
}else{
if(typeof RV_RES.RV_DRILL_DOWN!="undefined"){
this.m_drillDown=new CMenuItem(this.m_contextMenu,RV_RES.RV_DRILL_DOWN,this.getCVObjectRef()+".getDrillMgr().rvDrillDown();",_2ea+"/rv/images/action_drill_down.gif",gMenuItemStyle,_2ea,_2eb);
this.m_drillDown.disable();
}
if(typeof RV_RES.RV_DRILL_UP!="undefined"){
this.m_drillUp=new CMenuItem(this.m_contextMenu,RV_RES.RV_DRILL_UP,this.getCVObjectRef()+".getDrillMgr().rvDrillUp();",_2ea+"/rv/images/action_drill_up.gif",gMenuItemStyle,_2ea,_2eb);
this.m_drillUp.disable();
}
if(this.getCV().isInteractiveViewer()&&this.getCV().getAdvancedServerProperty("VIEWER_JS_ENABLE_EXPAND_COLLAPSE")=="true"){
this.m_contextMenu.add(gMenuSeperator);
if(typeof RV_RES.IDS_JS_EXPAND_MEMBER!="undefined"){
this.m_expand=new CMenuItem(this.m_contextMenu,RV_RES.IDS_JS_EXPAND_MEMBER,this.getCVObjectRef()+".expand();","",gMenuItemStyle,_2ea,_2eb);
this.m_expand.disable();
}
if(typeof RV_RES.IDS_JS_COLLAPSE_MEMBER!="undefined"){
this.m_collapse=new CMenuItem(this.m_contextMenu,RV_RES.IDS_JS_COLLAPSE_MEMBER,this.getCVObjectRef()+".collapse();","",gMenuItemStyle,_2ea,_2eb);
this.m_collapse.disable();
}
}
if(!this.getCV().m_viewerFragment&&typeof RV_RES.IDS_JS_FREEZECOLUMNHEADINGS!=="undefined"&&typeof RV_RES.IDS_JS_FREEZEROWHEADINGS!=="undefined"){
this.m_freezeRowHeadings=new CMenuItem(this.m_contextMenu,RV_RES.IDS_JS_FREEZEROWHEADINGS,this.getCVObjectRef()+".getPinFreezeManager().freezeSelectedRowHeadings();",_2ea+"/rv/images/action_freeze_row_heading.gif",gMenuItemStyle,_2ea,_2eb);
this.m_unfreezeRowHeadings=new CMenuItem(this.m_contextMenu,RV_RES.IDS_JS_UNFREEZEROWHEADINGS,this.getCVObjectRef()+".getPinFreezeManager().unfreezeSelectedRowHeadings();",_2ea+"/rv/images/action_freeze_row_heading.gif",gMenuItemStyle,_2ea,_2eb);
this.m_freezeColumnHeadings=new CMenuItem(this.m_contextMenu,RV_RES.IDS_JS_FREEZECOLUMNHEADINGS,this.getCVObjectRef()+".getPinFreezeManager().freezeSelectedColumnHeadings();",_2ea+"/rv/images/action_freeze_column_heading.gif",gMenuItemStyle,_2ea,_2eb);
this.m_unfreezeColumnHeadings=new CMenuItem(this.m_contextMenu,RV_RES.IDS_JS_UNFREEZECOLUMNHEADINGS,this.getCVObjectRef()+".getPinFreezeManager().unfreezeSelectedColumnHeadings();",_2ea+"/rv/images/action_freeze_column_heading.gif",gMenuItemStyle,_2ea,_2eb);
this.m_freezeColumnHeadings.hide();
this.m_unfreezeColumnHeadings.hide();
this.m_freezeRowHeadings.hide();
this.m_unfreezeRowHeadings.hide();
}
if(typeof RV_RES.RV_GO_TO!="undefined"){
if(_2ec.indexOf(" RV_CONTEXT_MENU_GOTO ")==-1){
if(_2ec.indexOf(" RV_CONTEXT_MENU_DRILL_UP ")==-1||!_2ec.indexOf(" RV_CONTEXT_MENU_DRILL_DOWN ")==-1){
this.m_contextMenu.add(gMenuSeperator);
}
}
this.m_goto=new CMenuItem(this.m_contextMenu,RV_RES.RV_GO_TO,this.getCVObjectRef()+".getDrillMgr().launchGoToPage(null,true);",_2ea+"/rv/images/action_go_to.gif",gMenuItemStyle,_2ea,_2eb);
var _2ef=this.m_goto.createCascadedMenu(gMenuStyle);
_2ef.m_oCV=this.getCV();
if(this.getCV().envParams["cv.containerApp"]=="AA"){
_2ef.registerCallback(this.getCVObjectRef()+".m_viewerFragment.raiseGotoContextMenuEvent()");
}else{
_2ef.registerCallback(this.getCVObjectRef()+".getDrillMgr().getDrillThroughParameters()");
}
}
}
}
var _2f0=this.getCV().getSubscriptionManager();
if(_2f0&&this.getCV().bCanUseCognosViewerConditionalSubscriptions){
this.m_subscriptionSeperator=new CSeperator("horizontal_line","1",gMenuSeperatorStyle,_2ea);
this.m_subscriptionSeperator.hide();
this.m_contextMenu.add(this.m_subscriptionSeperator);
if(RV_RES.RV_NEW_WATCH_RULE){
this.m_subscription=new CMenuItem(this.m_contextMenu,RV_RES.RV_NEW_WATCH_RULE,this.getCVObjectRef()+".getSubscriptionManager().NewSubscription();",_2ea+"/rv/images/action_new_subscription.gif",gMenuItemStyle,_2ea,_2eb);
this.m_subscription.disable();
}
}
var _2f1=false;
if(this.getCV().bCanUseGlossary&&RV_RES.RV_GLOSSARY&&_2ec.indexOf(" RV_CONTEXT_MENU_GLOSSARY ")==-1){
_2f1=true;
this.m_contextMenu.add(gMenuSeperator);
this.m_glossaryItem=new CMenuItem(this.m_contextMenu,RV_RES.RV_GLOSSARY,this.getCVObjectRef()+".executeAction('Glossary');",_2ea+"/rv/images/action_glossary.gif",gMenuItemStyle,_2ea,_2eb);
this.m_glossaryItem.disable();
}
if(this.isLinegaeVisisble(_2ec)){
if(!_2f1){
this.m_contextMenu.add(gMenuSeperator);
}
this.m_lineageItem=new CMenuItem(this.m_contextMenu,RV_RES.RV_LINEAGE,this.getCVObjectRef()+".executeAction('Lineage');",_2ea+"/rv/images/action_lineage.gif",gMenuItemStyle,_2ea,_2eb);
this.m_lineageItem.disable();
}
};
CContextMenu.prototype=new CViewerHelper();
CContextMenu.prototype.isLinegaeVisisble=function(_2f2){
if(!isSafari()&&this.getCV().bCanUseLineage&&RV_RES.RV_LINEAGE&&_2f2.indexOf(" RV_CONTEXT_MENU_LINEAGE ")==-1){
if(this.getCV().envParams["ui.object"]||(this.getCV().envParams["metadataInformationURI"]&&this.getCV().envParams["metadataInformationURI"].indexOf("iis=")==-1)){
return true;
}
}
return false;
};
CContextMenu.prototype.hideFirstSeperators=function(){
var _2f3=this.m_contextMenu.m_menuItems.length;
for(var _2f4=0;_2f4<_2f3;_2f4++){
var _2f5=this.m_contextMenu.m_menuItems[_2f4];
if(_2f5.isVisible()&&typeof _2f5.m_toolbarSeperatorClass!="string"){
break;
}else{
if(typeof _2f5.m_toolbarSeperatorClass=="string"){
_2f5.hide();
}
}
}
};
CContextMenu.prototype.updateFreezeHeadings=function(){
if(this.getCV().m_viewerFragment){
return;
}
if(this.getCV().getPinFreezeManager()){
var _2f6=this.getCV().getPinFreezeManager();
if(this.m_freezeRowHeadings){
if(_2f6.canFreezeSelectedRowHeadings()){
this.m_freezeRowHeadings.show();
}else{
this.m_freezeRowHeadings.hide();
}
}
if(this.m_unfreezeRowHeadings){
if(_2f6.canUnfreezeSelectedRowHeadings()){
this.m_unfreezeRowHeadings.show();
}else{
this.m_unfreezeRowHeadings.hide();
}
}
if(this.m_freezeColumnHeadings){
if(_2f6.canFreezeSelectedColumnHeadings()){
this.m_freezeColumnHeadings.show();
}else{
this.m_freezeColumnHeadings.hide();
}
}
if(this.m_unfreezeColumnHeadings){
if(_2f6.canUnfreezeSelectedColumnHeadings()){
this.m_unfreezeColumnHeadings.show();
}else{
this.m_unfreezeColumnHeadings.hide();
}
}
}
};
function CContextMenu_draw(evt){
this.updateSubscriptionContextMenuItem();
if(this.m_bFaultModalShown){
this.update(this.subject);
this.m_bFaultModalShown=false;
}
this.hideFirstSeperators();
this.m_contextMenu.remove();
this.m_contextMenu.setHTMLContainer(document.body);
this.m_contextMenu.draw();
if(isIE()&&evt.keyCode&&evt.keyCode!=0){
var node=getCrossBrowserNode(evt);
var _2f9=clientToScreenCoords(node,document.body);
this.m_contextMenu.setXCoord(_2f9.leftCoord+node.scrollWidth);
this.m_contextMenu.setYCoord(_2f9.topCoord);
}else{
this.m_contextMenu.setXCoord(evt.clientX);
this.m_contextMenu.setYCoord(evt.clientY);
}
if(getCVWaitingOnFault()==null){
this.m_contextMenu.show();
this.m_bFaultModalShown=false;
}else{
this.m_bFaultModalShown=true;
}
var _2fa=this.m_contextMenu.get(this.m_contextMenu.getNumItems()-1);
if(_2fa&&typeof _2fa.getObservers=="function"&&typeof _2fa.getObservers()=="object"){
_2fa.getObservers().attach(this,this.closeMenuTabEvent,"CMenuItem_closeMenuTabEvent");
}
};
function CContextMenu_getDrillUpMenuItem(){
return this.m_drillUp;
};
function CContextMenu_getDrillDownMenuItem(){
return this.m_drillDown;
};
function CContextMenu_getGoToMenuItem(){
return this.m_goto;
};
function CContextMenu_closeMenuTabEvent(){
var oCV=this.m_mainWnd.getCV();
var _2fc=oCV.getSelectionController();
var _2fd=_2fc.getAllSelectedObjects().length;
if(_2fd>0){
var _2fe=_2fc.getAllSelectedObjects()[_2fd-1];
var _2ff=_2fe.getCellRef().getElementsByTagName("span");
if(_2ff.length>0){
for(var i=0;i<_2ff.length;i++){
var span=_2ff[i];
if(span.getAttribute("tabindex")!=null&&span.style.visibility!="hidden"){
span.focus();
}
}
}
}
};
function CContextMenu_hide(){
this.m_contextMenu.remove();
};
function CContextMenu_hideDownloadChartMenuItem(){
this.m_downloadChart.hide();
this.m_downloadChartSeperator.hide();
};
function CContextMenu_showDownloadChartMenuItem(){
this.m_downloadChart.show();
this.m_downloadChartSeperator.show();
};
function CContextMenu_update(_302){
if(_302 instanceof CSelectionController){
this.subject=_302;
var _303=this.m_mainWnd.getUIHide();
var _304=this.getCV().getDrillMgr();
if(_304){
if(this.getCV().envParams["ui.action"]!="view"){
var _305=this.getGoToMenuItem();
var _306=_305.getMenu();
if(_306){
_306.clear();
}
if(!_302.getSelectionBasedFeaturesEnabled()||_303.indexOf(" RV_CONTEXT_MENU_GOTO ")!=-1){
_305.hide();
}
var _307=this.getDrillDownMenuItem();
if(_303.indexOf(" RV_CONTEXT_MENU_DRILL_DOWN ")!=-1){
_307.hide();
}else{
if(_304.canDrillDown()){
this.updateDrillMenu(_307,"DrillDown");
_307.enable();
}else{
if(!_302.getSelectionBasedFeaturesEnabled()){
_307.hide();
}else{
_307.disable();
}
}
}
var _308=this.getDrillUpMenuItem();
if(_303.indexOf(" RV_CONTEXT_MENU_DRILL_UP ")!=-1){
_308.hide();
}
if(_304.canDrillUp()){
this.updateDrillMenu(_308,"DrillUp");
_308.enable();
}else{
if(!_302.getSelectionBasedFeaturesEnabled()){
_308.hide();
gMenuSeperator.hide();
}else{
_308.disable();
}
}
if(this.m_expand){
this.getCV().canExpand()?this.m_expand.enable():this.m_expand.disable();
}
if(this.m_collapse){
this.getCV().canCollapse()?this.m_collapse.enable():this.m_collapse.disable();
}
}
if(_303.indexOf(" RV_CONTEXT_MENU_DOWNLOAD_CHART ")!=-1){
this.hideDownloadChartMenuItem();
}else{
if(!_302.hasSelectedChartNodes()){
if(!_302.getSelectionBasedFeaturesEnabled()){
this.hide();
}else{
this.hideDownloadChartMenuItem();
}
}else{
this.showDownloadChartMenuItem();
}
}
}
var _309=false;
if(this.m_lineageItem||this.m_glossaryItem){
var _30a=_302.getAllSelectedObjects();
if(_30a!=null&&_30a.length>0){
for(var i=0;i<_30a.length;i++){
if(_30a[i].hasContextInformation()){
_309=true;
break;
}
}
}
}
this.updateFreezeHeadings();
if(this.m_glossaryItem&&_309&&this.getCV().envParams["glossaryURI"]!=null&&this.getCV().envParams["glossaryURI"]!=""){
this.m_glossaryItem.enable();
}else{
if(this.m_glossaryItem){
this.m_glossaryItem.disable();
}
}
if(this.m_lineageItem&&_309){
this.m_lineageItem.enable();
}else{
if(this.m_lineageItem){
this.m_lineageItem.disable();
}
}
}
};
CContextMenu.prototype.updateDrillMenu=function(_30c,_30d){
_30c.clearCascadedMenu();
var _30e={};
DrillContextMenuHelper.updateDrillMenuItems(_30e,this.getCV(),_30d);
if(_30e.items){
var _30f=_30e.items;
var _310=_30c.createCascadedMenu(gMenuStyle);
var _311=this.getCV().getWebContentRoot();
var _312=this.m_mainWnd.getCV().getSkin();
for(var i=0;i<_30f.length;i++){
var _314=_30f[i];
if(_314.separator){
if(i<(_30f.length-1)){
_310.add(gMenuSeperator);
}
}else{
var _315=_314.action&&_314.action.payload&&_314.action.payload.userSelectedDrillItem?_314.action.payload.userSelectedDrillItem:"";
var _316=_315?"{\"userSelectedDrillItem\" : \""+_315+"\"}":"{}";
if(_30d=="DrillDown"){
new CMenuItem(_310,_314.label,this.getCVObjectRef()+".getDrillMgr().rvDrillDown("+_316+");","",gMenuItemStyle,_311,_312);
}else{
new CMenuItem(_310,_314.label,this.getCVObjectRef()+".getDrillMgr().rvDrillUp("+_316+");","",gMenuItemStyle,_311,_312);
}
}
}
}
};
function CContextMenu_updateSubscriptionContextMenuItem(){
var _317=this.m_mainWnd.getUIHide();
var _318=this.getCV().getSubscriptionManager();
if(_317.indexOf(" RV_CONTEXT_MENU_ALERT_USING_NEW_WATCH_RULE ")!=-1&&this.m_subscription){
this.m_subscription.hide();
}else{
if(_318&&this.m_subscription&&_318.CanCreateNewWatchRule()){
this.m_subscriptionSeperator.show();
this.m_subscription.show();
if(_318.IsValidSelectionForNewRule()){
this.m_subscription.enable();
}else{
this.m_subscription.disable();
}
}else{
if(this.m_subscription){
this.m_subscriptionSeperator.hide();
this.m_subscription.hide();
}
}
}
};
CContextMenu.prototype.draw=CContextMenu_draw;
CContextMenu.prototype.hide=CContextMenu_hide;
CContextMenu.prototype.closeMenuTabEvent=CContextMenu_closeMenuTabEvent;
CContextMenu.prototype.getDrillUpMenuItem=CContextMenu_getDrillUpMenuItem;
CContextMenu.prototype.getDrillDownMenuItem=CContextMenu_getDrillDownMenuItem;
CContextMenu.prototype.getGoToMenuItem=CContextMenu_getGoToMenuItem;
CContextMenu.prototype.hideDownloadChartMenuItem=CContextMenu_hideDownloadChartMenuItem;
CContextMenu.prototype.showDownloadChartMenuItem=CContextMenu_showDownloadChartMenuItem;
CContextMenu.prototype.update=CContextMenu_update;
CContextMenu.prototype.updateSubscriptionContextMenuItem=CContextMenu_updateSubscriptionContextMenuItem;
function CReportHistory(_319,_31a,_31b,_31c){
this.m_mainWnd=_319;
this.m_stack_idx=_31a;
this.m_reportName="";
if(typeof _31b=="undefined"||_31b==null||_31b.length==0){
if(typeof _319!="undefined"&&_319!=null){
var _31d=RV_RES.RV_PREVIOUS_REPORT;
this.m_reportName=_31d;
}
}else{
this.m_reportName=_31b;
}
this.m_params=_31c;
};
CReportHistory.prototype.getDropDownMenuIcon=function(){
var _31e="/ps/portal/images/";
if(this.m_params["ui.action"]=="view"){
_31e+="icon_result_";
if(this.m_params["ui.format"]=="PDF"){
_31e+="pdf.gif";
}else{
_31e+="html.gif";
}
}else{
_31e+="action_run.gif";
}
return _31e;
};
CReportHistory.prototype.addParamNode=function(_31f,_320,_321){
var _322=_31f.ownerDocument.createElement("param");
_31f.appendChild(_322);
_322.setAttribute("name",_320);
_322.appendChild(_31f.ownerDocument.createTextNode(_321));
};
CReportHistory.prototype.saveAsXML=function(_323){
var _324=_323.ownerDocument.createElement("previousReport");
_323.appendChild(_324);
for(var _325 in this.m_params){
this.addParamNode(_324,_325,this.m_params[_325]);
}
this.addParamNode(_324,"ui.name",this.getReportName());
};
CReportHistory.prototype.getIdx=function(){
return this.m_stack_idx;
};
CReportHistory.prototype.getReportName=function(){
return this.m_reportName;
};
CReportHistory.prototype.getParameters=function(){
return this.m_params;
};
CReportHistory.prototype.createRequestForm=function(){
var oCV=this.m_mainWnd.getCV();
var _327=document.getElementById("formWarpRequest"+oCV.getId());
var form=document.createElement("form");
form.setAttribute("id","previousReport");
form.setAttribute("name","previousReport");
form.setAttribute("target",_327.getAttribute("target")?_327.getAttribute("target"):"");
form.setAttribute("method","post");
form.setAttribute("action",_327.getAttribute("action"));
form.style.display="none";
document.body.appendChild(form);
for(var _329 in this.m_params){
if(_329!="m_tracking"){
form.appendChild(createHiddenFormField(_329,this.m_params[_329]));
}
}
for(var _32a in oCV.envParams){
if(_32a.indexOf("cv.")==0&&_32a!="cv.previousReports"&&_32a!="m_tracking"&&_32a!="cv.actionState"){
form.appendChild(createHiddenFormField(_32a,oCV.envParams[_32a]));
}
}
if(this.getIdx()>0){
this.m_mainWnd.m_reportHistoryList=this.m_mainWnd.m_reportHistoryList.slice(0,this.getIdx());
form.appendChild(createHiddenFormField("cv.previousReports",this.m_mainWnd.saveReportHistoryAsXML()));
}
form.appendChild(createHiddenFormField("ui.name",this.getReportName()));
form.appendChild(createHiddenFormField("b_action","cognosViewer"));
var _32b=_327.getElementsByTagName("INPUT");
for(var _32c=0;_32c<_32b.length;++_32c){
if(typeof form[_32b[_32c].name]=="undefined"&&_32b[_32c].name!="cv.previousReports"&&_32b[_32c].name.length>0){
form.appendChild(createHiddenFormField(_32b[_32c].name,_32b[_32c].value));
}
}
return form;
};
CReportHistory.prototype.execute=function(){
var oCV=this.m_mainWnd.getCV();
if(typeof oCV.m_viewerFragment!="undefined"){
var _32e=new ViewerDispatcherEntry(oCV);
_32e.addFormField("ui.action",this.m_params["ui.action"]);
for(var _32f in this.m_params){
if(_32f!="ui.action"&&_32f!="m_tracking"&&_32f!="cv.actionState"){
_32e.addFormField(_32f,this.m_params[_32f]);
}
}
if(this.getIdx()>0){
this.m_mainWnd.m_reportHistoryList=this.m_mainWnd.m_reportHistoryList.slice(0,this.getIdx());
_32e.addFormField("cv.previousReports",this.m_mainWnd.saveReportHistoryAsXML());
}else{
_32e.removeFormField("cv.previousReports");
}
if(this.m_reportName&&this.m_reportName.length>0){
_32e.addFormField("ui.name",this.m_reportName);
}
_32e.addFormField("cv.responseFormat","fragment");
_32e.addFormField("cv.ignoreState","true");
_32e.addFormField("cv.id","_THIS_");
_32e.addFormField("m_tracking","");
oCV.dispatchRequest(_32e);
}else{
var form=this.createRequestForm();
form.submit();
}
};
function CViewerManager(oCV){
this.setCV(oCV);
};
CViewerManager.prototype=new CViewerHelper();
CViewerManager.prototype.Print=function(){
var _332=document.getElementById("CVIFrame"+this.getCVId());
if(_332){
if(isIE()){
_332.contentWindow.document.execCommand("print",true,null);
}else{
_332.focus();
_332.contentWindow.print();
}
}
var cv=this.getCV();
var _334=cv.rvMainWnd;
var _335=_334.getToolbarControl();
if(typeof _335!="undefined"&&_335!=null){
var _336=_335.getItem("print");
if(_336){
_336.setFocus();
}
}
};
CViewerManager.prototype.DownloadReport=function(){
var _337="";
var f=document.forms["formWarpRequest"+this.getCVId()];
_337+="b_action=xts.run&m=portal/download.xts&m_obj=";
_337+=f["ui.object"].value;
_337+="&m_name=";
_337+=f["ui.name"].value;
if(f["ui.format"]&&f["ui.format"].value){
_337+="&format=";
_337+=f["ui.format"].value;
}
_337=constructGETRequestParamsString(_337);
_337=f.action+"?"+_337;
location.href=_337;
};
CViewerManager.prototype.SaveReport=function(_339){
var oCV=this.getCV();
var oReq=new ViewerDispatcherEntry(oCV);
oReq.setWorkingDialog(null);
oReq.addFormField("ui.action","save");
if(!_339){
oReq.addFormField("run.continueConversation","true");
}else{
this.getCV().closeActiveHTTPConnection();
if(oCV.getWorkingDialog()){
oCV.getWorkingDialog().hide();
}
this.getCV().setKeepSessionAlive(true);
oReq.addFormField("run.continueConversation","false");
var _33c=GUtil.generateCallback(executeBackURL,[this.getCV().getId()],null);
oReq.setCallbacks({"complete":{"method":_33c}});
}
oReq.addFormField("run.saveOutput","true");
this.getCV().dispatchRequest(oReq);
};
CViewerManager.prototype.SaveAsReportView=function(_33d){
var _33e=document.getElementById("formWarpRequest"+this.getCVId());
if(_33e){
var _33f=!_33d;
var _340={"m":"portal/viewer-saveAs.xts"};
_340["run.continueConversation"]=_33f;
_340["initializeSave"]="true";
_340["ui.object"]=_33e["ui.object"].value;
_340["ui.backURL"]=_33e["ui.backURL"].value;
_340["ui.routingServerGroup"]=this.getRoutingServerGroup();
cvLoadDialog(this.getCV(),_340,600,425,RV_RES.IDS_JS_SAVE_AS_REPORT_VIEW_IFRAME_TITLE);
}
};
CViewerManager.prototype.init=function(_341){
if(_341&&typeof _341=="object"){
for(var _342 in _341){
this[_342]=_341[_342];
}
}
};
CViewerManager.prototype.SendReport=function(_343){
var _344=!_343;
var _345={"m":"portal/viewer-email.xts"};
_345["run.continueConversation"]=_344;
_345["ui.routingServerGroup"]=this.getRoutingServerGroup();
cvLoadDialog(this.getCV(),_345,800,550,RV_RES.IDS_JS_EMAIL_REPORT_IFRAME_TITLE);
};
CViewerManager.prototype.validatePromptControls=function(){
if(typeof this.getCV().preProcessControlArray!="undefined"&&typeof preProcessForm!="undefined"){
preProcessForm(this.getCV().preProcessControlArray);
}
};
CViewerManager.prototype.RunReport=function(){
this.validatePromptControls();
var oReq=null;
var _347=this.getCV().envParams["ui.object"];
var _348=this.getCV().envParams["ui.spec"];
var _349=this.getCV().envParams["ui.action"];
var _34a=document.forms["formWarpRequest"+this.getCVId()];
if(_348!=null&&_348!=""){
oReq=new ViewerDispatcherEntry(this.getCV());
oReq.addFormField("ui.action","runSpecification");
oReq.addFormField("ui.spec",_348);
var _34b=this.getCV().envParams["specificationType"];
if(_34b!=null){
oReq.addFormField("specificationType",_34b);
}
}else{
if(_347!=null&&_347!=""){
if(this.getCV().isBux){
oReq=new ViewerDispatcherEntry(this.getCV());
oReq.addFormField("ui.action","bux");
}else{
oReq=new ViewerDispatcherEntry(this.getCV());
oReq.addFormField("ui.action","run");
}
if(_349=="view"){
if(this.getCV().envParams["ui.reRunObj"]){
_347=this.getCV().envParams["ui.reRunObj"];
}else{
if(typeof _34a["reRunObj"]!="undefined"&&_34a["reRunObj"]!=null){
_347=_34a["reRunObj"].value;
}
}
}
oReq.addFormField("ui.object",_347);
}
}
oReq.addFormField("run.outputFormat",this.getCV().rvMainWnd.getCurrentFormat());
oReq.addFormField("ui.primaryAction","");
var _34c=this.getCV().envParams["promptOnRerun"];
if(_34c!=null){
oReq.addFormField("run.prompt",_34c);
}else{
oReq.addFormField("run.prompt","true");
}
this.getCV().preparePromptValues(oReq);
this.getCV().dispatchRequest(oReq);
};
CViewerManager.prototype.viewReport=function(_34d){
if(this.getCV().rvMainWnd.getCurrentFormat()==_34d){
return;
}
var f=document.forms["formWarpRequest"+this.getCVId()];
if(f["ui.action"].value=="view"){
this.viewOutput(_34d);
}else{
var oReq=new ViewerDispatcherEntry(this.getCV());
oReq.addFormField("ui.action","render");
oReq.addFormField("run.outputFormat",_34d);
if(this.isExcelFormat(_34d)){
this.viewInExcel(oReq);
}else{
if(this.getCV().isAccessibleMode()&&_34d=="PDF"){
this.viewPDFInNewWindow(oReq);
}else{
if(isSafari()&&_34d=="PDF"){
oReq.addFormField("ui.reuseWindow","true");
this.viewPDFInNewWindow(oReq);
}else{
this.getCV().deleteTabs();
this.getCV().dispatchRequest(oReq);
}
}
}
}
};
CViewerManager.prototype.isExcelFormat=function(_350){
if(_350=="xlsxData"||_350=="XLS"||_350=="CSV"||_350=="XLWA"||_350=="singleXLS"||_350=="spreadsheetML"){
return true;
}
return false;
};
CViewerManager.prototype.viewOutput=function(_351){
var oFWR=document.forms["formWarpRequest"+this.getCVId()];
var oReq=new ViewerDispatcherEntry(this.getCV());
oReq.addFormField("ui.action","view");
oReq.addFormField("cv.responseFormat","view");
oReq.addFormField("ui.format",_351);
var _354="";
switch(_351){
case "HTML":
_354=this.getCV().oOutputFormatPath.HTML;
break;
case "PDF":
_354=this.getCV().oOutputFormatPath.PDF;
break;
case "singleXLS":
_354=this.getCV().oOutputFormatPath.singleXLS;
break;
case "XLS":
_354=this.getCV().oOutputFormatPath.XLS;
break;
case "XLWA":
_354=this.getCV().oOutputFormatPath.XLWA;
break;
case "CSV":
_354=this.getCV().oOutputFormatPath.CSV;
break;
case "XML":
_354=this.getCV().oOutputFormatPath.XML;
break;
case "spreadsheetML":
_354=this.getCV().oOutputFormatPath.spreadsheetML;
break;
case "xlsxData":
_354=this.getCV().oOutputFormatPath.xlsxData;
break;
}
if(_354){
oReq.addFormField("ui.object",_354);
}
oReq.addFormField("reRunObj",oFWR.reRunObj.value);
oReq.addFormField("ui.format",_351);
oReq.addFormField("ui.name",oFWR["ui.name"].value);
if(this.isExcelFormat(_351)){
this.viewInExcel(oReq);
}else{
if(this.getCV().isAccessibleMode()&&_351=="PDF"){
this.viewPDFInNewWindow(oReq);
}else{
if(isSafari()&&_351=="PDF"){
oReq.addFormField("ui.reuseWindow","true");
this.viewPDFInNewWindow(oReq);
}else{
this.getCV().dispatchRequest(oReq);
}
}
}
};
CViewerManager.prototype.viewPDFInNewWindow=function(oReq){
this.viewInNewWindow(oReq,__pdf_win);
};
CViewerManager.prototype.viewInExcel=function(oReq){
this.viewInNewWindow(oReq,__excel_win);
};
CViewerManager.prototype.viewInNewWindow=function(oReq,_358){
var _359=window.onbeforeunload;
window.onbeforeunload=null;
if(_358!=null){
_358.close();
}
var _35a="winNAT_"+(new Date()).getTime();
var _35b=this.getCV().getWebContentRoot()+"/"+"rv/blankNewWin.html?cv.id="+this.getCVId();
var _35c="viewForm"+this.getCVId();
var _35d=document.getElementById(_35c);
if(_35d){
_35d.parentNode.removeChild(_35d);
}
_35d=document.createElement("form");
_35d.setAttribute("method","post");
_35d.setAttribute("id",_35c);
_35d.setAttribute("action",this.getCV().getGateway());
_35d.style.display="inline";
var oFWR=document["formWarpRequest"+this.getCVId()];
if(oFWR&&oFWR["run.outputFormat"]){
oReq.addFormField("previousFormat",oFWR["run.outputFormat"].value);
}
var _35f=oReq.getFormFields().keys();
for(var _360=0;_360<_35f.length;_360++){
var name=_35f[_360];
if(name!="cv.responseFormat"&&name!="b_action"&&name!="m_tracking"){
_35d.appendChild(createHiddenFormField(name,oReq.getFormField(name)));
}
}
_35d.appendChild(createHiddenFormField("cv.responseFormat","page"));
_35d.appendChild(createHiddenFormField("b_action","cognosViewer"));
_35d.appendChild(createHiddenFormField("BIline1",RV_RES.RV_RUNNING));
_35d.appendChild(createHiddenFormField("BIline2",RV_RES.RV_PLEASE_WAIT));
if(this.getCV().envParams["ui.name"]){
_35d.appendChild(createHiddenFormField("ui.name",this.getCV().envParams["ui.name"]));
}
document.body.appendChild(_35d);
_35d.target=_35a;
_358=window.open(_35b,_35a,"rv");
window.onbeforeunload=_359;
};
CViewerManager.prototype.cancel=function(){
var oCV=this.getCV();
oCV.cancel();
};
CViewerManager.prototype.sXmlEncode=function(_363){
var _364=""+_363;
if((_364=="0")||((_363!=null)&&(_363!=false))){
_364=_364.replace(/&/g,"&amp;");
_364=_364.replace(/</g,"&lt;");
_364=_364.replace(/>/g,"&gt;");
_364=_364.replace(/"/g,"&quot;");
_364=_364.replace(/'/g,"&apos;");
}else{
if(_363==null){
_364="";
}
}
return _364;
};
CViewerManager.prototype.exit=function(_365){
var form=document.getElementById("formWarpRequest"+this.getCVId());
var oCV=this.getCV();
if(form&&form["ui.action"]&&form["ui.action"].value=="view"&&_365){
executeBackURL(this.getCVId());
}else{
if(oCV.getKeepSessionAlive()==false){
oCV.exit(_365);
}
}
};
function executeBackURL(_368){
var _369="";
if(_368){
_369=_368;
}
if(window["oCV"+_369]&&window["oCV"+_369].isBux){
return false;
}
var form=document.getElementById("formWarpRequest"+_369);
if(form["ui.backURL"].value.length<2048){
document.location.href=form["ui.backURL"].value;
return;
}
var _36b=decodeURIComponent(form["ui.backURL"].value);
var _36c=_36b.split("?");
var _36d=document.createElement("form");
_36d.style.display="none";
_36d.setAttribute("method","post");
_36d.setAttribute("action",_36c[0]);
_36d.setAttribute("target","_self");
var _36e=_36c[1].split("&");
for(var _36f=0;_36f<_36e.length;_36f++){
var _370=_36e[_36f].indexOf("=");
var _371=_36e[_36f].substr(0,_370);
var _372=_36e[_36f].substr(_370+1);
var _373=document.createElement("input");
_373.setAttribute("type","hidden");
_373.setAttribute("name",decodeURIComponent(_371));
_373.setAttribute("value",decodeURIComponent(_372));
_36d.appendChild(_373);
}
document.body.appendChild(_36d);
_36d.submit();
};
CViewerManager.prototype.getRoutingServerGroup=function(){
var oCV=this.getCV();
if(oCV.envParams["ui.routingServerGroup"]){
return oCV.envParams["ui.routingServerGroup"];
}
return "";
};
CViewerManager.prototype.launchQS=function(){
var _375=document.forms["formWarpRequest"+this.getCVId()];
var oCV=this.getCV();
if(typeof oCV.m_viewerFragment!="undefined"){
cognosLaunchInWindow("","menubar=no,toolbar=no,status=yes,location=no,resizable=yes,width=650,height=480","ui.gateway",_375.action,"ui.tool","QueryStudio","ui.action","edit","ui.object",_375["ui.object"].value,"ui.routingServerGroup",this.getRoutingServerGroup());
}else{
cognosLaunch("ui.gateway",_375.action,"ui.tool","QueryStudio","ui.action","edit","ui.object",_375["ui.object"].value,"ui.backURL",_375["ui.backURL"].value,"ui.routingServerGroup",this.getRoutingServerGroup());
}
};
CViewerManager.prototype.launchAS=function(){
var _377=document.forms["formWarpRequest"+this.getCVId()];
cognosLaunchInWindow("","menubar=no,toolbar=no,status=yes,location=no,resizable=yes,width=650,height=480","ui.gateway",_377.action,"ui.tool","AnalysisStudio","ui.action","edit","ui.object",_377["ui.object"].value,"ui.routingServerGroup",this.getRoutingServerGroup());
};
CViewerManager.prototype.launchRS=function(){
var _378=document.forms["formWarpRequest"+this.getCVId()];
cognosLaunchInWindow("_blank","menubar=no,toolbar=no,status=yes,location=no,resizable=yes,width=650,height=480","ui.gateway",_378.action,"ui.tool","ReportStudio","ui.action","edit","ui.profile","Professional","ui.object",_378["ui.object"].value,"ui.routingServerGroup",this.getRoutingServerGroup());
};
CViewerManager.prototype.returnHome=function(url){
var _37a=document.forms["formWarpRequest"+this.getCVId()];
_37a["ui.backURL"].value=url;
executeBackURL(this.getCVId());
};
CViewerManager.prototype.doPostBack=function(){
var f=document.forms["formWarpRequest"+this.getCVId()];
f.appendChild(createHiddenFormField("b_action","xts.run"));
f.appendChild(createHiddenFormField("m",f["ui.postBack"].value));
f.submit();
};
CViewerManager.prototype.hideAbout=function(){
this.getCV().removeTransparentBackgroundLayer();
var cvId=this.getCV().getId();
if(document.getElementById("viewerAboutDiv"+cvId)){
document.getElementById("viewerAboutDiv"+cvId).parentNode.removeChild(document.getElementById("viewerAboutDiv"+cvId));
}
if(document.getElementById("viewerAboutIframe"+cvId)){
document.getElementById("viewerAboutIframe"+cvId).parentNode.removeChild(document.getElementById("viewerAboutIframe"+cvId));
}
};
function viewerAboutOnKeyDown(evt){
evt=(evt)?evt:((event)?event:null);
var _37e=getCrossBrowserNode(evt);
if(evt.keyCode=="13"||evt.keyCode=="27"||evt.keyCode=="32"){
var oCV=window["oCV"+_37e.getAttribute("viewerId")];
oCV.m_oCVMgr.hideAbout();
return stopEventBubble(evt);
}
};
CViewerManager.prototype.fileExist=function(_380){
var http=null;
if(window.XMLHttpRequest){
http=new XMLHttpRequest();
}else{
http=new ActiveXObject("Msxml2.XMLHTTP");
}
http.open("HEAD",_380,false);
http.send();
return (http.status==200);
};
CViewerManager.prototype.getAboutBoxImageURL=function(){
var _382="about_"+this.getCV().getProductLocale()+".jpg";
var _383=this.getCV().getWebContentRoot()+"/rv/images/";
var _384=_383+_382;
if(!this.fileExist(_384)){
_384=_383+"about_en.jpg";
}
return _384;
};
CViewerManager.prototype.about=function(){
if(document.getElementById("viewerAbout"+this.getCV().getId())){
this.hideAbout();
}
this.getCV().createTransparentBackgroundLayer();
var _385=650;
var _386=522;
var _387=document.createElement("iframe");
_387.id="viewerAboutIframe"+this.getCV().getId();
_387.style.position="absolute";
_387.style.zIndex=99;
_387.style.width=_385+"px";
_387.style.height=_386+"px";
_387.setAttribute("src",this.getCV().getWebContentRoot()+"/common/blank.html");
_387.setAttribute("scrolling","no");
_387.setAttribute("frameborder","0");
_387.setAttribute("title",RV_RES.IDS_JS_MODAL_BACK_IFRAME);
_387.setAttribute("role","presentation");
document.body.appendChild(_387);
var id=this.getCV().getId();
var _389=document.createElement("div");
_389.tabIndex=0;
_389.onfocus=function(){
document.getElementById("viewerAboutOK"+id).focus();
};
document.body.appendChild(_389);
var div=document.createElement("div");
div.id="viewerAboutDiv"+this.getCV().getId();
div.style.position="absolute";
div.onkeydown=viewerAboutOnKeyDown;
div.style.zIndex=100;
div.style.width=_385+"px";
div.style.height=_386+"px";
div.style.outline="none";
div.setAttribute("role","dialog");
div.setAttribute("aria-label",RV_RES.RV_ABOUT_DESCRIPTION);
var _38b=this.getAboutBoxImageURL();
var _38c=RV_RES.RV_ABOUT_DESCRIPTION.replace(/"/g,"&quot;")+RV_RES.IDS_PROP_LEGAL.replace(/"/g,"&quot;");
div.innerHTML="<img role=\"img\" id=\"viewerAbout"+this.getCV().getId()+"\" tabIndex=\"0\" alt=\""+_38c+"\" title=\""+_38c+"\" src=\""+_38b+"\" onclick=\""+getCognosViewerObjectString(this.getCV().getId())+".m_oCVMgr.hideAbout()\"></img>";
div.setAttribute("viewerId",this.getCV().getId());
document.body.appendChild(div);
this.createOKButton(div);
var _38d=document.createElement("div");
_38d.tabIndex=0;
_38d.onfocus=function(){
document.getElementById("viewerAbout"+id).focus();
};
document.body.appendChild(_38d);
var _38e=0;
var _38f=0;
if(typeof window.innerHeight!="undefined"){
_38e=Math.round((window.innerHeight/2)-(_386/2));
_38f=Math.round((window.innerWidth/2)-(_385/2));
}else{
_38e=Math.round((document.body.clientHeight/2)-(_386/2));
_38f=Math.round((document.body.clientWidth/2)-(_385/2));
}
div.style.bottom=_387.style.bottom=_38e+"px";
div.style.left=_387.style.left=_38f+"px";
setTimeout("document.getElementById('viewerAbout"+id+"').focus();",1);
};
CViewerManager.prototype.createOKButton=function(_390){
var _391=document.createElement("div");
_391.style.backgroundcolor="#FFFFFF";
_391.id="viewerAboutOK"+this.getCV().getId();
_391.setAttribute("role","button");
_391.setAttribute("viewerId",this.getCV().getId());
_391.setAttribute("tabIndex","0");
var _392=this;
_391.onclick=function(){
_392.hideAbout();
};
_391.onkeydown=viewerAboutOnKeyDown;
_391.className="aboutOkButton";
_390.appendChild(_391);
var span=document.createElement("span");
span.style.padding="7px 30px 7px 30px";
span.appendChild(document.createTextNode(RV_RES.IDS_JS_OK));
_391.appendChild(span);
};
CViewerManager.prototype.updateUserName=function(){
var _394=new DataDispatcherEntry(this.getCV());
_394.addFormField("ui.action","CMRequest");
_394.addFormField("CMRequest","<CMRequest><searchPath>~</searchPath><properties><property>defaultName</property></properties></CMRequest>");
_394.addFormField("cv.responseFormat","CMRequest");
_394.addFormField("cv.catchLogOnFault","true");
_394.addFormField("cv.id",this.getCVId());
_394.setCallbacks({"complete":{"object":this,"method":this.updateUserNameCallback}});
_394.setCanBeQueued(true);
this.getCV().dispatchRequest(_394);
};
CViewerManager.prototype.updateUserNameCallback=function(_395){
var _396=this.getUserNameFromResponse(_395);
if(_396!=null){
var _397="userNameTD"+this.getCVId();
var _398=document.getElementById(_397);
if(_398!=null){
_398.innerHTML=html_encode(_396);
}
var _399=this.getCV().rvMainWnd.getBannerToolbar();
if(_399){
for(var _39a=0;_39a<_399.getNumItems();_39a++){
if(typeof _399.get(_39a).getId=="function"&&_399.get(_39a).getId()==_397){
_399.get(_39a).setText(html_encode(_396));
break;
}
}
}
}
};
CViewerManager.prototype.getUserNameFromResponse=function(_39b){
if(_39b){
var _39c=XMLBuilderLoadXMLFromString(_39b.getResult());
var _39d=XMLHelper_FindChildByTagName(_39c,"defaultName",true);
if(_39d!=null){
var _39e=XMLHelper_FindChildByTagName(_39d,"value",false);
if(_39e!=null){
return XMLHelper_GetText(_39e);
}
}
}
return null;
};
CViewerManager.prototype.getAvailableOutput=function(){
var oCV=this.getCV();
var _3a0=document.getElementById("formWarpRequest"+this.getCVId());
var _3a1=new JSONDispatcherEntry(this.getCV());
_3a1.addFormField("ui.action","getAvailableOutputs");
_3a1.addFormField("cv.responseFormat","getAvailableOutputs");
_3a1.addFormField("ui.object",_3a0["ui.object"].value);
_3a1.addFormField("ui.reportVersion",_3a0["ui.reportVersion"].value);
_3a1.addFormField("reRunObj",_3a0["reRunObj"].value);
_3a1.addFormField("ui.outputLocale",_3a0["ui.outputLocale"].value);
_3a1.addFormField("ui.burstKey",_3a0["ui.burstKey"].value);
_3a1.addFormField("cv.id",this.getCVId());
_3a1.setCallbacks({"complete":{"object":this,"method":this.getAvailableOutputResponseCallback}});
oCV.dispatchRequest(_3a1);
};
CViewerManager.prototype.getAvailableOutputResponseCallback=function(_3a2){
var oCV=this.getCV();
oCV.init(_3a2.getJSONResponseObject());
oCV.rvMainWnd.renderAvailableOutputs();
};
CViewerManager.prototype.authenticate=function(_3a4,url){
this.exit();
this.getCV().setKeepSessionAlive(true);
if(window.delCookie){
delCookie("cc_state");
}
if(_3a4=="logon"||_3a4=="relogon"){
location.href=url+"&h_CAM_action=logon&m_reload=";
}
if(_3a4=="logoff"){
location.href=url+"&h_CAM_action=logoff";
}
};
CViewerManager.prototype.launchNewGeneral=function(_3a6,_3a7){
var _3a8=document.getElementById("formWarpRequest"+this.getCVId());
if(_3a8){
var _3a9="";
if(_3a8["reRunObj"]){
_3a9=_3a8["reRunObj"].value;
}else{
_3a9=_3a8["ui.object"].value;
}
var _3aa=this.getCV().getGateway()+"?"+constructGETRequestParamsString("b_action=xts.run&m=portal/viewer-closeIframe.xts&cv.id="+this.getCVId());
var _3ab={"m":"portal/new_general.xts","m_new_class":_3a6,"so.searchPath":_3a7,"m_name":this.getCV().envParams["ui.name"],"m_obj_searchPath":_3a9,"m_obj":_3a9};
_3ab["ui.backURL"]=_3aa;
cvLoadDialog(this.getCV(),_3ab,500,425,RV_RES.IDS_JS_ADD_TO_MY_FOLDERS_IFRAME_TITLE);
}
};
CViewerManager.prototype.addToBookmarks=function(){
var _3ac=document.getElementById("formWarpRequest"+this.getCVId());
var _3ad=this.getCV().envParams;
var _3ae="b_action=cognosViewer";
for(var _3af in _3ad){
if(_3af.indexOf("ui.")==0&&_3af!="ui.primaryAction"&&_3af!="ui.backURL"&&_3ad!="ui.spec"&&_3af!="ui.conversation"&&_3af!="ui.cafcontextid"){
_3ae+="&"+_3af+"=";
if(_3af=="ui.action"&&_3ad["ui.primaryAction"]!=""){
_3ae+=encodeURIComponent(_3ad["ui.primaryAction"]);
}else{
_3ae+=encodeURIComponent(_3ad[_3af]);
}
}
if(_3af.indexOf("run.")==0){
_3ae+="&"+_3af+"="+encodeURIComponent(_3ad[_3af]);
}
}
var sURL=this.getCV().sGateway+"?"+constructGETRequestParamsString(_3ae);
var _3b1="";
if(_3ac["ui.action"].value=="view"){
if(typeof _3ad["versionName"]!="undefined"&&_3ad["versionName"]!=""){
_3b1=RV_RES.RV_VIEW_REPORT;
}else{
_3b1=RV_RES.RV_VIEW_RECENT_REPORT;
}
}
if(_3ac["ui.action"].value=="run"){
_3b1=RV_RES.RV_RUN_REPORT;
}
if(_3b1!=""){
_3b1+=" - ";
}
_3b1+=_3ad["ui.name"];
window.external.AddFavorite(sURL,_3b1);
};
function leavingRV(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
for(var _3b2=0;_3b2<window.gaRV_INSTANCES.length;_3b2++){
try{
var oCV=window.gaRV_INSTANCES[_3b2];
if(oCV){
var oRV=oCV.getRV();
if(oRV){
oRV.exit();
}
}
}
catch(e){
}
}
}
};
function viewerMainKeyPress(evt){
evt=(evt)?evt:((event)?event:null);
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
for(var _3b6=0;_3b6<window.gaRV_INSTANCES.length;_3b6++){
try{
var oCV=window.gaRV_INSTANCES[_3b6];
if(oCV&&oCV.getId()=="_NS_"){
var _3b8=evt.keyCode;
if(_3b8==0&&typeof evt.charCode!="undefined"){
_3b8=evt.charCode;
}
if(!oCV.getViewerWidget()&&(_3b8=="64"||_3b8=="50")&&evt.shiftKey==true&&evt.ctrlKey==true){
var _3b9=document.getElementById("RVContent"+oCV.getId());
if(_3b9){
_3b9.setAttribute("tabIndex","-1");
_3b9.focus();
return stopEventBubble(evt);
}
}else{
if(!oCV.getViewerWidget()&&(_3b8=="78"||_3b8=="110")&&evt.shiftKey==true&&evt.ctrlKey==true){
var _3ba=document.getElementById("CVNavLinks"+oCV.getId());
if(_3ba){
_3ba.setAttribute("tabIndex","-1");
_3ba.focus();
return stopEventBubble(evt);
}
}
}
}
}
catch(e){
}
}
}
};
var g_ViewerResizeTimer=0;
function onResizeViewerEvent(evt){
clearTimeout(g_ViewerResizeTimer);
g_ViewerResizeTimer=setTimeout(resizePinnedContainers,200);
};
function constructGETRequestParamsString(_3bc){
if(typeof CAFXSSEncode=="function"){
if(_3bc.indexOf("?")>=0){
var _3bd=_3bc.split("?");
return _3bd[0]+"?"+CAFXSSEncode(_3bd[_3bd.length-1]);
}
return CAFXSSEncode(_3bc);
}else{
return _3bc;
}
};
function sortReportHistoryStackDescending(a,b){
return (b.getIdx()-a.getIdx());
};
function sortReportHistoryStackAscending(a,b){
return (b.getIdx()-a.getIdx());
};
gToolbarButtonStyle=new CUIStyle("toolbarButton","toolbarButtonOver","toolbarButtonPressed","toolbarButtonOverPressed","toolbarButton");
gToolbarStyle=new CUIStyle("mainViewerHeader3","","","","");
gBannerButtonStyle=new CUIStyle("bannerToolbarButton","bannerToolbarButtonOver","","","");
gBannerToolbarStyle=new CUIStyle("bannerButtonContainer","","","","");
gMenuItemStyle=new CUIStyle("menuItem_normal","menuItem_hover","","","menuItem_disabled");
gMenuStyle=new CUIStyle("clsMenu","","","","");
gMenuSeperatorStyle=new CUIStyle("menuHorizontalSeperator","","","","");
gBannerItemStyle=new CUIStyle("bannerMenuItem","bannerMenuItemOver","","","");
gBannerStaticText=new CUIStyle("bannerText","","","","");
gBannerLink=new CUIStyle("bannerLink","bannerLink","","","");
gMenuSeperator=new CSeperator("horizontal_line","1",gMenuSeperatorStyle);
gToolbarSeperator=new CSeperator("horizonal_blank","5");
function CMainWnd(oCV){
this.setCV(oCV);
this.m_contextMenu=null;
this.m_reportHistoryList=[];
this.m_currentFormat="";
this.m_toolbar=null;
this.m_bannerToolbar=null;
this.m_browserHistoryIndex=history.length;
this.m_showContextMenuOnClick=false;
if(oCV.getConfig&&oCV.getConfig()){
var _3c3=oCV.getConfig().getEventsConfig();
this.m_showContextMenuOnClick=_3c3?_3c3.getShowContextMenuOnClick():false;
}
};
CMainWnd.prototype=new CViewerHelper();
CMainWnd.prototype.setBannerToolbar=function(_3c4){
this.m_bannerToolbar=new CViewerToolbar();
this.m_bannerToolbar.init(_3c4);
};
CMainWnd.prototype.getBannerToolbar=function(){
if(this.m_bannerToolbar){
return this.m_bannerToolbar.getCBar();
}
return null;
};
CMainWnd.prototype.closeContextMenuAndToolbarMenus=function(){
var _3c5=this.getToolbar();
if(_3c5){
_3c5.closeMenus();
}
var cm=this.getContextMenu();
if(cm){
cm.m_contextMenu.remove();
}
};
CMainWnd.prototype.setToolbar=function(_3c7){
this.m_toolbar=new CViewerToolbar();
this.m_toolbar.init(_3c7);
};
CMainWnd.prototype.getToolbar=function(){
if(this.m_toolbar){
return this.m_toolbar.getCBar();
}
return null;
};
CMainWnd.prototype.getToolbarControl=function(){
return this.m_toolbar;
};
CMainWnd.prototype.setCurrentFormat=function(_3c8){
this.m_currentFormat=_3c8;
};
CMainWnd.prototype.updateToolbar=function(_3c9){
this.updateCurrentFormat(_3c9,this.getCV().getWebContentRoot());
this.updateKeepThisVersion();
};
CMainWnd.prototype.updateKeepThisVersion=function(){
if(this.getCV().getStatus()=="complete"){
var _3ca=this.getCV().getSecondaryRequests();
var _3cb=false;
var _3cc=false;
var _3cd=false;
if(_3ca){
for(var _3ce=0;_3ce<_3ca.length;_3ce++){
switch(_3ca[_3ce]){
case "save":
_3cb=true;
break;
case "saveAs":
_3cc=true;
break;
case "email":
_3cd=true;
break;
}
}
}
var _3cf=this.getToolbarControl();
if(_3cf){
var _3d0=_3cf.getItem("keepThisVersion");
if(_3d0){
if(!_3cb&&!_3cc&&!_3cd){
_3d0.hide();
}else{
_3d0.show();
}
var _3d1=_3d0.getMenu();
if(_3cb||_3cc||_3cd){
if(_3d1){
var _3d2=_3d1.getItem("saveReport");
if(_3d2){
if(_3cb){
_3d2.show();
}else{
_3d2.hide();
}
}
var _3d3=_3d1.getItem("saveAsReportView");
if(_3d3){
if(_3cc){
_3d3.show();
}else{
_3d3.hide();
}
}
var _3d4=_3d1.getItem("emailReport");
if(_3d4){
if(_3cd){
_3d4.show();
}else{
_3d4.hide();
}
}
}
}
}
}
}
};
function CMainWnd_updateCurrentFormat(_3d5,_3d6){
var _3d7="";
var _3d8="";
switch(_3d5){
case "HTML":
case "HTMLFragment":
case "XHTMLFRGMT":
_3d7=_3d6+"/rv/images/action_view_html.gif";
_3d8=RV_RES.RV_VIEW_HTML;
break;
case "PDF":
_3d7=_3d6+"/rv/images/action_view_pdf.gif";
_3d8=RV_RES.RV_VIEW_PDF;
break;
case "XML":
_3d7=_3d6+"/rv/images/action_view_xml.gif";
_3d8=RV_RES.RV_VIEW_XML;
break;
}
if(_3d7!=""&&_3d8!=""){
var _3d9=this.getToolbarControl();
if(_3d9){
var _3da=this.getCV().envParams["ui.action"]=="view";
var _3db=null;
if(_3da){
_3db=_3d9.getItem("viewIn");
}else{
_3db=_3d9.getItem("runIn");
}
if(_3db){
_3db.setIcon(_3d7);
_3db.setToolTip(_3d8);
var sRV=this.getCVObjectRef()+".getRV().";
_3db.setAction("javascript:"+sRV+"viewReport('"+_3d5+"');");
}
}
}
this.setCurrentFormat(_3d5);
};
CMainWnd.prototype.getCurrentFormat=function(){
return this.m_currentFormat;
};
function CMainWnd_getSelectionController(){
var _3dd;
try{
_3dd=getCognosViewerSCObjectRef(this.getCV().getId());
}
catch(e){
_3dd=null;
}
return _3dd;
};
var g_oPressTimer=null;
var g_bLongPressDetected=false;
var g_oPreviousValues={};
if(window.attachEvent){
window.attachEvent("onmouseout",f_cancelLongTouch);
window.attachEvent("ontouchstart",onTouchStart);
window.attachEvent("ontouchend",f_cancelLongTouch);
window.attachEvent("ontouchleave",f_cancelLongTouch);
window.attachEvent("ontouchcancel",f_cancelLongTouch);
}else{
if(window.addEventListener){
window.addEventListener("mouseout",f_cancelLongTouch);
window.addEventListener("touchstart",onTouchStart);
window.addEventListener("touchend",f_cancelLongTouch);
window.addEventListener("touchleave",f_cancelLongTouch);
window.addEventListener("touchcancel",f_cancelLongTouch);
}
}
function f_cancelLongTouch(evt){
if(isIOS()){
if(g_oPressTimer!==null){
clearTimeout(g_oPressTimer);
g_oPressTimer=null;
}
}
};
function onTouchStart(evt){
if(isIOS()){
g_bLongPressDetected=false;
g_oPressTimer=setTimeout(function(){
var node=getNodeFromEvent(evt);
g_oPreviousValues.webkitTouchCallout=node.style.getPropertyValue("webkitTouchCallout");
g_oPreviousValues.webkitUserSelect=node.style.getPropertyValue("webkitUserSelect");
node.style.webkitTouchCallout="None";
node.style.webkitUserSelect="None";
g_bLongPressDetected=true;
},1500);
}
return false;
};
function CMainWnd_pageClicked(evt){
var oCV=this.getCV();
f_cancelLongTouch(evt);
if(this.m_showContextMenuOnClick||(isIOS()&&g_bLongPressDetected)){
var node=getNodeFromEvent(evt);
if(node&&typeof node.onclick!="function"&&(node.nodeName.toLowerCase()!="span"||typeof node.parentNode.onclick!="function")){
oCV.dcm(evt,true);
if(isIOS()&&g_bLongPressDetected){
node.style.webkitTouchCallout=g_oPreviousValues.webkitTouchCallout;
node.style.webkitUserSelect=g_oPreviousValues.webkitUserSelect;
}
return stopEventBubble(evt);
}
}
this.hideOpenMenus();
if(oCV!=null){
if(typeof oCV.sortColumn=="undefined"||!oCV.sortColumn(evt)){
var _3e4=oCV.getDrillMgr();
if(_3e4){
var _3e5=_3e4.singleClickDrillEvent(evt,"RV");
}
}
}
if(oCV.getViewerWidget()){
oCV.getViewerWidget().updateToolbar();
}
setNodeFocus(evt);
if(_3e5){
return stopEventBubble(evt);
}
};
function CMainWnd_hideOpenMenus(){
var cm=this.getContextMenu();
if(typeof cm!="undefined"&&cm!=null){
cm.hide();
}
var tb=this.getToolbar();
if(typeof tb!="undefined"&&tb!=null){
tb.closeMenus();
}
var _3e8=this.getBannerToolbar();
if(_3e8!="undefined"&&_3e8!=null){
_3e8.closeMenus();
}
};
function CMainWnd_draw(){
var _3e9=this.getToolbar();
if(_3e9&&this.m_uiBlackList.indexOf(" RV_TOOLBAR_BUTTONS ")){
var _3ea="";
var f=document.forms["formWarpRequest"+this.getCVId()];
if(f["run.outputFormat"]&&f["run.outputFormat"].value){
_3ea=f["run.outputFormat"].value;
}else{
if(f["ui.format"]&&f["ui.format"].value){
_3ea=f["ui.format"].value;
}
}
if(_3ea!=""){
this.updateCurrentFormat(_3ea,this.getCV().getWebContentRoot());
}
_3e9.draw();
}
var _3ec=this.getBannerToolbar();
if(_3ec){
_3ec.draw();
}
};
function CMainWnd_addToReportHistory(_3ed){
this.m_reportHistoryList[this.m_reportHistoryList.length]=_3ed;
};
function CMainWnd_getReportHistory(){
return this.m_reportHistoryList;
};
function CMainWnd_getContextMenu(){
return this.m_contextMenu;
};
function CMainWnd_displayContextMenu(evt,_3ef){
if(!this.getCV().bEnableContextMenu){
return false;
}
evt=(evt)?evt:((event)?event:null);
var _3f0=this.getSelectionController();
if(_3f0!=null){
var cm=this.getContextMenu();
if(_3ef&&this.getCV().bCanUseCognosViewerSelection==true){
if(!_3f0.pageContextClicked(evt)){
if(typeof cm!="undefined"&&cm!=null){
cm.m_contextMenu.remove();
}
return false;
}
}
cm=this.getContextMenu();
if(typeof cm!="undefined"&&cm!=null){
cm.draw(evt);
if(!isIE()){
cm.m_contextMenu.m_focusCell=getNodeFromEvent(evt);
}
}
var tb=this.getToolbar();
if(typeof tb!="undefined"&&tb!=null){
tb.closeMenus();
}
var _3f3=this.getBannerToolbar();
if(_3f3!="undefined"&&_3f3!=null){
_3f3.closeMenus();
}
}
};
function CMainWnd_getReportHistoryLength(){
return this.m_reportHistoryList.length;
};
function CMainWnd_executePreviousReport(_3f4){
if(_3f4==-1){
_3f4=this.getReportHistoryLength()-1;
}
for(var i=0;i<this.getReportHistoryLength();++i){
var _3f6=this.m_reportHistoryList[i];
if(_3f6.getIdx()==_3f4){
_3f6.execute();
return;
}
}
};
function CMainWnd_getReportHistoryConversations(){
var _3f7=[];
var _3f8=this.getReportHistory();
for(var _3f9=0;_3f9<_3f8.length;++_3f9){
var _3fa=_3f8[_3f9];
var _3fb=_3fa.getTrackingInfo();
if(_3fb!=""){
_3f7.push(_3fb);
}
}
return _3f7;
};
function CMainWnd_getUIHide(){
return this.m_uiBlackList;
};
CMainWnd.prototype.loadPreviousReports=function(){
var _3fc=this.getCV().envParams["cv.previousReports"];
if(typeof _3fc!="undefined"&&_3fc!=null){
var _3fd=XMLBuilderLoadXMLFromString(_3fc);
var _3fe=XMLHelper_GetFirstChildElement(_3fd);
if(XMLHelper_GetLocalName(_3fe)=="previousReports"){
var _3ff=_3fe.childNodes;
for(var _400=0;_400<_3ff.length;++_400){
var _401=_3ff[_400];
var _402=_401.childNodes;
var _403="";
var _404={};
for(var _405=0;_405<_402.length;++_405){
var _406=_402[_405].getAttribute("name");
switch(_406){
case "ui.name":
_403=XMLHelper_GetText(_402[_405]);
break;
default:
_404[_406]=XMLHelper_GetText(_402[_405]);
break;
}
}
this.addToReportHistory(new CReportHistory(this,_400,_403,_404));
}
}
}
};
CMainWnd.prototype.init=function(){
this.m_uiBlackList="";
if(typeof this.getCV().UIBlacklist=="string"){
this.m_uiBlackList=this.getCV().UIBlacklist;
}
if((typeof gCognosViewer!="undefined")&&(gCognosViewer.envParams["isTitan"])&&(gCognosViewer.envParams["isTitan"]==true)){
gMenuItemStyle=new CUIStyle("titanui menuItem_normal","titanui menuItem_hover","","","titanui menuItem_disabled");
}
this.m_contextMenu=null;
if(this.getCV().bEnableContextMenu&&typeof CContextMenu!="undefined"&&this.m_uiBlackList.indexOf(" RV_CONTEXT_MENU ")==-1){
this.m_contextMenu=new CContextMenu(this);
}
this.loadPreviousReports();
gMenuSeperator.setWebContentRoot(this.getCV().getWebContentRoot());
gToolbarSeperator.setWebContentRoot(this.getCV().getWebContentRoot());
};
CMainWnd.prototype.renderPreviousReports=function(){
var _407=this.getToolbarControl();
var _408=_407.getItem("previousReport");
var _409=this.getCV().getWebContentRoot();
var _40a=this.getCV().getSkin();
if(_408){
var _40b=_408.getMenu();
var _40c=this.getReportHistory();
for(var _40d=0;_40d<_40c.length;++_40d){
var _40e=_40c[_40d];
new CMenuItem(_40b,_40e.getReportName(),"javascript:"+this.getCV().getObjectId()+".rvMainWnd.executePreviousReport("+_40d+");",_409+_40e.getDropDownMenuIcon(),gMenuItemStyle,_409,_40a);
}
_40b.draw();
}
};
function CMainWnd_update(_40f){
if(typeof _40f=="undefined"||_40f===null){
return;
}
if(_40f instanceof CSelectionController){
var _410=this.getToolbarControl();
if(typeof _410!="undefined"&&_410!=null){
var _411=this.getCV().getDrillMgr();
if(_411){
var _412=_410.getItem("goto");
if(_412){
var menu=_412.getMenu();
if(menu){
menu.clear();
}
}
var _414=_410.getItem("drillDown");
if(_414){
if(_411.canDrillDown()){
_414.enable();
}else{
_414.disable();
}
}
var _415=_410.getItem("drillUp");
if(_415){
if(_411.canDrillUp()){
_415.enable();
}else{
_415.disable();
}
}
}
var _416=_410.getItem("lineage");
if(_416){
var _417=_40f.getAllSelectedObjects();
if(_417!=null&&_417.length>0){
_416.enable();
}else{
_416.disable();
}
}
}
var _418=this.getContextMenu();
if(typeof _418!="undefined"&&_418!=null){
_418.update(_40f);
}
}
};
function CMainWnd_addDrillTargets(_419){
this.m_oCV.addDrillTargets(_419);
};
function CMainWnd_getDrillTargets(){
return this.m_oCV.getDrillTargets();
};
function CMainWnd_getDrillTarget(idx){
return this.m_oCV.getDrillTarget(idx);
};
function CMainWnd_getNumberOfDrillTargets(){
return this.m_oCV.getNumberOfDrillTargets();
};
CMainWnd.prototype.renderAvailableOutputs=function(){
var _41b=this.getCVObjectRef()+".getRV().";
var oCV=this.getCV();
var _41d=this.getToolbarControl();
var _41e=this.getUIHide();
var _41f=oCV.getWebContentRoot();
var _420=oCV.getSkin();
var _421=null;
var _422=null;
if(typeof _41d!="undefined"&&_41d!=null){
_421=_41d.getItem("viewIn");
if(_421){
_422=_421.getMenu();
}
}
if(_422.getNumItems()==0){
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_HTML ")==-1){
this.m_viewInHtmlButton=new CMenuItem(_422,RV_RES.RV_VIEW_HTML,"javascript:"+_41b+"viewReport('HTML');",_41f+"/rv/images/action_view_html.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.HTML==""){
this.m_viewInHtmlButton.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_PDF ")==-1){
this.m_viewInPDFButton=new CMenuItem(_422,RV_RES.RV_VIEW_PDF,"javascript:"+_41b+"viewReport('PDF');",_41f+"/rv/images/action_view_pdf.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.PDF==""){
this.m_viewInPDFButton.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XML ")==-1){
this.m_viewInXMLButton=new CMenuItem(_422,RV_RES.RV_VIEW_XML,"javascript:"+_41b+"viewReport('XML');",_41f+"/rv/images/action_view_xml.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.XML==""){
this.m_viewInXMLButton.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS ")==-1){
this.m_viewInXLSButton=new CMenuItem(_422,RV_RES.RV_VIEW_OPTIONS,"",_41f+"/rv/images/action_view_excel_options.gif",gMenuItemStyle,_41f,_420);
this.excelFormatCascadedMenu=this.m_viewInXLSButton.createCascadedMenu(gMenuStyle,RV_RES.RV_VIEW_OPTIONS);
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS_SPREADSHEETML_DATA ")==-1){
this.viewInSpreadsheetMLDataMenuItem=new CMenuItem(this.excelFormatCascadedMenu,RV_RES.RV_VIEW_SPREADSHEETML_DATA,"javascript:"+_41b+"viewReport('xlsxData');",_41f+"/rv/images/action_view_excel_2007.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.xlsxData==""){
this.viewInSpreadsheetMLDataMenuItem.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS_SPREADSHEETML ")==-1){
this.viewInSpreadsheetMLMenuItem=new CMenuItem(this.excelFormatCascadedMenu,RV_RES.RV_VIEW_SPREADSHEETML,"javascript:"+_41b+"viewReport('spreadsheetML');",_41f+"/rv/images/action_view_excel_2007.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.spreadsheetML==""){
this.viewInSpreadsheetMLMenuItem.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS_XLWA ")==-1){
this.viewInXLSWebArchiveMenuItem=new CMenuItem(this.excelFormatCascadedMenu,RV_RES.RV_VIEW_XLWA,"javascript:"+_41b+"viewReport('XLWA');",_41f+"/rv/images/action_view_excel_2002.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.XLWA==""){
this.viewInXLSWebArchiveMenuItem.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS_SINGLEXLS ")==-1){
this.viewInSingleXLSMenuItem=new CMenuItem(this.excelFormatCascadedMenu,RV_RES.RV_VIEW_SINGLE_EXCEL,"javascript:"+_41b+"viewReport('singleXLS');",_41f+"/rv/images/action_view_excel_options.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.singleXLS==""){
this.viewInSingleXLSMenuItem.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS_XLS ")==-1){
this.viewInSingleXLSMenuItem=new CMenuItem(this.excelFormatCascadedMenu,RV_RES.RV_VIEW_EXCEL,"javascript:"+_41b+"viewReport('XLS');",_41f+"/rv/images/action_view_excel_2000.gif",gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.XLS==""){
this.viewInSingleXLSMenuItem.disable();
}
}
if(_41e.indexOf(" RV_TOOLBAR_BUTTONS_XLS_CSV ")==-1){
var _423="";
if(getViewerDirection()=="rtl"){
_423="/rv/images/action_view_csv_rtl.gif";
}else{
_423="/rv/images/action_view_csv.gif";
}
this.viewInCSVMenuItem=new CMenuItem(this.excelFormatCascadedMenu,RV_RES.RV_VIEW_CSV,"javascript:"+_41b+"viewReport('CSV');",_41f+_423,gMenuItemStyle,_41f,_420);
if(oCV.oOutputFormatPath.CSV==""){
this.viewInCSVMenuItem.disable();
}
}
}
}
_422.draw();
if(_422.isVisible()){
_422.show();
}
};
CMainWnd.prototype.saveReportHistoryAsXML=function(){
var _424="";
var _425=this.getReportHistory();
if(_425.length>0){
var _426=self.XMLBuilderCreateXMLDocument("previousReports");
var _427=0;
if(_425.length>20){
_427=_425.length-20;
}
for(var _428=_427;_428<_425.length;++_428){
_425[_428].saveAsXML(_426.documentElement);
}
_424=XMLBuilderSerializeNode(_426);
}
return _424;
};
CMainWnd.prototype.addCurrentReportToReportHistory=function(){
var oCV=this.getCV();
var _42a={};
var _42b=oCV.envParams["ui.name"];
var _42c=oCV.envParams["ui.action"];
if(_42c=="view"){
_42a["ui.action"]="view";
_42a["ui.format"]=oCV.envParams["ui.format"];
}else{
_42a["ui.action"]="currentPage";
_42a["ui.conversation"]=oCV.getConversation();
_42a["m_tracking"]=oCV.getTracking();
_42a["run.outputFormat"]=oCV.envParams["run.outputFormat"];
if(oCV.envParams["rapReportInfo"]){
_42a["rapReportInfo"]=oCV.envParams["rapReportInfo"];
}
if(oCV.envParams.limitedInteractiveMode){
_42a.limitedInteractiveMode=oCV.envParams.limitedInteractiveMode;
}
if(oCV.envParams["ui.spec"]){
_42a["ui.spec"]=oCV.envParams["ui.spec"];
}
if(oCV.envParams.uiSpecAddedFromRun){
_42a.uiSpecAddedFromRun=oCV.envParams.uiSpecAddedFromRun;
}
}
if(typeof oCV.envParams["ui.object"]!="undefined"){
_42a["ui.object"]=oCV.envParams["ui.object"];
}else{
_42a["ui.spec"]=oCV.envParams["ui.spec"];
_42a["ui.object"]="";
}
_42a["ui.primaryAction"]=oCV.envParams["ui.primaryAction"];
if(oCV.envParams["ui.routingServerGroup"]){
_42a["ui.routingServerGroup"]=oCV.envParams["ui.routingServerGroup"];
}
this.addToReportHistory(new CReportHistory(this,this.m_reportHistoryList.length,_42b,_42a));
};
CMainWnd.prototype.draw=CMainWnd_draw;
CMainWnd.prototype.addDrillTargets=CMainWnd_addDrillTargets;
CMainWnd.prototype.getDrillTarget=CMainWnd_getDrillTarget;
CMainWnd.prototype.getDrillTargets=CMainWnd_getDrillTargets;
CMainWnd.prototype.getNumberOfDrillTargets=CMainWnd_getNumberOfDrillTargets;
CMainWnd.prototype.addToReportHistory=CMainWnd_addToReportHistory;
CMainWnd.prototype.getReportHistoryLength=CMainWnd_getReportHistoryLength;
CMainWnd.prototype.getReportHistory=CMainWnd_getReportHistory;
CMainWnd.prototype.executePreviousReport=CMainWnd_executePreviousReport;
CMainWnd.prototype.getContextMenu=CMainWnd_getContextMenu;
CMainWnd.prototype.displayContextMenu=CMainWnd_displayContextMenu;
CMainWnd.prototype.hideOpenMenus=CMainWnd_hideOpenMenus;
CMainWnd.prototype.pageClicked=CMainWnd_pageClicked;
CMainWnd.prototype.getUIHide=CMainWnd_getUIHide;
CMainWnd.prototype.update=CMainWnd_update;
CMainWnd.prototype.getSelectionController=CMainWnd_getSelectionController;
CMainWnd.prototype.getReportHistoryConversations=CMainWnd_getReportHistoryConversations;
CMainWnd.prototype.updateCurrentFormat=CMainWnd_updateCurrentFormat;
function resizeIFrame(evt){
var oCV=window.gaRV_INSTANCES[0];
var _42f=document.getElementById("CVReport"+oCV.getId());
var _430=document.getElementById("CVIFrame"+oCV.getId());
if(typeof _42f!="undefined"&&_42f!=null&&typeof _430!="undefined"&&_430!=null){
oCV.attachedOnResize=true;
oCV.setMaxContentSize();
_430.style.height="99%";
}
};
function CognosViewerAction(){
this.m_oCV=null;
};
CognosViewerAction.prototype.setRequestParms=function(_431){
};
CognosViewerAction.prototype.onMouseOver=function(evt){
return false;
};
CognosViewerAction.prototype.onMouseOut=function(evt){
return false;
};
CognosViewerAction.prototype.onMouseDown=function(evt){
return false;
};
CognosViewerAction.prototype.onClick=function(evt){
return false;
};
CognosViewerAction.prototype.onDoubleClick=function(evt){
return false;
};
CognosViewerAction.prototype.updateMenu=function(_437){
return _437;
};
CognosViewerAction.prototype.addAdditionalOptions=function(_438){
};
CognosViewerAction.prototype.genSelectionContextWithUniqueCTXIDs=function(){
return false;
};
CognosViewerAction.prototype.doUndo=function(){
if(typeof console!="undefined"){
console.log("Required method doUndo not implemented.");
}
};
CognosViewerAction.prototype.doRedo=function(){
if(typeof console!="undefined"){
console.log("Required method doRedo not implemented.");
}
};
CognosViewerAction.prototype.forceRunSpecRequest=function(){
return false;
};
CognosViewerAction.prototype.preProcess=function(){
};
CognosViewerAction.prototype.setCognosViewer=function(oCV){
this.m_oCV=oCV;
};
CognosViewerAction.prototype.getCognosViewer=function(){
return this.m_oCV;
};
CognosViewerAction.prototype.getUndoRedoQueue=function(){
if(this.getCognosViewer().getViewerWidget()){
return this.getCognosViewer().getViewerWidget().getUndoRedoQueue();
}
return null;
};
CognosViewerAction.prototype.getViewerWidget=function(){
return this.m_oCV.getViewerWidget();
};
CognosViewerAction.prototype.getObjectDisplayName=function(){
var _43a="";
if(this.m_oCV!=null){
if(typeof this.m_oCV.envParams["reportpart_id"]!="undefined"){
_43a=this.m_oCV.envParams["reportpart_id"];
}else{
if(typeof this.m_oCV.envParams["ui.name"]!="undefined"){
_43a=this.m_oCV.envParams["ui.name"];
}
}
}
return _43a;
};
CognosViewerAction.prototype.getContainerId=function(_43b){
var _43c="";
if(_43b&&_43b.getAllSelectedObjects){
var _43d=_43b.getAllSelectedObjects();
if(_43d){
var _43e=_43d[0];
if(_43e&&_43e.getLayoutElementId){
_43c=this.removeNamespace(_43e.getLayoutElementId());
}
}
}
return _43c;
};
CognosViewerAction.prototype.removeNamespace=function(_43f){
var _440=_43f;
try{
if(_43f!=""){
var _441=_43f.indexOf(this.m_oCV.getId());
if(_441!=-1){
_43f=_43f.replace(this.m_oCV.getId(),"");
}
}
return _43f;
}
catch(e){
return _440;
}
};
CognosViewerAction.prototype.doAddActionContext=function(){
return true;
};
CognosViewerAction.prototype.getSelectionContext=function(){
return getViewerSelectionContext(this.m_oCV.getSelectionController(),new CSelectionContext(this.m_oCV.envParams["ui.object"]),this.genSelectionContextWithUniqueCTXIDs());
};
CognosViewerAction.prototype.getNumberOfSelections=function(){
var _442=-1;
if(this.m_oCV!=null&&this.m_oCV.getSelectionController()!=null){
_442=this.m_oCV.getSelectionController().getSelections().length;
}
return _442;
};
CognosViewerAction.prototype.buildDynamicMenuItem=function(_443,_444){
_443.action={name:"LoadMenu",payload:{action:_444}};
_443.items=[{"name":"loading","label":RV_RES.GOTO_LOADING,iconClass:"loading"}];
return _443;
};
CognosViewerAction.prototype.createCognosViewerDispatcherEntry=function(_445){
var oReq=new ViewerDispatcherEntry(this.getCognosViewer());
oReq.addFormField("ui.action",_445);
this.preProcess();
if(this.doAddActionContext()===true){
var _447=this.addActionContext();
oReq.addFormField("cv.actionContext",_447);
if(window.gViewerLogger){
window.gViewerLogger.log("Action context",_447,"xml");
}
}
oReq.addFormField("ui.object",this.m_oCV.envParams["ui.object"]);
if(typeof this.m_oCV.envParams["ui.spec"]!="undefined"){
oReq.addFormField("ui.spec",this.m_oCV.envParams["ui.spec"]);
}
if(this.m_oCV.getModelPath()!==""){
oReq.addFormField("modelPath",this.m_oCV.getModelPath());
}
if(typeof this.m_oCV.envParams["packageBase"]!="undefined"){
oReq.addFormField("packageBase",this.m_oCV.envParams["packageBase"]);
}
if(typeof this.m_oCV.envParams["rap.state"]!="undefined"){
oReq.addFormField("rap.state",this.m_oCV.envParams["rap.state"]);
}
if(typeof this.m_oCV.envParams["rapReportInfo"]!="undefined"){
oReq.addFormField("rap.reportInfo",this.m_oCV.envParams["rapReportInfo"]);
}
this.addAdditionalOptions(oReq);
return oReq;
};
CognosViewerAction.prototype.fireModifiedReportEvent=function(){
try{
var _448=this.getCognosViewer().getViewerWidget();
if(_448){
var _449={"modified":true};
_448.fireEvent("com.ibm.bux.widget.modified",null,_449);
}
}
catch(e){
}
};
CognosViewerAction.prototype.showCustomCursor=function(evt,id,_44c){
var _44d=document.getElementById(id);
if(_44d==null){
_44d=document.createElement("span");
_44d.className="customCursor";
_44d.setAttribute("id",id);
document.body.appendChild(_44d);
}
var _44e="<img src=\""+this.getCognosViewer().getWebContentRoot()+_44c+"\"/>";
_44d.innerHTML=_44e;
_44d.style.position="absolute";
_44d.style.left=(evt.clientX+15)+"px";
_44d.style.top=(evt.clientY+15)+"px";
_44d.style.display="inline";
};
CognosViewerAction.prototype.hideCustomCursor=function(id){
var _450=document.getElementById(id);
if(_450!=null){
_450.style.display="none";
}
};
CognosViewerAction.prototype.selectionHasContext=function(){
var _451=this.getCognosViewer().getSelectionController().getAllSelectedObjects();
var _452=false;
if(_451!=null&&_451.length>0){
for(var i=0;i<_451.length;i++){
if(_451[i].hasContextInformation()){
_452=true;
break;
}
}
}
return _452;
};
CognosViewerAction.prototype.isInteractiveDataContainer=function(_454){
var _455=false;
if(typeof _454!="undefined"&&_454!=null){
var id=_454.toLowerCase();
_455=id=="crosstab"||id=="list"||this.getCognosViewer().getRAPReportInfo().isChart(id);
}
return _455;
};
CognosViewerAction.prototype.getSelectedContainerId=function(){
var _457=this.getCognosViewer();
var _458=_457.getSelectionController();
var _459=null;
if(_458!=null&&typeof _458!="undefined"){
_459=this.getContainerId(_458);
}
return _459;
};
CognosViewerAction.prototype.getSelectedReportInfo=function(){
var _45a=this.getCognosViewer();
var _45b=this.getSelectedContainerId();
var _45c=this.getReportInfo(_45b);
if(_45c==null){
var _45d=_45a.getRAPReportInfo();
if(_45d.getContainerCount()==1){
_45c=_45d.getContainerFromPos(0);
}
}
return _45c;
};
CognosViewerAction.prototype.getReportInfo=function(_45e){
var _45f=null;
if(_45e!=null&&_45e.length>0){
var _460=this.getCognosViewer();
var _461=_460.getRAPReportInfo();
_45f=_461.getContainer(_45e);
}
return _45f;
};
CognosViewerAction.prototype.isSelectionOnChart=function(){
var _462=this.getCognosViewer();
if(_462.getSelectionController().hasSelectedChartNodes()){
return true;
}
var _463=this.getContainerId(_462.getSelectionController());
if(typeof _463!="undefined"){
var _464=this.getReportInfo(_463);
if(_464!=null&&_464.displayTypeId){
var _465=_464.displayTypeId.toLowerCase();
return _462.getRAPReportInfo().isChart(_465);
}
}
return false;
};
CognosViewerAction.prototype.ifContainsInteractiveDataContainer=function(){
var _466=this.getCognosViewer().getRAPReportInfo();
if(_466){
return _466.containsInteractiveDataContainer();
}
return false;
};
CognosViewerAction.prototype.isPromptWidget=function(){
var oCV=this.getCognosViewer();
if(oCV.getRAPReportInfo()&&oCV.getRAPReportInfo().isPromptPart()){
return true;
}
return false;
};
CognosViewerAction.prototype.getLayoutComponents=function(){
var _468=[];
var _469=document.getElementById("rt"+this.m_oCV.getId());
if(_469!=null){
_468=getElementsByAttribute(_469,"*","lid");
}
return _468;
};
CognosViewerAction.prototype.addClientContextData=function(_46a){
var _46b=this.m_oCV.getSelectionController();
if(typeof _46b!="undefined"&&_46b!=null&&typeof _46b.getCCDManager!="undefined"&&_46b.getCCDManager()!=null){
var _46c=_46b.getCCDManager();
return ("<md>"+xml_encode(_46c.MetadataToJSON())+"</md>"+"<cd>"+xml_encode(_46c.ContextDataSubsetToJSON(_46a))+"</cd>");
}
return "";
};
CognosViewerAction.prototype.getDataItemInfoMap=function(){
var _46d=this.m_oCV.getSelectionController();
if(typeof _46d!="undefined"&&_46d!=null&&typeof _46d.getCCDManager!="undefined"&&_46d.getCCDManager()!=null){
var _46e=_46d.getCCDManager();
return ("<di>"+xml_encode(_46e.DataItemInfoToJSON())+"</di>");
}
return "";
};
CognosViewerAction.prototype.getRAPLayoutTag=function(_46f){
var _470=null;
if(typeof _46f=="object"&&_46f!=null){
_470=_46f.getAttribute("rap_layout_tag");
}
return _470;
};
CognosViewerAction.prototype.addMenuItemChecked=function(_471,_472,_473){
if(_471){
if(this.getCognosViewer().isHighContrast()){
_472["class"]="menuItemSelected";
}
_472.iconClass="menuItemChecked";
}else{
if(_473&&_473.length>0){
_472.iconClass=_473;
}
}
};
CognosViewerAction.prototype.gatherFilterInfoBeforeAction=function(_474){
var _475=this.getCognosViewer().getViewerWidget();
_475.filterRequiredAction=_474;
_475.clearRAPCache();
_475.fireEvent("com.ibm.bux.widget.action",null,{action:"canvas.filters"});
};
CognosViewerAction.prototype.addClientSideUndo=function(_476,_477){
var _478=GUtil.generateCallback(_476.doUndo,_477,_476);
var _479=GUtil.generateCallback(_476.doRedo,_477,_476);
this.getUndoRedoQueue().addClientSideUndo({"tooltip":_476.getUndoHint(),"undoCallback":_478,"redoCallback":_479});
this.getCognosViewer().getViewerWidget().updateToolbar();
};
CognosViewerAction.prototype.isValidMenuItem=function(){
var _47a=this.getCognosViewer();
var _47b=_47a.getViewerWidget();
if(this.isPromptWidget()){
return false;
}
return true;
};
CognosViewerAction.prototype.isPositiveInt=function(_47c){
if(typeof _47c==="undefined"||_47c===null){
return false;
}
var _47d=parseInt(_47c,10);
return _47c&&_47d===+_47c&&_47d>0&&_47c.indexOf(".")==-1;
};
CognosViewerAction.prototype.buildActionResponseObject=function(_47e,code,msg){
return {"status":_47e,"message":msg?msg:null,"code":code?code:null,getStatus:function(){
return this.status;
},getMessage:function(){
return this.message;
},getCode:function(){
return this.code;
}};
};
function LineageAction(){
};
LineageAction.prototype=new CognosViewerAction();
LineageAction.prototype.getCommonOptions=function(_481){
_481.addFormField("cv.responseFormat","asynchDetailMIMEAttachment");
_481.addFormField("bux",this.m_oCV.getViewerWidget()?"true":"false");
_481.addFormField("cv.id",this.m_oCV.envParams["cv.id"]);
};
LineageAction.prototype.getSelectionOptions=function(_482){
var _483=this.m_oCV.getSelectionController();
var _484=getSelectionContextIds(_483);
_482.addFormField("context.format","initializer");
_482.addFormField("context.type","reportService");
_482.addFormField("context.selection","metadata,"+_484.toString());
};
LineageAction.prototype.getPrimaryRequestOptions=function(_485){
_485.addFormField("specificationType","metadataServiceLineageSpecification");
_485.addFormField("ui.action","runLineageSpecification");
_485.addFormField("ui.object",this.m_oCV.envParams["ui.object"]);
};
LineageAction.prototype.getSecondaryRequestOptions=function(_486){
_486.addFormField("ui.conversation",this.m_oCV.getConversation());
_486.addFormField("m_tracking",this.m_oCV.getTracking());
_486.addFormField("ui.action","lineage");
};
LineageAction.prototype.updateMenu=function(_487){
if(!this.getCognosViewer().bCanUseLineage){
return "";
}
_487.disabled=!this.selectionHasContext();
return _487;
};
LineageAction.prototype.execute=function(){
var oCV=this.getCognosViewer();
var _489=new AsynchDataDispatcherEntry(oCV);
this.getCommonOptions(_489);
this.getSelectionOptions(_489);
if(oCV.getConversation()==""){
this.getPrimaryRequestOptions(_489);
}else{
this.getSecondaryRequestOptions(_489);
}
_489.setCallbacks({"complete":{"object":this,"method":this.handleLineageResponse}});
if(!oCV.m_viewerFragment){
_489.setRequestIndicator(oCV.getRequestIndicator());
var _48a=new WorkingDialog(oCV);
_48a.setSimpleWorkingDialogFlag(true);
_489.setWorkingDialog(_48a);
}
oCV.dispatchRequest(_489);
};
LineageAction.prototype.handleLineageResponse=function(_48b){
var oCV=this.getCognosViewer();
oCV.loadExtra();
oCV.setStatus(_48b.getAsynchStatus());
oCV.setConversation(_48b.getConversation());
oCV.setTracking(_48b.getTracking());
var _48d=null;
if(typeof MDSRV_CognosConfiguration!="undefined"){
_48d=new MDSRV_CognosConfiguration();
var _48e="";
if(this.m_oCV.envParams["metadataInformationURI"]){
_48e=this.m_oCV.envParams["metadataInformationURI"];
}
_48d.addProperty("lineageURI",_48e);
_48d.addProperty("gatewayURI",this.m_oCV.getGateway());
}
var _48f=this.m_oCV.envParams["ui.object"];
var _490=getViewerSelectionContext(this.m_oCV.getSelectionController(),new CSelectionContext(_48f));
var _491=new MDSRV_LineageFragmentContext(_48d,_490);
_491.setExecutionParameters(this.m_oCV.getExecutionParameters());
if(typeof _48f=="string"){
_491.setReportPath(_48f);
}
_491.setReportLineage(_48b.getResult());
_491.open();
};
function CSelectionDefaultStyles(_492){
this.m_primarySelectionColor=null;
this.m_highContrastBorderStyle="solid";
this.m_secondarySelectionIsDisabled=false;
if(_492){
this.m_selectionController=_492;
this.m_oCognosViewer=_492.m_oCognosViewer;
if(this.m_oCognosViewer){
var _493=this.m_oCognosViewer.getUIConfig();
if(_493){
if(_493.getPrimarySelectionColor()){
this.m_primarySelectionColor=_493.getPrimarySelectionColor();
}
if(!_493.getShowSecondarySelection()){
this.m_secondarySelectionIsDisabledConfig=true;
}else{
if(_493.getSeondarySelectionColor()){
this.m_secondarySelectionColor=_493.getSeondarySelectionColor();
}
}
}
}
}
};
CSelectionDefaultStyles.prototype.getPrimarySelectionColor=function(_494){
return this.m_primarySelectionColor;
};
CSelectionDefaultStyles.prototype.getSecondarySelectionColor=function(){
return this.m_secondarySelectionColor;
};
CSelectionDefaultStyles.prototype.getHighContrastBorderStyle=function(){
return this.m_highContrastBorderStyle;
};
CSelectionDefaultStyles.prototype.canApplyToSelection=function(_495){
return true;
};
CSelectionDefaultStyles.prototype.secondarySelectionIsDisabled=function(){
return this.m_secondarySelectionIsDisabled;
};
CSelectionDefaultStyles.prototype.setStyleForSelection=function(){
};
function CSelectionFilterStyles(_496){
this.m_selectionController=_496;
this.m_primarySelectionColor=this.m_primarySelectionFilterColor="#44BFDD";
this.m_primarySelectionFilterColorForMeasure=null;
this.m_secondarySelectionColor=null;
this.m_highContrastBorderStyle="dotted";
this.m_secondarySelectionIsDisabled=true;
};
CSelectionFilterStyles.prototype=new CSelectionDefaultStyles();
CSelectionFilterStyles.prototype.getPrimarySelectionColor=function(_497){
return this.m_primarySelectionColor;
};
CSelectionFilterStyles.prototype.getSecondarySelectionColor=function(){
return this.m_secondarySelectionColor;
};
CSelectionFilterStyles.prototype.getHighContrastBorderStyle=function(){
return this.m_highContrastBorderStyle;
};
CSelectionFilterStyles.prototype.secondarySelectionIsDisabled=function(){
return this.m_secondarySelectionIsDisabled;
};
CSelectionFilterStyles.prototype.canApplyToSelection=function(_498){
return !this.selectionHasOnlyMeasure(_498);
};
CSelectionFilterStyles.prototype.selectionHasOnlyMeasure=function(_499){
return (_499.length===1&&_499[0].length===1&&this.m_selectionController.isMeasure(_499[0][0]));
};
CSelectionFilterStyles.prototype.setStyleForSelection=function(_49a){
this.m_primarySelectionColor=(this.selectionHasOnlyMeasure(_49a))?null:this.m_primarySelectionFilterColor;
};
function CSelectionFilterContextMenuStyles(_49b){
CSelectionDefaultStyles.call(this,_49b);
this.m_secondarySelectionIsDisabled=true;
};
CSelectionFilterContextMenuStyles.prototype=new CSelectionDefaultStyles();
function CSelectionObject(){
this.initialize();
};
CSelectionObject.prototype.initialize=function(){
this.m_oCellRef={};
this.m_sColumnRef="";
this.m_sColumnName="";
this.m_aDataItems=[];
this.m_aUseValues=[];
this.m_aDisplayValues=[];
this.m_sCellTypeId="";
this.m_sLayoutType="";
this.m_sTag="";
this.m_aMuns=[];
this.m_aRefQueries=[];
this.m_aMetadataItems=[];
this.m_aDrillOptions=[];
this.m_selectionController={};
this.m_contextIds=[];
this.m_ctxAttributeString="";
this.m_fetchedContextIds=false;
this.m_selectedClass=[];
this.m_cutClass=[];
this.m_dataContainerType="";
this.m_oJsonContext=null;
};
CSelectionObject.prototype.isSelectionOnVizChart=function(){
return false;
};
CSelectionObject.prototype.getCellRef=function(){
return this.m_oCellRef;
};
CSelectionObject.prototype.getColumnRP_Name=function(){
if(this.m_oCellRef!=null){
return this.m_oCellRef.getAttribute("rp_name");
}
};
CSelectionObject.prototype.getColumnRef=function(){
return this.m_sColumnRef;
};
CSelectionObject.prototype.getColumnName=function(){
if(this.m_sColumnName==""){
if(this.m_selectionController.hasContextData()&&this.m_contextIds.length){
this.m_sColumnName=this.m_selectionController.getRefDataItem(this.m_contextIds[0][0]);
}
}
return this.m_sColumnName;
};
CSelectionObject.prototype.getDataItemDisplayValue=function(_49c){
var _49d=this.getDataItems();
var item="";
if(_49d&&_49d[0]&&_49d[0][0]){
item=this.getDataItems()[0][0];
if(_49c&&_49c.itemInfo&&_49c.itemInfo.length){
var _49f=_49c.itemInfo;
for(var i=0;i<_49f.length;i++){
if(_49f[i].item===item&&_49f[i].itemLabel){
return _49f[i].itemLabel;
}
}
}
}
return item;
};
CSelectionObject.prototype.getDataItems=function(){
if(!this.m_aDataItems.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aDataItems[this.m_aDataItems.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4a3=this.m_contextIds[i][j];
this.m_aDataItems[this.m_aDataItems.length-1].push(this.m_selectionController.isContextId(_4a3)?this.m_selectionController.getRefDataItem(_4a3):"");
}
}
}
return this.m_aDataItems;
};
CSelectionObject.prototype.getUseValues=function(){
if(!this.m_aUseValues.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aUseValues[this.m_aUseValues.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4a6=this.m_contextIds[i][j];
this.m_aUseValues[this.m_aUseValues.length-1].push(this.m_selectionController.isContextId(_4a6)?this.m_selectionController.getUseValue(_4a6):"");
}
}
}
return this.m_aUseValues;
};
CSelectionObject.prototype.getCellTypeId=function(){
return this.m_sCellTypeId;
};
CSelectionObject.prototype.getDisplayValues=function(){
return this.m_aDisplayValues;
};
CSelectionObject.prototype.getLayoutType=function(){
return this.m_sLayoutType;
};
CSelectionObject.prototype.getTag=function(){
return this.m_sTag;
};
CSelectionObject.prototype.getMuns=function(){
if(!this.m_aMuns.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aMuns[this.m_aMuns.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4a9=this.m_contextIds[i][j];
this.m_aMuns[this.m_aMuns.length-1].push(this.m_selectionController.isContextId(_4a9)?this.m_selectionController.getMun(_4a9):"");
}
}
}
return this.m_aMuns;
};
CSelectionObject.prototype.getRefQueries=function(){
if(!this.m_aRefQueries.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aRefQueries[this.m_aRefQueries.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4ac=this.m_contextIds[i][j];
this.m_aRefQueries[this.m_aRefQueries.length-1].push(this.m_selectionController.isContextId(_4ac)?this.m_selectionController.getRefQuery(_4ac):"");
}
}
}
return this.m_aRefQueries;
};
CSelectionObject.prototype.getDimensionalItems=function(_4ad){
var _4ae=[];
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
_4ae[_4ae.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4b1=this.m_contextIds[i][j];
var _4b2="";
if(this.m_selectionController.isContextId(_4b1)){
switch(_4ad){
case "hun":
_4b2=this.m_selectionController.getHun(_4b1);
break;
case "lun":
_4b2=this.m_selectionController.getLun(_4b1);
break;
case "dun":
_4b2=this.m_selectionController.getDun(_4b1);
break;
}
}
_4ae[_4ae.length-1].push(_4b2);
}
}
return _4ae;
};
CSelectionObject.prototype.getMetadataItems=function(){
if(!this.m_aMetadataItems.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aMetadataItems[this.m_aMetadataItems.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4b5=this.m_contextIds[i][j];
var _4b6="";
if(this.m_selectionController.isContextId(_4b5)){
var sLun=this.m_selectionController.getLun(_4b5);
var sHun=this.m_selectionController.getHun(_4b5);
if(sLun&&sLun!=""){
_4b6=sLun;
}else{
if(sHun&&sHun!=""){
_4b6=sHun;
}else{
_4b6=this.m_selectionController.getQueryModelId(_4b5);
}
}
}
this.m_aMetadataItems[this.m_aMetadataItems.length-1].push(_4b6);
}
}
}
return this.m_aMetadataItems;
};
CSelectionObject.prototype.getDrillOptions=function(){
if(!this.m_aDrillOptions.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aDrillOptions[this.m_aDrillOptions.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _4bb=this.m_contextIds[i][j];
this.m_aDrillOptions[this.m_aDrillOptions.length-1].push(this.m_selectionController.isContextId(_4bb)?this.m_selectionController.getDrillFlag(_4bb):0);
}
}
}
return this.m_aDrillOptions;
};
CSelectionObject.prototype.getSelectedContextIds=function(){
return this.m_contextIds;
};
CSelectionObject.prototype.fetchContextIds=function(){
if(!this.m_fetchedContextIds&&this.m_contextIds.length&&this.m_selectionController.hasContextData()){
var _4bc=[];
for(var i=0;i<this.m_contextIds.length;i++){
for(var j=0;j<this.m_contextIds[i].length;j++){
_4bc.push(this.m_contextIds[i][j]);
}
}
this.m_selectionController.fetchContextData(_4bc);
this.m_fetchedContextIds=true;
}
};
CSelectionObject.prototype.setSelectionController=function(sc){
if(sc){
this.m_selectionController=sc;
}
};
CSelectionObject.prototype.getLayoutElementId=function(){
return this.m_layoutElementId;
};
CSelectionObject.prototype.hasContextInformation=function(){
for(var i=0;i<this.m_contextIds.length;i++){
for(var j=0;j<this.m_contextIds[i].length;j++){
if(this.m_contextIds[i][j].length>0){
return true;
}
}
}
return false;
};
CSelectionObject.prototype.isHomeCell=function(){
var _4c2=this.getCellRef().className;
if(_4c2&&(_4c2=="xm"||_4c2.indexOf("xm ")!=-1||_4c2.indexOf(" xm")!=-1)){
return true;
}
return false;
};
CSelectionObject.prototype.getDataContainerType=function(){
return this.m_dataContainerType;
};
CSelectionObject.prototype.getContextJsonObject=function(_4c3,_4c4){
if(this.m_oJsonContext===null){
var _4c5={};
var _4c6=[];
var _4c7=null;
this.getDataItems();
this.getUseValues();
if(this.m_contextIds.length==0){
return null;
}
var i=0,j=0;
var _4ca=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_4c3);
_4c7=_4ca;
this._populateJsonContextObj(_4ca,this.m_aUseValues[i][j],_4c3.getDisplayValue(this.m_contextIds[i][j]),_4c3.getMun(this.m_contextIds[i][j]),_4c5,_4c6);
j++;
for(;i<this.m_aDataItems.length;i++,j=0){
for(;j<this.m_aDataItems[i].length;j++){
_4ca=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_4c3);
if(!_4c7){
_4c7=_4ca;
}
this._populateJsonContextObj(_4ca,this.m_aUseValues[i][j],_4c3.getDisplayValue(this.m_contextIds[i][j]),_4c3.getMun(this.m_contextIds[i][j]),_4c5,_4c6);
}
}
this.m_oJsonContext=this._createGenericPayloadStructureJson(_4c7,_4c5,_4c6,_4c4);
}
return this.m_oJsonContext;
};
CSelectionObject.prototype._getBestPossibleItemName=function(_4cb,_4cc,_4cd){
var _4ce=null;
if(_4cd.isMeasure(_4cc)){
if(!_4cd.isValidColumnTitle(this.m_oCellRef)){
if(!_4cd.isRelational([_4cc])){
_4ce=_4cd.getCCDManager().GetBestPossibleDimensionMeasureName(_4cc);
}
return (_4ce)?_4ce:_4cb;
}
}
_4ce=_4cd.getCCDManager().GetBestPossibleItemName(_4cc);
return (_4ce)?_4ce:_4cb;
};
CSelectionObject.prototype._isTypeColumnTitle=function(){
if(this.m_oCellRef&&typeof this.m_oCellRef.getAttribute=="function"){
return (this.m_oCellRef.getAttribute("type")==="columnTitle");
}
return false;
};
CSelectionObject.prototype._populateJsonContextObj=function(_4cf,_4d0,_4d1,mun,_4d3,_4d4){
if(_4d3&&_4d4&&_4cf&&typeof _4d3[_4cf]=="undefined"){
var _4d5=_4d1?_4d1:_4d0;
_4d3[_4cf]=[_4d5];
var _4d6={};
if(_4d1){
_4d6["caption"]=_4d1;
}
if(mun){
_4d6["mun"]=mun;
}
if(_4d0){
_4d6["use"]=_4d0;
}
_4d4.push(_4d6);
}
};
CSelectionObject.prototype._createGenericPayloadStructureJson=function(_4d7,_4d8,_4d9,_4da){
if(_4d7&&_4d8&&_4d9){
var _4db=(_4da)?_4da:".";
var _4dc={};
_4dc[_4db]={"values":_4d9};
var obj={"com.ibm.widget.context":{"values":_4d8},"com.ibm.widget.context.report.select":{"select":{"selectedItem":_4d7,"itemSpecification":_4dc}}};
return obj;
}
return null;
};
CSelectionObject.prototype.populateSelectionPayload=function(_4de,_4df,_4e0){
this.getDataItems();
this.getUseValues();
if(this.m_contextIds.length==0){
return false;
}
_4e0=((_4e0===undefined)?false:_4e0);
var _4e1=this.m_selectionController;
for(var i=0,j=0;i<this.m_aDataItems.length;i++,j=0){
var _4e4=(_4e0?1:this.m_aDataItems[i].length);
for(;j<_4e4;j++){
if(!_4e1.isMeasure(this.m_contextIds[i][j])){
var _4e5=this.m_aDataItems[i][j];
this._populateItemInSelectionPayload(_4e5,this.m_aUseValues[i][j],_4e1.getDisplayValue(this.m_contextIds[i][j]),_4e1.getMun(this.m_contextIds[i][j]),_4de,_4df);
}
}
}
return true;
};
CSelectionObject.prototype._populateItemInSelectionPayload=function(_4e6,_4e7,_4e8,mun,_4ea,_4eb){
if(_4ea&&_4e6){
var _4ec=_4e7?_4e7:_4e8;
if(_4ea[_4e6]){
_4ea[_4e6].push(_4ec);
}else{
_4ea[_4e6]=[_4ec];
}
var _4ed={};
_4ed["caption"]=_4ec;
if(mun){
_4ed["mun"]=mun;
}
var _4ee=_4eb[_4e6];
if(!_4ee){
_4ee={"values":[]};
_4eb[_4e6]=_4ee;
}
_4ee.values.push(_4ed);
}
};
CSelectionObject.prototype.getCtxAttributeString=function(){
return this.m_ctxAttributeString;
};
CSelectionObject.prototype.isDataValueOrChartElement=function(){
return (this.m_sLayoutType==="datavalue"||this.m_sLayoutType==="chartElement");
};
CSelectionObject.prototype.marshal=function(_4ef,_4f0){
if(!this.m_oJsonForMarshal){
var _4f1={};
var _4f2=[];
var _4f3=null;
this.getDataItems();
this.getUseValues();
if(this.m_contextIds.length==0){
return null;
}
var i=0,j=0;
if(this.m_contextIds[i][j].length==0){
var _4f6=false;
do{
for(;j<this.m_contextIds[i].length;j++){
if(this.m_contextIds[i][j].length>0){
_4f6=true;
break;
}
}
if(!_4f6){
j=0;
i++;
}
}while(!_4f6);
}
var _4f7=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_4ef);
var _4f8=_4ef.isMeasure(this.m_contextIds[i][j]);
var _4f9=this._getBestPossibleItemReference(this.m_contextIds[i][j],_4f8,_4ef.getCCDManager());
var _4fa=_4ef.getCCDManager().GetQuery(this.m_contextIds[i][j]);
var _4fb=this.isDataValueOrChartElement();
var _4fc=this._populateJsonForMarshal(_4f7,_4f9,_4f8,this.m_aUseValues[i][j],_4ef.getDisplayValue(this.m_contextIds[i][j]),_4ef.getMun(this.m_contextIds[i][j]),_4fb);
j++;
var _4fd=[];
for(;i<this.m_aDataItems.length;i++,j=0){
for(;j<this.m_aDataItems[i].length;j++){
_4f7=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_4ef);
_4f8=_4ef.isMeasure(this.m_contextIds[i][j]);
_4f9=this._getBestPossibleItemReference(this.m_contextIds[i][j],_4f8,_4ef.getCCDManager());
var _4fe=this._populateJsonForMarshal(_4f7,_4f9,_4f8,this.m_aUseValues[i][j],_4ef.getDisplayValue(this.m_contextIds[i][j]),_4ef.getMun(this.m_contextIds[i][j]));
if(_4fe){
_4fd.push(_4fe);
}
}
}
var lid=(typeof this.getArea=="function")?getImmediateLayoutContainerId(this.getArea()):getImmediateLayoutContainerId(this.getCellRef());
if(lid&&lid.indexOf(_4f0)>0){
lid=lid.substring(0,lid.indexOf(_4f0)-1);
}
this.m_oJsonForMarshal={"lid":lid,"query":_4fa,"selectedItem":_4fc,"context":_4fd};
}
return this.m_oJsonForMarshal;
};
CSelectionObject.prototype._populateJsonForMarshal=function(_500,_501,_502,_503,_504,mun,_506){
if(_500){
var _507={};
_507["itemName"]=_500;
_507["isMeasure"]=_502?"true":"false";
_507["mdProperty"]=_501.mdProperty;
_507["mdValue"]=_501.mdValue;
_507["isDataValueOrChartElement"]=_506?"true":"false";
if(mun){
_507["mun"]=mun;
}
if(_503){
_507["use"]=_503;
}
return _507;
}
return null;
};
CSelectionObject.prototype._getBestPossibleItemReference=function(_508,_509,_50a){
var _50b=null;
var _50c=null;
if(_509){
_50c="i";
_50b=_50a.GetQMID(_508);
if(_50b==null){
_50c="m";
_50b=_50a.GetMUN(_508);
}
if(_50b==null){
_50c="r";
_50b=_50a.GetRDIValue(_508);
}
}else{
_50c="l";
_50b=_50a.GetLUN(_508);
if(_50b==null){
_50c="h";
_50b=_50a.GetHUN(_508);
}
if(_50b==null){
_50c="i";
_50b=_50a.GetQMID(_508);
}
if(_50b==null){
_50c="r";
_50b=_50a.GetRDIValue(_508);
}
}
return {"mdProperty":_50c,"mdValue":_50b};
};
CSelectionChartObject.prototype=new CSelectionObject();
CSelectionChartObject.prototype.constructor=CSelectionChartObject;
CSelectionChartObject.baseclass=CSelectionObject.prototype;
function CSelectionChartObject(){
CSelectionChartObject.baseclass.initialize.call(this);
this.m_chartArea=null;
this.m_context="";
this.m_chartCtxAreas=[];
this.m_selectedVizChart=false;
};
CSelectionChartObject.prototype.isSelectionOnVizChart=function(){
return this.m_selectedVizChart;
};
CSelectionChartObject.prototype.setSelectionOnVizChart=function(_50d){
var _50e=this.m_selectionController.getSelectedChartImageFromChartArea(_50d);
if(_50e){
this.m_selectedVizChart=_50e.parentNode.getAttribute("vizchart")=="true"?true:false;
}
};
CSelectionChartObject.prototype.getArea=function(){
return this.m_chartArea;
};
CSelectionChartObject.prototype.getContext=function(){
return this.m_context;
};
CSelectionChartObject.prototype.getCtxAreas=function(){
return this.m_chartCtxAreas;
};
CSelectionChartObject.prototype.setCtxAreas=function(_50f){
this.m_chartCtxAreas=_50f;
};
CSelectionChartObject.prototype.getCtxAttributeString=function(){
return this.m_context;
};
function CChartHelper(_510,_511,_512){
var _513=_510.parentNode;
this.m_selectionObjectFactory=_511;
this.m_map=_513;
_512.loadExtra();
this.imageMapHighlighter=new CImageMapHighlight(_513,_512.sWebContentRoot);
this.initialize();
};
CChartHelper.prototype.initialize=function(){
this.buildMapCtxAreas();
this.m_chartCtxNodes={};
};
CChartHelper.prototype.buildMapCtxAreas=function(){
var _514={};
var _515=this.m_map.childNodes;
var _516=_515.length;
var _517=null;
for(var i=0;i<_516;i++){
var a=_515[i];
_517=a.getAttribute("ctx");
if(_517){
if(_514[_517]){
_514[_517].push(a);
}else{
_514[_517]=[a];
}
}
}
this.m_ctxAreas=_514;
};
CChartHelper.prototype.getChartNode=function(_51a){
if(!this.isAreaInitialized(_51a)){
var _51b=_51a.parentNode;
this.m_map=_51b;
this.initialize();
this.imageMapHighlighter.initialize(_51b);
}
var _51c=_51a.getAttribute("ctx");
if(!this.m_chartCtxNodes[_51c]){
this.m_chartCtxNodes[_51c]=this.m_selectionObjectFactory.getSelectionChartObject(_51a);
this.m_chartCtxNodes[_51c].setCtxAreas(this.m_ctxAreas[_51c]);
}
return this.m_chartCtxNodes[_51c];
};
CChartHelper.prototype.isAreaInitialized=function(_51d){
return this.imageMapHighlighter.isAreaInitialized(_51d);
};
CChartHelper.prototype.getImageMapHighlighter=function(){
return this.imageMapHighlighter;
};
function CSelectionObjectFactory(_51e){
this.m_selectionController=_51e;
};
CSelectionObjectFactory.prototype.getSelectionController=function(){
return this.m_selectionController;
};
CSelectionObjectFactory.prototype.getChildSpans=function(_51f){
var _520=[];
for(var i=0;i<_51f.childNodes.length;i++){
var _522=_51f.childNodes[i];
if(!_522.getAttribute||_522.getAttribute("skipSelection")!="true"){
_520.push(_51f.childNodes[i]);
}
}
var _523=_51f;
var _524="";
while(!_524&&_523){
_524=_523.attributes?_523.attributes["LID"]:"";
_523=_523.parentNode;
}
_524=_524?_524.value:"";
var _525=[];
while(_520.length>0){
var _522=_520.pop();
var lid=_522.attributes?_522.attributes["LID"]:"";
lid=lid?lid.value:"";
if(!lid||lid==_524){
if(_522.nodeName.toLowerCase()=="span"){
_525.push(_522);
}else{
for(i=0;i<_522.childNodes.length;i++){
_520.push(_522.childNodes[i]);
}
}
}
}
return _525;
};
CSelectionObjectFactory.prototype.getSelectionObject=function(_527,_528){
var _529=new CSelectionObject();
try{
_529.setSelectionController(this.getSelectionController());
_529.m_oCellRef=_527;
_529.m_sColumnRef=_527.getAttribute("cid");
_529.m_sCellTypeId=_527.getAttribute("uid");
_529.m_sLayoutType=_527.getAttribute("type");
_529.m_sTag=_527.getAttribute("tag");
_529.m_layoutElementId=this.getLayoutElementId(_527);
_529.m_dataContainerType=this.getContainerType(_527);
if(typeof cf!="undefined"){
var _52a=cf.cfgGet("MiniQueryObj");
if(_52a){
var _52b=_52a.findChildWithAttribute("tag",_529.m_sTag);
if(_52b&&_52b.getAttribute("id")!=null){
_529.m_sColumnName=_52b.getAttribute("id");
}
}
}
var _52c=this.getChildSpans(_527);
if(_52c.length>0){
for(var i=0;i<_52c.length;i++){
var _52e=_52c[i];
if(_52e.nodeType==1&&_52e.nodeName.toLowerCase()=="span"&&_52e.style.visibility!="hidden"){
var _52f=null;
if(_527.getAttribute("ctx")!=null&&_527.getAttribute("ctx")!=""){
_52f=_527;
}else{
if(_52e.getAttribute("ctx")!=null&&_52e.getAttribute("ctx")!=""){
_52f=_52e;
}else{
if(_52e.getAttribute("dtTargets")&&_52e.childNodes&&_52e.childNodes.length){
for(var _530=0;_530<_52e.childNodes.length;_530++){
if(_52e.childNodes[_530].nodeType==1&&_52e.childNodes[_530].style.visibility!="hidden"){
_52f=_52e.childNodes[_530];
}
}
}else{
for(var _531=0;_531<_52e.childNodes.length;_531++){
var _532=_52e.childNodes[_531];
if(typeof _532.getAttribute!="undefined"&&_532.getAttribute("ctx")!=null&&_532.getAttribute("ctx")!=""){
_52f=_532;
break;
}
}
}
}
}
var _533="";
if(_52f&&_52f.getAttribute("ctx")){
_533=_52f.getAttribute("ctx");
}
_529.m_aDisplayValues[_529.m_aDisplayValues.length]=this.getSelectionController().getDisplayValue(_533,_527.parentNode);
if(typeof _528!="undefined"&&_528!=_533){
continue;
}
_529=this.processCTX(_529,_533);
}
}
}else{
if(_527.getAttribute("ctx")!=null&&_527.getAttribute("ctx")!=""&&_529.m_sLayoutType=="datavalue"){
_529=this.processCTX(_529,_527.getAttribute("ctx"));
}
}
this.getSelectionController().processColumnTitleNode(_529);
}
catch(ex){
}
return _529;
};
CSelectionObjectFactory.prototype.processCTX=function(_534,_535){
if(typeof _535!="string"||_535.length==0){
return _534;
}
var ctx;
if(typeof _534.m_contextIds=="object"&&_534.m_contextIds!==null&&_534.m_contextIds.length>0){
var _537=_535.split("::");
for(ctx=0;ctx<_534.m_contextIds.length;++ctx){
try{
if(_537[ctx]){
_534.m_contextIds[ctx]=_534.m_contextIds[ctx].concat(_537[ctx].split(":"));
}
}
catch(e){
}
}
}else{
_534.m_contextIds=this.m_selectionController.m_oCognosViewer.getReportContextHelper().processCtx(_535);
}
_534.m_ctxAttributeString=_535;
return _534;
};
CSelectionObjectFactory.prototype.getSecondarySelectionObject=function(tag,_539,_53a){
if(!_53a){
_53a=document;
}
var _53b=new CSelectionObject();
_53b.setSelectionController(this.getSelectionController());
_53b.m_oCellRef=null;
_53b.m_sColumnRef=null;
_53b.m_sCellTypeId=null;
_53b.refQuery="";
var _53c=_53a.getElementsByTagName("td");
for(var i=0;i<_53c.length;i++){
var _53e=_53c[i].getAttribute("tag");
if(_53e!=null&&_53e!=""){
if(tag==_53e){
var _53f=_53c[i].className;
if(_53f!=null&&_53e!=""){
if((_539=="columnTitle"&&_53f=="lt")||(_539=="datavalue"&&_53f=="lc")){
_53b.m_sColumnRef=_53c[i].getAttribute("cid");
_53b.m_sCellTypeId=_53c[i].getAttribute("uid");
break;
}
}
}
}
}
if(_53b.m_sCellTypeId==null){
return null;
}
return _53b;
};
CSelectionObjectFactory.prototype.getSelectionChartObject=function(_540){
var _541="";
if(_540.getAttribute("flashChart")!=null){
if(typeof _540.getCtx!="undefined"){
try{
_541=_540.getCtx();
}
catch(e){
_541="";
}
}
}else{
_541=_540.getAttribute("ctx");
}
var _542=new CSelectionChartObject();
_542.setSelectionController(this.getSelectionController());
if(_541!=null){
_542.m_contextIds=_541.split("::");
for(var ctx=0;ctx<_542.m_contextIds.length;++ctx){
_542.m_contextIds[ctx]=_542.m_contextIds[ctx].split(":");
}
}
_542.m_layoutElementId=this.getLayoutElementId(_540);
_542.m_sLayoutType=_540.getAttribute("type");
_542.m_chartArea=_540;
_542.m_context=_541;
_542.setSelectionOnVizChart(_540);
return _542;
};
CSelectionObjectFactory.prototype.getContainerTypeFromClass=function(_544){
var _545="";
switch(_544){
case "ls":
_545="list";
break;
case "xt":
_545="crosstab";
break;
case "rt":
_545="repeaterTable";
break;
}
return _545;
};
CSelectionObjectFactory.prototype.getContainerType=function(el){
var type="";
if(el){
if(el.className){
type=this.getContainerTypeFromClass(el.className);
}
if(!type){
var _548=el.parentNode;
if(_548){
type=this.getContainerType(_548);
}
}
}
return type;
};
CSelectionObjectFactory.prototype.getLayoutElementId=function(el){
var id="";
var _54b=this.getSelectionController().getNamespace();
if(el){
if(el.getAttribute&&el.getAttribute("chartcontainer")=="true"){
for(var _54c=0;_54c<el.childNodes.length;_54c++){
var _54d=el.childNodes[_54c];
if(_54d.nodeName.toLowerCase()=="img"&&_54d.getAttribute("lid")!=null){
return _54d.getAttribute("lid");
}
}
}
id=(el.getAttribute&&el.getAttribute("LID"))||"";
if(!id){
var _54e=el.parentNode;
if(_54e){
id=this.getLayoutElementId(_54e);
}
}else{
if(el.tagName.toUpperCase()=="MAP"){
id=id.replace(_54b,"");
id=_54b+id;
var _54f="#"+id;
var _550=getElementsByAttribute(el.parentNode,"IMG","usemap",_54f);
if(_550.length>0){
id=_550[0].getAttribute("LID");
}
}
}
}
return id;
};
function CSelectionController(_551,_552){
this.m_bSelectionBasedFeaturesEnabled=false;
this.m_bDrillUpDownEnabled=false;
this.m_bModelDrillThroughEnabled=false;
this.m_oCognosViewer=null;
this.m_bSavedSelections=false;
if(_552){
this.m_oCognosViewer=_552;
}
this.initialize(_551);
this.FILTER_SELECTION_STYLE=0;
this.FILTER_SELECTION_CONTEXT_MENU_STYLE=1;
};
CSelectionController.prototype.initialize=function(_553){
this.m_sNamespace=_553;
this.m_aCutColumns=[];
this.m_aSelectedObjects=[];
this.m_selectedClass=[];
this.m_cutClass=[];
this.m_oObserver=new CObserver(this);
this.m_bSelectionArraysSetup=false;
this.m_aSelectionHoverNodes=[];
this.m_bUsingCCDManager=false;
this.m_aReportMetadataArray=[];
this.m_aReportContextDataArray=[];
this.m_oCDManager=new CCDManager();
this.m_oSelectionObjectFactory=new CSelectionObjectFactory(this);
this.m_selectedChartArea=null;
this.m_selectedChartNodes=[];
this.m_selectionContainerMap=null;
this.m_chartHelpers={};
if(this.m_oCognosViewer!=null){
this.m_oCDManager.SetCognosViewer(this.m_oCognosViewer);
}
this.m_maxSecondarySelection=-1;
this.c_usageMeasure="2";
this.m_ccl_dateTypes={59:"dateTime",60:"interval"};
this.m_selectionStyles=new CSelectionDefaultStyles(this);
this.m_originalSelectionStyles=this.m_selectionStyles;
this.m_bAllowHorizontalDataValueSelection=false;
};
CSelectionController.prototype.secondarySelectionIsDisabled=function(){
return this.m_selectionStyles.secondarySelectionIsDisabled();
};
CSelectionController.prototype.getPrimarySelectionColor=function(){
return this.m_selectionStyles.getPrimarySelectionColor();
};
CSelectionController.prototype.getHighContrastBorderStyle=function(){
return this.m_selectionStyles.getHighContrastBorderStyle();
};
CSelectionController.prototype.getSecondarySelectionColor=function(){
return this.m_selectionStyles.getSecondarySelectionColor();
};
CSelectionController.prototype.resetSelectionStyles=function(){
this.setSelectionStyles();
};
CSelectionController.prototype.setSelectionStyles=function(_554){
switch(_554){
case this.FILTER_SELECTION_STYLE:
if(!this.m_selectionFilterStyles){
this.m_selectionFilterStyles=new CSelectionFilterStyles(this);
}
this.m_selectionStyles=this.m_selectionFilterStyles;
break;
case this.FILTER_SELECTION_CONTEXT_MENU_STYLE:
if(!this.m_selectionFilterContextMenuStyles){
this.m_selectionFilterContextMenuStyles=new CSelectionFilterContextMenuStyles(this);
}
this.m_selectionStyles=this.m_selectionFilterContextMenuStyles;
break;
default:
this.m_selectionStyles=this.m_originalSelectionStyles;
}
};
CSelectionController.prototype.resetAllowHorizontalDataValueSelection=function(){
this.m_bAllowHorizontalDataValueSelection=false;
};
CSelectionController.prototype.setAllowHorizontalDataValueSelection=function(_555){
this.m_bAllowHorizontalDataValueSelection=_555;
};
CSelectionController.prototype.allowHorizontalDataValueSelection=function(){
return this.m_bAllowHorizontalDataValueSelection;
};
CSelectionController.prototype.clearSelectionData=function(){
this.m_aSelectedObjects=[];
this.m_selectedChartNodes=[];
this.m_oSelectedDrillThroughImage=null;
this.m_oSelectedDrillThroughSingleton=null;
};
CSelectionController.prototype.getCCDManager=function(){
return this.m_oCDManager;
};
CSelectionController.prototype.getCtxIdFromDisplayValue=function(_556){
if(!this.m_bUsingCCDManager){
var _557=this.getReportContextDataArray();
var _558=1;
for(var _559 in _557){
var _55a=_557[_559];
if(_55a[_558]==_556){
return _559;
}
}
return "";
}else{
var sId=this.m_oCDManager.GetContextIdForDisplayValue(_556);
return (sId==null)?"":sId;
}
};
CSelectionController.prototype.getCtxIdFromMetaData=function(sLun,sHun,_55e){
return this.m_oCDManager.getContextIdForMetaData(sLun,sHun,_55e);
};
CSelectionController.prototype.replaceNamespaceForSharedTM1DimensionOnly=function(lun,hun,mun){
var sLun=lun;
var sHun=hun;
if(mun&&mun.indexOf("->:[TM].")>0){
sLun=this.m_oCDManager._replaceNamespaceForSharedTM1DimensionOnly(lun);
sHun=this.m_oCDManager._replaceNamespaceForSharedTM1DimensionOnly(hun);
}
return {"lun":sLun,"hun":sHun};
};
CSelectionController.prototype.getCtxIdFromMun=function(sMun){
if(!this.m_bUsingCCDManager){
var _565=this.getReportMetadataArray();
var _566=0;
for(var sKey in _565){
var _568=_565[sKey];
if(_568[_566]==sMun){
var _569=2;
var _56a=this.getReportContextDataArray();
for(var _56b in _56a){
var _56c=_56a[_56b];
if(_56c[_569]==sKey){
return _56b;
}
}
}
}
return "";
}else{
var sId=this.m_oCDManager.GetContextIdForMUN(sMun);
return (sId==null)?"":sId;
}
};
CSelectionController.prototype.canDrillDown=function(_56e){
var _56f=this.getDrillFlagForMember(_56e);
return (_56f==3||_56f==2);
};
CSelectionController.prototype.canDrillUp=function(_570){
var _571=this.getDrillFlagForMember(_570);
return (_571==3||_571==1);
};
CSelectionController.prototype.getQueryModelId=function(_572){
var qmid="";
if(!this.m_bUsingCCDManager){
var _574=this.m_aReportContextDataArray[_572];
if(_574&&typeof _574[3]!="undefined"){
var _575=_574[3];
var _576=this.m_aReportMetadataArray[_575];
if(typeof _576!="undefined"&&typeof _576[1]!="undefined"&&_576[1]=="I"){
qmid=_576[0];
}
}
}else{
qmid=this.m_oCDManager.GetQMID(_572);
}
return qmid;
};
CSelectionController.prototype.getRefQuery=function(_577){
if(!this.m_bUsingCCDManager){
return this.getMetaDataItemUseValue(4,_577);
}else{
var _578=this.m_oCDManager.GetQuery(_577);
return (_578==null)?"":_578;
}
};
CSelectionController.prototype.getRefDataItem=function(_579){
return this.m_oCognosViewer.getReportContextHelper().getRefDataItem(_579);
};
CSelectionController.prototype.getMun=function(_57a){
return this.m_oCognosViewer.getReportContextHelper().getMun(_57a);
};
CSelectionController.prototype.getHun=function(_57b){
if(!this.m_bUsingCCDManager){
var sHun=null;
var _57d=this.getRDI(_57b);
if(_57d&&_57d.length>4&&_57d[1]=="R"){
var _57e=_57d[4];
var _57f=this.getReportMetadataArray();
_57d=_57f[_57e];
}
if(_57d&&_57d.length>1&&_57d[1]=="H"){
sHun=_57d[0];
}
return sHun;
}else{
return this.m_oCDManager.GetHUN(_57b);
}
};
CSelectionController.prototype.fetchContextData=function(_580,_581){
var _582=0;
if(this.m_bUsingCCDManager){
_582=this.m_oCDManager.FetchContextData(_580,_581);
}
return _582;
};
CSelectionController.prototype.getMetaDataItem=function(sKey){
var _584=this.getReportMetadataArray();
if(typeof _584[sKey]!="undefined"){
return _584[sKey];
}
return null;
};
CSelectionController.prototype.getContextDataItem=function(_585){
var _586=this.getReportContextDataArray();
if(typeof _586[_585]!="undefined"){
return _586[_585];
}
return null;
};
CSelectionController.prototype.getMetaDataItemUseValue=function(_587,_588){
var _589=this.getContextDataItem(_588);
if(_589!=null){
var _58a=_589[_587];
if(_58a!=""){
var _58b=this.getMetaDataItem(_58a);
if(_58b!=null){
return _58b[0];
}
}
}
return "";
};
CSelectionController.prototype.getRDI=function(_58c){
var _58d=this.getContextDataItem(_58c);
if(_58d!=null){
var _58e=_58d[0];
if(_58e!=""){
var _58f=this.getMetaDataItem(_58e);
if(_58f!=null){
return _58f;
}
}
}
};
CSelectionController.prototype.getNamespace=function(){
return this.m_sNamespace;
};
CSelectionController.prototype.setSelectionBasedFeaturesEnabled=function(_590){
this.m_bSelectionBasedFeaturesEnabled=_590;
};
CSelectionController.prototype.getSelectionBasedFeaturesEnabled=function(){
return this.m_bSelectionBasedFeaturesEnabled;
};
CSelectionController.prototype.setDrillUpDownEnabled=function(_591){
this.m_bDrillUpDownEnabled=_591;
};
CSelectionController.prototype.getDrillUpDownEnabled=function(){
return this.m_bDrillUpDownEnabled;
};
CSelectionController.prototype.setModelDrillThroughEnabled=function(_592){
this.m_bModelDrillThroughEnabled=_592;
};
CSelectionController.prototype.getBookletItemForCurrentSelection=function(){
var _593=this.getAllSelectedObjects();
if(_593&&_593.length>0){
var _594=_593[0];
if(_594.hasContextInformation()){
var _595=this.m_oCDManager.GetBIValue(_594.m_contextIds[0][0]);
if(!_595){
return null;
}
return _595;
}
}
return null;
};
CSelectionController.prototype.getModelPathForCurrentSelection=function(){
var _596=null;
var _597=this.getBookletItemForCurrentSelection();
if(_597){
var _596=this.m_oCDManager.getModelPathFromBookletItem(_597);
}
return _596;
};
CSelectionController.prototype.getModelDrillThroughEnabled=function(){
var _598=this.getBookletItemForCurrentSelection();
if(_598){
var _599=this.m_oCDManager.GetBookletModelBasedDrillThru(_598);
return _599==1?true:false;
}else{
return this.m_bModelDrillThroughEnabled;
}
};
CSelectionController.prototype.clearSelectedObjects=function(_59a){
try{
if(!_59a){
_59a=document;
}
this.updateUI(_59a,this.getSelections(),true,false);
this.m_aSelectedObjects=[];
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.resetSelections=function(_59b){
try{
if(!_59b){
_59b=document;
}
if(this.hasSelectedChartNodes()){
this.resetChartSelections(_59b);
}
this.m_oSelectedDrillThroughImage=null;
this.m_oSelectedDrillThroughSingleton=null;
if(this.getSelections()){
this.updateUI(_59b,this.getSelections(),true,false);
this.updateUI(_59b,this.getCutColumns(),true,false);
this.m_aCutColumns=[];
this.m_aSelectedObjects=[];
this.m_selectedClass=[];
this.m_cutClass=[];
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.resetChartSelections=function(_59c){
var _59d=this.m_chartHelpers;
for(var _59e in _59d){
if(_59d[_59e]){
var _59f=_59d[_59e].getImageMapHighlighter();
if(_59f.hideAllAreas){
_59f.hideAllAreas();
}
}
}
this.m_selectedChartNodes=[];
this.m_selectionContainerMap=null;
};
CSelectionController.prototype.addSelectionObject=function(_5a0,_5a1){
try{
if(!_5a1){
_5a1=document;
}
var _5a2=_5a0.getCellRef();
if(this.isCellSelected(_5a2)!==true||(typeof _5a2!="object"||_5a2===null)){
if(this.isColumnCut(_5a0.getTag())!==true){
this.m_aSelectedObjects[this.m_aSelectedObjects.length]=_5a0;
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
this.updateUI(_5a1,this.getSelections(),false,false);
}
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.removeSelectionObject=function(_5a3,_5a4){
try{
if(!_5a4){
_5a4=document;
}
var _5a5=[];
var _5a6;
for(_5a6=0;_5a6<this.m_aSelectedObjects.length;_5a6++){
var _5a7=this.m_aSelectedObjects[_5a6].getCellRef();
var _5a8=_5a3.getCellRef();
if(typeof _5a7=="object"&&typeof _5a8=="object"&&_5a7!==null&&_5a8!==null){
if(_5a7==_5a8){
_5a5[_5a5.length]=_5a6;
}
}
}
if(_5a5.length>0){
this.updateUI(_5a4,this.getSelections(),true,false);
var _5a9=[];
for(_5a6=0;_5a6<this.m_aSelectedObjects.length;_5a6++){
var _5aa=true;
for(var j=0;j<_5a5.length;j++){
if(_5a6==_5a5[j]){
_5aa=false;
}
}
if(_5aa){
_5a9[_5a9.length]=this.m_aSelectedObjects[_5a6];
}
}
this.m_aSelectedObjects=_5a9;
this.updateUI(_5a4,this.getSelections(),false,false);
}
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.isSavedCellSelected=function(_5ac){
return this.isCellSelectedHelper(_5ac,this.getSavedSelectedObjects());
};
CSelectionController.prototype.isCellSelected=function(_5ad){
return this.isCellSelectedHelper(_5ad,this.getSelections());
};
CSelectionController.prototype.isCellSelectedHelper=function(_5ae,_5af){
try{
for(var i=0;i<_5af.length;i++){
var _5b1=_5af[i].getCellRef();
if(typeof _5b1=="object"&&_5b1!==null){
if(_5b1==_5ae){
return true;
}
}
}
}
catch(e){
}
return false;
};
CSelectionController.prototype.isColumnSelected=function(_5b2){
try{
for(var i=0;i<this.m_aSelectedObjects.length;i++){
if(this.m_aSelectedObjects[i].getTag()==_5b2){
return true;
}
}
}
catch(e){
}
return false;
};
CSelectionController.prototype.isColumnCut=function(_5b4){
try{
for(var i=0;i<this.m_aCutColumns.length;i++){
if(this.m_aCutColumns[i].getTag()==_5b4){
return true;
}
}
}
catch(e){
}
return false;
};
CSelectionController.prototype.getSelections=function(){
return this.m_aSelectedObjects;
};
CSelectionController.prototype.selectSingleDomNode=function(_5b6){
this.clearSelectedObjects();
var _5b7=this.getSelectionObjectFactory().getSelectionObject(_5b6);
var _5b8=null;
if(isIE()){
_5b8=_5b6.document;
}else{
_5b8=_5b6.ownerDocument;
}
this.addSelectionObject(_5b7,_5b8);
};
CSelectionController.prototype.hasCutColumns=function(){
if(this.m_aCutColumns.length===0){
return false;
}else{
return true;
}
};
CSelectionController.prototype.setCutColumns=function(_5b9,_5ba){
try{
if(!_5ba){
_5ba=document;
}
this.updateUI(_5ba,this.getSelections(),true,false);
this.updateUI(_5ba,this.getCutColumns(),true,1);
this.m_aCutColumns=[];
if(_5b9===true){
for(var i=0;i<this.m_aSelectedObjects.length;i++){
this.m_aCutColumns[i]=this.m_aSelectedObjects[i];
}
this.m_aSelectedObjects=[];
}
this.updateUI(_5ba,this.getCutColumns(),false,2);
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.getCutColumns=function(){
return this.m_aCutColumns;
};
CSelectionController.prototype.getObservers=function(){
return this.m_oObserver;
};
CSelectionController.prototype.attachObserver=function(_5bc){
this.m_oObserver.attach(_5bc);
};
CSelectionController.prototype.onSelectionChange=function(){
this.getObservers().notify();
};
CSelectionController.prototype.getSelectedColumns=function(_5bd){
var _5be=[];
if(typeof _5bd=="undefined"){
_5bd=this.getSelections();
}
var _5bf=_5bd.length;
for(var i=0;i<_5bf;i++){
var _5c1=_5bd[i];
var _5c2=true;
for(var j=0;j<_5be.length;j++){
if(_5be[j][0]==_5c1.getColumnRef()&&_5be[j][1]==_5c1.getCellTypeId()){
_5c2=false;
break;
}
}
if(_5c2){
_5be[_5be.length]=[_5c1.getColumnRef(),_5c1.getCellTypeId(),_5c1.getLayoutType(),_5c1.getTag(),_5c1.getColumnName()];
}
}
return _5be;
};
CSelectionController.prototype.getAllSelectedObjectsWithUniqueCTXIDs=function(){
var _5c4=[];
var _5c5=this.getAllSelectedObjects();
for(var i=0;i<_5c5.length;i++){
var _5c7=false;
var _5c8=_5c5[i];
for(var ii=0;ii<_5c4.length;ii++){
if(_5c8.m_contextIds[0][0]==_5c4[ii].m_contextIds[0][0]){
_5c7=true;
break;
}
}
if(!_5c7){
_5c4.push(_5c8);
}
}
return _5c4;
};
CSelectionController.prototype.getAllSelectedObjects=function(){
var _5ca=this.getSelections();
if(this.hasSelectedChartNodes()){
_5ca=_5ca.concat(this.getSelectedChartNodes());
}
return _5ca;
};
CSelectionController.prototype.getSelectedColumnIds=function(_5cb){
var _5cc=[];
if(typeof _5cb=="undefined"){
_5cb=this.getSelections();
}
var _5cd=this.getSelectedColumns(_5cb);
for(var _5ce=0;_5ce<_5cd.length;_5ce++){
var _5cf=true;
for(var _5d0=0;_5d0<_5cc.length;_5d0++){
if(_5cc[_5d0]==_5cd[_5ce][4]){
_5cf=false;
break;
}
}
if(_5cf){
_5cc[_5cc.length]=_5cd[_5ce][4];
}
}
return _5cc;
};
var STYLE_SELECTION={};
CSelectionController.prototype.selecting=function(c,_5d2){
var _5d3="."+c+_5d2;
var doc=document;
var _5d5=document.getElementById("CVIFrame"+this.m_sNamespace);
if(_5d5){
doc=_5d5.contentWindow.document;
}
var _5d6=doc.createElement("style");
_5d6.setAttribute("type","text/css");
if(_5d6.styleSheet){
_5d6.styleSheet.cssText=_5d3;
}else{
_5d6.appendChild(doc.createTextNode(_5d3));
}
doc.getElementsByTagName("head").item(0).appendChild(_5d6);
STYLE_SELECTION[c]=_5d6;
};
CSelectionController.prototype.deselecting=function(_5d7){
for(var i=0;i<_5d7.length;++i){
if(STYLE_SELECTION[_5d7[i]]){
var node=STYLE_SELECTION[_5d7[i]];
node.parentNode.removeChild(node);
STYLE_SELECTION[_5d7[i]]=null;
}
}
if(isIE()&&typeof this.m_oCognosViewer.m_viewerFragment!="undefined"){
var _5da=document.getElementById("CVReport"+this.m_oCognosViewer.getId());
if(_5da!=null){
var _5db=_5da.style.display;
_5da.style.display="none";
_5da.style.display=_5db;
}
}
};
CSelectionController.prototype.showViewerContextMenu=function(){
if(this.hasSelectedChartNodes()){
return true;
}
if(this.m_aSelectedObjects&&this.m_aSelectedObjects.length>0){
return true;
}
return false;
};
function getStyleFromClass(c){
for(var i=0;i<document.styleSheets.length;i++){
var ss=document.styleSheets[i];
var _5df=(ss.cssRules?ss.cssRules:ss.rules);
for(var j=0;j<_5df.length;j++){
var cr=_5df[j];
var _5e2=new RegExp("\\b"+c+"\\b","g");
if(cr.selectorText&&cr.selectorText.match(_5e2)){
return cr;
}
}
}
return 0;
};
CSelectionController.prototype.canUpdateSelection=function(_5e3){
return this.m_selectionStyles.canApplyToSelection(_5e3);
};
CSelectionController.prototype.setStyleForSelection=function(_5e4){
return this.m_selectionStyles.setStyleForSelection(_5e4);
};
CSelectionController.prototype.updateUI=function(_5e5,_5e6,_5e7,_5e8){
if(!_5e5){
_5e5=document;
}
try{
if(_5e6&&_5e6.length>0){
var _5e9,_5ea,_5eb;
if(_5e8==1||_5e8==2){
if(_5e7){
this.deselecting(this.m_cutClass);
}else{
var _5ec=getStyleFromClass("cutSelection").style.color;
var _5ed=getStyleFromClass("cutSelection").style.backgroundColor;
_5e9=_5e6.length;
for(_5ea=0;_5ea<_5e9;_5ea++){
_5eb=_5e6[_5ea].getCellRef();
var _5ee="cutQS"+_5eb.getAttribute("cid");
this.selecting(_5ee,"\n{ background-color: "+_5ed+"; color: "+_5ec+";}\n");
this.m_cutClass.push(_5ee);
}
}
}else{
if(this.m_oCognosViewer){
this.findSelectionURLs();
_5eb="";
_5e9=_5e6.length;
for(_5ea=0;_5ea<_5e9;_5ea++){
_5eb=_5e6[_5ea].getCellRef();
if(_5eb.getAttribute("oldClassName")!=null){
_5eb.className=_5eb.getAttribute("oldClassName");
_5eb.removeAttribute("oldClassName");
}
this.setStyleForSelection(_5e6[_5ea].m_contextIds);
if(!this.secondarySelectionIsDisabled()||_5e7){
var _5ef=document.getElementById("CVReport"+this.getNamespace());
var _5f0=getElementsByAttribute(_5ef,["td","th"],"name",_5eb.getAttribute("name"),this.m_maxSecondarySelection);
for(var _5f1=0;_5f1<_5f0.length;_5f1++){
var cell=_5f0[_5f1];
if(_5e7){
this.restoreOldBackgroundImage(cell);
}else{
if(cell.getAttribute("oldBackgroundImageStyle")==null){
this.saveOldCellStyles(cell);
this.setSecondarySelectionStyles(cell);
}
}
}
}
this.saveOldCellStyles(_5eb);
if(_5e7){
this.restoreOldBackgroundImage(_5eb);
if(this.m_oCognosViewer.isHighContrast()){
this.restoreOldBorder(_5eb);
this.restoreOldPadding(_5eb);
}
}else{
this.setPrimarySelectionStyles(_5eb);
if(this.m_oCognosViewer.isHighContrast()){
var size=getBoxInfo(_5eb,true);
this.saveOldBorder(_5eb);
this.saveOldPadding(_5eb,size);
var _5f4=3;
var _5f5=size.borderTopWidth+size.paddingTop-_5f4;
var _5f6=size.borderBottomWidth+size.paddingBottom-_5f4;
var _5f7=size.borderLeftWidth+size.paddingLeft-_5f4;
var _5f8=size.borderRightWidth+size.paddingRight-_5f4;
_5eb.style.border=_5f4+"px "+this.getHighContrastBorderStyle()+" black";
_5eb.style.padding=_5f5+"px "+_5f8+"px "+_5f6+"px "+_5f7+"px";
}
}
}
}
}
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.findSelectionURLs=function(){
if(!(this.sS_backgroundImageURL&&this.pS_backgroundImageURL)){
if(this.m_oCognosViewer.isBux||isSafari()||this.m_oCognosViewer.isMobile()){
this.pS_backgroundImageURL="url(../common/images/selection_primary.png)";
this.sS_backgroundImageURL="url(../common/images/selection_secondary.png)";
}else{
this.pS_backgroundImageURL=this.getBackgroundImage(getStyleFromClass("primarySelection"));
this.sS_backgroundImageURL=this.getBackgroundImage(getStyleFromClass("secondarySelection"));
}
}
};
CSelectionController.prototype.setSelectedChartImgArea=function(_5f9){
var _5fa=true;
var _5fb=_5f9.getAttribute("rsvpChart");
var _5fc=_5f9.parentNode.getAttribute("chartContainer");
if(_5fb!="true"&&_5fc!="true"){
this.m_selectedChartNodes=[];
_5fa=false;
}else{
var _5fd=this.getSelectionObjectFactory().getSelectionChartObject(_5f9);
this.m_selectedChartNodes=[_5fd];
}
return _5fa;
};
CSelectionController.prototype.setSelectedChartArea=function(_5fe,e){
var _600=typeof this.m_oCognosViewer.isBux!=="undefined";
var _601=false;
if(_5fe!==null){
if(_5fe.tagName=="IMG"){
_601=this.setSelectedChartImgArea(_5fe);
}else{
if(_5fe.nodeName=="AREA"&&_5fe.attributes["ctx"]){
_601=true;
if(_600){
this.setBuxSelectedChartArea(_5fe,e);
}else{
this.m_selectedChartNodes=[this.getSelectionObjectFactory().getSelectionChartObject(_5fe)];
}
}
}
if(_601){
this.getObservers().notify();
}
}
return _601;
};
CSelectionController.prototype.setBuxSelectedChartArea=function(_602,e){
var _604=this.getChartHelper(_602);
var _605=_604.getChartNode(_602);
this.setStyleForSelection(_605.m_contextIds);
var _606=_604.getImageMapHighlighter();
_606.setFillColour(this.getPrimarySelectionColor());
_606.setStrokeColour(this.getPrimarySelectionColor());
if(typeof e=="undefined"){
e={};
}
if(this.ctrlKeyPressed(e)||this.shiftKeyPressed(e)){
if(_606.isAreaHighlighted(_602)){
_606.hideAreas(_605.getCtxAreas());
var _607=_602.getAttribute("ctx");
var _608=this.m_selectedChartNodes.length;
for(var i=0;i<_608;i++){
var _60a=this.m_selectedChartNodes[i];
if(_607==_60a.getContext()){
this.m_selectedChartNodes.splice(i,1);
break;
}
}
}else{
this.updateSelectionContainer(_602);
_606.highlightAreas(_605.getCtxAreas(),true);
this.m_selectedChartNodes.push(_605);
}
}else{
if(this.hasSavedSelectedChartNodes()){
var _60b=this.m_savedSelectedChartNodes.length;
var _60c=this.m_savedSelectedChartNodes;
for(var i=0;i<_60b;i++){
var area=_60c[i].getArea();
var _60e=this.getSavedChartHelper(area);
var _60f=_60e.getImageMapHighlighter();
var _610=_60f.getAreaId(area);
if(_606.getAreaId(_602)===_610){
_60f.hideAreaById(_610+this.m_savedPrimarySelectionColor);
break;
}
}
}
this.updateSelectionContainer(_602);
_606.highlightAreas(_605.getCtxAreas());
this.m_selectedChartNodes=[_605];
}
};
CSelectionController.prototype.updateSelectionContainer=function(_611){
var _612=_611.parentNode;
if(this.m_selectionContainerMap&&this.m_selectionContainerMap.name!=_612.name){
var _613=this.getChartHelper(_611).getImageMapHighlighter();
_613.hideAllAreas();
}
this.m_selectionContainerMap=_612;
};
CSelectionController.prototype.getChartHelper=function(_614){
var _615=_614.parentNode;
var _616=_615.name;
if(!this.m_chartHelpers[_616]){
this.m_chartHelpers[_616]=new CChartHelper(_614,this.getSelectionObjectFactory(),this.m_oCognosViewer);
}
return this.m_chartHelpers[_616];
};
CSelectionController.prototype.getSavedChartHelper=function(_617){
var _618=_617.parentNode;
var _619=_618.name;
return this.m_savedChartHelpers[_619];
};
CSelectionController.prototype.getSelectedChartArea=function(){
return this.m_selectedChartArea;
};
CSelectionController.prototype.getSelectedChartNodes=function(){
return this.m_selectedChartNodes;
};
CSelectionController.prototype.hasSelectedChartNodes=function(){
return this.m_selectedChartNodes&&this.m_selectedChartNodes.length&&this.m_selectedChartNodes.length>0;
};
CSelectionController.prototype.getSelectedChartImage=function(){
var _61a=null;
if(this.hasSelectedChartNodes()){
var _61b=this.m_selectedChartNodes[0];
_61a=_61b.getArea();
}
if(_61a===null){
return null;
}
if(_61a.tagName=="IMG"){
return _61a;
}
return this.getSelectedChartImageFromChartArea(_61a);
};
CSelectionController.prototype.getSelectedChartImageFromChartArea=function(_61c){
var _61d=_61c.parentNode;
var _61e="#"+_61d.getAttribute("name");
return this.checkChildrenForChart(_61d.parentNode,_61e);
};
CSelectionController.prototype.checkChildrenForChart=function(_61f,_620){
var _621=_61f.firstChild;
while(_621!==null){
if(!_621.tagName){
return null;
}else{
if(_621.tagName=="IMG"&&_621.getAttribute("usemap")==_620){
return _621;
}else{
if(_621.tagName==="DIV"||_621.tagName==="SPAN"){
var _622=this.checkChildrenForChart(_621,_620);
if(_622){
return _622;
}
}
}
}
_621=_621.nextSibling;
}
return null;
};
CSelectionController.prototype.downloadSelectedChartImage=function(_623){
var _624=this.getSelectedChartImage();
if(_624!==null){
var _625=this.getDocumentFromImage(_624);
var _626=_624.name.replace(".","_");
var _627=_626.substr(5);
var _628="?m_name=";
_628+=_627;
_628+="&format=png&b_action=xts.run&m=portal/download.xts&m_obj=";
if(isIE()){
_626=_625.parentWindow.eval("graphicSrc"+_627);
}else{
_626=_625.defaultView.eval("graphicSrc"+_627);
}
var _629="";
if(typeof _626!="undefined"&&_626!==null){
var _62a=_626.split("&");
if(_62a.length===0){
return;
}
if(_626.indexOf("/repository/")<0){
for(var i=0;i<_62a.length;++i){
var _62c=_62a[i];
var _62d=_62c.indexOf("=");
if(_62d!=-1){
var _62e=_62c.substr(0,_62d);
var _62f=_62c.slice(_62d+1);
if(_62e=="search"){
_629+=_62f;
break;
}
}
}
}
if(_629==""){
_628=_624.getAttribute("src");
if(_628.indexOf("?")!=-1){
_628+="&download=true";
}else{
_628+="?download=true";
}
}
if(typeof getConfigFrame=="function"){
_628+=_629;
_628=getConfigFrame().constructGETRequestParamsString(_628);
window.open(_628,"_blank","width=0,height=0");
}else{
_628=constructGETRequestParamsString(_628);
_628+=_629;
var _630=this.m_oCognosViewer.getGateway();
var _631=document.getElementById("CVIFrame"+this.m_sNamespace);
if(_631){
var _632=_631.src;
if(_632.indexOf("repository")>=0&&_628.indexOf("repository")<0){
var _633=_632.indexOf("content");
_628=_632.substring(0,_633)+_628;
}
}
if(_628.indexOf(_630)==-1){
var _634=document.forms["formWarpRequest"+_623];
_628=_634.action+_628;
}
if(typeof window.detachLeavingRV=="function"){
window.detachLeavingRV();
}
location.href=_628;
if(typeof window.attachLeavingRV=="function"){
setTimeout(window.attachLeavingRV,100);
}
}
}
}
};
CSelectionController.prototype.getDocumentFromImage=function(_635){
var _636=null;
if(_635.ownerDocument){
_636=_635.ownerDocument;
}else{
_636=_635.document;
}
return _636;
};
CSelectionController.prototype.shouldExecutePageClickedOnMouseDown=function(e){
var _638=this.getSelections();
if(_638.length>1){
if(this.m_oCognosViewer.envParams["ui.action"]!=="view"){
var node=getNodeFromEvent(e);
try{
while(node&&(node.nodeType==3||(node.getAttribute&&node.getAttribute("uid")===null))){
node=node.parentNode;
}
}
catch(ex){
}
var _63a=this.getSelectionObjectFactory().getContainerType(node);
if(_63a==="list"){
for(var i=0;i<_638.length;i++){
if(_638[i].m_oCellRef==node){
return false;
}
}
}
}
}
return true;
};
CSelectionController.prototype.getContainerType=function(){
var _63c="";
if(this.hasSelectedChartNodes()){
_63c="chart";
}else{
if(this.getDataContainerType()==="list"){
_63c="list";
}else{
_63c="crosstab";
}
}
return _63c;
};
CSelectionController.prototype.getDisplayValues=function(){
var _63d={};
var _63e=this.getAllSelectedObjects()[0];
if(_63e){
var _63f=_63e.getSelectedContextIds();
if(_63f){
for(var axis=0;axis<_63f.length;axis++){
var _641=[];
var _642=_63f[axis];
for(var _643=0;_643<_642.length;_643++){
var _644=_642[_643];
var _645=this.getDisplayValue(_644);
_641.push(_645);
if(axis===0){
break;
}
}
var _646="";
switch(axis){
case 0:
_646="selected";
break;
case 1:
_646="rows";
break;
default:
_646="columns";
}
_63d[_646]=_641;
}
}
}
return _63d;
};
CSelectionController.prototype.getChartTooltip=function(){
var _647=this.getAllSelectedObjects()[0];
if(_647){
var area=_647.getArea();
if(area){
var _649=area.getAttribute("title");
if(_649&&_649.length>0){
return area.getAttribute("title");
}
}
}
return "";
};
CSelectionController.prototype.pageClickedForMobile=function(e){
this.pageClicked(e);
var _64b=this.getAllSelectedObjects().length;
if(_64b==0){
var node=getNodeFromEvent(e,true);
if(!node){
return false;
}
if(node.nodeName.toLowerCase()=="img"&&node.getAttribute("dttargets")){
this.selectDrillThroughImage(node);
return true;
}else{
if(node.getAttribute("dttargets")){
this.selectDrillThroughSingleton(node);
return true;
}else{
if(node.parentNode&&node.parentNode.getAttribute("dttargets")){
this.selectDrillThroughSingleton(node.parentNode);
return true;
}
}
}
return false;
}
return true;
};
CSelectionController.prototype.clearSavedSelections=function(){
this.m_bSavedSelections=false;
if(this.hasSavedSelectedObjects()){
this.updateUI(null,this.getSavedSelectedObjects(),true,false);
delete (this.m_aSavedSelectedObjects);
}
if(this.hasSavedSelectedChartNodes()){
var _64d=this.m_savedChartHelpers;
for(var _64e in _64d){
if(_64d[_64e]){
var _64f=_64d[_64e].getImageMapHighlighter();
if(_64f.hideAllAreas){
_64f.hideAllAreas();
}
}
}
delete this.m_savedChartHelpers;
delete this.m_savedSelectedChartNodes;
}
};
CSelectionController.prototype.hasSavedSelectedChartNodes=function(){
return (this.m_savedSelectedChartNodes&&this.m_savedSelectedChartNodes.length>0);
};
CSelectionController.prototype.getSavedSelectedChartNodes=function(){
return this.m_savedSelectedChartNodes;
};
CSelectionController.prototype.saveSelections=function(){
this.m_savedSelectionStyles=this.m_selectionStyles;
if(this.m_aSelectedObjects.length>0){
this.m_aSavedSelectedObjects=[];
var _650=this.m_aSelectedObjects.length;
var temp=[];
for(var i=0;i<_650;i++){
if(this.isMeasure(this.m_aSelectedObjects[i].m_contextIds[0][0])){
temp.push(this.m_aSelectedObjects[i]);
}else{
this.m_aSavedSelectedObjects.push(this.m_aSelectedObjects[i]);
}
}
this.m_aSelectedObjects=temp;
}
if(this.hasSelectedChartNodes()){
this.m_savedChartHelpers=this.m_chartHelpers;
this.m_chartHelpers={};
this.m_savedSelectedChartNodes=[];
var _653=this.m_selectedChartNodes.length;
var temp=[];
for(var i=0;i<_653;i++){
if(this.isMeasure(this.m_selectedChartNodes[i].m_contextIds[0][0])){
var _654=this.m_selectedChartNodes[i].getArea();
var _655=this.getImageMapName(_654);
this.m_chartHelpers[_655]=this.m_savedChartHelpers[_655];
delete this.m_savedChartHelpers[_655];
temp.push(this.m_selectedChartNodes[i]);
}else{
this.m_savedSelectedChartNodes.push(this.m_selectedChartNodes[i]);
}
}
this.m_selectedChartNodes=temp;
}
this.m_bSavedSelections=true;
};
CSelectionController.prototype.hasSavedSelections=function(){
return this.m_bSavedSelections;
};
CSelectionController.prototype.hasSavedSelectedObjects=function(){
return (this.m_aSavedSelectedObjects&&this.m_aSavedSelectedObjects.length>0)||this.hasSavedSelectedChartNodes();
};
CSelectionController.prototype.getSavedSelectedObjects=function(){
return this.m_aSavedSelectedObjects;
};
CSelectionController.prototype.getImageMapName=function(_656){
var _657=_656.parentNode;
return _657.name;
};
CSelectionController.prototype.repaintBUXSelectedChartArea=function(_658,_659,_65a){
var _65b={};
var _65c=_658.length;
for(var i=0;i<_65c;i++){
var _65e=_658[i].getArea();
var _65f=this.getImageMapName(_65e);
var _660;
if(!_65b[_65f]){
_660=(_659)?this.getSavedChartHelper(_65e):this.getChartHelper(_65e);
_65b[_65f]=_660;
var _661=_660.getImageMapHighlighter();
_661.hideAllAreas();
_661.setFillColour(this.getPrimarySelectionColor());
_661.setStrokeColour(this.getPrimarySelectionColor());
}else{
_660=_65b[_65f];
}
var _662=_658[i].m_contextIds;
if(_65a&&_662.length===1&&_662[0].length===1&&this.isMeasure(_662[0][0])){
continue;
}
_661.highlightAreas(_658[i].getCtxAreas(),1);
}
};
CSelectionController.prototype.repaintSavedSelections=function(){
var _663=this.m_selectionStyles;
this.m_selectionStyles=this.m_savedSelectionStyles;
var _664=this.getSavedSelectedChartNodes();
var _665=false;
if(_664&&_664.length>0){
bIsChart=true;
}else{
_664=this.getSavedSelectedObjects();
}
this.repaintSelectionsHelper(_664,true,_665);
this.resetSelectionStyles();
this.m_selectionStyles=_663;
};
CSelectionController.prototype.repaintSelections=function(){
var _666=this.getSelectedChartNodes();
var _667=false;
if(_666&&_666.length>0){
_667=true;
}else{
_666=this.getSelections();
}
this.repaintSelectionsHelper(_666,false,_667);
};
CSelectionController.prototype.repaintSelectionsHelper=function(_668,_669,_66a){
try{
if(_66a){
this.repaintBUXSelectedChartArea(_668,_669);
}else{
this.updateUI(document,_668,true,false);
this.updateUI(document,_668,false,false);
}
}
catch(e){
return false;
}
};
CSelectionController.prototype.resetAll=function(){
this.resetSelectionStyles();
this.clearSavedSelections();
this.resetSelections();
this.resetAllowHorizontalDataValueSelection();
};
CSelectionController.prototype.pageClicked=function(e){
try{
var node=getNodeFromEvent(e);
if(this.m_aSelectedObjects.length>0&&!this.shiftKeyPressed(e)&&!this.ctrlKeyPressed(e)){
var _66d=node;
if(!_66d.getAttribute("uid")){
var _66e=_66d.parentNode;
if(_66e&&_66e.nodeType==1&&typeof _66e.getAttribute!="undefined"&&_66e.getAttribute("uid")!=null){
_66d=_66e;
}
}
if(this.isCellSelected(_66d)){
if(typeof this.m_oCognosViewer.isBux!=="undefined"){
this.repaintSelections();
}
if(e.button!==0){
return false;
}
}
}
if(node.tagName&&node.tagName.toUpperCase()=="INPUT"){
return true;
}
if((e.keyCode!=null)&&(e.keyCode!=13)&&(e.keyCode!=32)&&(e.keyCode!=27)&&(e.keyCode!=0)&&(e.keyCode!=121)&&(e.keyCode!=93)){
return false;
}
var _66f=getDocumentFromEvent(e);
if(!this.hasContextData()||!this.hasMetadata()){
if(node.nodeName=="AREA"||node.nodeName=="IMG"||(typeof node.getAttribute=="function"&&node.getAttribute("flashChart")!=null)){
this.setSelectedChartArea(node,e);
}
this.getObservers().notify();
return false;
}
if(typeof node.selectedCell!="undefined"){
var _670=node;
node=node.selectedCell;
_670.removeAttribute("selectedCell");
}
if(typeof cf!="undefined"&&typeof cf.hidePickers=="function"){
cf.hidePickers();
}
if(e.keyCode==27){
if(typeof g_reportSelectionController!="undefined"){
g_reportSelectionController.clearSelections();
}
this.resetSelections(_66f);
}else{
if(node.nodeName=="AREA"||node.nodeName=="IMG"||(typeof node.getAttribute!="undefined"&&node.getAttribute("flashChart")!=null)){
if(e.button!==2||this.getAllSelectedObjects().length<=1||typeof this.m_oCognosViewer.isBux==="undefined"){
this.selectNode(node,e);
this.setSelectedChartArea(node,e);
}
}else{
if(!(node.firstChild==null&&node.cellIndex==0&&node.parentNode.rowIndex==0&&node.getAttribute("cid")==null)){
var _671=this.m_oCognosViewer.getViewerWidget();
this.selectNode(node,e);
}
}
}
if(window.gViewerLogger){
window.gViewerLogger.addContextInfo(this);
}
}
catch(e){
}
};
CSelectionController.prototype.getSelectionObjectFactory=function(){
return this.m_oSelectionObjectFactory;
};
CSelectionController.prototype.isDrillLinkOnCrosstabCell=function(node){
return (node.getAttribute("ctx")==null&&node.parentNode.getAttribute("dtTargets")!=null);
};
CSelectionController.prototype.selectObject=function(sMun,sLun,sHun,_676){
var _677=this.getCtxIdFromMun(sMun);
if(_677==""){
_677=this.getCtxIdFromMetaData(sLun,sHun,_676);
}
if(_677!=null&&this.m_oCDManager.GetUsage(_677)!="2"){
var _678=document.getElementById("rt"+this.getNamespace());
if(_678!=null){
var _679=getElementsByAttribute(_678,"*","ctx",_677);
if(_679&&_679.length===0){
var _67a=new RegExp("(^|:)"+_677+"(:|$)","i");
_679=getElementsByAttribute(_678,"*","ctx",_677,-1,_67a);
}
var _67b=null;
if(_679!=null&&_679.length>0){
_67b=new CSelectionObject();
_67b.setSelectionController(this);
_67b.m_sColumnRef=_679[0].getAttribute("cid");
_67b.m_sCellTypeId=_679[0].getAttribute("uid");
_67b.m_sLayoutType=_679[0].getAttribute("type");
_67b.m_sTag=_679[0].getAttribute("tag");
_67b.m_layoutElementId=this.m_oSelectionObjectFactory.getLayoutElementId(_679[0]);
_67b.m_dataContainerType=this.m_oSelectionObjectFactory.getContainerType(_679[0]);
_67b.m_contextIds=[[_677]];
this.m_aSelectedObjects[this.m_aSelectedObjects.length]=_67b;
}else{
var _67c=getElementsByAttribute(_678,"*","flashChart","true");
if(_67c!=null){
for(var _67d=0;_67d<_67c.length;++_67d){
var ldx=_67c[_67d].getLDX();
if(ldx.indexOf("<ctx>"+_677+"</ctx>")!=-1){
_67b=new CSelectionObject();
_67b.setSelectionController(this);
var lid=_67c[_67d].getAttribute("lid");
_67b.m_layoutElementId=lid.replace(this.m_oCognosViewer.getId(),"");
_67b.m_dataContainerType="chart";
_67b.m_contextIds=[[_677]];
this.m_aSelectedObjects[this.m_aSelectedObjects.length]=_67b;
}
}
}
}
}
}
};
CSelectionController.prototype.buildSelectionObject=function(node,e){
var _682=null;
try{
while(node.nodeType==3){
node=node.parentNode;
}
if(this.isDrillLinkOnCrosstabCell(node)){
node=node.parentNode;
}
var ctx=node.getAttribute("ctx");
var uid=node.getAttribute("uid");
if((uid==null)&&((ctx!=null)||(node.parentNode&&node.parentNode.nodeType==1&&typeof node.parentNode.getAttribute!="undefined"&&node.parentNode.getAttribute("uid")!=null))){
if(node.nodeName=="IMG"&&(node.src.indexOf("SM=")>-1||(isIE()>-1&&node.src.indexOf("space.gif")>-1))){
return null;
}
node=node.parentNode;
if((node.className.toUpperCase()=="BLOCK"&&node.nodeName.toUpperCase()=="DIV")||(node.getAttribute("dtTargets")!=null)){
node=node.parentNode;
}
uid=node.getAttribute("uid");
}
if(uid!=null){
var _685=node.childNodes;
for(var i=0;i<_685.length;i++){
if(_685[i].nodeName.toUpperCase()=="TABLE"&&(_685[i].className=="ls"||_685[i].className=="xt")){
var trs=_685[i].rows;
for(var j=0;j<trs.length;j++){
var tds=trs[j].cells;
for(var k=0;k<tds.length;k++){
if(tds[k].getAttribute("uid")!=null){
return null;
}
}
}
}
}
if(node.className.toUpperCase()=="REPEATERTABLECELL"&&ctx!=null){
_682=this.getSelectionObjectFactory().getSelectionObject(node,ctx);
}else{
_682=this.getSelectionObjectFactory().getSelectionObject(node);
}
}
}
catch(e){
}
return _682;
};
CSelectionController.prototype.shiftKeyPressed=function(e){
if(e.keyCode=="121"){
return false;
}
if(isSafari()){
if(e.button!=2){
return e.shiftKey?e.shiftKey:false;
}else{
return false;
}
}
return e.shiftKey?e.shiftKey:false;
};
CSelectionController.prototype.ctrlKeyPressed=function(e){
if(isSafari()){
if(e.button!=2){
return e.ctrlKey?e.ctrlKey:false;
}else{
return false;
}
}
return e.ctrlKey?e.ctrlKey:false;
};
CSelectionController.prototype.isSelectionsPreviouslySaved=function(_68d){
var _68e=false;
if(!this.m_aSavedSelectedObjects||!this.m_aSavedSelectedObjects.length||!_68d||!_68d.length){
return false;
}
for(var i=0;i<_68d.length;i++){
if(this.isSavedCellSelected(_68d[i].getCellRef())){
return true;
}
}
return false;
};
CSelectionController.prototype.selectNode=function(node,e){
try{
while(node.nodeType==3){
node=node.parentNode;
}
if(this.isDrillLinkOnCrosstabCell(node)){
node=node.parentNode;
}
var _692=null;
if(isIE()){
_692=node.document;
}else{
_692=node.ownerDocument;
}
var ctx=node.getAttribute("ctx");
var uid=node.getAttribute("uid");
var _695=false;
if(typeof e=="undefined"){
e={};
}
var _696=false;
if(typeof g_reportSelectionController!="undefined"){
_696=this.checkForReportElementNode(node);
}
if((ctx==null&&uid==null&&node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")==null&&_696==false)||(!this.ctrlKeyPressed(e)&&!this.shiftKeyPressed(e))){
if(this.getSelections().length>0){
_695=true;
}
if(this.hasCutColumns()==true){
this.clearSelectedObjects(_692);
}else{
this.resetSelections(_692);
this.repaintSavedSelections();
if(typeof cf!="undefined"&&typeof cf.removeAllSelectionsFromCfgVariables=="function"){
cf.removeAllSelectionsFromCfgVariables();
}
this.m_oCognosViewer.setCurrentNodeFocus(null);
}
if(this.ctrlKeyPressed(e)||this.shiftKeyPressed(e)){
clearTextSelection(_692);
}
if(typeof g_reportSelectionController!="undefined"&&_696==false){
if(g_reportSelectionController.getSelections().length>0){
_695=true;
}
g_reportSelectionController.clearSelections();
}
}
var _697=node.getAttribute("dtTargets")?node:null;
var _698=(node.nodeName.toLowerCase()==="area");
if((uid==null)&&((ctx!=null)||(node.parentNode&&node.parentNode.nodeType==1&&typeof node.parentNode.getAttribute!="undefined"))){
if(node.nodeName=="IMG"&&(node.src.indexOf("SM=")>-1||(isIE()>-1&&node.src.indexOf("space.gif")>-1))){
return false;
}
node=node.parentNode;
_697=(!_697&&node.getAttribute("dtTargets"))?node:_697;
if((node.className.toUpperCase()=="BLOCK"&&node.nodeName.toUpperCase()=="DIV")||(node.getAttribute("dtTargets")!=null)){
node=node.parentNode;
}
_697=(!_697&&typeof node.getAttribute!="undefined"&&node.getAttribute("dtTargets"))?node:_697;
uid=(typeof node.getAttribute!="undefined")?node.getAttribute("uid"):null;
if(uid==null&&node.nodeName.toLowerCase()=="span"&&node.parentNode.nodeName.toLowerCase()=="td"){
node=node.parentNode;
uid=node.getAttribute("uid");
}
if(uid==null&&_697!=null){
if(node.nodeName.toLowerCase()=="div"&&node.attributes!=null&&node.parentNode.nodeName.toLowerCase()=="td"){
node=node.parentNode;
}
if(node){
uid=(typeof node.getAttribute!="undefined")?node.getAttribute("uid"):null;
}
}
}
if(uid!=null){
var _699=node.childNodes;
for(var i=0;i<_699.length;i++){
if(_699[i].nodeName.toUpperCase()=="TABLE"&&(_699[i].className=="ls"||_699[i].className=="xt")){
var trs=_699[i].rows;
for(var j=0;j<trs.length;j++){
var tds=trs[j].cells;
for(var k=0;k<tds.length;k++){
if(tds[k].getAttribute("uid")!=null){
return false;
}
}
}
}
}
var _69f;
if(node.className.toUpperCase()=="REPEATERTABLECELL"&&ctx!=null){
_69f=this.getSelectionObjectFactory().getSelectionObject(node,ctx);
}else{
_69f=this.getSelectionObjectFactory().getSelectionObject(node);
}
if(this.isCellSelected(node)==false){
if(this.shiftKeyPressed(e)){
var _6a0=this.getSelections();
if(_6a0.length>0){
var _6a1=_6a0[_6a0.length-1];
if(_6a1.getLayoutType()==_69f.getLayoutType()&&(_6a1.getCellRef().parentNode.parentNode==_69f.getCellRef().parentNode.parentNode)){
if(this.cellsAreInSameColumn(_6a1.getCellRef(),_69f.getCellRef())){
this.selectVertical(_6a1,_69f,_692);
}else{
if(_6a1.getCellRef().parentNode.rowIndex==_69f.getCellRef().parentNode.rowIndex){
this.selectHorizontal(_6a1,_69f,_692);
}
}
}
}
clearTextSelection(_692);
}else{
if(this.ctrlKeyPressed(e)){
clearTextSelection(_692);
}
}
this.addSelectionObject(_69f,_692);
if(typeof cf!="undefined"&&typeof cf.addSelectionToCfgVariables=="function"){
cf.addSelectionToCfgVariables(_69f.getColumnName());
}
this.m_oCognosViewer.setCurrentNodeFocus(node);
}else{
if(this.ctrlKeyPressed(e)){
this.removeSelectionObject(_69f,_692);
if(typeof cf!="undefined"&&typeof cf.removeSelectionFromCfgVariables=="function"){
if(!this.isColumnSelected(_69f.getTag())){
cf.removeSelectionFromCfgVariables(_69f.getTag());
}
}
clearTextSelection(_692);
}else{
if(this.shiftKeyPressed(e)){
clearTextSelection(_692);
}
}
}
_695=true;
}else{
if(_696){
var _6a2=null;
while((typeof node.id=="undefined"||node.id==null||node.id=="")&&node.parentNode!=null){
node=node.parentNode;
}
if(node.id=="reportTitle"){
_6a2="TitleStyle";
}else{
if(node.id=="reportSubtitle"){
_6a2="SubtitleStyle";
}else{
if(node.id.indexOf("reportFilter")==0){
_6a2="FilterStyle";
}
}
}
if(_6a2!=null){
selectReportElement(e,node.id,_6a2);
_695=true;
}
}else{
if(_697!=null&&this.m_oCognosViewer&&this.m_oCognosViewer.isMobile()&&!_698){
var _69f=this.getSelectionObjectFactory().getSelectionObject(_697);
this.addSelectionObject(_69f,_692);
}
}
}
if(_695==true&&(typeof cf!="undefined"&&typeof cf.refreshDialog=="function")){
cf.refreshDialog();
}
}
catch(ex){
}
};
CSelectionController.prototype.selectDrillThroughImage=function(node){
this.m_oSelectedDrillThroughImage=node;
};
CSelectionController.prototype.getSelectedDrillThroughImage=function(){
return this.m_oSelectedDrillThroughImage?this.m_oSelectedDrillThroughImage:null;
};
CSelectionController.prototype.selectDrillThroughSingleton=function(node){
this.m_oSelectedDrillThroughSingleton=node;
};
CSelectionController.prototype.getSelectDrillThroughSingleton=function(){
return this.m_oSelectedDrillThroughSingleton?this.m_oSelectedDrillThroughSingleton:null;
};
CSelectionController.prototype.getReportContextDataArray=function(){
return this.m_aReportContextDataArray;
};
CSelectionController.prototype.getReportMetadataArray=function(){
return this.m_aReportMetadataArray;
};
CSelectionController.prototype.setupContextDataArray=function(_6a5){
this.m_aReportContextDataArray=_6a5;
};
CSelectionController.prototype.setupMetaDataArray=function(_6a6){
this.m_aReportMetadataArray=_6a6;
};
CSelectionController.prototype.addContextData=function(_6a7){
this.m_aSelectedObjects=[];
this.m_oCDManager.SetContextData(_6a7);
if(!this.m_bUsingCCDManager){
this.m_bUsingCCDManager=true;
}
for(var i=0;i<this.m_selectedClass.length;++i){
this.deselecting(this.m_selectedClass);
}
};
CSelectionController.prototype.addMetaData=function(_6a9){
this.m_aSelectedObjects=[];
this.m_oCDManager.SetMetadata(_6a9);
if(!this.m_bUsingCCDManager){
this.m_bUsingCCDManager=true;
}
};
CSelectionController.prototype.getDrillFlag=function(_6aa){
var _6ab="";
if(!this.m_bUsingCCDManager){
var _6ac=this.m_aReportContextDataArray[_6aa];
var _6ad=_6ac[0];
var _6ae=this.m_aReportMetadataArray[_6ad];
if(typeof _6ae!="undefined"&&typeof _6ae[3]!="undefined"){
_6ab=_6ae[3];
}
}else{
_6ab=this.m_oCDManager.GetDrillFlag(_6aa);
}
return _6ab;
};
CSelectionController.prototype.getDrillFlagForMember=function(_6af){
var _6b0="0";
if(!this.m_bUsingCCDManager){
var _6b1=this.getContextDataItem(_6af);
if(_6b1!=null){
var _6b2=_6b1[2];
if(_6b2!=""){
var _6b3=_6b1[0];
var _6b4=this.getMetaDataItem(_6b3);
if(_6b4!=null){
_6b0=_6b4[3];
}
}
}
}else{
_6b0=this.m_oCDManager.GetDrillFlagForMember(_6af);
}
return (_6b0==null)?0:_6b0;
};
CSelectionController.prototype.getDataType=function(_6b5){
var _6b6=null;
if(!this.m_bUsingCCDManager){
var _6b7=this.getRDI(_6b5);
if(_6b7&&_6b7.length>2){
_6b6=parseInt(_6b7[2],10);
}
}else{
_6b6=parseInt(this.m_oCDManager.GetDataType(_6b5),10);
}
return _6b6;
};
CSelectionController.prototype.getUsageInfo=function(_6b8){
if(this.m_bUsingCCDManager){
return this.m_oCDManager.GetUsage(_6b8);
}
};
CSelectionController.prototype.isMeasure=function(_6b9){
return (this.getUsageInfo(_6b9)==this.c_usageMeasure);
};
CSelectionController.prototype.getDepth=function(_6ba){
var _6bb=null;
if(!this.m_bUsingCCDManager){
var _6bc=this.getRDI(_6ba);
if(_6bc&&_6bc.length>5&&_6bc[1]=="R"){
_6bb=_6bc[5];
}
}else{
_6bb=this.m_oCDManager.GetDepth(_6ba);
}
return _6bb;
};
CSelectionController.prototype.getUseValue=function(_6bd){
var _6be="";
if(!this.m_bUsingCCDManager){
var _6bf=this.m_aReportContextDataArray[_6bd];
if(typeof _6bf[1]!="undefined"){
_6be=_6bf[1];
}
}else{
_6be=this.m_oCDManager.GetDisplayValue(_6bd);
}
return _6be;
};
CSelectionController.prototype.getTextValue=function(_6c0){
var _6c1=null;
for(var _6c2=0;_6c2<_6c0.length;_6c2++){
if(_6c0[_6c2].style.visisbility!="hidden"){
if(isIE()){
_6c1=_6c0[_6c2].innerText;
}else{
_6c1=_6c0[_6c2].textContent;
}
var _6c3=_6c0[_6c2].nextSibling;
while(_6c3!=null){
if(_6c3.nodeName.toUpperCase()=="SPAN"&&_6c3.style.visibility!="hidden"){
if(isIE()){
_6c1+=_6c3.innerText;
}else{
_6c1+=_6c3.textContent;
}
}
_6c3=_6c3.nextSibling;
}
break;
}
}
return _6c1;
};
CSelectionController.prototype.getDisplayValueFromDOM=function(_6c4,_6c5){
var _6c6=null;
var _6c7;
var _6c8=new RegExp("(^|\\s)"+_6c4+"(\\s|$|:)","i");
if(typeof _6c5!="undefined"){
_6c7=getElementsByAttribute(_6c5,["span","td","th"],"ctx",_6c4,1,_6c8);
}else{
var _6c9=document.getElementById("CVIFrame"+this.m_sNamespace);
if(typeof _6c9=="undefined"||_6c9==null){
var _6ca=document.getElementById("RVContent"+this.m_sNamespace);
if(typeof _6ca=="undefined"||_6ca==null){
_6c7=getElementsByAttribute(document.body,["span","td","th"],"ctx",_6c4,1,_6c8);
}else{
_6c7=getElementsByAttribute(_6ca,["span","td","th"],"ctx",_6c4,1,_6c8);
}
}else{
_6c7=getElementsByAttribute(_6c9.contentWindow.document.body,["span","td","th"],"ctx",_6c4,1,_6c8);
}
}
var _6cb;
if(_6c7.length>0&&(_6c7[0].nodeName.toUpperCase()=="TD"||_6c7[0].nodeName.toUpperCase()=="TH")){
_6cb=_6c7[0].childNodes;
}else{
_6cb=_6c7;
}
if(_6cb.length==0||(_6cb[0].className.indexOf("chart_area")==-1&&_6cb[0].className.indexOf("bux-comment")==-1)){
_6c6=this.getTextValue(_6cb);
}
return _6c6;
};
CSelectionController.prototype.getDisplayValue=function(_6cc,_6cd){
var _6ce=this.getDisplayValueFromDOM(_6cc,_6cd);
if(_6ce==null){
_6ce=this.getUseValue(_6cc);
}
return _6ce;
};
CSelectionController.prototype.getDun=function(_6cf){
if(this.m_bUsingCCDManager){
return this.m_oCDManager.GetDUN(_6cf);
}else{
var _6d0=this.m_aReportContextDataArray[_6cf];
if(_6d0&&typeof _6d0[5]!="undefined"){
var _6d1=_6d0[5];
var _6d2=this.m_aReportMetadataArray[_6d1];
if(typeof _6d2!="undefined"&&typeof _6d2[1]!="undefined"&&_6d2[1]=="D"){
return _6d2[0];
}
}
}
};
CSelectionController.prototype.getPun=function(_6d3){
if(this.m_bUsingCCDManager){
return this.m_oCDManager.GetPUN(_6d3);
}
};
CSelectionController.prototype.getLun=function(_6d4){
var lun="";
if(!this.m_bUsingCCDManager){
var _6d6=this.m_aReportContextDataArray[_6d4];
if(_6d6&&typeof _6d6[3]!="undefined"){
var _6d7=_6d6[3];
var _6d8=this.m_aReportMetadataArray[_6d7];
if(typeof _6d8!="undefined"&&typeof _6d8[1]!="undefined"&&_6d8[1]=="L"){
lun=_6d8[0];
}
}
}else{
lun=this.m_oCDManager.GetLUN(_6d4);
}
return lun;
};
CSelectionController.prototype.isContextId=function(_6d9){
var _6da=false;
if(!this.m_bUsingCCDManager){
var _6db=this.m_aReportContextDataArray[_6d9];
_6da=(typeof _6db=="object");
}else{
this.m_oCDManager.FetchContextData([_6d9]);
_6da=this.m_oCDManager.ContextIdExists(_6d9);
}
return _6da;
};
CSelectionController.prototype.hasContextData=function(){
var _6dc=false;
if(!this.m_bUsingCCDManager){
if(this.m_aReportContextDataArray&&this.m_aReportContextDataArray.length&&this.m_aReportContextDataArray.length()>0){
return true;
}
}else{
_6dc=this.m_oCDManager.HasContextData();
}
return _6dc;
};
CSelectionController.prototype.hasMetadata=function(){
var _6dd=false;
if(!this.m_bUsingCCDManager){
if(this.m_aReportMetadataArray&&this.m_aReportMetadataArray.length&&this.m_aReportMetadataArray.length()>0){
return true;
}
}else{
_6dd=this.m_oCDManager.HasMetadata();
}
return _6dd;
};
CSelectionController.prototype.getDifferentCellIndex=function(_6de,_6df,_6e0){
for(var i=0;i<_6de.cells.length;i++){
if(this.getSelectionObjectFactory().getSelectionObject(_6de.cells[i]).getLayoutType()=="datavalue"){
break;
}
}
if(_6e0=="relative"){
return (_6df-i);
}else{
if(_6e0=="actual"){
return (_6df+i);
}
}
};
CSelectionController.prototype.cellsAreInSameColumn=function(_6e2,_6e3){
if(_6e2.parentNode.rowIndex==_6e3.parentNode.rowIndex){
return false;
}
if(_6e2.getAttribute("cid")===null){
if(_6e2.getAttribute("uid")===_6e3.getAttribute("uid")){
if(_6e2.getAttribute("type")!="datavalue"){
return true;
}else{
if(this.getDifferentCellIndex(_6e2.parentNode,_6e2.cellIndex,"relative")==this.getDifferentCellIndex(_6e3.parentNode,_6e3.cellIndex,"relative")){
return true;
}
}
}else{
return false;
}
}else{
if(_6e2.getAttribute("cid")===_6e3.getAttribute("cid")){
return true;
}else{
return false;
}
}
};
CSelectionController.prototype.selectVertical=function(_6e4,_6e5,_6e6){
if(!_6e6){
_6e6=document;
}
var _6e7=_6e4.getCellRef().parentNode;
var _6e8,i;
var _6ea=(_6e4.getCellRef().parentNode.rowIndex<_6e5.getCellRef().parentNode.rowIndex);
var _6eb=(_6e4.getCellRef().parentNode.cells.length-_6e4.getCellRef().cellIndex);
while(_6e7.rowIndex!=_6e5.getCellRef().parentNode.rowIndex){
if(_6ea){
_6e7=_6e7.nextSibling;
}else{
_6e7=_6e7.previousSibling;
}
if(_6e7==null){
break;
}
if(_6e7.cells.length>=_6eb){
for(i=0;i<_6e7.cells.length;i++){
if((_6e7.cells[i].getAttribute("type")==_6e4.getLayoutType())&&this.cellsAreInSameColumn(_6e4.getCellRef(),_6e7.cells[i])){
_6e8=this.getSelectionObjectFactory().getSelectionObject(_6e7.cells[i]);
if(this.addSelectionObject(_6e8,_6e6)){
if(typeof cf!="undefined"&&typeof cf.addSelectionToCfgVariables=="function"){
cf.addSelectionToCfgVariables(_6e8.getColumnName());
}
}
break;
}
}
}
}
};
CSelectionController.prototype.selectHorizontal=function(_6ec,_6ed,_6ee){
var _6ef="";
if(_6ec.getColumnRef()==null){
if(_6ec.getCellRef().getAttribute("uid")==_6ed.getCellRef().getAttribute("uid")){
_6ef=_6ec.getCellRef().getAttribute("uid");
}else{
return;
}
}
var _6f0,_6f1;
var _6f2=_6ed.getCellRef().parentNode;
var _6f3;
if(_6ed.getCellRef().cellIndex<_6ec.getCellRef().cellIndex){
_6f0=_6ed.getCellRef().cellIndex;
_6f1=_6ec.getCellRef().cellIndex;
}else{
_6f1=_6ed.getCellRef().cellIndex;
_6f0=_6ec.getCellRef().cellIndex;
}
for(var i=_6f0+1;i<_6f1;i++){
if(((_6ec.getColumnRef()!=null)&&(_6ec.getLayoutType()==_6ed.getLayoutType())&&(_6ec.getLayoutType()!="datavalue")||this.allowHorizontalDataValueSelection())||((_6ec.getColumnRef()==null)&&(_6f2.cells[i].getAttribute("uid")==_6ef))){
_6f3=this.getSelectionObjectFactory().getSelectionObject(_6f2.cells[i]);
if(this.addSelectionObject(_6f3,_6ee)){
if(typeof cf!="undefined"&&typeof cf.addSelectionToCfgVariables=="function"){
cf.addSelectionToCfgVariables(_6f3.getColumnName());
}
}
}
}
};
CSelectionController.prototype.pageDoubleClicked=function(e){
try{
var node=getNodeFromEvent(e);
if(typeof node.selectedCell!="undefined"){
var _6f7=node;
node=node.selectedCell;
_6f7.removeAttribute("selectedCell");
}
while(node.nodeType==3){
node=node.parentNode;
}
var ctx=node.getAttribute("ctx");
var uid=node.getAttribute("uid");
if((ctx!=null)||(node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")!=null)){
node=node.parentNode;
if(node.className.toUpperCase()=="BLOCK"&&node.nodeName.toUpperCase()=="DIV"){
node=node.parentNode;
}
uid=node.getAttribute("uid");
}
if(uid!=null&&node.firstChild!=null&&(node.getAttribute("type")=="columnTitle"||node.getAttribute("type")=="section")){
if(typeof goWindowManager!="undefined"&&goWindowManager&&typeof goWindowManager.getApplicationFrame=="function"){
goWindowManager.getFeatureManager().launchFeature("Rename");
}
}
if(typeof g_reportSelectionController!="undefined"){
g_reportSelectionController.clearSelections();
}
}
catch(ex){
}
};
CSelectionController.prototype.getSelectionHoverNodes=function(){
return this.m_aSelectionHoverNodes;
};
CSelectionController.prototype.setSelectionHoverNodes=function(_6fa){
this.m_aSelectionHoverNodes=_6fa;
};
CSelectionController.prototype.addSelectionHoverNode=function(node){
this.m_aSelectionHoverNodes[this.m_aSelectionHoverNodes.length]=node;
};
CSelectionController.prototype.pageHover=function(e){
try{
var node=getNodeFromEvent(e);
while(node.nodeType==3){
node=node.parentNode;
}
if((node.getAttribute("ctx")!=null)||(node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")!=null)){
if(node.parentNode.nodeName.toLowerCase()!="tr"){
node=node.parentNode;
}
}
var _6fe=this.getSelectionHoverNodes();
var _6ff=this.getAllSelectedObjects().length;
if(!(_6fe.length==1&&_6fe[0]==node)){
for(var i=0;i<_6fe.length;i++){
this.sortIconHover(_6fe[i],true);
if(_6ff==0){
this.pageChangeHover(_6fe[i],true);
}
}
this.setSelectionHoverNodes([]);
if(_6ff==0){
this.sortIconHover(node,false);
if(this.pageChangeHover(node,false)){
this.addSelectionHoverNode(node);
}
}else{
if(this.sortIconHover(node,false)){
this.addSelectionHoverNode(node);
}
}
}
}
catch(ex){
}
};
CSelectionController.prototype.sortIconHover=function(node,_702){
if(!this.isValidColumnTitle(node)){
return false;
}
var _703=this.getSortImgNode(node);
if(_703!=null&&_703!="undefined"){
if(_703.getAttribute("sortOrder")==="nosort"){
if(_702){
_703.style.visibility="hidden";
}else{
_703.style.visibility="visible";
}
}
return true;
}
return false;
};
CSelectionController.prototype.isValidColumnTitle=function(node){
if(node&&node.parentNode){
var uid=node.getAttribute("uid");
if(uid!=null&&(!(node.firstChild==null&&node.cellIndex==0&&node.parentNode.rowIndex==0&&node.getAttribute("cid")==null))&&(node.getAttribute("type")=="columnTitle"||node.getAttribute("type")=="section")){
return true;
}
}
return false;
};
CSelectionController.prototype.pageChangeHover=function(node,_707){
try{
if((node.getAttribute("ctx")!=null)||(node.parentNode&&node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")!=null)){
if(node.parentNode.nodeName.toLowerCase()!="tr"){
node=node.parentNode;
}
}
if(this.isValidColumnTitle(node)){
var _708=this.isColumnSelected(node.getAttribute("tag"));
if(!_708){
_708=this.isColumnCut(node.getAttribute("tag"));
}
if(!_708){
if(_707){
if(node.getAttribute("oldClassName")!=null){
node.className=node.getAttribute("oldClassName");
node.removeAttribute("oldClassName");
}
this.restoreOldBackgroundImage(node);
}else{
if(node.getAttribute("oldClassName")!=null){
node.className=node.getAttribute("oldClassName");
}else{
node.setAttribute("oldClassName",node.className);
}
if(node.getAttribute("oldBackgroundImageStyle")!=null){
node.style.backgroundImage=node.getAttribute("oldBackgroundImageStyle");
}else{
this.saveOldCellStyles(node);
}
node.className+=" hoverSelection";
return true;
}
}
}
}
catch(ex){
}
return false;
};
CSelectionController.prototype.getSortImgNode=function(node){
var _70a=node.getElementsByTagName("img");
for(var i=0;i<_70a.length;i++){
var sId=_70a[i].id.toString();
if(sId!=null&&sId.length>0&&sId.indexOf("sortimg")>=0){
node=_70a[i];
return node;
}
}
return null;
};
CSelectionController.prototype.restoreOldPadding=function(node){
if(node&&node.style&&node.getAttribute("oldPaddingStyle")!=null){
if(node.getAttribute("oldPaddingStyle").length>0){
node.style.padding=node.getAttribute("oldPaddingStyle");
}
node.removeAttribute("oldPaddingStyle");
}
};
CSelectionController.prototype.saveOldPadding=function(node,size){
if(node&&node.getAttribute("oldPaddingStyle")==null){
node.setAttribute("oldPaddingStyle",size.paddingTop+"px "+size.paddingRight+"px "+size.paddingBottom+"px "+size.paddingLeft+"px");
}
};
CSelectionController.prototype.saveOldBorder=function(node){
if(node&&node.getAttribute("oldBorderStyle")==null){
node.setAttribute("oldBorderStyle",node.style.border);
}
};
CSelectionController.prototype.restoreOldBorder=function(node){
if(node&&node.style&&node.getAttribute("oldBorderStyle")!=null){
if(node.getAttribute("oldBorderStyle").length>0){
node.style.border=node.getAttribute("oldBorderStyle");
}else{
node.style.borderColor=node.style.borderWidth=node.style.borderStyle="";
}
node.removeAttribute("oldBorderStyle");
}
};
CSelectionController.prototype.setPrimarySelectionStyles=function(cell){
if(this.getPrimarySelectionColor()){
cell.style.backgroundColor=this.getPrimarySelectionColor();
}else{
cell.style.backgroundImage=this.pS_backgroundImageURL;
cell.style.backgroundRepeat="repeat";
}
};
CSelectionController.prototype.setSecondarySelectionStyles=function(cell){
if(this.getSecondarySelectionColor()){
cell.style.backgroundColor=this.getSecondarySelectionColor();
}else{
cell.style.backgroundImage=this.sS_backgroundImageURL;
cell.style.backgroundRepeat="repeat";
}
};
CSelectionController.prototype.saveOldCellStyles=function(node){
if(node&&node.getAttribute("oldBackgroundImageStyle")==null){
node.setAttribute("oldBackgroundColor",this.getStyleProperty(node,"backgroundColor"));
node.setAttribute("oldBackgroundImageStyle",this.getBackgroundImage(node));
node.setAttribute("oldBackgroundRepeat",this.getStyleProperty(node,"backgroundRepeat"));
node.style.backgroundImage="";
node.style.backgroundRepeat="";
}
};
CSelectionController.prototype.restoreOldBackgroundImage=function(node){
if(node&&node.style&&node.getAttribute("oldBackgroundImageStyle")!=null){
node.style.backgroundImage=node.getAttribute("oldBackgroundImageStyle");
node.removeAttribute("oldBackgroundImageStyle");
node.style.backgroundRepeat=node.getAttribute("oldBackgroundRepeat");
node.removeAttribute("oldBackgroundRepeat");
node.style.backgroundColor=node.getAttribute("oldBackgroundColor");
node.removeAttribute("oldBackgroundColor");
}
};
CSelectionController.prototype.getStyleProperty=function(node,_717){
if(node&&node.style&&node.style[_717]){
return node.style[_717];
}
return "";
};
CSelectionController.prototype.getBackgroundImage=function(node){
if(node&&node.style){
return node.style.backgroundImage;
}
return "";
};
CSelectionController.prototype.pageContextClicked=function(e){
var node=getNodeFromEvent(e);
if(typeof node.selectedCell!="undefined"){
var _71b=node;
node=node.selectedCell;
_71b.removeAttribute("selectedCell");
}
while(node!=null&&node.tagName!="TD"){
node=node.parentNode;
}
if(node!=null){
var _71c=this.getBackgroundImage(node);
this.findSelectionURLs();
if(this.getSelections().length==0||_71c!=this.pS_backgroundImageURL){
this.pageClicked(e);
}
}
if(typeof populateContextMenu!="undefined"){
populateContextMenu();
moveContextMenu(e);
}
var _71d=false;
if(this.showViewerContextMenu()){
if(typeof e.preventDefault=="function"){
e.preventDefault();
}
_71d=true;
}
return _71d;
};
CSelectionController.prototype.chartContextMenu=function(e){
if(!this.hasSelectedChartNodes()){
return;
}
if(typeof populateContextMenu!="undefined"){
populateContextMenu();
moveContextMenu(e);
}
if(typeof e.preventDefault=="function"){
e.preventDefault();
}
return false;
};
CSelectionController.prototype.titleAreaContextMenu=function(e,_720,sId){
if(typeof populateContextMenu!="undefined"){
goWindowManager.getApplicationFrame().cfgSet("contextMenuType",_720);
goWindowManager.getApplicationFrame().cfgSet("contextMenuId",sId);
populateContextMenu(_720.toUpperCase());
moveContextMenu(e,_720.toUpperCase());
}
if(typeof e.preventDefault=="function"){
e.preventDefault();
}
return false;
};
CSelectionController.prototype.selectionsAreAllSameType=function(){
var _722=this.getSelections();
if(_722.length>0){
var _723=_722[0].getLayoutType();
for(var i=1;i<_722.length;i++){
if(_723!=_722[i].getLayoutType()){
return 0;
}
}
return 1;
}
return -1;
};
CSelectionController.prototype.selectionsAreAllOnSameColumn=function(){
var _725=this.getSelections();
var i=0;
if(_725.length>0){
var _727=_725[0].getColumnRef();
if(_727!=null&&_727!=""){
for(i=1;i<_725.length;i++){
if(_727!=_725[i].getColumnRef()){
return false;
}
}
}else{
var _728=_725[0].getCellTypeId();
for(i=1;i<_725.length;i++){
if(_728!=_725[i].getCellTypeId()){
return false;
}
}
}
return true;
}
return false;
};
CSelectionController.prototype.checkForReportElementNode=function(node){
if(typeof node!="undefined"&&node!=null&&typeof node.className!="undefined"&&node.className!=null){
if(node.className=="tt"){
if(typeof node.parentNode!="undefined"&&node.parentNode!=null&&typeof node.parentNode.parentNode!="undefined"&&node.parentNode.parentNode!=null&&(node.parentNode.className=="reportSubtitleStyle"||node.parentNode.id=="reportTitleLink")){
node=node.parentNode.parentNode;
}else{
return false;
}
}else{
if(typeof node.parentNode!="undefined"&&node.parentNode!=null){
var _72a=node.parentNode;
while(typeof _72a!="undefined"&&_72a!=null){
if(typeof _72a.className!="undefined"&&_72a.className!=null&&_72a.className.substr(0,2)=="ft"){
node=_72a;
break;
}else{
_72a=_72a.parentNode;
}
}
}else{
return false;
}
}
var _72b=node.className.substr(0,2);
if(_72b=="ta"||_72b=="ts"||_72b=="ft"){
return true;
}
}
return false;
};
CSelectionController.prototype.chartClicked=function(_72c){
this.setSelectedChartArea(_72c);
};
CSelectionController.prototype.processColumnTitleNode=function(_72d){
if(!_72d||!this.m_oCognosViewer.isBux){
return;
}
var _72e=_72d.getCellRef();
if(_72e.getAttribute("contextAugmented")=="true"||"list"!=_72d.getDataContainerType()||"columnTitle"!=_72d.getLayoutType()){
return;
}
var _72f=_72d.getSelectedContextIds();
var _730=false;
if(typeof _72f=="object"&&_72f!=null&&_72f.length>0){
if(this.isRelational(_72f)&&this.getQueryModelId(_72f[0][0])==null){
_730=true;
}else{
return;
}
}
var lid=_72e.parentNode.parentNode.parentNode.getAttribute("lid");
var _732=_72e.parentNode.nextSibling;
var _733=getChildElementsByAttribute(_732,"td","cid",_72e.getAttribute("cid"));
var _734=null;
var _735=true;
var _736;
if(_733.length>0){
var _737=_733[0];
var _738=_737.childNodes.length;
for(var _739=0;_739<_738;_739++){
var _73a=_737.childNodes[_739];
if(_73a.getAttribute&&((_73a.nodeName.toLowerCase()=="table"&&typeof _73a.getAttribute("lid")=="string")||_73a.nodeName.toLowerCase()=="map"||_73a.nodeName.toLowerCase()=="img"||_73a.getAttribute("chartcontainer")=="true")){
if(_739==0){
_735=false;
}
}else{
_736=[];
if(_73a.nodeName.toLowerCase()=="span"){
_736.push(_73a);
}
var _73b=_73a.getElementsByTagName?_73a.getElementsByTagName("span"):[];
for(var _73c=0;_73c<_73b.length;++_73c){
if(lid==getImmediateLayoutContainerId(_73b[_73c])){
_736.push(_73b[_73c]);
}
}
for(var _73d=0;_73d<_736.length;++_73d){
var _73e=_736[_73d];
if(_73e.nodeType==1&&_73e.nodeName.toLowerCase()=="span"&&_73e.style.visibility!="hidden"){
if(_73e.getAttribute("ctx")!=null&&_73e.getAttribute("ctx")!=""){
_734=_73e.getAttribute("ctx");
break;
}
}
}
}
}
}
if(_734!=null){
var _73f=_734.split("::")[0].split(":")[0];
if(!_730){
_736=_72e.getElementsByTagName("span");
if(_736.length!=0){
var _740=this.m_oCDManager.m_cd[_73f];
var _741=this.getTextValue(_736);
var _742={"u":_741===null?"":_741};
if(typeof _740!="undefined"){
if(typeof _740["r"]!="undefined"){
_742.r=_740["r"];
}
if(typeof _740["q"]!="undefined"){
_742.q=_740["q"];
}
if(typeof _740["i"]!="undefined"){
_742.i=_740["i"];
}
}
var _743="cloned"+_73f;
this.m_oCDManager.m_cd[_743]=_742;
_736[0].setAttribute("ctx",_743);
_72d=this.getSelectionObjectFactory().processCTX(_72d,_743);
}
}else{
var qmid=this.getQueryModelId(_73f);
if(qmid==null){
}
if(qmid!=null){
var _745=_72f[0][0];
this.m_oCDManager.m_cd[_745].i=this.m_oCDManager.m_cd[_73f].i;
return false;
}
}
}else{
_735=false;
}
if(!_735){
_72e.setAttribute("canSort","false");
}
_72e.setAttribute("contextAugmented","true");
};
CSelectionController.prototype.selectionsInSameDataContainer=function(){
try{
var _746=this.getAllSelectedObjects();
var _747=_746[0].getLayoutElementId();
for(var _748=1;_748<_746.length;_748++){
if(_747!=_746[_748].getLayoutElementId()){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.selectionsFromSameDataItem=function(){
try{
var _749=this.getAllSelectedObjects();
var _74a=_749[0].getDataItems()[0][0];
for(var _74b=1;_74b<_749.length;_74b++){
if(_74a!=_749[_74b].getDataItems()[0][0]){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.isRelational=function(_74c){
try{
if(!_74c){
var _74d=this.getAllSelectedObjects()[0];
_74c=_74d.getSelectedContextIds();
}
for(var _74e=0;_74e<_74c.length;_74e++){
for(var _74f=0;_74f<_74c[_74e].length;_74f++){
var ctx=_74c[_74e][_74f];
var mun=this.getMun(ctx);
var lun=this.getLun(ctx);
var hun=this.getHun(ctx);
if(mun!=null&&typeof mun!="undefined"&&mun.length>0){
return false;
}
if(lun!=null&&typeof lun!="undefined"&&lun.length>0){
return false;
}
if(hun!=null&&typeof hun!="undefined"&&hun.length>0){
return false;
}
}
}
return true;
}
catch(e){
return true;
}
return true;
};
CSelectionController.prototype.getDataContainerType=function(){
try{
if(!this.getAllSelectedObjects()[0]){
return "";
}
return this.getAllSelectedObjects()[0].m_dataContainerType;
}
catch(e){
return "";
}
};
CSelectionController.prototype.areSelectionsColumnRowTitles=function(){
try{
var _754=this.getAllSelectedObjects();
for(var _755=0;_755<_754.length;_755++){
var _756=_754[_755];
if(_756.getLayoutType()!="columnTitle"||_756.isHomeCell()){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.selectionsAreMeasures=function(){
try{
var _757=this.getAllSelectedObjects();
for(var _758=0;_758<_757.length;_758++){
var _759=_757[_758];
if(this.getUsageInfo(_759.getSelectedContextIds()[0][0])!=this.c_usageMeasure){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.selectionsNonMeasureWithMUN=function(){
var _75a=this.getAllSelectedObjects();
if(_75a.length==0){
return false;
}
for(var _75b=0;_75b<_75a.length;_75b++){
var _75c=_75a[0];
if(_75c.getSelectedContextIds().length==0){
return false;
}
var _75d=_75c.getSelectedContextIds()[0][0];
var mun=this.getMun(_75d);
var _75f=this.getUsageInfo(_75d);
if(mun==null||typeof mun=="undefined"||mun.length==0||_75f==this.c_usageMeasure){
return false;
}
}
return true;
};
CSelectionController.prototype.areSelectionsMeasureOrCalculation=function(){
var _760=this.getAllSelectedObjects();
if(_760.length==0){
return false;
}
var _761=this.selectionsHaveCalculationMetadata();
for(var _762=0;_762<_760.length;_762++){
var _763=_760[_762];
var _764=_763.getSelectedContextIds()[0][0];
if(!this.isCalculationOrMeasure(_764,_761)){
return false;
}
}
return true;
};
CSelectionController.prototype.selectionsHaveCalculationMetadata=function(){
try{
var _765=this.getDataContainerType();
var _766=this.getAllSelectedObjects();
for(var _767=0;_767<_766.length;_767++){
var _768=_766[_767];
var _769=_768.getSelectedContextIds();
var _76a=_769[0][0];
var sHun=this.getHun(_76a);
if(!this.hasCalculationMetadata(_76a,_769,_765)){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.isCalculationOrMeasure=function(_76c,_76d){
var mun=this.getMun(_76c);
var _76f=this.getUsageInfo(_76c);
if(!(((mun==null||typeof mun=="undefined"||mun.length==0)&&_76d)||_76f==this.c_usageMeasure)){
return false;
}
return true;
};
CSelectionController.prototype.hasCalculationMetadata=function(_770,_771,_772){
var sHun=this.getHun(_770);
if(this.getUsageInfo(_770)!=this.c_usageMeasure){
if((this.isRelational(_771)&&this.getQueryModelId(_770)!=null)||(!this.isRelational(_771)&&_772=="list"&&(sHun&&sHun!=""))){
return false;
}
}
return true;
};
CSelectionController.prototype.selectionsAreDateTime=function(){
try{
var _774=this.getAllSelectedObjects();
for(var _775=0;_775<_774.length;_775++){
var _776=_774[_775];
var _777=_776.getSelectedContextIds();
var _778=_777[0][0];
var _779=this.getDataType(_778);
if(_779&&typeof this.m_ccl_dateTypes[_779]!=="undefined"){
return true;
}
}
}
catch(e){
return false;
}
return false;
};
CSelectionController.prototype.getSelectedObjectsJsonContext=function(){
try{
var _77a=this.getAllSelectedObjects();
if(_77a===null||_77a.length<=0){
return null;
}
var _77b=this.m_oCognosViewer.getModelPath();
var _77c=[];
for(var i=0;i<_77a.length;i++){
var obj=_77a[i].getContextJsonObject(this,_77b);
_77c.push(obj);
}
return _77c;
}
catch(e){
}
};
CSelectionController.prototype.destroy=function(){
delete this.m_oCognosViewer;
delete this.m_aCutColumns;
delete this.m_aSelectedObjects;
delete this.m_selectedClass;
delete this.m_cutClass;
if(this.m_oObserver&&this.m_oObserver.destroy){
this.m_oObserver.destroy();
}
delete this.m_oObserver;
delete this.m_aReportMetadataArray;
delete this.m_aReportContextDataArray;
if(this.m_oCDManager&&this.m_oCDManager.destroy){
this.m_oCDManager.destroy();
}
delete this.m_oCDManager;
if(this.m_oSelectionObjectFactory&&this.m_oSelectionObjectFactory.destroy){
this.m_oSelectionObjectFactory.destroy();
}
delete this.m_oSelectionObjectFactory;
delete this.m_selectedChartArea;
delete this.m_selectedChartNodes;
delete this.m_selectionContainerMap;
delete this.m_chartHelpers;
delete this.m_oJsonForMarshal;
if(this.hasSavedSelections()){
this.clearSavedSelections();
}
};
function clearTextSelection(_77f){
if(!_77f){
_77f=document;
}
try{
if(typeof _77f.selection=="object"&&_77f.selection!==null){
_77f.selection.empty();
}else{
if(typeof window.getSelection=="function"&&typeof window.getSelection()=="object"&&window.getSelection()!==null){
window.getSelection().removeAllRanges();
}
}
}
catch(e){
}
};
function CtxArrayPlaceHolder(){
};
var self=window;
function CDrillManager(oCV){
this.m_drawDrillTargets=false;
this.setCV(oCV);
};
CDrillManager.prototype=new CViewerHelper();
CDrillManager.prototype.getSelectionController=function(){
var _781;
try{
_781=getCognosViewerSCObjectRef(this.getCV().getId());
}
catch(e){
_781=null;
}
return _781;
};
CDrillManager.prototype.getSelectedObject=function(){
var _782=this.getSelectionController();
if(_782==null){
return null;
}
var _783=null;
var _784=null;
if(_782.hasSelectedChartNodes()){
_784=_782.getSelectedChartNodes();
}else{
_784=_782.getSelections();
}
if(_784&&_784.length==1){
_783=_784[0];
}
return _783;
};
CDrillManager.prototype.canDrillUp=function(){
if(this.getDrillOption("drillUp")==true&&this.hasMuns()){
return true;
}
return false;
};
CDrillManager.prototype.canDrillDown=function(){
if(this.getDrillOption("drillDown")==true){
return true;
}
return false;
};
CDrillManager.prototype.hasMuns=function(_785){
if(typeof _785=="undefined"){
_785=this.getSelectedObject();
}
if(_785==null){
return false;
}
var _786=_785.getMuns();
var muns="";
for(var _788=0;_788<_786.length&&muns=="";++_788){
if(typeof _786[_788][0]!="undefined"){
muns+=_786[_788][0];
}
}
return (muns!="");
};
CDrillManager.prototype.getRefQuery=function(){
var _789="";
var _78a=this.getSelectedObject();
if(_78a==null){
return "";
}
var _78b=_78a.getRefQueries();
for(var i=0;i<_78b.length;i++){
if(_78b[i]!=null){
for(var j=0;j<_78b[i].length;j++){
if(_78b[i][j]!=null&&_78b[i][j]!=""){
return _78b[i][j];
}
}
}
}
return _789;
};
CDrillManager.prototype.isIsolated=function(){
var _78e=this.getSelectionController();
if(_78e==null||_78e.getDrillUpDownEnabled()==false){
return false;
}
var _78f=this.getSelectedObject();
if(_78f==null){
return false;
}
if(_78f instanceof CSelectionChartObject&&_78e!=null){
var _790=_78f.getArea();
if(_790!=null){
var _791=_790.getAttribute("isolated");
if(typeof _791!="undefined"&&_791!=null&&_791=="true"){
return true;
}
}
}else{
var _792=_78f.getCellRef();
if(typeof _792=="object"&&_792!=null){
var _793=_792.getElementsByTagName("span");
if(_793!=null&&typeof _793!="undefined"&&_793.length>0){
var _794=_793[0].getAttribute("isolated");
if(_794!=null&&_794!="undefined"&&_794=="true"){
return true;
}
}
}
}
return false;
};
CDrillManager.prototype.getDrillOption=function(_795){
var _796=this.getSelectionController();
if(_796==null||_796.getDrillUpDownEnabled()==false||typeof _795=="undefined"){
return false;
}
var _797=this.getSelectedObject();
if(_797==null){
return false;
}
if(this.isIsolated()){
if(_795=="drillDown"){
return false;
}else{
if(_795=="drillUp"){
return true;
}
}
}
if(_795=="drillDown"){
if(_797 instanceof CSelectionChartObject&&_796!=null){
var _798=_797.getArea();
if(_798!=null){
var _799=_798.getAttribute("isChartTitle");
if(typeof _799!="undefined"&&_799!=null&&_799=="true"){
return false;
}
}
}
}
var _79a=_797.getDrillOptions();
var _79b=(typeof DrillContextMenuHelper!=="undefined"&&DrillContextMenuHelper.needsDrillSubMenu(this.m_oCV));
for(var idx=0;idx<_79a.length;++idx){
var _79d=(_79b)?_79a[idx].length:1;
for(var _79e=0;_79e<_79d;++_79e){
var _79f=_79a[idx][_79e];
if(_79f=="3"){
return true;
}else{
if(_795=="drillUp"&&_79f=="1"){
return true;
}else{
if(_795=="drillDown"&&_79f=="2"){
return true;
}
}
}
}
}
return false;
};
CDrillManager.prototype.canDrillThrough=function(){
var _7a0=this.getSelectionController();
if(_7a0==null||_7a0.getModelDrillThroughEnabled()==false){
return false;
}
return true;
};
CDrillManager.prototype.singleClickDrillEvent=function(evt,app){
var _7a3=this.getSelectionController();
if(_7a3!=null){
if(this.getCV().bCanUseCognosViewerSelection==true){
_7a3.pageClicked(evt);
}
}
var node=getCrossBrowserNode(evt);
try{
if(node.className&&node.className.indexOf("dl")==0){
if(this.canDrillDown()){
this.singleClickDrillDown(evt,app);
return true;
}else{
if(this.canDrillUp()){
this.singleClickDrillUp(evt,app);
return true;
}
}
}
}
catch(e){
}
if(app=="RV"){
return this.getDrillThroughParameters("execute",evt);
}
return false;
};
CDrillManager.prototype.singleClickDrillDown=function(evt,app){
if(app=="QS"){
this.qsDrillDown();
}else{
this.rvDrillDown();
}
};
CDrillManager.prototype.singleClickDrillUp=function(evt,app){
if(app=="QS"){
this.qsDrillUp();
}else{
this.rvDrillUp();
}
};
CDrillManager.prototype.getDrillParameters=function(_7a9,_7aa,_7ab,_7ac){
var _7ad=[];
var _7ae=this.getSelectedObject();
if(_7ae==null){
return _7ad;
}
if(typeof _7aa=="undefined"){
_7aa=true;
}
var _7af=_7ae.getDataItems();
var _7b0=_7ae.getMuns();
var _7b1=_7ae.getDimensionalItems("lun");
var _7b2=_7ae.getDimensionalItems("hun");
var _7b3=_7ae.getDrillOptions();
if(typeof _7af=="undefined"||typeof _7b0=="undefined"||typeof _7b3=="undefined"||_7b0==null||_7af==null||_7b3==null){
return _7ad;
}
if(_7b0.length!=_7af.length){
return _7ad;
}
var _7b4=_7b0.length;
for(var _7b5=0;_7b5<_7b4;++_7b5){
if(_7af[_7b5].length!=0){
var _7b6=(_7ac)?this.findUserSelectedDrillItem(_7ac,_7af[_7b5]):0;
if(_7b6<0){
continue;
}
if((_7ab===true)||this.getDrillOption(_7a9)){
if(_7b0[_7b5][_7b6]==""||_7ad.toString().indexOf(_7b0[_7b5][_7b6],0)==-1){
_7ad[_7ad.length]=_7af[_7b5][_7b6];
_7ad[_7ad.length]=_7b0[_7b5][_7b6];
if(_7aa===true){
_7ad[_7ad.length]=_7b1[_7b5][_7b6];
_7ad[_7ad.length]=_7b2[_7b5][_7b6];
}
}
}
}
}
return _7ad;
};
CDrillManager.prototype.findUserSelectedDrillItem=function(_7b7,_7b8){
for(var _7b9=0;_7b9<_7b8.length;++_7b9){
if(_7b7==_7b8[_7b9]){
return _7b9;
}
}
return -1;
};
CDrillManager.prototype.getModelDrillThroughContext=function(_7ba){
var _7bb="";
if(this.canDrillThrough()===true){
if(typeof gUseNewSelectionContext=="undefined"){
var _7bc="";
if(typeof getConfigFrame!="undefined"){
_7bc=decodeURIComponent(getConfigFrame().cfgGet("PackageBase"));
}else{
if(this.getCV().getModelPath()!==""){
_7bc=this.getCV().getModelPath();
}
}
_7bb=getViewerSelectionContext(this.getSelectionController(),new CSelectionContext(_7bc));
}else{
var _7bd=new CParameterValues();
var _7be=this.getSelectionController();
if(_7be){
var _7bf=_7be.getAllSelectedObjects();
for(var _7c0=0;_7c0<_7bf.length;++_7c0){
var _7c1=_7bf[_7c0];
var _7c2=_7c1.getMuns();
var _7c3=_7c1.getMetadataItems();
var _7c4=_7c1.getUseValues();
for(var _7c5=0;_7c5<_7c3.length;++_7c5){
for(var idx=0;idx<_7c3[_7c5].length;++idx){
if(_7c3[_7c5][idx]==null||_7c3[_7c5][idx]==""){
continue;
}
var name=_7c3[_7c5][idx];
var _7c8;
if(_7c2[_7c5][idx]!=null&&_7c2[_7c5][idx]!=""){
_7c8=_7c2[_7c5][idx];
}else{
_7c8=_7c4[_7c5][idx];
}
var _7c9=_7c4[_7c5][idx];
_7bd.addSimpleParmValueItem(name,_7c8,_7c9,"true");
}
}
}
}
var _7ca=_7ba.XMLBuilderCreateXMLDocument("context");
_7bb=_7bd.generateXML(_7ba,_7ca);
}
}
return _7bb;
};
CDrillManager.prototype.rvDrillUp=function(_7cb){
this.getCV().executeAction("DrillUp",_7cb);
};
CDrillManager.prototype.rvDrillDown=function(_7cc){
this.getCV().executeAction("DrillDown",_7cc);
};
CDrillManager.prototype.rvBuildXMLDrillParameters=function(_7cd,_7ce){
var _7cf=this.getDrillParameters(_7cd,true,false,_7ce);
if(_7cf.length==0){
return drillParams;
}
return this.buildDrillParametersSpecification(_7cf);
};
CDrillManager.prototype.buildDrillParametersSpecification=function(_7d0){
var _7d1="<DrillParameters>";
var idx=0;
while(idx<_7d0.length){
_7d1+="<DrillGroup>";
_7d1+="<DataItem>";
_7d1+=sXmlEncode(_7d0[idx++]);
_7d1+="</DataItem>";
_7d1+="<MUN>";
_7d1+=sXmlEncode(_7d0[idx++]);
_7d1+="</MUN>";
_7d1+="<LUN>";
_7d1+=sXmlEncode(_7d0[idx++]);
_7d1+="</LUN>";
_7d1+="<HUN>";
_7d1+=sXmlEncode(_7d0[idx++]);
_7d1+="</HUN>";
_7d1+="</DrillGroup>";
}
_7d1+="</DrillParameters>";
return _7d1;
};
CDrillManager.prototype.getAuthoredDrillsForCurrentSelection=function(){
var _7d3=null;
var _7d4=this.getAuthoredDrillThroughTargets();
if(_7d4.length>0){
var _7d5="<AuthoredDrillTargets>";
for(var _7d6=0;_7d6<_7d4.length;++_7d6){
_7d5+=eval("\""+_7d4[_7d6]+"\"");
}
_7d5+="</AuthoredDrillTargets>";
var cv=this.getCV();
var _7d8=cv.getAction("AuthoredDrill");
var _7d9=cv.getDrillTargets();
if(_7d9.length>0){
_7d3=_7d8.getAuthoredDrillThroughContext(_7d5,_7d9);
}
}
return _7d3;
};
CDrillManager.prototype.getAuthoredDrillsForGotoPage=function(){
var _7da="";
var _7db=this.getAuthoredDrillsForCurrentSelection();
if(_7db){
_7da=XMLBuilderSerializeNode(_7db);
}
return _7da;
};
CDrillManager.prototype.launchGoToPage=function(_7dc,_7dd){
var _7de=this.getSelectionController();
if((_7de!=null&&_7de.getModelDrillThroughEnabled()==true)||(typeof _7dc!="undefined"&&_7dc!=null&&_7dc!="")){
var _7df=this.getAuthoredDrillsForGotoPage();
var _7e0=this.getModelDrillThroughContext(self);
var form=document.getElementById("drillForm");
if(form!=null){
document.body.removeChild(form);
}
form=document.createElement("form");
var cvid=this.getCVId();
var _7e3=document.forms["formWarpRequest"+cvid];
form.setAttribute("id","drillForm");
form.setAttribute("name","drillForm");
form.setAttribute("target",_7e3.getAttribute("target"));
form.setAttribute("method","post");
form.setAttribute("action",_7e3.getAttribute("action"));
form.style.display="none";
document.body.appendChild(form);
if(this.getCV().getModelPath()!==""){
form.appendChild(createHiddenFormField("modelPath",this.getCV().getModelPath()));
}
if(typeof _7e3["ui.object"]!="undefined"&&_7e3["ui.object"].value!=""){
form.appendChild(createFormField("drillSource",_7e3["ui.object"].value));
}else{
if(typeof this.getCV().envParams["ui.spec"]!="undefined"){
form.appendChild(createFormField("sourceSpecification",this.getCV().envParams["ui.spec"]));
}
}
if(_7df!=""){
form.appendChild(createHiddenFormField("m","portal/drillthrough.xts"));
form.appendChild(createFormField("invokeGotoPage","true"));
form.appendChild(createFormField("m","portal/drillthrough.xts"));
form.appendChild(createFormField("modelDrillEnabled",_7de.getModelDrillThroughEnabled()));
if(typeof gUseNewSelectionContext=="undefined"){
form.appendChild(createFormField("newSelectionContext","true"));
}
}else{
if(typeof gUseNewSelectionContext=="undefined"){
form.appendChild(createHiddenFormField("m","portal/goto2.xts"));
}else{
form.appendChild(createHiddenFormField("m","portal/goto.xts"));
}
}
form.appendChild(createHiddenFormField("b_action","xts.run"));
form.appendChild(createHiddenFormField("drillTargets",_7df));
if(typeof gUseNewSelectionContext=="undefined"){
form.appendChild(createHiddenFormField("drillContext",_7e0));
}else{
form.appendChild(createHiddenFormField("modeledDrillthru",_7e0));
}
form.appendChild(createHiddenFormField("errURL","javascript:window.close();"));
if(typeof _7dd!="undefined"&&_7dd==true){
form.appendChild(this.createFormField("directLaunch","true"));
}
var _7e4="";
if(this.getCV().envParams["ui.routingServerGroup"]){
_7e4=this.getCV().envParams["ui.routingServerGroup"];
}
form.appendChild(createHiddenFormField("ui.routingServerGroup",_7e4));
if(this.getCV().getExecutionParameters()!=""){
form.appendChild(createHiddenFormField("encExecutionParameters",this.getCV().getExecutionParameters()));
}
if(_7e3.lang&&_7e3.lang.value!=""){
form.appendChild(createHiddenFormField("lang",_7e3.lang.value));
}
if(!this.getCV()||!this.getCV().launchGotoPageForIWidgetMobile(drillForm)){
if(typeof this.getCV().launchGotoPage==="function"){
this.getCV().launchGotoPage(form);
}else{
var _7e5="winNAT_"+(new Date()).getTime();
var _7e6=this.getCV().getWebContentRoot()+"/rv/blankDrillWin.html?cv.id="+cvid;
window.open(_7e6,_7e5,"toolbar,location,status,menubar,resizable,scrollbars=1");
form.target=_7e5;
}
}
}
};
CDrillManager.prototype.buildSearchPageXML=function(_7e7,pkg,_7e9,_7ea,_7eb,_7ec,_7ed){
var _7ee=null;
if(typeof _7e7.XMLElement=="function"){
_7ee=_7e7.XMLBuilderCreateXMLDocument("cognosSearch");
_7e7.XMLBuilderSetAttributeNodeNS(_7ee.documentElement,"xmlns:cs","http://developer.cognos.com/schemas/cs/1/");
var _7ef=_7ee.createElement("package");
if(typeof pkg=="string"&&pkg!==""){
_7ef.appendChild(_7ee.createTextNode(pkg));
}
_7ee.documentElement.appendChild(_7ef);
var _7f0=_7ee.createElement("model");
if(typeof _7e9=="string"&&_7e9!==""){
_7f0.appendChild(_7ee.createTextNode(_7e9));
}
_7ee.documentElement.appendChild(_7f0);
var _7f1=_7ee.createElement("selectedContext");
_7e7.XMLBuilderSetAttributeNodeNS(_7f1,"xmlns:xs","http://www.w3.org/2001/XMLSchema");
_7e7.XMLBuilderSetAttributeNodeNS(_7f1,"xmlns:bus","http://developer.cognos.com/schemas/bibus/3/");
_7e7.XMLBuilderSetAttributeNodeNS(_7f1,"SOAP-ENC:arrayType","bus:parameterValue[]","http://schemas.xmlsoap.org/soap/encoding/");
_7e7.XMLBuilderSetAttributeNodeNS(_7f1,"xmlns:xsd","http://www.w3.org/2001/XMLSchema");
_7e7.XMLBuilderSetAttributeNodeNS(_7f1,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_7ee.documentElement.appendChild(_7f1);
for(var _7f2 in _7ea){
var _7f3=_7ee.createElement("item");
_7e7.XMLBuilderSetAttributeNodeNS(_7f3,"xsi:type","bus:parameterValue","http://www.w3.org/2001/XMLSchema-instance");
var _7f4=_7e7.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:name",_7ee);
_7e7.XMLBuilderSetAttributeNodeNS(_7f4,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_7f4.appendChild(_7ee.createTextNode(_7ea[_7f2].name));
var _7f5=_7e7.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:value",_7ee);
_7e7.XMLBuilderSetAttributeNodeNS(_7f5,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_7e7.XMLBuilderSetAttributeNodeNS(_7f5,"SOAP-ENC:arrayType","bus:parmValueItem[]","http://schemas.xmlsoap.org/soap/encoding/");
for(var j=0;j<_7ea[_7f2].values.length;j++){
var _7f7=_7ee.createElement("item");
_7e7.XMLBuilderSetAttributeNodeNS(_7f7,"xsi:type","bus:simpleParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
var _7f8=_7e7.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:use",_7ee);
_7e7.XMLBuilderSetAttributeNodeNS(_7f8,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_7f8.appendChild(_7ee.createTextNode(_7ea[_7f2].values[j][0]));
var _7f9=_7e7.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:display",_7ee);
_7e7.XMLBuilderSetAttributeNodeNS(_7f9,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
var _7fa=_7ea[_7f2].values[j][1]==null?"":_7ea[_7f2].values[j][1];
_7f9.appendChild(_7ee.createTextNode(_7fa));
_7f7.appendChild(_7f8);
_7f7.appendChild(_7f9);
_7f5.appendChild(_7f7);
}
_7f3.appendChild(_7f4);
_7f3.appendChild(_7f5);
_7f1.appendChild(_7f3);
}
var _7fb=_7ee.createElement("defaultMeasure");
_7ee.documentElement.appendChild(_7fb);
_7ec.buildXML(_7e7,_7ee,"data");
var _7fc=_7ee.createElement("filter");
_7ee.documentElement.appendChild(_7fc);
}
return _7ee;
};
CDrillManager.prototype.openSearchPage=function(_7fd,_7fe){
this.getModelDrillThroughContext(self);
var _7ff=document.getElementById("searchPage");
if(_7ff!=null){
document.body.removeChild(_7ff);
}
_7ff=document.createElement("form");
_7ff.setAttribute("id","searchPage");
_7ff.setAttribute("name","searchPage");
_7ff.setAttribute("method","post");
_7ff.setAttribute("target",_7ff.name);
_7ff.setAttribute("action",this.getCV().getGateway()+"/gosearch");
_7ff.style.display="none";
document.body.appendChild(_7ff);
_7ff.appendChild(createHiddenFormField("csn.action","search"));
_7ff.appendChild(createHiddenFormField("csn.drill",_7fe));
var _800=window.open("",_7ff.name,"directories=no,location=no,status=no,toolbar=no,resizable=yes,scrollbars=yes,top=100,left=100,height=480,width=640");
_800.focus();
_7ff.submit();
};
CDrillManager.prototype.launchSearchPage=function(){
var _801=this.getSelectionController();
var _802=document.forms["formWarpRequest"+this.getCVId()];
var _803=this.determineSelectionsForSearchPage(_801);
var _804=this.getSearchContextDataSpecfication(_801);
var _805=this.buildSearchPageXML(self,_802.packageBase.value,this.getCV().getModelPath(),_803,[],_804,[]);
this.openSearchPage(_802.packageBase.value,XMLBuilderSerializeNode(_805));
};
CDrillManager.prototype.qsDrillDown=function(){
if(!this.canDrillDown()){
getConfigFrame().dlgGenericSelectionMessage(false);
return;
}
var _806="DD:";
this.qsSendDrillCommand(_806);
};
CDrillManager.prototype.qsDrillUp=function(){
if(!this.canDrillUp()){
getConfigFrame().dlgGenericSelectionMessage(false);
return;
}
var _807="DU:";
this.qsSendDrillCommand(_807);
};
CDrillManager.prototype.qsSendDrillCommand=function(_808){
var _809;
if(_808=="DU:"){
_809="drillUp";
}else{
_809="drillDown";
}
var _80a=this.getDrillParameters(_809,false,false);
if(_80a.length==0){
getConfigFrame().dlgGenericSelectionMessage(false);
return;
}
for(var idx=0;idx<_80a.length;++idx){
_808+=getConfigFrame().escapeParam(_80a[idx]);
if(idx+1<_80a.length){
_808+=",";
}
}
getConfigFrame().sendCmd(_808,"",true);
};
CDrillManager.prototype.qsLaunchGoToPage=function(_80c){
var _80d=this.getSelectionController();
if(_80d!=null&&_80d.getModelDrillThroughEnabled()==true){
var _80e=this.getModelDrillThroughContext(cf);
if(_80e==""){
getConfigFrame().dlgGenericSelectionMessage(false);
return;
}
var _80f=document.getElementById("gotoPage");
if(_80f!=null){
document.body.removeChild(_80f);
}
_80f=document.createElement("form");
_80f.setAttribute("id","gotoPage");
_80f.setAttribute("name","gotoPage");
_80f.setAttribute("method","post");
_80f.style.display="none";
document.body.appendChild(_80f);
var _810=getConfigFrame();
_80f.appendChild(this.createFormField("objpath",decodeURIComponent(_810.cfgGet("PackageBase"))));
if(typeof gUseNewSelectionContext=="undefined"){
_80f.appendChild(this.createFormField("m","portal/goto2.xts"));
}else{
_80f.appendChild(this.createFormField("m","portal/goto.xts"));
}
_80f.appendChild(this.createFormField("b_action","xts.run"));
if(typeof gUseNewSelectionContext=="undefined"){
_80f.appendChild(this.createFormField("drillContext",_80e));
}else{
_80f.appendChild(this.createFormField("modeledDrillthru",_80e));
}
if(typeof getConfigFrame().routingServerGroup!="undefined"){
_80f.appendChild(this.createFormField("ui.routingServerGroup",getConfigFrame().routingServerGroup));
}
if(typeof _80c!="undefined"&&_80c==true){
_80f.appendChild(this.createFormField("directLaunch","true"));
}
var _811=_810.goApplicationManager.getReportManager().getParameterManager().getExecutionParameters();
if(_811){
_80f.appendChild(this.createFormField("encExecutionParameters",_811));
}
var _812="winNAT_"+(new Date()).getTime();
var _813=this.getCV().getWebContentRoot()+"/rv/blankDrillWin.html?cv.id="+this.getCVId();
window.open(_813,_812,"toolbar,location,status,menubar,resizable,scrollbars=1");
_80f.target=_812;
}
};
CDrillManager.prototype.qsLaunchSearchPage=function(){
var cf=getConfigFrame();
var _815=goWindowManager.getSelectionController();
var _816=this.determineSelectionsForSearchPage(_815);
var _817=this.getSearchContextDataSpecfication(_815);
var _818=decodeURIComponent(cf.cfgGet("PackageBase"));
var _819=this.buildSearchPageXML(cf,_818,decodeURIComponent(cf.cfgGet("cmLastModel")),_816,[],_817,[]);
this.openSearchPage(_818,cf.XMLBuilderSerializeNode(_819));
};
CDrillManager.prototype.determineSelectionsForSearchPage=function(_81a){
var _81b=new CtxArrayPlaceHolder();
var _81c=_81a.getAllSelectedObjects();
for(var i=0;i<_81c.length;i++){
var _81e=_81c[i].getColumnName();
if(!this.containsByIndiceInArray(_81b,_81e)){
_81b[_81e]={};
_81b[_81e].name=_81e;
_81b[_81e].values=[];
}
var idx0="";
var muns=_81c[i].getMuns();
if(muns!=null&&muns.length>0){
idx0=muns[0][0];
}
var idx1=_81c[i].getDisplayValues()[0];
if(!(this.containsInArray(_81b[_81e].values,0,idx0)&&this.containsInArray(_81b[_81e].values,1,idx1))){
_81b[_81e].values[_81b[_81e].values.length]=[idx0,idx1];
}
}
return _81b;
};
CDrillManager.prototype.getSearchContextDataSpecfication=function(_822){
var _823=new CParameterValues();
var _824=_822.getCCDManager();
var _825=_824.m_cd;
for(var _826 in _825){
var _827=_824.GetUsage(_826);
if(_827!="2"){
var _828=_824.GetRDIValue(_826);
var _829=_824.GetDisplayValue(_826);
_823.addSimpleParmValueItem(_828,_828,_829,"true");
}
}
return _823;
};
CDrillManager.prototype.containsByIndiceInArray=function(a,v){
for(var i in a){
if(i==v){
return true;
}
}
return false;
};
CDrillManager.prototype.containsInArray=function(a,idx,v){
for(var i in a){
if(a[i][idx]==v){
return true;
}
}
return false;
};
CDrillManager.prototype.createFormField=function(name,_832){
var _833=document.createElement("input");
_833.setAttribute("type","hidden");
_833.setAttribute("name",name);
_833.setAttribute("value",_832);
return (_833);
};
CDrillManager.prototype.getAuthoredDrillThroughTargets=function(){
var _834=[];
var _835=this.getSelectionController();
var _836=null;
if(_835!=null){
if(_835.getSelectedColumnIds().length==1){
var _837=_835.getSelections();
for(var _838=0;_838<_837.length;++_838){
var _839=_837[_838];
_836=_839.getCellRef();
while(_836){
if(_836.getAttribute("dtTargets")!=null){
_834.push("<rvDrillTargets>"+_836.getAttribute("dtTargets")+"</rvDrillTargets>");
break;
}
_836=XMLHelper_GetFirstChildElement(_836);
}
}
}else{
if(_835.hasSelectedChartNodes()){
var _83a=_835.getSelectedChartNodes();
var _83b=_83a[0];
_836=_83b.getArea();
if(_836.getAttribute("dtTargets")!=null){
_834.push("<rvDrillTargets>"+_836.getAttribute("dtTargets")+"</rvDrillTargets>");
}
}else{
if(_835.getSelectedDrillThroughImage()!=null){
var _83c=_835.getSelectedDrillThroughImage();
if(_83c&&_83c.getAttribute("dtTargets")!=null){
_834.push("<rvDrillTargets>"+_83c.getAttribute("dtTargets")+"</rvDrillTargets>");
}
}else{
if(_835.getSelectDrillThroughSingleton()!=null){
var _83d=_835.getSelectDrillThroughSingleton();
if(_83d&&_83d.getAttribute("dtTargets")!=null){
_834.push("<rvDrillTargets>"+_83d.getAttribute("dtTargets")+"</rvDrillTargets>");
}
}
}
}
}
}
return _834;
};
CDrillManager.prototype.getDrillThroughParameters=function(_83e,evt){
if(typeof _83e=="undefined"){
_83e="query";
}
var _840=[];
if(typeof evt!="undefined"){
var _841=getCrossBrowserNode(evt,true);
try{
while(_841){
if(typeof _841.getAttribute!="undefined"&&_841.getAttribute("dtTargets")){
_840.push("<rvDrillTargets>"+_841.getAttribute("dtTargets")+"</rvDrillTargets>");
break;
}
_841=_841.parentNode;
}
}
catch(e){
return false;
}
}else{
var oCV=this.getCV();
var _843=oCV.getDrillMgr();
var _844=_843.getSelectionController();
if(_844!=null){
var _845=null;
if(_844.hasSelectedChartNodes()){
var _846=_844.getSelectedChartNodes();
var _847=_846[0];
_845=_847.getArea();
}
if(_845!=null){
_840.push("<rvDrillTargets>"+_845.getAttribute("dtTargets")+"</rvDrillTargets>");
}else{
_840=this.getAuthoredDrillThroughTargets();
}
}
}
if(_840.length>0){
var _848="<AuthoredDrillTargets>";
for(var _849=0;_849<_840.length;++_849){
_848+=eval("\""+_840[_849]+"\"");
}
_848+="</AuthoredDrillTargets>";
var _84a=this.getCV().getAction("AuthoredDrill");
if(_83e=="query"){
_84a.populateContextMenu(_848);
this.showOtherMenuItems();
}else{
if(this.getCV().envParams["cv.id"]=="AA"){
this.getCV().m_viewerFragment.raiseAuthoredDrillClickEvent();
}else{
_84a.execute(_848);
}
}
return true;
}else{
if(_83e=="query"){
this.showOtherMenuItems();
return true;
}else{
return false;
}
}
};
CDrillManager.prototype.executeAuthoredDrill=function(_84b){
var _84c=decodeURIComponent(_84b);
var _84d=this.getCV().getAction("AuthoredDrill");
_84d.executeDrillTarget(_84c);
};
CDrillManager.prototype.doesMoreExist=function(_84e){
for(var i=0;i<_84e.getNumItems();i++){
var _850=_84e.get(i);
if(_850!=null){
if((_850 instanceof CMenuItem)&&(_850.getLabel()==RV_RES.RV_MORE)&&(_850.getAction()==this.getCVObjectRef()+".getDrillMgr().launchGoToPage();")){
return true;
}
}
}
return false;
};
CDrillManager.prototype.showOtherMenuItems=function(){
var cv=this.getCV();
var _852=cv.rvMainWnd;
var _853=_852.getToolbarControl();
var _854=null;
var _855=null;
if(typeof _853!="undefined"&&_853!=null){
_854=_853.getItem("goto");
if(_854){
_855=_854.getMenu();
}
}
var _856=_852.getContextMenu();
var _857=_852.getUIHide();
var _858=null;
if(typeof _856!="undefined"&&_856!=null&&_856.getGoToMenuItem()){
_858=_856.getGoToMenuItem().getMenu();
}
var _859=null;
var _85a=this.getSelectionController();
if(_855!=null){
if(this.doesMoreExist(_855)==false){
if(typeof gMenuSeperator!="undefined"&&_855.getNumItems()>0&&(cv.bCanUseCognosViewerIndexSearch||_857.indexOf(" RV_TOOLBAR_BUTTONS_GOTO_RELATED_LINKS ")==-1)){
_855.add(gMenuSeperator);
}
var _85b=new CMenuItem(_855,RV_RES.RV_MORE,this.getCVObjectRef()+".getDrillMgr().launchGoToPage();","",gMenuItemStyle,cv.getWebContentRoot(),cv.getSkin());
if(_857.indexOf(" RV_TOOLBAR_BUTTONS_GOTO_RELATED_LINKS ")!=-1){
_85b.hide();
}else{
if(_85a==null||_85a.getModelDrillThroughEnabled()==false){
_85b.disable();
}
}
}
}
if(_858!=null){
if(typeof gMenuSeperator!="undefined"&&_858.getNumItems()>0&&(cv.bCanUseCognosViewerIndexSearch||_857.indexOf(" RV_CONTEXT_MENU_GOTO_RELATED_LINKS ")==-1)){
_858.add(gMenuSeperator);
}
var _85c=new CMenuItem(_858,RV_RES.RV_MORE,this.getCVObjectRef()+".getDrillMgr().launchGoToPage();","",gMenuItemStyle,cv.getWebContentRoot(),cv.getSkin());
if(_857.indexOf(" RV_CONTEXT_MENU_GOTO_RELATED_LINKS ")!=-1){
_85c.hide();
}else{
if(_85a==null||_85a.getModelDrillThroughEnabled()==false){
_85c.disable();
}
}
}
if(_859!=null&&_85a!=null){
var _85d=_85a.getAllSelectedObjects();
if(_85d==null||_85d.length===0){
_859.disable();
}
}
if(_855!=null){
_855.draw();
if(_855.isVisible()){
_855.show();
}
}
if(_858!=null){
_858.draw();
if(_858.isVisible()){
_858.show();
}
}
};
CDrillManager.prototype.ddc=function(evt){
var node=getNodeFromEvent(evt);
if(node!=null&&node.getAttribute("ddc")!=="1"){
node.setAttribute("ddc","1");
if(node.getAttribute("dtTargets")){
node.className="dl "+node.className;
node.setAttribute("href","#");
return;
}
var _860=this.getSelectionController();
if(_860!=null){
var _861=_860.getSelectionObjectFactory().getSelectionChartObject(node);
if(_861!=null){
var _862=_861.getDrillOptions();
for(var idx=0;idx<_862.length;++idx){
var _864=_862[idx][0];
if((node.getAttribute("isChartTitle")==="true"&&_864=="1")||_864=="3"||_864=="2"){
node.className="dl "+node.className;
node.setAttribute("href","#");
break;
}
}
}
}
}
};
function CDrillThroughTarget(_865,_866,_867,_868,_869,path,_86b,_86c,_86d,_86e,_86f,_870){
this.m_label=_865;
this.m_outputFormat=_866;
this.m_outputLocale=_867;
this.m_showInNewWindow=_868;
this.m_method=_869;
this.m_path=path;
this.m_bookmark=_86b;
this.m_parameters=_86c;
this.m_objectPaths=_86d;
this.m_prompt="false";
this.m_dynamicDrillThrough=false;
this.m_parameterProperties=_870;
if(typeof _86e!="undefined"&&_86e!=null){
if(_86e=="yes"){
this.m_prompt="true";
}else{
if(_86e=="target"){
this.m_prompt="";
}
}
}
if(typeof _86f!="undefined"&&_86f!=null){
if(typeof _86f=="string"){
_86f=_86f=="true"?true:false;
}
this.m_dynamicDrillThrough=_86f;
}
};
function CDrillThroughTarget_getParameterProperties(){
return this.m_parameterProperties;
};
function CDrillThroughTarget_getLabel(){
return this.m_label;
};
function CDrillThroughTarget_getOutputFormat(){
return this.m_outputFormat;
};
function CDrillThroughTarget_getOutputLocale(){
return this.m_outputLocale;
};
function CDrillThroughTarget_getShowInNewWindow(){
return this.m_showInNewWindow;
};
function CDrillThroughTarget_getMethod(){
return this.m_method;
};
function CDrillThroughTarget_getPath(){
return this.m_path;
};
function CDrillThroughTarget_getBookmark(){
return this.m_bookmark;
};
function CDrillThroughTarget_getParameters(){
return this.m_parameters;
};
function CDrillThroughTarget_getObjectPaths(){
return this.m_objectPaths;
};
function CDrillThroughTarget_getPrompt(){
return this.m_prompt;
};
function CDrillThroughTarget_isDynamicDrillThrough(){
return this.m_dynamicDrillThrough;
};
CDrillThroughTarget.prototype.getLabel=CDrillThroughTarget_getLabel;
CDrillThroughTarget.prototype.getOutputFormat=CDrillThroughTarget_getOutputFormat;
CDrillThroughTarget.prototype.getOutputLocale=CDrillThroughTarget_getOutputLocale;
CDrillThroughTarget.prototype.getShowInNewWindow=CDrillThroughTarget_getShowInNewWindow;
CDrillThroughTarget.prototype.getMethod=CDrillThroughTarget_getMethod;
CDrillThroughTarget.prototype.getPath=CDrillThroughTarget_getPath;
CDrillThroughTarget.prototype.getBookmark=CDrillThroughTarget_getBookmark;
CDrillThroughTarget.prototype.getParameters=CDrillThroughTarget_getParameters;
CDrillThroughTarget.prototype.getObjectPaths=CDrillThroughTarget_getObjectPaths;
CDrillThroughTarget.prototype.getPrompt=CDrillThroughTarget_getPrompt;
CDrillThroughTarget.prototype.isDynamicDrillThrough=CDrillThroughTarget_isDynamicDrillThrough;
CDrillThroughTarget.prototype.getParameterProperties=CDrillThroughTarget_getParameterProperties;
function sXmlEncode(_871){
var _872=""+_871;
if((_872=="0")||((_871!=null)&&(_871!=false))){
_872=_872.replace(/&/g,"&amp;");
_872=_872.replace(/</g,"&lt;");
_872=_872.replace(/>/g,"&gt;");
_872=_872.replace(/"/g,"&quot;");
_872=_872.replace(/'/g,"&apos;");
}else{
if(_871==null){
_872="";
}
}
return _872;
};
function createFormField(name,_874){
var _875=document.createElement("input");
_875.setAttribute("type","hidden");
_875.setAttribute("name",name);
_875.setAttribute("value",_874);
return (_875);
};
function setBackURLToCloseWindow(_876){
var _877=_876.childNodes;
if(_877){
for(var _878=0;_878<_877.length;++_878){
var _879=_877[_878];
var _87a=_879.getAttribute("name");
if(_87a&&_87a=="ui.backURL"){
_876.removeChild(_879);
}
}
}
_876.appendChild(createFormField("ui.backURL","javascript:window.close();"));
};
function doMultipleDrills(_87b,cvId){
if(parent!=this&&parent.doMultipleDrills){
if(getCVId()!=""&&getCVId()!=cvId){
cvId=getCVId();
}
return parent.doMultipleDrills(_87b,cvId);
}else{
if(window.gViewerLogger){
window.gViewerLogger.log("Drill Targets",_87b,"text");
}
var oCV=null;
try{
oCV=getCognosViewerObjectRef(cvId);
}
catch(exception){
}
var _87e=buildDrillForm(oCV);
addDrillEnvironmentFormFields(_87e,oCV);
if(typeof oCV!="undefined"&&oCV!=null){
var _87f=oCV.getModelPath();
_87e.appendChild(createFormField("modelPath",_87f));
var _880=oCV.getSelectionController();
var _881="";
if(typeof getViewerSelectionContext!="undefined"&&typeof CSelectionContext!="undefined"){
_881=getViewerSelectionContext(_880,new CSelectionContext(_87f));
}
_87e.appendChild(createFormField("drillContext",_881));
_87e.appendChild(createFormField("modelDrillEnabled",_880.getModelDrillThroughEnabled()));
if(typeof document.forms["formWarpRequest"+oCV.getId()]["ui.object"]!="undefined"&&document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value!=""){
_87e.appendChild(createFormField("drillSource",document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value));
}else{
if(typeof oCV.envParams["ui.spec"]!="undefined"){
_87e.appendChild(createFormField("sourceSpecification",oCV.envParams["ui.spec"]));
}
}
}
_87e.setAttribute("launchGotoPage","true");
_87e.appendChild(createFormField("drillTargets",_87b));
_87e.appendChild(createFormField("invokeGotoPage","true"));
_87e.appendChild(createFormField("m","portal/drillthrough.xts"));
_87e.appendChild(createFormField("b_action","xts.run"));
var _882="winNAT_"+(new Date()).getTime();
var _883="..";
if(oCV!=null){
_883=oCV.getWebContentRoot();
var _884=oCV.getExecutionParameters();
if(_884!=""){
_87e.appendChild(createFormField("encExecutionParameters",_884));
}
}
if(!oCV||!oCV.launchGotoPageForIWidgetMobile(_87e)){
if(oCV&&typeof oCV.launchGotoPage==="function"){
oCV.launchGotoPage(_87e);
}else{
var _885=_883+"/rv/blankDrillWin.html";
_87e.target=_882;
window.open(_885,_882);
}
}
}
};
function buildDrillForm(oCV){
var _887=document.getElementById("drillForm");
if(_887){
document.body.removeChild(_887);
}
_887=document.createElement("form");
if(typeof oCV!="undefined"&&oCV!=null){
var _888=document.getElementById("formWarpRequest"+oCV.getId());
_887.setAttribute("target",_888.getAttribute("target"));
_887.setAttribute("action",_888.getAttribute("action"));
}else{
_887.setAttribute("action",location.pathname);
}
_887.setAttribute("id","drillForm");
_887.setAttribute("name","drillForm");
_887.setAttribute("method","post");
_887.style.display="none";
document.body.appendChild(_887);
return _887;
};
function addDrillEnvironmentFormFields(_889,oCV){
if(window.g_dfEmail){
_889.appendChild(createFormField("dfemail",window.g_dfEmail));
}
if(oCV!=null){
_889.appendChild(createFormField("cv.id",oCV.getId()));
if(typeof oCV.envParams["ui.sh"]!="undefined"){
_889.appendChild(createFormField("ui.sh",oCV.envParams["ui.sh"]));
}
if(oCV.getViewerWidget()==null){
if(typeof oCV.envParams["cv.header"]!="undefined"){
_889.appendChild(createFormField("cv.header",oCV.envParams["cv.header"]));
}
if(typeof oCV.envParams["cv.toolbar"]!="undefined"){
_889.appendChild(createFormField("cv.toolbar",oCV.envParams["cv.toolbar"]));
}else{
var _88b=oCV.getAdvancedServerProperty("VIEWER_PASS_PORTLET_TOOLBAR_STATE_ON_DRILLTHROUGH");
if(oCV.m_viewerFragment&&_88b!=null&&_88b===true){
var _88c=oCV.m_viewerFragment.canShowToolbar()?"true":"false";
_889.appendChild(createFormField("cv.toolbar",_88c));
}
}
}
if(typeof oCV.envParams["ui.backURL"]!="undefined"){
_889.appendChild(createFormField("ui.backURL",oCV.envParams["ui.backURL"]));
}
if(typeof oCV.envParams["ui.postBack"]!="undefined"){
_889.appendChild(createFormField("ui.postBack",oCV.envParams["ui.postBack"]));
}
if(typeof oCV.envParams["savedEnv"]!="undefined"){
_889.appendChild(createFormField("savedEnv",oCV.envParams["savedEnv"]));
}
if(typeof oCV.envParams["ui.navlinks"]!="undefined"){
_889.appendChild(createFormField("ui.navlinks",oCV.envParams["ui.navlinks"]));
}
if(typeof oCV.envParams["lang"]!="undefined"){
_889.appendChild(createFormField("lang",oCV.envParams["lang"]));
}
if(typeof oCV.envParams["ui.errURL"]!="undefined"){
_889.appendChild(createFormField("ui.errURL",oCV.envParams["ui.errURL"]));
}
var _88d="";
if(oCV.envParams["ui.routingServerGroup"]){
_88d=oCV.envParams["ui.routingServerGroup"];
}
_889.appendChild(createHiddenFormField("ui.routingServerGroup",_88d));
}else{
_889.appendChild(createFormField("cv.header","false"));
_889.appendChild(createFormField("cv.toolbar","false"));
}
};
function appendReportHistoryObjects(oCV,_88f){
if(oCV!=null&&typeof oCV.rvMainWnd!="undefined"&&_88f!=null){
oCV.rvMainWnd.addCurrentReportToReportHistory();
var _890=oCV.rvMainWnd.saveReportHistoryAsXML();
_88f.appendChild(createFormField("cv.previousReports",_890));
}
};
function doSingleDrill(_891,args,_893,_894,_895,_896,_897,_898,cvId,_89a,_89b){
var _89c="";
if(typeof cvId=="string"){
_89c=cvId;
}
var oCV=null;
try{
oCV=getCognosViewerObjectRef(cvId);
}
catch(exception){
}
if(!oCV&&parent!=this&&parent.doSingleDrill){
if(getCVId()!=""&&getCVId()!=cvId){
cvId=getCVId();
}
return parent.doSingleDrill(_891,args,_893,_894,_895,_896,_897,_898,cvId,_89a,_89b);
}else{
if(typeof _893=="undefined"){
_893="default";
}else{
if(_893=="execute"){
_893="run";
}
}
if(_893=="edit"&&oCV!=null&&typeof oCV.m_viewerFragment){
_891="_blank";
}
var _89e=buildDrillForm(oCV);
var _89f="<authoredDrillRequest>";
_89f+="<param name=\"action\">"+sXmlEncode(_893)+"</param>";
_89f+="<param name=\"target\">"+sXmlEncode(args[0][1])+"</param>";
_89f+="<param name=\"format\">"+sXmlEncode(_894)+"</param>";
_89f+="<param name=\"locale\">"+sXmlEncode(_895)+"</param>";
_89f+="<param name=\"prompt\">"+sXmlEncode(_89a)+"</param>";
_89f+="<param name=\"dynamicDrill\">"+sXmlEncode(_89b)+"</param>";
if(typeof oCV!="undefined"&&oCV!=null){
_89f+="<param name=\"sourceTracking\">"+oCV.getTracking()+"</param>";
if(typeof document.forms["formWarpRequest"+oCV.getId()]["ui.object"]!="undefined"){
_89f+="<param name=\"source\">"+sXmlEncode(document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value)+"</param>";
}
var _8a0=oCV.getModelPath();
_89f+="<param name=\"metadataModel\">"+sXmlEncode(_8a0)+"</param>";
_89f+="<param name=\"selectionContext\">"+sXmlEncode(getViewerSelectionContext(oCV.getSelectionController(),new CSelectionContext(_8a0)))+"</param>";
if(typeof document.forms["formWarpRequest"+oCV.getId()]["ui.object"]!="undefined"&&document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value!=""){
_89f+="<param name=\"source\">"+sXmlEncode(document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value)+"</param>";
}else{
if(typeof oCV.envParams["ui.spec"]!="undefined"){
_89f+="<param name=\"sourceSpecification\">"+sXmlEncode(oCV.envParams["ui.spec"])+"</param>";
}
}
}
if(_896!=""){
_89f+="<param name=\"bookmark\">"+_896+"</param>";
}
if(_893!="view"){
if(typeof _897!="undefined"){
_89f+="<param name=\"sourceContext\">"+sXmlEncode(_897)+"</param>";
}
if(typeof _898!="undefined"){
_89f+="<param name=\"objectPaths\">"+sXmlEncode(_898)+"</param>";
}
}
var _8a1=0;
_89f+="<drillParameters>";
var _8a2=[];
for(_8a1=1;_8a1<args.length;_8a1++){
var sSel=args[_8a1][1];
if(_894=="HTML"&&(sSel.indexOf("<selectChoices")==0)){
var _8a4=XMLHelper_GetFirstChildElement(XMLHelper_GetFirstChildElement(XMLBuilderLoadXMLFromString(args[_8a1][1])));
if(_8a4){
var sMun=_8a4.getAttribute("mun");
if(sMun!=null&&sMun!=""){
_8a4.setAttribute("useValue",sMun);
sSel="<selectChoices>"+XMLBuilderSerializeNode(_8a4)+"</selectChoices>";
}
}
}
var _8a6=args[_8a1][0];
var _8a7=false;
for(var i=0;i<_8a2.length;i++){
var _8a9=_8a2[i];
if(_8a9.name===_8a6&&_8a9.value===sSel){
_8a7=true;
break;
}
}
if(!_8a7){
_8a2.push({"name":_8a6,"value":sSel});
_89f+="<param name=\""+sXmlEncode(_8a6)+"\">"+sXmlEncode(sSel)+"</param>";
}
}
_89f+="</drillParameters>";
_89f+=getExecutionParamNode(oCV);
_89f+="</authoredDrillRequest>";
_89e.appendChild(createFormField("authoredDrill.request",_89f));
_89e.appendChild(createFormField("ui.action","authoredDrillThrough2"));
_89e.appendChild(createFormField("b_action","cognosViewer"));
addDrillEnvironmentFormFields(_89e,oCV);
if(!oCV||!oCV.executeDrillThroughForIWidgetMobile(_89e)){
if(oCV&&typeof oCV.sendDrillThroughRequest==="function"){
oCV.sendDrillThroughRequest(_89e);
}else{
if(_891==""&&oCV!=null&&typeof oCV.m_viewerFragment!="undefined"){
oCV.m_viewerFragment.raiseAuthoredDrillEvent(_89f);
}else{
if((oCV!=null&&oCV.getViewerWidget()!=null)||_891!=""){
setBackURLToCloseWindow(_89e);
var _8aa="winNAT_"+(new Date()).getTime();
var _8ab="..";
if(oCV!=null){
_8ab=oCV.getWebContentRoot();
}
var _8ac=_8ab+"/rv/blankDrillWin.html";
if(_89c){
_8ac+="?cv.id="+_89c;
}
if(oCV==null){
_8ac=window.location.href.substring(0,window.location.href.indexOf("/v1"));
_8ac+="/?perspective=classicviewer";
_8ac+="&altDrillFlag=true";
_8ac+="&format="+sXmlEncode(_894);
var _8ad=_89e.getAttribute("name")+Date.now().toString();
_89e.setAttribute("name",_8ad);
if(typeof (Storage)!=="undefined"){
localStorage.setItem(_8ad,_89e.outerHTML);
_8ac+="&drillFormLabel="+_8ad;
}else{
console.log("Sorry! No Web Storage support...");
}
}
if(window.gViewerLogger){
window.gViewerLogger.log("Drill Specification",_89f,"xml");
}
_89e.target=_8aa;
newWindow=window.open(_8ac,_8aa);
}else{
appendReportHistoryObjects(oCV,_89e);
if(window.gViewerLogger){
window.gViewerLogger.log("Drill Specification",_89f,"xml");
}
_89e.target=(oCV&&oCV.getDrillFormTarget)?oCV.getDrillFormTarget():"_self";
_89e.submit();
if(oCV!=null&&!oCV.getDrillFormTarget){
setTimeout(getCognosViewerObjectRefAsString(oCV.getId())+".getRequestIndicator().show()",10);
}
}
}
}
}
}
};
function getExecutionParamNode(oCV){
var _8af="";
if(typeof oCV!="undefined"&&oCV!=null){
var _8b0=oCV.getExecutionParameters();
if(_8b0!=""){
_8af+="<param name=\"executionParameters\">";
_8af+=sXmlEncode(_8b0);
_8af+="</param>";
}
}
return _8af;
};
function doSingleDrillThrough(_8b1,_8b2,cvId){
var _8b4=_8b1[0][0];
if(typeof _8b4=="undefined"||_8b4==null){
return;
}
var _8b5=cvId&&window[cvId+"drillTargets"]?window[cvId+"drillTargets"][_8b4]:drillTargets[_8b4];
if(typeof _8b5=="undefined"){
return;
}
if(_8b2!=""&&_8b5.getPath()==""){
document.location="#"+_8b2;
}else{
var args=[];
args[args.length]=["ui.object",_8b5.getPath()];
for(var _8b7=1;_8b7<_8b1.length;++_8b7){
args[args.length]=_8b1[_8b7];
}
var _8b8="";
if(_8b5.getShowInNewWindow()=="true"){
_8b8="_blank";
}
var _8b9=_8b5.getParameters();
var _8ba=_8b5.getObjectPaths();
var _8bb=cvId;
if(!cvId){
_8bb=getCVId();
}
doSingleDrill(_8b8,args,_8b5.getMethod(),_8b5.getOutputFormat(),_8b5.getOutputLocale(),_8b2,_8b9,_8ba,_8bb,_8b5.getPrompt(),false);
}
};
function getCVId(){
var _8bc="";
try{
_8bc=this.frameElement.id.substring("CVIFrame".length);
}
catch(exception){
}
return _8bc;
};
function doMultipleDrillThrough(_8bd,cvId){
var _8bf="<rvDrillTargets>";
for(var _8c0=0;_8c0<_8bd.length;++_8c0){
var _8c1=_8bd[_8c0];
if(_8c1.length<3){
continue;
}
var _8c2=_8c1[0];
if(typeof _8c2=="undefined"||_8c2==null){
continue;
}
var _8c3=_8c1[1];
if(typeof _8c3=="undefined"||_8c3==null){
continue;
}
var _8c4=cvId&&window[cvId+"drillTargets"]?window[cvId+"drillTargets"][_8c2]:drillTargets[_8c2];
if(typeof _8c4=="undefined"||_8c4==null){
continue;
}
if(_8c3===null||_8c3===""){
_8c3=_8c4.getLabel();
}
_8bf+="<drillTarget ";
_8bf+="outputFormat=\"";
_8bf+=_8c4.getOutputFormat();
_8bf+="\" ";
_8bf+="outputLocale=\"";
_8bf+=_8c4.getOutputLocale();
_8bf+="\" ";
_8bf+="label=\"";
_8bf+=sXmlEncode(_8c3);
_8bf+="\" ";
_8bf+="path=\"";
_8bf+=sXmlEncode(_8c4.getPath());
_8bf+="\" ";
_8bf+="showInNewWindow=\"";
_8bf+=_8c4.getShowInNewWindow();
_8bf+="\" ";
_8bf+="method=\"";
_8bf+=_8c4.getMethod();
_8bf+="\" ";
_8bf+="prompt=\"";
_8bf+=_8c4.getPrompt();
_8bf+="\" ";
_8bf+="dynamicDrill=\"";
_8bf+=_8c4.isDynamicDrillThrough();
_8bf+="\">";
for(var _8c5=2;_8c5<_8c1.length;++_8c5){
_8bf+=_8c1[_8c5];
}
_8bf+=_8c4.getParameters();
_8bf+=_8c4.getObjectPaths();
_8bf+="</drillTarget>";
}
_8bf+="</rvDrillTargets>";
if(!cvId){
cvId=getCVId();
}
doMultipleDrills(_8bf,cvId);
};
function CScriptLoader(_8c6){
this.m_oFiles={};
this.m_aScripts=[];
this.m_aDocumentWriters=[];
this.m_ajaxWarnings=[];
this.m_bIgnoreAjaxWarnings=false;
this.m_bHandleStylesheetLimit=false;
this.m_iInterval=20;
this.m_reFindCssPath=new RegExp("<link[^>]*href=\"([^\"]*)\"","i");
this.m_reFindInlineStyle=/<style\b(\s|.)*?<\/style>/gi;
this.m_reHasCss=/<link .*?>/gi;
this.m_reIsCss=/\.css$/i;
this.m_reIsJavascript=/\.js$/i;
this.m_reIsPromptingLocaleJavascript=/prompting.res.[promptingStrings|promptLocale].*\.js$/i;
this.m_reScriptTagClose=/\s*<\/script>.*?$/i;
this.m_reScriptTagOpen=/^.*?<script[^>]*>\s*/i;
this.m_reStyleTagClose=/(-|>|\s)*<\/style>\s*$/gi;
this.m_reStyleTagOpen=/^\s*<style[^>]*>(\s|<|!|-)*/gi;
this.m_reEscapedCharacters=/\\[\\"']/g;
this.m_reStringLiterals=/("|')[\s\S]*?\1/g;
this.m_sWebContentRoot=_8c6;
this.m_bHasCompletedExecution=false;
this.m_aScriptLoadQueue=[];
this.m_bBlockScriptLoading=false;
this.m_bUseScriptBlocking=false;
this.m_bBlockPromptingLocaleScripts=false;
this.m_aBlockedPromptingLocaleFileQueue=[];
};
CScriptLoader.prototype.hasCompletedExecution=function(){
return this.m_bHasCompletedExecution;
};
CScriptLoader.prototype.setHandlerStylesheetLimit=function(_8c7){
this.m_bHandleStylesheetLimit=_8c7;
};
CScriptLoader.prototype.executeScripts=function(_8c8,_8c9){
if(this.isReadyToExecute()){
for(var _8ca=0;_8ca<this.m_aScripts.length;_8ca++){
if(this.m_aScripts[_8ca]){
var _8cb=document.createElement("script");
_8cb.setAttribute("language","javascript");
_8cb.setAttribute("type","text/javascript");
this.addNamespaceAttribute(_8cb,_8c9);
_8cb.text=this.m_aScripts[_8ca];
document.getElementsByTagName("head").item(0).appendChild(_8cb);
}
}
this.m_aScripts=[];
for(var idx=0;idx<this.m_aDocumentWriters.length;++idx){
var _8cd=this.m_aDocumentWriters[idx];
_8cd.execute();
}
this.m_aDocumentWriters=[];
if(!this.m_aScripts.length&&!this.m_aDocumentWriters.length){
if(typeof _8c8=="function"){
_8c8();
}
this.m_bHasCompletedExecution=true;
}else{
setTimeout(function(){
window.gScriptLoader.executeScripts(_8c8,_8c9);
},this.m_iInterval);
}
}else{
setTimeout(function(){
window.gScriptLoader.executeScripts(_8c8,_8c9);
},this.m_iInterval);
}
};
CScriptLoader.prototype.isReadyToExecute=function(){
for(var _8ce in this.m_oFiles){
if(this.m_oFiles[_8ce]!="complete"){
return false;
}
}
if(this.m_aScriptLoadQueue.length>0){
return false;
}
return true;
};
CScriptLoader.prototype.loadCSS=function(_8cf,_8d0,_8d1,_8d2){
var aM=_8cf.match(this.m_reHasCss);
if(aM){
for(var i=0;i<aM.length;i++){
if(aM[i].match(this.m_reFindCssPath)){
var _8d5=RegExp.$1;
if(_8d5.indexOf("GlobalReportStyles")!=-1){
this.validateGlobalReportStyles(_8d5);
if(_8d1){
if(_8d5.indexOf("GlobalReportStyles.css")!=-1){
_8d5=_8d5.replace("GlobalReportStyles.css","GlobalReportStyles_10.css");
}
var _8d6=this.getGlobalReportStylesClassPrefix(_8d5);
_8d5=_8d5.replace(".css","_NS.css");
if(_8d0){
_8d0.className="buxReport "+_8d6;
}
}
}
this.loadObject(_8d5,_8d2);
}
_8cf=_8cf.replace(aM[i],"");
}
}
return _8cf;
};
CScriptLoader.prototype.getGlobalReportStylesClassPrefix=function(_8d7){
var _8d8=null;
if(_8d7.indexOf("GlobalReportStyles_11.4.css")!=-1){
_8d8="v114";
}
if(_8d7.indexOf("GlobalReportStyles_11.css")!=-1){
_8d8="v11";
}
if(_8d7.indexOf("GlobalReportStyles_10.css")!=-1){
_8d8="v10";
}else{
if(_8d7.indexOf("GlobalReportStyles_1.css")!=-1){
_8d8="v1";
}else{
if(_8d7.indexOf("GlobalReportStyles_none.css")!=-1){
_8d8="vnone";
}else{
if(_8d7.indexOf("GlobalReportStyles.css")!=-1){
_8d8="v8";
}
}
}
}
return _8d8;
};
CScriptLoader.prototype.validateGlobalReportStyles=function(_8d9){
var _8da=document.getElementsByTagName("link");
for(var i=0;i<_8da.length;++i){
var _8dc=_8da[i];
if(_8dc.getAttribute("href").indexOf("GlobalReportStyles")!=-1){
if(_8dc.getAttribute("href").toLowerCase()!=_8d9.toLowerCase()){
var _8dd=_8d9.split("/");
var _8de=_8dc.getAttribute("href").split("/");
if(_8dd[_8dd.length-1]!=_8de[_8de.length-1]){
this.m_ajaxWarnings.push("Ajax response contains different versions of the GlobalReportStyles.css.");
}
}
break;
}
}
};
CScriptLoader.prototype.loadFile=function(_8df,_8e0,_8e1){
var sURL="";
if(_8df){
sURL=_8df;
}
var _8e3=null;
if(typeof _8e0=="string"){
_8e3=_8e0;
}
var _8e4="POST";
if(_8e1=="GET"){
_8e4="GET";
}
var _8e5=null;
if(typeof ActiveXObject!="undefined"){
_8e5=new ActiveXObject("Msxml2.XMLHTTP");
}else{
_8e5=new XMLHttpRequest();
}
_8e5.open(_8e4,sURL,false);
_8e5.send(_8e3);
return _8e5.responseText;
};
function CScriptLoader_onReadyStateChange(){
if(typeof this.readyState=="undefined"){
this.readyState="complete";
}
if(this.readyState=="loaded"||this.readyState=="complete"){
var path=this.sFilePath;
if(!path&&this.getAttribute){
path=this.getAttribute("href");
}
window.gScriptLoader.setFileState(path,"complete");
window.gScriptLoader.m_bBlockScriptLoading=false;
if(this.sFilePath&&window.gScriptLoader.m_bBlockPromptingLocaleScripts&&this.sFilePath.match(window.gScriptLoader.m_reIsPromptingLocaleJavascript)){
window.gScriptLoader.m_bBlockPromptingLocaleScripts=false;
if(window.gScriptLoader.m_aBlockedPromptingLocaleFileQueue.length>0){
var _8e7=window.gScriptLoader.m_aBlockedPromptingLocaleFileQueue.shift();
window.gScriptLoader.loadObject(_8e7.sName,_8e7.sNamespaceId);
}
}
if(window.gScriptLoader.m_aScriptLoadQueue.length>0){
window.gScriptLoader.loadObject();
}
}
};
CScriptLoader.prototype.moveLinks=function(node){
if(!node){
return;
}
var _8e9=node.getAttribute("href");
if(!_8e9||this.m_oFiles[_8e9]){
return;
}
this.m_oFiles[_8e9]="complete";
document.getElementsByTagName("head").item(0).appendChild(node);
};
CScriptLoader.prototype.loadObject=function(_8ea,_8eb){
var _8ec=null;
if(typeof _8ea==="undefined"){
if(this.m_aScriptLoadQueue.length>0){
var _8ed=this.m_aScriptLoadQueue.shift();
_8ea=_8ed.name;
_8eb=_8ed.namespaceId;
}else{
return;
}
}
if(this.m_oFiles[_8ea]){
return;
}
if(this.m_bBlockScriptLoading){
this.m_aScriptLoadQueue.push({"name":_8ea,"namespaceId":_8eb});
}else{
if(_8ea.match(this.m_reIsCss)){
_8ec=document.createElement("link");
_8ec.setAttribute("rel","stylesheet");
_8ec.setAttribute("type","text/css");
_8ec.setAttribute("href",_8ea);
if(window.isIE&&window.isIE()){
_8ec.onreadystatechange=CScriptLoader_onReadyStateChange;
_8ec.onload=CScriptLoader_onReadyStateChange;
_8ec.onerror=CScriptLoader_onReadyStateChange;
this.m_oFiles[_8ea]="new";
}else{
this.m_oFiles[_8ea]="complete";
}
}else{
if(_8ea.match(this.m_reIsJavascript)){
if(_8ea.match(this.m_reIsPromptingLocaleJavascript)){
if(this.m_bBlockPromptingLocaleScripts){
this.m_aBlockedPromptingLocaleFileQueue.push({"sName":_8ea,"sNamespaceId":_8eb});
return;
}
this.m_bBlockPromptingLocaleScripts=true;
}
this.m_bBlockScriptLoading=this.m_bUseScriptBlocking;
_8ec=document.createElement("script");
_8ec.setAttribute("language","javascript");
_8ec.setAttribute("type","text/javascript");
_8ec.setAttribute("src",_8ea);
_8ec.sFilePath=_8ea;
_8ec.onreadystatechange=CScriptLoader_onReadyStateChange;
_8ec.onload=CScriptLoader_onReadyStateChange;
_8ec.onerror=CScriptLoader_onReadyStateChange;
this.addNamespaceAttribute(_8ec,_8eb);
this.m_oFiles[_8ea]="new";
}
}
if(_8ec){
document.getElementsByTagName("head").item(0).appendChild(_8ec);
}
}
};
CScriptLoader.prototype.loadScriptsFromDOM=function(_8ee,_8ef,_8f0){
if(!_8ee){
return;
}
var _8f1=_8ee.parentNode.getElementsByTagName("script");
while(_8f1.length>0){
var _8f2=_8f1[0];
if(_8f2.getAttribute("src")!=null&&_8f2.getAttribute("src").length>0){
this.loadObject(_8f2.getAttribute("src"),_8ef);
}else{
var _8f3=_8f2.innerHTML;
var _8f4=false;
if(_8f3.indexOf("document.write")!=-1){
var _8f5=_8f3.replace(this.m_reEscapedCharacters,"").replace(this.m_reStringLiterals,"");
_8f4=(_8f5.indexOf("document.write")!=-1);
}
if(_8f4){
if(_8f0){
var sId="CVScriptFromDOMPlaceHolder"+_8f1.length+_8ef;
var _8f7=_8f2.ownerDocument.createElement("span");
_8f7.setAttribute("id",sId);
_8f2.parentNode.insertBefore(_8f7,_8f2);
this.m_aDocumentWriters.push(new CDocumentWriter(sId,_8f3));
}
}else{
if(_8f3.length>0){
this.m_aScripts.push(_8f3);
}
}
}
_8f2.parentNode.removeChild(_8f2);
}
};
CScriptLoader.prototype.loadStyles=function(_8f8,_8f9){
if(!_8f8||!_8f8.parentNode){
return;
}
var _8fa=_8f8.parentNode.getElementsByTagName("style");
while(_8fa.length>0){
var _8fb=_8fa[0];
if(_8f9){
this.addNamespaceAttribute(_8fb,_8f9);
}
if(window.isIE&&window.isIE()&&window.getNavVer()<10){
if((document.getElementsByTagName("style").length+document.getElementsByTagName("link").length)>=30){
if(this.m_bHandleStylesheetLimit){
if(typeof window.gaRV_INSTANCES!="undefined"){
for(var i=0;i<window.gaRV_INSTANCES.length;i++){
window.gaRV_INSTANCES[i].cleanupStyles();
}
}
}
if((document.getElementsByTagName("style").length+document.getElementsByTagName("link").length)>=30){
if(typeof console!="undefined"&&console&&console.log){
console.log("Stylesheet limit reached.");
}
this.m_ajaxWarnings.push("Stylesheet limit reached.");
return;
}
}
}
document.getElementsByTagName("head").item(0).appendChild(_8fb);
}
};
CScriptLoader.prototype.loadAll=function(_8fd,_8fe,_8ff,_900){
this.m_bScriptLoaderCalled=true;
this.m_bHasCompletedExecution=false;
this.loadScriptsFromDOM(_8fd,_8ff,_900);
if(this.containsAjaxWarnings()){
return false;
}
this.loadStyles(_8fd,_8ff);
if(this.containsAjaxWarnings()){
return false;
}
this.executeScripts(_8fe,_8ff);
return true;
};
CScriptLoader.prototype.setFileState=function(_901,_902){
this.m_oFiles[_901]=_902;
};
CScriptLoader.prototype.containsAjaxWarnings=function(){
if(this.m_bIgnoreAjaxWarnings){
return false;
}else{
return (this.m_ajaxWarnings.length>0);
}
};
CScriptLoader.prototype.addNamespaceAttribute=function(_903,_904){
if(typeof _904==="string"){
_903.setAttribute("namespaceId",_904);
}
};
if(typeof window.gScriptLoader=="undefined"){
window.gScriptLoader=new CScriptLoader();
}
function ViewerA11YHelper(oCV){
this.m_oCV=oCV;
};
ViewerA11YHelper.prototype.onFocus=function(evt){
var _907=getCrossBrowserNode(evt);
_907=ViewerA11YHelper.findChildOfTableCell(_907);
this.updateCellAccessibility(_907,false);
};
ViewerA11YHelper.prototype.onKeyDown=function(evt){
evt=(evt)?evt:((event)?event:null);
var _909=getCrossBrowserNode(evt);
if(ViewerA11YHelper.isTableCell(_909)){
for(var i=0;i<_909.childNodes.length;i++){
if(_909.childNodes[i].nodeName.toLowerCase()=="span"){
_909=_909.childNodes[i];
break;
}
}
}
if(!this.isValidNodeToSelect(_909)){
return true;
}
_909=ViewerA11YHelper.findChildOfTableCell(_909);
if(_909){
if(evt.keyCode=="39"){
if(this.m_oCV.getState()&&this.m_oCV.getState().getFindState()&&evt.ctrlKey&&evt.shiftKey){
this.m_oCV.executeAction("FindNext");
}else{
this.moveRight(_909);
}
return stopEventBubble(evt);
}else{
if(evt.keyCode=="37"){
this.moveLeft(_909);
return stopEventBubble(evt);
}else{
if(evt.keyCode=="38"){
this.moveUp(_909);
return stopEventBubble(evt);
}else{
if(evt.keyCode=="40"){
this.moveDown(_909);
return stopEventBubble(evt);
}else{
if(evt.keyCode=="13"){
if(this.m_oCV.isBux){
if(this.m_oCV.getViewerWidget().isSelectionFilterEnabled()){
this.m_oCV.getViewerWidget().preprocessPageClicked(false,evt);
if(this.m_oCV.getSelectionController().pageClicked(evt)!==false){
this.m_oCV.JAWSTalk(RV_RES.IDS_JS_SELECTION_FILTER_INFO_JAWS);
this.m_oCV.getViewerWidget().updateToolbar();
}
}else{
this.m_oCV.getSelectionController().pageClicked(evt);
var _90b=this.m_oCV.getActionFactory().load("Selection");
_90b.onKeyDown(evt);
}
this.m_oCV.getViewerWidget().onSelectionChange();
}else{
this.m_oCV.de(evt);
}
}else{
if(evt.keyCode=="32"){
if(this.m_oCV.isBux){
this.m_oCV.getViewerWidget().preprocessPageClicked(false);
if(this.m_oCV.getSelectionController().pageClicked(evt)!==false&&this.m_oCV.getViewerWidget().isSelectionFilterEnabled()){
this.m_oCV.JAWSTalk(RV_RES.IDS_JS_SELECTION_FILTER_INFO_JAWS);
}
this.m_oCV.getViewerWidget().updateToolbar();
this.m_oCV.getViewerWidget().onSelectionChange();
}else{
this.m_oCV.getSelectionController().pageClicked(evt);
}
return stopEventBubble(evt);
}else{
if(evt.keyCode=="46"&&this.m_oCV.isBux){
if(typeof this.m_oCV.envParams!="undefined"&&typeof this.m_oCV.envParams["ui.action"]!="undefined"&&this.m_oCV.envParams["ui.action"]!="view"&&!this.m_oCV.isLimitedInteractiveMode()){
var _90c=this.m_oCV.getActionFactory().load("Delete");
if(!this.m_oCV.isBlacklisted("Delete")&&_90c.canDelete()){
_90c.execute();
return stopEventBubble(evt);
}
}
}else{
if(this.m_oCV.isBux&&evt.ctrlKey==true&&evt.shiftKey==true&&evt.keyCode=="49"){
var lid=this.m_oCV.getSelectionController().getSelectionObjectFactory().getLayoutElementId(_909);
if(lid!=""){
lid=lid.split(this.m_oCV.getId())[0];
var _90e=-1;
var _90f=this.m_oCV.getRAPReportInfo();
if(_90f){
var _910=_90f.getContainer(lid);
if(typeof _910.layoutIndex!="undefined"){
_90e=_910.layoutIndex;
}
}
var _911=document.getElementById("infoBarHeaderButton"+_90e+this.m_oCV.getId());
if(_911!==null){
this.m_oCV.setCurrentNodeFocus(getCrossBrowserNode(evt));
_911.focus();
}
}
return stopEventBubble(evt);
}else{
if(!this.m_oCV.isBux&&evt.shiftKey==true&&evt.keyCode=="121"){
var ocv=this.m_oCV;
var _913=function(){
if(typeof evt.clientX=="undefined"||typeof evt.clientY=="undefined"){
var _914=clientToScreenCoords(evt.target,document.body);
evt.clientX=_914.leftCoord;
evt.clientY=_914.topCoord;
}
ocv.dcm(evt,true);
};
if(isFF()){
setTimeout(_913,0);
}else{
_913.call();
}
return stopEventBubble(evt);
}else{
if(this.m_oCV.isBux&&(evt.keyCode=="93"||(evt.shiftKey==true&&evt.keyCode=="121"))){
var _915=this.m_oCV.getViewerWidget();
var _916=this.m_oCV.getSelectionController();
_915.preprocessPageClicked(true);
_916.pageClicked(evt);
_915.updateToolbar();
_915.onContextMenu(evt);
}
}
}
}
}
}
}
}
}
}
}
};
ViewerA11YHelper.prototype.isValidNodeToSelect=function(node){
return this.getValidNodeToSelect(node)?true:false;
};
ViewerA11YHelper.prototype.getValidNodeToSelect=function(node){
if(node&&node.style&&node.style.visibility!="hidden"&&node.style.display!="none"){
var _919=node.nodeName.toLowerCase();
if((_919=="span"&&(!node.getAttribute("class")||node.getAttribute("class").indexOf("expandButton")===-1))||(_919=="div"&&node.getAttribute("flashchartcontainer")=="true")||(_919=="div"&&node.getAttribute("chartcontainer")=="true")||(_919=="img"&&(!node.id||node.id.indexOf("sortimg")!==0))){
return node;
}
if(ViewerA11YHelper.isSemanticNode(node)){
var _91a=node.childNodes&&node.childNodes.length?node.childNodes[0]:null;
if(_91a){
return this.getValidNodeToSelect(_91a);
}
}
}
return null;
};
ViewerA11YHelper.isSemanticNode=function(node){
if(!ViewerA11YHelper.isSemanticNode._semanticNodeNames){
ViewerA11YHelper.isSemanticNode._semanticNodeNames=["strong","em","h1","h2","h3","h4","h5","h6"];
}
var _91c=node.nodeName.toLowerCase();
for(var i=0;i<ViewerA11YHelper.isSemanticNode._semanticNodeNames.length;i++){
if(_91c===ViewerA11YHelper.isSemanticNode._semanticNodeNames[i]){
return true;
}
}
return false;
};
ViewerA11YHelper.isTableCell=function(node){
var _91f=node.nodeName.toLowerCase();
return _91f==="td"||_91f==="th";
};
ViewerA11YHelper.findChildOfTableCell=function(_920){
var _921=_920;
while(_921&&_921.parentNode){
if(ViewerA11YHelper.getTableCell(_921)){
break;
}
_921=_921.parentNode;
}
return _921;
};
ViewerA11YHelper.getTableCell=function(node){
var _923=node.parentNode;
if(ViewerA11YHelper.isTableCell(_923)){
return _923;
}
if(ViewerA11YHelper.isSemanticNode(_923)&&ViewerA11YHelper.isTableCell(_923.parentNode)){
return _923.parentNode;
}
return null;
};
ViewerA11YHelper.prototype.moveRight=function(_924){
var _925=this.getNextNonTextSibling(_924);
_925=this.getValidNodeToSelect(_925);
if(_925){
this.setFocusToNode(_925);
return true;
}
var _926=ViewerA11YHelper.getTableCell(_924);
_926=this.getPfMainOutputCell(_926);
while(_926.nextSibling){
if(this.moveToTD(_926.nextSibling)){
return true;
}
_926=_926.nextSibling;
}
var _927=_926.parentNode;
while(_927.nextSibling){
var _928=_927.nextSibling;
if(this.moveToTD(_928.childNodes[0])){
return true;
}
_927=_927.nextSibling;
}
return false;
};
ViewerA11YHelper.prototype.moveLeft=function(_929){
var _92a=this.getPreviousNonTextSibling(_929);
_92a=this.getValidNodeToSelect(_92a);
if(_92a){
this.setFocusToNode(_92a);
return true;
}
var _92b=ViewerA11YHelper.getTableCell(_929);
_92b=this.getPfMainOutputCell(_92b);
while(_92b.previousSibling){
if(this.moveToTDFromTheRight(_92b.previousSibling)){
return true;
}
_92b=_92b.previousSibling;
}
var _92c=_92b.parentNode;
while(_92c.previousSibling){
var _92d=_92c.previousSibling;
if(this.moveToTDFromTheRight(_92d.lastChild)){
return true;
}
_92c=_92c.previousSibling;
}
return false;
};
ViewerA11YHelper.prototype.moveDown=function(_92e){
var _92f=ViewerA11YHelper.getTableCell(_92e);
_92f=this.getPfMainOutputCell(_92f);
var _930=this.getColumnIndex(_92f);
_930+=this.getColSpanFromRowSpans(_92f);
var _931=_92f.parentNode;
if(_92f.rowSpan&&_92f.rowSpan>1){
var _932=_92f.rowSpan;
for(var _933=1;_933<_932;_933++){
_931=_931.nextSibling;
}
}
var _934=false;
while(_931){
if(_931.nextSibling){
_931=_931.nextSibling;
}else{
if(_92f.nextSibling&&!_934){
_931=_931.parentNode.firstChild;
_934=true;
_930++;
}else{
return false;
}
}
if(this.doMoveUpDown(_931,_930)){
return true;
}
}
return false;
};
ViewerA11YHelper.prototype.moveUp=function(_935){
var _936=ViewerA11YHelper.getTableCell(_935);
_936=this.getPfMainOutputCell(_936);
var _937=_936.parentNode;
var _938=this.getColumnIndex(_936);
_938+=this.getColSpanFromRowSpans(_936);
var _939=false;
while(_937){
if(_937.previousSibling){
_937=_937.previousSibling;
}else{
if(_936.previousSibling&&!_939){
_937=_937.parentNode.lastChild;
_939=true;
_938--;
}else{
return false;
}
}
if(this.doMoveUpDown(_937,_938)){
return true;
}
}
return false;
};
ViewerA11YHelper.prototype.getNextNonTextSibling=function(node){
while(node.nextSibling){
node=node.nextSibling;
if(node.nodeName.toLowerCase()!="#text"){
return node;
}
}
if(ViewerA11YHelper.isSemanticNode(node.parentNode)){
return this.getNextNonTextSibling(node.parentNode);
}
return null;
};
ViewerA11YHelper.prototype.doMoveUpDown=function(_93b,_93c){
if(_93b!=null){
var _93d=_93b.firstChild;
var pos=this.getColSpanFromRowSpans(_93d);
while(_93d){
if(pos==_93c){
return this.moveToTDFromTheRight(_93d);
}else{
if(pos>_93c){
break;
}
}
var _93f=0;
if(_93d.colSpan){
_93f=_93d.colSpan;
}else{
_93f++;
}
pos+=_93f;
_93d=_93d.nextSibling;
}
}
};
ViewerA11YHelper.prototype.moveToTDFromTheRight=function(td){
td=this.getPfVisibleCell(td);
var _941=td.childNodes;
for(var _942=_941.length-1;_942>=0;_942--){
var node=this.getValidNodeToSelect(_941[_942]);
if(node){
if(node.childNodes&&node.childNodes[0]&&node.childNodes[0].nodeName.toLowerCase()=="span"){
node=node.childNodes[0];
}
if(node.tabIndex!=-1&&node.tabIndex!=0){
node.tabIndex=-1;
}
this.setFocusToNode(node);
return true;
}
}
return false;
};
ViewerA11YHelper.prototype.moveToTD=function(td){
td=this.getPfVisibleCell(td);
var _945=td.childNodes;
for(var _946=0;_946<_945.length;_946++){
var node=this.getValidNodeToSelect(_945[_946]);
if(node){
if(node.childNodes&&node.childNodes[0]&&node.childNodes[0].nodeName.toLowerCase()=="span"){
node=node.childNodes[0];
}
if(node.tabIndex!=-1&&node.tabIndex!=0){
node.tabIndex=-1;
}
this.setFocusToNode(node);
return true;
}
}
return false;
};
ViewerA11YHelper.prototype.setFocusToNode=function(node){
this.m_oCV.setCurrentNodeFocus(node);
this.updateCellAccessibility(node,false);
node.focus();
if(this.m_oCV.m_pinFreezeManager){
var _949=this.m_oCV.m_pinFreezeManager.nodeToContainer(node);
if(_949){
_949.updateScroll(node);
}
}
};
ViewerA11YHelper.prototype.getPfMainOutputCell=function(_94a){
var main=null;
var slid=_94a.getAttribute("pfslid");
if(slid){
var lid=PinFreezeContainer.getLidFromSlid(slid);
if(lid&&this.m_oCV.m_pinFreezeManager){
lid=this.m_oCV.m_pinFreezeManager.removeNamespace(lid);
var _94e=this.m_oCV.m_pinFreezeManager.getContainer(lid);
if(_94e){
main=_94e.getMain(_94a);
}
}
}
return main?main:_94a;
};
ViewerA11YHelper.prototype.getPreviousNonTextSibling=function(node){
while(node.previousSibling){
node=node.previousSibling;
if(node.nodeName.toLowerCase()!="#text"){
return node;
}
}
if(ViewerA11YHelper.isSemanticNode(node.parentNode)){
return this.getPreviousNonTextSibling(node.parentNode);
}
return null;
};
ViewerA11YHelper.prototype.getColumnIndex=function(node){
var _951=0;
while(node.previousSibling){
node=node.previousSibling;
if(node.rowSpan==1){
if(node.colSpan){
_951+=node.colSpan;
}else{
_951++;
}
}
}
return _951;
};
ViewerA11YHelper.prototype.getPfVisibleCell=function(_952){
var copy=null;
var slid=_952.getAttribute("pfslid");
if(slid){
var lid=PinFreezeContainer.getLidFromSlid(slid);
if(lid&&this.m_oCV.m_pinFreezeManager){
lid=this.m_oCV.m_pinFreezeManager.removeNamespace(lid);
var _956=this.m_oCV.m_pinFreezeManager.getContainer(lid);
if(_956){
copy=_956.getCopy(_952);
}
}
}
return copy?copy:_952;
};
ViewerA11YHelper.prototype.updateCellAccessibility=function(_957,_958){
if(!_957){
return false;
}
var _959=false;
var _95a=false;
var _95b=false;
var _95c=_957.getAttribute("ctx")!=null?_957:_957.parentNode;
if(_957.getAttribute("flashChartContainer")!="true"){
if(_95c.getAttribute("ctx")!=null){
if(this.m_oCV.isBux){
var _95d=this.m_oCV.getAction("DrillUpDown");
_95d.updateDrillability(this.m_oCV,_95c);
_959=_95d.canDrillDown();
_95a=_95d.canDrillUp();
}else{
var _95e=_95c.getAttribute("ctx");
var _95f=_95e.indexOf(":")==-1?_95e:_95e.substring(0,_95e.indexOf(":"));
var _960=this.m_oCV.getSelectionController();
_959=_960.canDrillDown(_95f);
_95a=_960.canDrillUp(_95f);
}
}
_95b=_957.parentNode.getAttribute("dtTargets")?true:false;
}
var _961=_957.nodeName.toLowerCase()=="img";
var _962=_957.parentNode.getAttribute("type")=="columnTitle";
if(!_961&&(_958||((_957.getAttribute("aria-labelledby")!=null||_962||this.m_oCV.isAccessibleMode())))){
var _963="";
if(_957.parentNode.getAttribute("cc")=="true"){
_963+=" "+RV_RES.IDS_JS_CROSSTAB_CORNER;
}
if(_957.innerHTML.length===0){
_963+=" "+RV_RES.IDS_JS_EMPTY_CELL;
}
if(_959&&_95a){
_963+=" "+RV_RES.IDS_JS_DRILL_DOWN_UP_JAWS;
}else{
if(_959){
_963+=" "+RV_RES.IDS_JS_DRILL_DOWN_JAWS;
}else{
if(_95a){
_963+=" "+RV_RES.IDS_JS_DRILL_UP_JAWS;
}
}
}
if(_95b){
_963+=" "+RV_RES.IDS_JS_DRILL_THROUGH_JAWS;
}
if(_957.altText&&_957.altText.length>0){
_963=_957.altText;
}else{
if(_957.getAttribute("flashChartContainer")=="true"){
_963=RV_RES.IDS_JS_CHART_IMAGE;
}
}
if(this.m_oCV.isBux){
var _964=_957.previousSibling;
if(_964){
var wid=_964.getAttribute("widgetid");
if(wid&&wid.indexOf("comment")){
_963+=" "+RV_RES.IDS_JS_ANNOTATION_JAWS;
}
}
if(_957.getAttribute("rp_name")||_957.parentNode.getAttribute("rp_name")){
_963+=" "+RV_RES.IDS_JS_LABEL_HAS_BEEN_RENAMED;
}
if(_957.nextSibling&&_957.nextSibling.getAttribute("class")=="sortIconVisible"){
_963+=" "+_957.nextSibling.getAttribute("alt");
}
}
if(_963.length>0){
this.addAriaLabelledByOnCell(_957,_963);
}
}
if(_95a||_959||_95b){
this.addDrillAccessibilityAttributes(_957,_95b);
}
if(_957.attachEvent){
_957.attachEvent("onblur",this.onBlur);
}else{
_957.addEventListener("blur",this.onBlur,false);
}
if((isIE()&&_957.getAttribute("tabIndex")!=0)||_961){
_957.setAttribute("modifiedTabIndex","true");
_957.setAttribute("oldTabIndex",_957.getAttribute("tabIndex"));
_957.setAttribute("tabIndex",0);
}
};
ViewerA11YHelper.prototype.addAriaLabelledByOnCell=function(_966,_967){
var _968=0;
var _969=_966;
while(_969.previousSibling){
_968++;
_969=_969.previousSibling;
}
var _96a=_966.getAttribute("ariaHiddenSpanId");
if(_96a&&document.getElementById(_96a)){
document.getElementById(_96a).innerHTML=_967;
}else{
if(!_966.parentNode.id&&!_966.id){
_966.parentNode.id=Math.random();
}
var _96b=document.createElement("span");
_96b.style.visibility="hidden";
_96b.style.display="none";
_96b.id=(_966.id==""?_966.parentNode.id:_966.id)+"_"+_968;
_96b.innerHTML=_967;
_966.parentNode.appendChild(_96b);
var _96c="";
if(_966.getAttribute("aria-labelledby")!=null){
_96c+=_966.getAttribute("aria-labelledby");
}else{
if(_966.id==""){
_966.id=_966.parentNode.id+"_main_"+_968;
}
_96c+=_966.id;
}
_96c+=" "+_96b.id;
_966.setAttribute("aria-labelledby",_96c);
_966.setAttribute("ariaHiddenSpanId",_96b.id);
}
};
ViewerA11YHelper.prototype.addDrillAccessibilityAttributes=function(_96d,_96e){
if(!_96d.getAttribute("oldClassName")){
if(!_96e){
_96d.setAttribute("oldClassName",_96d.className);
_96d.className="dl "+_96d.className;
}
if(!_96d.getAttribute("role")){
_96d.setAttribute("role","link");
}
}
};
ViewerA11YHelper.prototype.onBlur=function(evt){
var _970=null;
if(isIE()){
_970=getNodeFromEvent(evt,true);
}else{
_970=this;
}
_970=ViewerA11YHelper.findChildOfTableCell(_970);
if(_970){
if(_970.getAttribute("oldClassName")){
_970.className=_970.getAttribute("oldClassName");
_970.removeAttribute("oldClassName");
}
if(_970.getAttribute("modifiedTabIndex")=="true"){
_970.removeAttribute("modifiedTabIndex");
_970.removeAttribute("tabIndex");
if(_970.getAttribute("oldTabIndex")){
_970.setAttribute("tabIndex",_970.getAttribute("oldTabIndex"));
}
_970.removeAttribute("oldTabIndex");
}
var _971=_970.getAttribute("ariaHiddenSpanId");
if(_971){
var _972=document.getElementById(_971);
if(_972){
_972.innerHTML="";
}
}
}
};
ViewerA11YHelper.prototype.getColSpanFromRowSpans=function(_973){
var _974=0;
var _975=_973.parentNode;
var _976=0;
while(_975){
var _977=_975.firstChild;
var _978=this.getColumnCount(_975)-_976;
while(_977&&_977.rowSpan>1&&_978>0&&_977!=_973){
_974+=_977.colSpan;
_977=_977.nextSibling;
_978--;
}
if(_975.childNodes.length>_976){
_976=this.getColumnCount(_975);
}
_975=_975.previousSibling;
}
return _974;
};
ViewerA11YHelper.prototype.getColumnCount=function(_979){
var _97a=0;
var node=_979.firstChild;
while(node){
_97a+=node.colSpan;
node=node.nextSibling;
}
return _97a;
};
ViewerA11YHelper.prototype.addLabelledByForItemsOutsideOfContainers=function(){
if(!this.m_oCV.isAccessibleMode()){
return;
}
var _97c=document.getElementById("RVContent"+this.m_oCV.getId());
if(!_97c){
return;
}
var _97d=getElementsByAttribute(_97c,"span","tabindex","0");
if(!_97d){
return;
}
for(var i=0;i<_97d.length;i++){
var span=_97d[i];
this.updateCellAccessibility(span,false);
}
};
var CV_BACKGROUND_LAYER_ID="CV_BACK";
if(typeof window.gaRV_INSTANCES=="undefined"){
window.gaRV_INSTANCES=[];
}
if(!window.gViewerLogger){
window.gViewerLogger={log:function(hint,_981,type){
},addContextInfo:function(_983){
}};
}
function CognosViewerSession(oCV){
this.m_sConversation=oCV.getConversation();
this.m_sParameters=oCV.getExecutionParameters();
this.m_envParams={};
applyJSONProperties(this.m_envParams,oCV.envParams);
this.m_bRefreshPage=false;
};
function CCognosViewer(sId,_986){
if(typeof window.gCognosViewer=="undefined"){
window.gCognosViewer=this;
}
if(typeof ViewerConfig=="function"){
this.m_viewerConfig=new ViewerConfig();
try{
if(typeof window.getViewerConfiguration=="function"){
this.m_viewerConfig.configure(window.getViewerConfiguration());
}else{
if(window.parent&&typeof window.parent.getViewerConfiguration=="function"){
this.m_viewerConfig.configure(window.parent.getViewerConfiguration());
}
}
}
catch(e){
}
this.m_viewerUIConfig=this.m_viewerConfig.getUIConfig();
}
this.m_sActionState="";
this.m_bKeepSessionAlive=false;
this.m_undoStack=[];
this.m_aSecRequests=[];
this.m_bDebug=false;
this.m_sCAFContext="";
this.m_sContextInfoXML="";
this.m_sConversation="";
this.m_sStatus="";
this.m_sGateway=_986;
this.m_sId=sId;
this.m_sMetadataInfoXML="";
this.m_sParameters="";
this.m_sReportState="";
this.envParams={};
this.m_sTracking="";
this.m_sSoapFault="";
this.m_sWaitHTML="";
this.m_oDrillMgr=null;
this.goDrillManager=null;
this.m_oWorkingDialog=null;
this.m_oRequestExecutedIndicator=null;
this.m_bUseWorkingDialog=true;
this.m_oSubscriptionManager=null;
this.m_oCVMgr=null;
this.m_bUseSafeMode=true;
if(typeof CViewerManager=="function"){
this.m_oCVMgr=new CViewerManager(this);
}
if(window.gaRV_INSTANCES){
var _987=false;
for(var _988=0;_988<window.gaRV_INSTANCES.length;_988++){
if(window.gaRV_INSTANCES[_988].m_sId==sId){
window.gaRV_INSTANCES[_988]=this;
_987=true;
break;
}
}
if(!_987){
window.gaRV_INSTANCES=window.gaRV_INSTANCES.concat(this);
}
}
this.m_bReportHasPrompts=false;
this.m_viewerWidget=null;
this.m_flashChartsObjectIds=[];
this.m_raiseSharePromptEvent=true;
this.m_actionFactory=null;
this.m_calculationCache={};
this.m_drillTargets=[];
this.m_reportRenderingDone=false;
if(typeof PinFreezeManager!=="undefined"){
this.m_pinFreezeManager=new PinFreezeManager(this);
}
if(typeof ViewerDispatcher!=="undefined"){
this.m_viewerDispatcher=new ViewerDispatcher();
}
this.m_retryDispatcherEntry=null;
this.m_RAPReportInfo=null;
if(typeof ViewerState=="function"){
this.m_viewerState=new ViewerState();
}
this.m_aInfoBar=null;
};
CCognosViewer.prototype.setScheduledMobileOutput=function(_989){
this.m_mobileScheduledOutput=_989;
if(_989){
this.m_sStatus="complete";
}
};
CCognosViewer.prototype.setTabInfo=function(_98a){
this.m_tabsPayload=_98a;
if(this.m_tabsPayload&&this.m_tabsPayload.tabs&&this._keepTabSelected){
var _98b=false;
for(var i=0;i<this.m_tabsPayload.tabs.length;i++){
var tab=this.m_tabsPayload.tabs[i];
if(tab.id==this._keepTabSelected){
this.m_tabsPayload.currentTabId=this._keepTabSelected;
break;
}
}
this._keepTabSelected=null;
}
};
CCognosViewer.prototype.setKeepTabSelected=function(_98e){
this._keepTabSelected=_98e;
};
CCognosViewer.prototype.getTabController=function(){
return this.m_tabControl;
};
CCognosViewer.prototype.getCurrentlySelectedTab=function(){
return this.m_currentlySelectedTab?this.m_currentlySelectedTab:null;
};
CCognosViewer.prototype.deleteTabs=function(){
if(this.m_tabControl){
this.m_tabControl.destroy();
delete this.m_tabControl;
this.m_tabControl=null;
}
this.m_tabsPayload=null;
};
CCognosViewer.prototype.renderTabs=function(){
if(!this.m_tabsPayload){
return;
}
var _98f=this.isSavedOutput()&&!this.m_mobileScheduledOutput;
var _990=document.getElementById("CVNavLinks"+this.getId());
if(_990||!this.shouldWriteNavLinks()||_98f){
var _991=this.getReportDiv();
this.m_bHasTabs=true;
if(this.m_tabControl&&this.m_tabControl.isSavedOutput()!=_98f){
this.deleteTabs();
}
if(!this.m_tabControl){
if(this.getStatus()!="complete"&&!_98f){
return;
}
var tr=document.createElement("tr");
var _993=document.createElement("td");
tr.appendChild(_993);
var _994=document.getElementById("mainViewerTR"+this.getId());
if(!_994){
return;
}
if(this.m_tabsPayload.position=="topLeft"){
_994.parentNode.insertBefore(tr,_994);
}else{
_994.parentNode.appendChild(tr);
}
var _995=null;
if(this.m_viewerWidget){
_995=this.m_viewerWidget.findContainerDiv().firstChild;
}else{
_995=_993;
}
var oCV=this;
if(_98f){
this.m_tabControl=new CognosTabControl(_995,function(_997){
oCV.switchSavedOutputTab(_997,true);
});
this.switchSavedOutputTab(this.m_tabsPayload.currentTabId,false);
}else{
this.m_tabControl=new CognosTabControl(_995,function(_998){
oCV.switchTabs(_998);
});
}
if(this.m_viewerWidget){
this.m_tabControl.setSpaceSaverContainer(_993);
this.m_tabControl.setScrollAttachNode(this.m_viewerWidget.findContainerDiv());
this.m_tabControl.useAbsolutePosition(true);
}
this.m_tabControl.setIsSavedOutput(_98f);
if(!window.gScriptLoader.m_bScriptLoaderCalled){
var _999=document.getElementById("RVContent"+this.getId());
var _99a=this._getNodesWithViewerId(_999,"link",null);
for(var i=0;i<_99a.length;i++){
window.gScriptLoader.moveLinks(_99a[i]);
if(_99a[i].getAttribute("href").indexOf("promptCommon.css")>0){
this.setHasPrompts(true);
}
}
window.gScriptLoader.loadStyles(_999,this.getId());
this.repaintDiv(_999);
}
}
if(this.getStatus()=="prompting"){
this.previouslySelectedTab=null;
this.m_tabControl.hide();
}else{
if(this.isHighContrast()){
this.m_tabControl.setHighContrast(true);
}
this.m_tabControl.render(this.m_tabsPayload);
this.m_currentlySelectedTab=this.m_tabControl.getSelectedTabId();
if(this.m_switchingToTabId&&this.m_currentlySelectedTab!=this.m_switchingToTabId){
this._removeTabContent(_991.parentNode,this.m_switchingToTabId);
this._removeTabContent(_991.parentNode,this.m_currentlySelectedTab);
if(_990){
this._removeTabContent(_990.parentNode,this.m_switchingToTabId);
this._removeTabContent(_990.parentNode,this.m_currentlySelectedTab);
}
this.m_tabInfo={};
}
this.m_switchingToTabId=null;
_991.setAttribute("tabId",this.m_currentlySelectedTab);
if(_990){
_990.setAttribute("tabId",this.m_currentlySelectedTab);
}
if(isIE()&&_98f&&window.resizeIFrame&&!this.m_viewerFragment&&!this.m_viewerWidget){
window.resizeIFrame();
}
}
this.setMaxContentSize();
}else{
var obj=this;
setTimeout(function(){
obj.renderTabs();
},100);
}
};
CCognosViewer.prototype.cancelTabSwitch=function(){
var _99d=this.getReportDiv();
var _99e=this.m_switchingToTabId;
this.m_currentlySelectedTab=_99e;
this.m_tabControl.selectTab(this.previouslySelectedTab,false);
this.switchTabs(this.previouslySelectedTab);
if(_99d){
_99d.parentNode.removeChild(_99d);
}
if(this.m_tabInfo[this.m_currentlySelectedTab]&&this.m_tabInfo[this.m_currentlySelectedTab].styles){
this._addTabStylesToHead(this.m_tabInfo[this.m_currentlySelectedTab].styles);
}
this.previouslySelectedTab=null;
this.m_tabInfo[_99e]=null;
};
CCognosViewer.prototype.switchSavedOutputTab=function(_99f,_9a0){
var _9a1=this.getSelectionController();
if(_9a1){
_9a1.clearSelectedObjects();
}
this.m_currentlySelectedTab=this.m_tabControl.getSelectedTabId();
if(_9a0){
this.notifyTabChange(_99f);
}
if(this.m_viewerWidget){
this.m_viewerWidget.getSavedOutput().switchSavedOutputTab(_99f,_9a0);
this.getTabController().resetPosition();
}else{
if(!this.savedOutputTabNodes){
var _9a2=document.getElementById("CVIFrame"+this.getId());
this.savedOutputTabNodes=getElementsByAttribute(_9a2.contentWindow.document.body,"*","tabid");
}
if(!this.savedOutputTabNodes){
return;
}
for(var i=0;i<this.savedOutputTabNodes.length;i++){
var _9a4=this.savedOutputTabNodes[i];
_9a4.style.display=_9a4.getAttribute("tabid")==_99f?"":"none";
}
this.setMaxContentSize();
}
};
CCognosViewer.prototype.notifyTabChange=function(_9a5){
};
CCognosViewer.prototype._getNodesWithViewerId=function(_9a6,_9a7,id){
var _9a9=[];
var _9aa=_9a6.getElementsByTagName(_9a7);
for(var i=0;i<_9aa.length;i++){
var node=_9aa[i];
if(!id||(node.getAttribute&&node.getAttribute("namespaceId")==id)){
node.parentNode.removeChild(node);
_9a9.push(node);
i--;
}
}
return _9a9;
};
CCognosViewer.prototype._removeTabStylesFromHead=function(){
var id=this.getId();
return this._getNodesWithViewerId(document.getElementsByTagName("head").item(0),"style",id);
};
CCognosViewer.prototype._addTabStylesToHead=function(_9ae){
if(!_9ae){
return;
}
for(var i=0;i<_9ae.length;i++){
document.getElementsByTagName("head").item(0).appendChild(_9ae[i]);
}
};
CCognosViewer.prototype.switchTabs=function(_9b0){
if(this.m_currentlySelectedTab==_9b0){
return;
}
var _9b1=this.getSelectionController();
if(_9b1){
_9b1.clearSelectedObjects();
}
var _9b2=this.getReportDiv();
this.m_nReportDiv=null;
var _9b3=_9b2.clientHeight;
_9b2.removeAttribute("id");
_9b2.style.display="none";
if(!this.m_tabInfo){
this.m_tabInfo={};
}
var _9b4=this._removeTabStylesFromHead();
var _9b5=this.getSelectionController().getCCDManager();
this.m_tabInfo[this.m_currentlySelectedTab]={"conversation":this.getConversation(),"metadata":_9b5.getClonedMetadataArray(),"contextdata":_9b5.getClonedContextdataArray(),"secondaryRequests":this.getSecondaryRequests(),"styles":_9b4,"hasPromptControl":this.getHasPrompts()};
var _9b6=this._findChildWithTabId(_9b2.parentNode,_9b0);
this.previouslySelectedTab=this.m_currentlySelectedTab;
if(_9b6&&this.m_tabInfo[_9b0]&&this.m_tabInfo[_9b0].hasPromptControl){
if(_9b6){
_9b6.parentNode.removeChild(_9b6);
_9b6=null;
}
delete this.m_tabInfo[_9b0];
this.m_tabInfo[_9b0]=null;
}
if(_9b6){
this.m_currentlySelectedTab=_9b0;
_9b6.style.display="block";
_9b6.setAttribute("id","CVReport"+this.getId());
if(this.m_tabInfo&&this.m_tabInfo[_9b0]){
var _9b7=this.m_tabInfo[_9b0];
if(_9b7.conversation){
this.setConversation(_9b7.conversation);
}
if(_9b7.metadata){
_9b5.SetMetadata(_9b7.metadata);
}
if(_9b7.contextdata){
_9b5.SetContextData(_9b7.contextdata);
}
if(_9b7.secondaryRequests){
this.setSecondaryRequests(_9b7.secondaryRequests);
}
if(_9b7.styles){
this._addTabStylesToHead(_9b7.styles);
}
this.setHasPrompts(_9b7.hasPromptControl);
}
if(this.shouldWriteNavLinks()){
this.writeNavLinks(this.getSecondaryRequests().join(" "));
}
if(this.getPinFreezeManager()&&this.getPinFreezeManager().hasFrozenContainers()){
this.getPinFreezeManager().rePaint();
if(isIE()){
var _9b8=document.getElementById("RVContent"+this.getId());
this.repaintDiv(_9b8);
}
}
if(this.m_viewerWidget){
this.m_viewerWidget.placeTabControlInView();
}
this._keepFocus=null;
this.doneLoadingUpdateA11Y("complete");
this.getTabController().resetPosition();
this.setMaxContentSize();
}else{
this.m_switchingToTabId=_9b0;
var _9b9=_9b2.cloneNode(false);
_9b9.style.display="block";
_9b9.setAttribute("id","CVReport"+this.getId());
_9b9.removeAttribute("tabId");
_9b2.parentNode.appendChild(_9b9);
_9b9.innerHTML="<table height='"+_9b3+"px'><tr><td height='100%'></td></tr></table>";
var _9ba=new ViewerDispatcherEntry(this);
_9ba.addFormField("ui.action","reportAction");
_9ba.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",_9b0);
if(this.m_viewerWidget){
this.m_viewerWidget.placeTabControlInView();
}
this.dispatchRequest(_9ba);
}
};
CCognosViewer.prototype._removeTabContent=function(_9bb,_9bc){
var _9bd=this._findChildWithTabId(_9bb,_9bc);
while(_9bd){
_9bd.parentNode.removeChild(_9bd);
_9bd=this._findChildWithTabId(_9bb,_9bc);
}
};
CCognosViewer.prototype._findChildWithTabId=function(_9be,_9bf){
var _9c0=null;
for(var i=0;i<_9be.childNodes.length;i++){
var _9c2=_9be.childNodes[i];
if(_9c2.getAttribute("tabId")==_9bf){
_9c0=_9c2;
break;
}
}
return _9c0;
};
CCognosViewer.prototype.clearTabs=function(){
if(!this.m_bHasTabs){
return;
}
this.m_tabInfo={};
var _9c3=this.getReportDiv();
var _9c4=_9c3.parentNode;
for(var i=0;i<_9c4.childNodes.length;i++){
var node=_9c4.childNodes[i];
if(node.getAttribute("id")!="CVReport"+this.m_sId){
_9c4.removeChild(node);
i--;
}
}
};
CCognosViewer.prototype.isSavedOutput=function(){
var _9c7=this.envParams["ui.action"];
return _9c7==="view"||_9c7==="buxView";
};
CCognosViewer.prototype.renderSavedOutputIFrame=function(url,_9c9,_9ca){
var _9cb=document.getElementById("CVReport"+this.getId());
var _9cc=document.createElement("iframe");
_9cc.style.width="100%";
_9cc.style.height="99%";
_9cc.id="CVIFrame"+this.getId();
_9cc.title=_9c9;
_9cc.setAttribute("frameBorder","0");
_9cb.appendChild(_9cc);
var obj=this;
var func=function(){
obj.renderTabs();
};
setTimeout(function(){
if(_9ca){
if(_9cc.attachEvent){
_9cc.attachEvent("onload",func);
}else{
_9cc.addEventListener("load",func,true);
}
}
_9cc.src=url;
},1);
};
CCognosViewer.prototype.updatePageState=function(_9cf){
if(_9cf&&this.getState()){
this.getState().setPageState(_9cf);
}
};
CCognosViewer.prototype.getPageInfo=function(){
if(this.m_viewerState&&this.m_viewerState.getPageState()){
var _9d0=this.m_viewerState.getPageState();
return {"currentPage":_9d0.getCurrentPage(),"pageCount":_9d0.getPageCount()};
}
return {};
};
CCognosViewer.prototype.isIWidgetMobile=function(){
return this.m_viewerWidget&&this.m_viewerWidget.isMobile();
};
CCognosViewer.prototype.isInteractiveViewer=function(){
return false;
};
CCognosViewer.prototype.launchGotoPageForIWidgetMobile=function(form){
if(this.isIWidgetMobile()){
this.m_viewerWidget.launchGotoPageForIWidgetMobile(form);
return true;
}
return false;
};
CCognosViewer.prototype.executeDrillThroughForIWidgetMobile=function(form){
if(this.isIWidgetMobile()){
this.m_viewerWidget.executeDrillThroughForIWidgetMobile(form);
return true;
}
return false;
};
CCognosViewer.prototype.getState=function(){
return this.m_viewerState;
};
CCognosViewer.prototype.getConfig=function(){
return this.m_viewerConfig;
};
CCognosViewer.prototype.getUIConfig=function(){
return this.m_viewerUIConfig;
};
CCognosViewer.prototype.setCurrentNodeFocus=function(node){
this.m_currentNodeFocus=node;
};
CCognosViewer.prototype.getCurrentNodeFocus=function(node){
return this.m_currentNodeFocus;
};
CCognosViewer.prototype.loadExtra=function(){
};
CCognosViewer.prototype.setRetryDispatcherEntry=function(_9d5){
this.m_retryDispatcherEntry=_9d5;
};
CCognosViewer.prototype.getRetryDispatcherEntry=function(){
return this.m_retryDispatcherEntry;
};
CCognosViewer.prototype.resetViewerDispatcher=function(){
if(this.m_viewerDispatcher!==null){
delete this.m_viewerDispatcher;
this.m_viewerDispatcher=new ViewerDispatcher();
}
};
CCognosViewer.prototype.getViewerDispatcher=function(){
return this.m_viewerDispatcher;
};
CCognosViewer.prototype.setFaultDispatcherEntry=function(_9d6){
this.m_faultDispatcherEntry=_9d6;
};
CCognosViewer.prototype.getFaultDispatcherEntry=function(){
return this.m_faultDispatcherEntry;
};
CCognosViewer.prototype.dispatchRequest=function(_9d7){
this.setFaultDispatcherEntry(null);
this.getViewerDispatcher().dispatchRequest(_9d7);
};
CCognosViewer.prototype.getActiveRequest=function(){
return this.getViewerDispatcher().getActiveRequest();
};
CCognosViewer.prototype.getProductLocale=function(){
if(this.sProductLocale){
return this.sProductLocale;
}
return "en";
};
CCognosViewer.prototype.getDirection=function(){
if(this.sDirection){
return this.sDirection;
}
return "ltr";
};
CCognosViewer.prototype.isBidiEnabled=function(){
if(this.bIsBidiEnabled){
return true;
}
return false;
};
CCognosViewer.prototype.getBaseTextDirection=function(){
if(this.isBidiEnabled()){
if(this.sBaseTextDirection){
return this.sBaseTextDirection;
}
}
return "";
};
CCognosViewer.prototype.getActionFactory=function(){
if(!this.m_actionFactory){
this.m_actionFactory=new ActionFactory(this);
}
return this.m_actionFactory;
};
CCognosViewer.prototype.getAction=function(_9d8){
var _9d8=this.getActionFactory().load(_9d8);
_9d8.setCognosViewer(this);
return _9d8;
};
CCognosViewer.prototype.getCalculationCache=function(){
return this.m_calculationCache;
};
CCognosViewer.prototype.updateOutputForA11ySupport=function(){
this.updateBorderCollapse();
if(this.getA11YHelper()){
this.getA11YHelper().addLabelledByForItemsOutsideOfContainers();
}
var _9d9=navigator.userAgent.toLowerCase();
var _9da=_9d9.indexOf("iphone")!=-1;
var _9db=_9d9.indexOf("ipod")!=-1;
var _9dc=_9d9.indexOf("ipad")!=-1;
var _9dd=_9da||_9db||_9dc;
var _9de=_9d9.indexOf("android")!=-1;
if(_9dd||_9de){
document.body.classList.add("clsViewerMobile");
}
};
CCognosViewer.prototype.checkForHighContrast=function(){
if(this.isBux){
this.m_bHighContrast=dojo.hasClass(document.body,"dijit_a11y")?true:false;
}else{
var _9df=document.createElement("div");
_9df.id=this.m_sId+"hc";
_9df.style.border="1px solid";
_9df.style.borderColor="red green";
_9df.style.height="10px";
_9df.style.top="-999px";
_9df.style.position="absolute";
document.body.appendChild(_9df);
var _9e0=null;
if(isIE()){
_9e0=_9df.currentStyle;
}else{
_9e0=_9df.ownerDocument.defaultView.getComputedStyle(_9df,null);
}
if(!_9e0){
return;
}
this.m_bHighContrast=_9e0.borderTopColor==_9e0.borderRightColor;
document.body.removeChild(_9df);
}
};
CCognosViewer.prototype.isHighContrast=function(){
if(typeof this.m_bHighContrast==="undefined"){
this.checkForHighContrast();
}
return this.m_bHighContrast;
};
CCognosViewer.prototype.isLimitedInteractiveMode=function(){
return this.envParams&&this.envParams.limitedInteractiveMode&&this.envParams.limitedInteractiveMode==="true";
};
CCognosViewer.prototype.updateBorderCollapse=function(){
if(this.isHighContrast()==true){
var _9e1=null;
if(this.envParams["ui.action"]=="view"&&!this.isBux){
var _9e2=document.getElementById("CVIFrame"+this.getId());
_9e1=_9e2.contentWindow.document;
}else{
_9e1=document.getElementById("CVReport"+this.getId());
}
var _9e3=_9e1.getElementsByTagName("table");
for(var i=0;i<_9e3.length;i++){
if(_9e3[i].style.borderCollapse=="collapse"){
_9e3[i].style.borderCollapse="separate";
}
}
}
};
CCognosViewer.prototype.isAccessibleMode=function(){
if(this.m_bAccessibleMode==true){
return true;
}
return false;
};
CCognosViewer.prototype.isSinglePageReport=function(){
for(var _9e5 in this.m_aSecRequests){
if(this.m_aSecRequests[_9e5]=="nextPage"||this.m_aSecRequests[_9e5]=="previousPage"){
return false;
}
}
return true;
};
CCognosViewer.prototype.hasNextPage=function(){
for(var _9e6 in this.m_aSecRequests){
if(this.m_aSecRequests[_9e6]=="nextPage"){
return true;
}
}
return false;
};
CCognosViewer.prototype.hasPrevPage=function(){
for(var _9e7 in this.m_aSecRequests){
if(this.m_aSecRequests[_9e7]=="previousPage"){
return true;
}
}
return false;
};
CCognosViewer.prototype.captureHotkeyPageNavigation=function(evt){
evt=(evt)?evt:((event)?event:null);
if(evt){
var node=getNodeFromEvent(evt);
var _9ea=(node&&node.nodeName)?node.nodeName.toLowerCase():null;
if((evt.keyCode==8&&_9ea!="input"&&_9ea!="textarea")||(evt.altKey==true&&(evt.keyCode==37||evt.keyCode==39))){
evt.returnValue=false;
evt.cancelBubble=true;
if(typeof evt.stopPropagation!="undefined"){
evt.stopPropagation();
}
if(typeof evt.preventDefault!="undefined"){
evt.preventDefault();
}
return false;
}
}
return true;
};
CCognosViewer.prototype.setUseWorkingDialog=function(_9eb){
this.m_bUseWorkingDialog=_9eb;
};
CCognosViewer.prototype.getWorkingDialog=function(){
if(!this.m_oWorkingDialog&&this.m_bUseWorkingDialog&&typeof WorkingDialog!=="undefined"){
if(this.getConfig()&&this.getConfig().getHttpRequestConfig()&&this.getConfig().getHttpRequestConfig().getWorkingDialog()){
this.m_oWorkingDialog=this.getConfig().getHttpRequestConfig().getWorkingDialog();
}else{
this.m_oWorkingDialog=new WorkingDialog(this);
}
}
return this.m_oWorkingDialog;
};
CCognosViewer.prototype.getRequestIndicator=function(){
if(this.m_bUseWorkingDialog&&!this.m_oRequestExecutedIndicator&&typeof RequestExecutedIndicator!=="undefined"){
if(this.getConfig()&&this.getConfig().getHttpRequestConfig()&&this.getConfig().getHttpRequestConfig().getRequestIndicator()){
this.m_oRequestExecutedIndicator=this.getConfig().getHttpRequestConfig().getRequestIndicator();
}else{
this.m_oRequestExecutedIndicator=new RequestExecutedIndicator(this);
}
}
return this.m_oRequestExecutedIndicator;
};
CCognosViewer.prototype.disableBrowserHotkeyPageNavigation=function(){
if(document.attachEvent){
document.attachEvent("onkeydown",this.captureHotkeyPageNavigation);
}else{
if(document.addEventListener){
document.addEventListener("keydown",this.captureHotkeyPageNavigation,false);
}
}
};
CCognosViewer.prototype.setHasPrompts=function(_9ec){
if(!_9ec){
this.preProcessControlArray=[];
}
this.m_bReportHasPrompts=_9ec;
};
CCognosViewer.prototype.getHasPrompts=function(){
return this.m_bReportHasPrompts;
};
CCognosViewer.prototype.setUsePageRequest=function(_9ed){
this.m_viewerDispatcher.setUsePageRequest(_9ed);
};
CCognosViewer.prototype.getUsePageRequest=function(){
return this.m_viewerDispatcher.getUsePageRequest();
};
CCognosViewer.prototype.setKeepSessionAlive=function(_9ee){
this.m_bKeepSessionAlive=_9ee;
};
CCognosViewer.prototype.getKeepSessionAlive=function(){
return this.m_bKeepSessionAlive;
};
CCognosViewer.prototype.getWebContentRoot=function(){
if(typeof this.sWebContentRoot!="undefined"){
return this.sWebContentRoot;
}else{
return "..";
}
};
CCognosViewer.prototype.getSkin=function(){
if(typeof this.sSkin!="undefined"){
return this.sSkin;
}else{
return this.getWebContentRoot()+"/skins/corporate";
}
};
CCognosViewer.prototype.getSelectionController=function(){
var _9ef;
try{
_9ef=getCognosViewerSCObjectRef(this.m_sId);
}
catch(e){
_9ef=null;
}
return _9ef;
};
CCognosViewer.prototype.addCallback=function(_9f0,oFct,_9f2){
if(!this.m_aCallback){
this.m_aCallback=[];
}
this.m_aCallback=this.m_aCallback.concat({m_sEvent:_9f0,m_oCallback:oFct,m_bCaptureEvent:(_9f2===true)});
};
CCognosViewer.prototype.canDrillDown=function(sId){
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _9f5=this.getSelectionController();
if(_9f5){
return (_9f5.canDrillDown(sCtx));
}
}
return false;
};
CCognosViewer.prototype.canDrillUp=function(sId){
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _9f8=this.getSelectionController();
if(_9f8){
return (_9f8.canDrillUp(sCtx));
}
}
return false;
};
CCognosViewer.prototype.canSubmitPrompt=function(){
var _9f9=null;
if(this.preProcessControlArray&&this.preProcessControlArray instanceof Array){
var _9fa=this.preProcessControlArray.length;
for(var k=0;k<_9fa;k++){
_9f9=eval(this.preProcessControlArray[k]);
if(_9f9.isValid()===false){
if(!this.m_reportRenderingDone||!_9f9.getCascadeOnParameter||!_9f9.getCascadeOnParameter()){
return false;
}
}
}
}
return true;
};
CCognosViewer.prototype.closeContextMenuAndToolbarMenus=function(){
if(this.rvMainWnd){
this.rvMainWnd.closeContextMenuAndToolbarMenus();
}
};
CCognosViewer.prototype.dcm=function(_9fc,_9fd){
if(this.canDisplayContextMenu()){
if(this.preSelectNode==true){
_9fd=false;
this.preSelectNode=false;
}
if(this.rvMainWnd.displayContextMenu(_9fc,_9fd)!=false){
return stopEventBubble(_9fc);
}
}
};
CCognosViewer.prototype.canDisplayContextMenu=function(){
if(!this.getUIConfig()||this.getUIConfig().getShowContextMenu()){
return (!this.isWorkingOrPrompting()&&this.rvMainWnd!=null&&typeof this.bCanUseCognosViewerContextMenu!="undefined"&&this.bCanUseCognosViewerContextMenu);
}
return false;
};
CCognosViewer.prototype.de=function(_9fe){
var _9ff=this.getDrillMgr();
if(_9ff){
_9ff.singleClickDrillEvent(_9fe,"RV");
}
};
CCognosViewer.prototype.debug=function(sMsg){
if(this.m_bDebug){
var _a01="";
var _a02=this.debug.caller;
if(typeof _a02=="object"&&_a02!==null){
_a01=_a02.toString().match(/function (\w*)/)[1];
}
if(!_a01){
_a01="?";
}
alert(_a01+": "+sMsg);
}
};
CCognosViewer.prototype.callbackExists=function(_a03){
var _a04=false;
if(this.m_aCallback&&this.m_aCallback.length){
for(var _a05=0;_a05<this.m_aCallback.length;++_a05){
var oCB=this.m_aCallback[_a05];
if(oCB.m_sEvent==_a03){
return true;
}
}
}
return false;
};
CCognosViewer.prototype.executeCallback=function(_a07){
var _a08=false;
if(this.m_aCallback&&this.m_aCallback.length){
for(var _a09=0;_a09<this.m_aCallback.length;++_a09){
var oCB=this.m_aCallback[_a09];
if(oCB.m_sEvent==_a07){
if(typeof oCB.m_oCallback=="function"){
oCB.m_oCallback();
}
if(oCB.m_bCaptureEvent){
_a08=true;
}
}
}
}
return _a08;
};
CCognosViewer.prototype.getCAFContext=function(){
return this.m_sCAFContext;
};
CCognosViewer.prototype.getSoapFault=function(){
return this.m_sSoapFault;
};
CCognosViewer.prototype.getColumnContextIds=function(sId){
return this.getContextIds(sId,2);
};
CCognosViewer.prototype.getConversation=function(){
return this.m_sConversation;
};
CCognosViewer.prototype.getStatus=function(){
return (this.m_sStatus?this.m_sStatus:"");
};
CCognosViewer.prototype.isWorking=function(_a0c){
if(typeof _a0c!="string"){
_a0c=this.getStatus();
}
return ((""+_a0c).match(/^(working|stillWorking)$/)?true:false);
};
CCognosViewer.prototype.isWorkingOrPrompting=function(){
return (this.getStatus().match(/^(working|stillWorking|prompting)$/)?true:false);
};
CCognosViewer.prototype.getActionState=function(){
return this.m_sActionState;
};
CCognosViewer.prototype.getDataItemName=function(sId){
var _a0e=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a10=this.getSelectionController();
if(_a10){
var _a11=_a10.getRefDataItem(sCtx);
if(_a11){
_a0e=_a11;
}
}
}
return _a0e;
};
CCognosViewer.prototype.getDataType=function(sId){
var _a13=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a15=this.getSelectionController();
if(_a15){
var _a16=_a15.getDataType(sCtx);
if(_a16){
_a13=_a16;
}
}
}
return _a13;
};
CCognosViewer.prototype.getDepth=function(sId){
var _a18=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a1a=this.getSelectionController();
if(_a1a){
var _a1b=_a1a.getDepth(sCtx);
if(_a1b){
_a18=_a1b;
}
}
}
return _a18;
};
CCognosViewer.prototype.getDrillMgr=function(){
if(!this.m_oDrillMgr){
this.loadExtra();
if(typeof CDrillManager=="function"){
this.m_oDrillMgr=new CDrillManager(this);
this.goDrillManager=this.m_oDrillMgr;
}
}
return this.m_oDrillMgr;
};
CCognosViewer.prototype.getSubscriptionManager=function(){
if(!this.m_oSubscriptionManager){
this.loadExtra();
if(typeof CSubscriptionManager=="function"){
this.m_oSubscriptionManager=new CSubscriptionManager(this);
}
}
return this.m_oSubscriptionManager;
};
CCognosViewer.prototype.updateGlobalParameters=function(_a1c){
var oReq=new ViewerDispatcherEntry(this);
oReq.addFormField("ui.action","forward");
oReq.addFormField("generic.anyURI.runOptionEnum#globalParameters",_a1c);
oReq.addFormField("run.prompt",true);
oReq.addFormField("_promptControl","reprompt");
this.submitPromptValues(oReq);
};
CCognosViewer.prototype.getExecutionParameters=function(){
return this.m_sParameters;
};
CCognosViewer.prototype.getGateway=function(){
return this.m_sGateway;
};
CCognosViewer.prototype.getSpecification=function(){
return this.envParams["ui.spec"];
};
CCognosViewer.prototype.getHierarchyUniqueName=function(sId){
var sHun=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a21=this.getSelectionController();
if(_a21){
var aHUN=_a21.getHun(sCtx);
if(aHUN){
sHun=aHUN;
}
}
}
return sHun;
};
CCognosViewer.prototype.getDimensionUniqueName=function(sId){
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a25=this.getSelectionController();
if(_a25){
var aDUN=_a25.getDun(sCtx);
if(aDUN){
return aDUN;
}
}
}
return null;
};
CCognosViewer.prototype.getId=function(){
return this.m_sId;
};
CCognosViewer.prototype.getLevelId=function(sId){
var _a28=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a2a=this.getSelectionController();
if(_a2a){
var aLUN=_a2a.getLun(sCtx);
if(aLUN){
_a28=aLUN;
}
}
}
return _a28;
};
CCognosViewer.prototype.getMemberUniqueName=function(sId){
var sMUN=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a2f=this.getSelectionController();
if(_a2f){
var aMUN=_a2f.getMun(sCtx);
if(aMUN){
sMUN=aMUN;
}
}
}
return sMUN;
};
CCognosViewer.prototype.getObjectId=function(){
var _a31="window";
if(typeof this.getId()=="string"){
_a31=getCognosViewerObjectRefAsString(this.getId());
}
return _a31;
};
CCognosViewer.prototype.getQueryModelId=function(sId){
var _a33=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a35=this.getSelectionController();
if(_a35){
var _a36=_a35.getQueryModelId(sCtx);
if(_a36){
_a33=_a36;
}
}
}
return _a33;
};
CCognosViewer.prototype.getQueryName=function(sId){
var _a38=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a3a=this.getSelectionController();
if(_a3a){
var _a3b=_a3a.getRefQuery(sCtx);
if(_a3b){
_a38=_a3b;
}
}
}
return _a38;
};
CCognosViewer.prototype.getContextIds=function(sId,_a3d){
var aIds=[];
var sCtx=this.findCtx(sId);
if(sCtx){
var _a40=sCtx.split("::");
if(_a40&&_a40.length>1&&_a3d<_a40.length){
aIds=_a40[_a3d].split(":");
}
}
return aIds;
};
CCognosViewer.prototype.getRowContextIds=function(sId){
return this.getContextIds(sId,1);
};
CCognosViewer.prototype.getPageContextIds=function(sId){
return this.getContextIds(sId,3);
};
CCognosViewer.prototype.getString=function(sKey){
if(RV_RES&&RV_RES[sKey]){
return RV_RES[sKey];
}
return sKey;
};
CCognosViewer.prototype.getRV=function(){
if(typeof this.m_oCVMgr=="object"){
return this.m_oCVMgr;
}
return window;
};
CCognosViewer.prototype.getSecondaryRequests=function(){
return this.m_aSecRequests;
};
CCognosViewer.prototype.getTracking=function(){
return this.m_sTracking;
};
CCognosViewer.prototype.findCtx=function(sId){
var sCtx="";
if(typeof sId=="string"){
var aCtx=this.getReportContextHelper().processCtx(sId);
var _a47=aCtx[0][0];
var _a48=this.getSelectionController();
if(_a48){
if(_a48.isContextId(_a47)){
sCtx=sId;
}
}
}
if(!sCtx){
var _a49=this.findElementWithCtx(sId);
if(_a49){
sCtx=_a49.getAttribute("ctx");
}
}
return sCtx;
};
CCognosViewer.prototype.findElementWithCtx=function(sId){
var _a4b=sId;
if(typeof sId=="string"){
_a4b=this.findElementWithCtx(document.getElementById(sId));
}
if(_a4b){
if(_a4b.getAttribute&&_a4b.getAttribute("ctx")){
return _a4b;
}
for(var _a4c=0;_a4c<_a4b.childNodes.length;_a4c++){
var _a4d=this.findElementWithCtx(_a4b.childNodes[_a4c]);
if(_a4d){
return _a4d;
}
}
}
return null;
};
CCognosViewer.prototype.getUseValue=function(sId){
var sVal=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _a51=this.getSelectionController();
if(_a51){
sVal=_a51.getUseValue(sCtx);
}
}
return sVal;
};
CCognosViewer.prototype.init=function(_a52){
if(_a52&&typeof _a52=="object"){
for(var _a53 in _a52){
this[_a53]=_a52[_a53];
}
}
};
CCognosViewer.prototype.initViewer=function(_a54){
var _a55=new RequestHandler(this);
var _a56=document.getElementById("formBackJax"+this.getId());
if(_a56&&typeof _a56.state!="undefined"&&_a56.state.value.length>0){
_a55.loadReportHTML(_a56.result.value);
var _a57=eval("("+_a56.state.value+")");
_a55.updateViewerState(_a57);
_a55.postComplete();
}else{
if(this.getUsePageRequest()){
var _a58=_a54?_a54.m_sStatus:null;
if(isIE()){
if(window.location.hash=="#working"){
window.history.go(-2);
return;
}else{
if(_a58==="working"||_a58==="stillWorking"){
window.location.hash="#working";
}
}
}else{
if(_a56&&_a56.working){
if(_a56.working.value=="true"){
window.history.go(-1);
return;
}else{
if(_a58==="working"||_a58==="stillWorking"){
_a56.working.value="true";
}
}
}
}
}
_a55.processInitialResponse(_a54);
}
};
CCognosViewer.prototype.saveBackJaxInformation=function(_a59){
var _a5a=document.getElementById("formBackJax"+this.getId());
if(_a5a){
if(typeof _a5a.state!="undefined"){
_a5a.state.value=_a59.getResponseStateText();
}
if(typeof _a5a.result!="undefined"){
_a5a.result.value=_a59.getResult();
}
}
};
CCognosViewer.prototype.pcc=function(evt){
if(evt&&typeof evt.button!="undefined"&&evt.button!="1"){
this.preSelectNode=true;
var _a5c=this.getSelectionController();
if(_a5c){
_a5c.pageContextClicked(evt);
}
}
};
CCognosViewer.prototype.isValidAjaxResponse=function(_a5d){
return (_a5d&&_a5d.childNodes&&_a5d.childNodes.length>0&&_a5d.childNodes[0].nodeName!="parsererror"?true:false);
};
CCognosViewer.prototype.resubmitInSafeMode=function(_a5e){
if(this.m_bUseSafeMode){
this.resetViewerDispatcher();
this.setUsePageRequest(true);
this.envParams["cv.useAjax"]="false";
if(_a5e){
_a5e.retryRequest();
}
}
};
CCognosViewer.prototype.showLoadedContent=function(_a5f){
if(_a5f!==null&&typeof _a5f!="undefined"){
_a5f.style.display="block";
}
this.m_resizeReady=true;
this.doneLoading();
var obj=this;
setTimeout(function(){
obj.renderTabs();
},1);
};
CCognosViewer.prototype.doneLoading=function(){
var _a61=this.getViewerWidget();
if(_a61){
if(window.IBM&&window.IBM.perf){
window.IBM.perf.log("viewer_doneLoading",this);
}
var _a62=this.getStatus();
if(!this.m_reportRenderingDone&&this.m_resizeReady&&this.m_stateSet){
var _a63=_a62=="working"||_a62=="stillWorking"||_a62=="fault";
_a61.fireEvent("com.ibm.bux.widget.render.done",null,{noAutoResize:_a63});
if(_a62=="complete"){
if(window.IBM&&window.IBM.perf){
window.IBM.perf.log("viewer_doneLoading",this);
}
if(typeof _a61.postLoadContent=="function"){
_a61.postLoadContent();
}
this.m_reportRenderingDone=true;
if(!_a63){
var _a64=this;
setTimeout(function(){
_a64.m_readyToRespondToResizeEvent=true;
},20);
}
}
}
if(_a62!="fault"){
_a61.clearErrorDlg();
}
this.doneLoadingUpdateA11Y(_a62);
}else{
var _a62=this.getStatus();
if(_a62=="complete"){
this.m_reportRenderingDone=true;
this.JAWSTalk(RV_RES.IDS_JS_READY);
}else{
if(_a62=="working"){
this.JAWSTalk(RV_RES.IDS_JS_WAIT_PAGE_LOADING);
}
}
}
};
CCognosViewer.prototype.doneLoadingUpdateA11Y=function(_a65){
if(this.getKeepFocus()!==false&&this.getKeepFocus()!=null){
var _a66=this.getKeepFocus();
if(_a65=="complete"){
this.setKeepFocus(false);
}
var _a67=null;
if(this.getVisibleDialog()!==null){
_a67=this.getVisibleDialog().getDialogDiv();
}else{
if(_a66===true){
_a67=document.getElementById("CVReport"+this.getId());
}else{
if(typeof _a66=="string"){
_a67=document.getElementById(_a66);
}else{
if(_a66!==null){
_a67=_a66;
if(this.isBux){
dojo.window.scrollIntoView(_a67);
}
}
}
}
}
if(_a67){
setFocusToFirstTabItem(_a67);
}
if(_a65=="complete"){
this.JAWSTalk(RV_RES.IDS_JS_READY);
}else{
if(_a65=="working"||_a65=="stillWorking"){
this.JAWSTalk(RV_RES.IDS_JS_WAIT_PAGE_LOADING);
}
}
}
};
CCognosViewer.prototype.JAWSTalk=function(_a68){
if(this.isMobile()||this.isIWidgetMobile()){
return;
}
var id=this.getId();
var div=document.getElementById("JAWS_Alert_"+id);
if(div){
div.parentNode.removeChild(div);
}
div=document.createElement("div");
div.id="JAWS_Alert_"+id;
div.style.position="absolute";
div.style.top="-9000px";
div.style.display="none";
div.setAttribute("role","alert");
div.appendChild(document.createTextNode(_a68));
var _a6b=document.getElementById("RVContent"+id);
if(_a6b){
_a6b.appendChild(div);
}else{
if(typeof console!="undefined"&&console&&console.log){
console.log("CCognosViewer: Could not find the Viewer div to append the JAWS alert.");
}
}
};
CCognosViewer.prototype.canInsertExpandIconsForAllCrosstabs=function(){
if(this.isLimitedInteractiveMode()||this.isBlacklisted("ExpandMember")||this.isIWidgetMobile()){
return false;
}
var _a6c=this.getAdvancedServerProperty("VIEWER_JS_EXPAND_COLLAPSE_CONTROLS_DEFAULT");
if(_a6c===null){
return false;
}
var _a6d=this.getViewerWidget().getProperties().getShowExpandCollapseIconFlag();
return (_a6c.toLowerCase()==="on"&&_a6d!==false)||(_a6c.toLowerCase()==="off"&&_a6d===true);
};
CCognosViewer.prototype.setMaxContentSize=function(){
if("10"!=window.getIEVersion()){
return;
}
if(document.body.className==="viewer"){
var _a6e=document.body.offsetHeight;
var _a6f=this.getNonReportHeight(document.getElementById("CVReport"+this.getId()));
var _a70=document.getElementById("mainViewerTable"+this.getId());
_a70.style.maxHeight=_a6e-_a6f-2+"px";
var _a71=GUtil.generateCallback(this.setMaxContentSize,[true],this);
if(!this.attachedOnResize){
this.attachedOnResize=true;
if(window.attachEvent){
window.attachEvent("onresize",_a71);
}else{
if(window.addEventListener){
window.addEventListener("resize",_a71,false);
}
}
}
}
};
CCognosViewer.prototype.getNonReportHeight=function(node){
var _a73=0;
var _a74=node.parentNode;
if(!_a74){
return _a73;
}
if(_a74.childNodes.length>1){
for(var i=0;i<_a74.childNodes.length;i++){
var _a76=_a74.childNodes[i];
if(_a76!=node&&!isNaN(_a76.clientHeight)&&_a76.style.display!="none"){
_a73+=_a76.clientHeight;
}
}
}
if(node.getAttribute("id")!=("mainViewerTable"+this.m_viewerId)){
_a73+=this.getNonReportHeight(_a74);
}
return _a73;
};
CCognosViewer.prototype.addPageAdornments=function(){
this.m_layoutElements=null;
this.m_lidToElement=null;
this.initFlashCharts();
this.insertSortIconsForAllLists();
var _a77=this.getViewerWidget().getProperties();
if(this.canInsertExpandIconsForAllCrosstabs()){
this.insertExpandIconsForAllCrosstabs();
}
var _a78=document.getElementById("CVReport"+this.getId());
if(_a78){
var oCV=this;
setTimeout(function(){
if(oCV.getPinFreezeManager()&&oCV.getPinFreezeManager().hasFrozenContainers()){
oCV.getPinFreezeManager().renderReportWithFrozenContainers(_a78);
}
oCV.addInfoBar();
},1);
}
this.getViewerWidget().reselectSelectionFilterObjects();
this.getViewerWidget().addChromeWhitespaceHandler(this.getId());
};
CCognosViewer.prototype.addFlashChart=function(_a7a){
this.m_flashChartsObjectIds.push(_a7a);
};
CCognosViewer.prototype.flashChartError=function(_a7b){
var _a7c=this.getViewerWidget();
var _a7d=_a7c.getProperties();
_a7d.setProperty("flashCharts",false);
var _a7e=this.getAction("Redraw");
_a7e.isUndoable=function(){
return false;
};
_a7e.execute();
};
CCognosViewer.prototype.initFlashCharts=function(){
var _a7f=this.getViewerWidget();
if(this.m_flashChartsObjectIds.length>0){
var _a80=document.getElementById("rt"+this.getId());
if(window.addEventListener){
_a80.addEventListener("mousedown",onFlashChartRightClick,true);
}else{
var _a81={};
var _a82=function(){
this.releaseCapture();
};
var _a83=function(){
onFlashChartRightClick(event);
this.setCapture();
};
for(var i=0;i<this.m_flashChartsObjectIds.length;++i){
var _a85=this.m_flashChartsObjectIds[i];
var _a86=document.getElementById(_a85);
_a81[_a85]=1;
_a86.parentNode.onmouseup=_a82;
_a86.parentNode.onmousedown=_a83;
}
if(this.m_flashChartsObjectIds.length>0){
_a80.attachEvent("oncontextmenu",function(){
if(_a81[window.event.srcElement.id]){
return false;
}
});
}
}
if(_a7f){
_a7f.fireEvent("com.ibm.bux.widget.setShowBordersWhenInnactive",null,true);
}
}else{
if(_a7f){
_a7f.fireEvent("com.ibm.bux.widget.setShowBordersWhenInnactive",null,false);
}
}
};
CCognosViewer.prototype.initializeLayoutElements=function(){
var _a87=document.getElementById("rt"+this.getId());
var _a88=getElementsByAttribute(_a87,"*","lid");
this.m_lidToElement={};
this.m_layoutElements=[];
var _a89=0;
var _a8a=this.getPinFreezeManager();
for(var i=0;i<_a88.length;i++){
var e=_a88[i];
if(!_a8a||!_a8a.getContainerElement(e)||_a8a.isElementInMainOutput(e)){
this.m_layoutElements[_a89]=e;
this.m_lidToElement[e.getAttribute("lid")]=e;
_a89++;
}
}
};
CCognosViewer.prototype.getLayoutElement=function(_a8d){
if(!this.m_layoutElements){
this.initializeLayoutElements();
}
if(this.m_layoutElements){
return this.m_layoutElements[_a8d];
}
return null;
};
CCognosViewer.prototype.getLayoutElementFromLid=function(lid){
if(!this.m_lidToElement){
this.initializeLayoutElements();
}
return this.m_lidToElement[lid];
};
CCognosViewer.prototype.getInfoBars=function(){
return this.m_aInfoBar?this.m_aInfoBar:null;
};
CCognosViewer.prototype.addInfoBar=function(){
if(this.getAdvancedServerProperty("VIEWER_JS_HIDE_INFO_BAR")==="true"){
return;
}
var _a8f=this.getRAPReportInfo();
if(_a8f){
var _a90=document.getElementById("rt"+this.getId());
this.initializeLayoutElements();
var _a91=[];
this.m_aInfoBar=[];
for(var _a92=0;_a92<this.m_layoutElements.length;++_a92){
var _a93=this.m_layoutElements[_a92];
var lid=_a93.getAttribute("lid");
if(lid){
if(lid.indexOf("RAP_NDH_")>-1){
lid=lid.substring(8);
}
lid=lid.substring(0,lid.indexOf(this.getId()));
}
var _a95=_a8f.getContainer(lid);
if(_a95&&typeof _a95.parentContainer=="undefined"){
var _a96=this.collectChildContainers(_a95.container);
if(this.getPinFreezeManager()){
oPinFreezeContainerElement=this.getPinFreezeManager().getContainerElement(_a93);
_a93=(oPinFreezeContainerElement)?oPinFreezeContainerElement:_a93;
}
var _a97=new InfoBar(this,_a93,_a95,_a96,_a92);
_a97.setTimingDetails(_a8f._getEventTimings());
_a97.render();
if(_a97.hasSomethingRendered()){
_a91.push(_a97.getId());
}
this.m_aInfoBar.push(_a97);
}
}
var _a98=this.getViewerWidget();
if(_a98){
_a98.refreshInfoBarRenderedState(_a91);
}
}
};
CCognosViewer.prototype.collectChildContainers=function(_a99){
var _a9a=[];
var _a9b=this.getRAPReportInfo();
if(_a9b){
var _a9c=_a9b.getContainerCount();
for(var cidx=0;cidx<_a9c;++cidx){
var _a9e=_a9b.getContainerFromPos(cidx);
if(typeof _a9e.parentContainer!="undefined"&&_a9e.parentContainer==_a99){
_a9a.push(_a9e);
}
}
}
return _a9a;
};
CCognosViewer.prototype.addReportInfo=function(){
var _a9f=this.getViewerWidget();
if(typeof _a9f==="undefined"||_a9f===null){
return;
}
if(!_a9f.getAttributeValue("originalReport")||this.isIWidgetMobile()){
return;
}
var _aa0=this.envParams["baseReportModificationTime"];
var _aa1=_a9f.getAttributeValue("baseReportModificationTime");
if(typeof _aa0!=="undefined"&&typeof _aa1!=="undefined"&&_aa1&&_aa1!="<empty>"&&_aa0!==_aa1){
var cvid=this.getId();
var _aa3=document.getElementById("CVReport"+cvid);
var _aa4=_aa3.parentNode;
var id="ReportInfo"+cvid;
var _aa6=document.createElement("div");
_aa6.setAttribute("id",id+"_container");
_aa6.setAttribute("cvid",cvid);
_aa6.className="new-info-indicator BUXNoPrint";
var _aa7=document.createElement("img");
var img=null;
if(this.getDirection()==="rtl"){
img="/rv/images/action_show_info_rtl.png";
}else{
img="/rv/images/action_show_info.png";
}
_aa7.src=this.getWebContentRoot()+img;
_aa7.className="reportInfoIcon";
_aa7.setAttribute("tabIndex","0");
_aa7.setAttribute("alt","");
_aa7.setAttribute("title","");
_aa7.setAttribute("role","presentation");
var _aa9=RV_RES.IDS_JS_REPORT_INFO_TITLE;
var _aaa=RV_RES.IDS_JS_REPORT_INFO_TEXT;
var _aab=RV_RES.IDS_JS_REPORT_INFO_LINK_TEXT;
_aa6.appendChild(_aa7);
_aa4.insertBefore(_aa6,_aa3);
this.m_reportInfoTooltip=new bux.reportViewer.ReportInfo({connectId:[id+"_container"],focusElement:_aa7,position:["above","below"],title:_aa9,text:_aaa,linkText:_aab,linkScript:getCognosViewerObjectRefAsString(cvid)+".reportInfoResetReport();",allowMouseOverToolTip:true});
}
};
CCognosViewer.prototype.reportInfoResetReport=function(){
this.executeAction("ResetToOriginal");
};
CCognosViewer.prototype.hideReportInfo=function(){
var _aac=document.getElementById("ReportInfo"+this.getId()+"_container");
if(typeof _aac!=="undefined"&&_aac!==null){
_aac.style.visibility="hidden";
}
};
CCognosViewer.prototype.insertSortIcons=function(){
var _aad=this.envParams?this.envParams.limitedInteractiveMode:true;
if(typeof _aad==="undefined"||_aad===true){
return;
}
if(this.envParams["ui.action"]==="run"||this.envParams["ui.primaryAction"]==="run"){
this.insertSortIconsForAllLists();
}
};
CCognosViewer.prototype._getContainers=function(_aae){
var _aaf=[];
var _ab0="",_ab1="";
if(_aae==="list"){
_ab0="list";
_ab1="ls";
}else{
if(_aae==="crosstab"){
_ab0="crosstab";
_ab1="xt";
}
}
var _ab2=document.getElementById("CVReport"+this.getId());
if(this.getRAPReportInfo()){
var _ab3=this.getRAPReportInfo().getContainerIds(_ab0);
for(var i=0;i<_ab3.length;++i){
var _ab5=getElementsByAttribute(_ab2,"table","lid",_ab3[i]+this.getId(),1);
if(_ab5&&_ab5.length>0){
_aaf.push(_ab5[0]);
}
}
}else{
_aaf=getElementsByClassName(_ab2,"table",_ab1);
}
return _aaf;
};
CCognosViewer.prototype.insertSortIconsForAllLists=function(){
var _ab6=this._getContainers("list");
for(var i=0;i<_ab6.length;++i){
this.insertSortIconsToList(_ab6[i]);
}
};
CCognosViewer.prototype.insertSortIconsToList=function(_ab8){
var _ab9=getElementsByAttribute(_ab8,"*","type","columnTitle");
for(var i=0;i<_ab9.length;++i){
var _abb=_ab9[i];
this.getSelectionController().getSelectionObjectFactory().getSelectionObject(_abb);
if(_abb.getAttribute("canSort")!="false"&&_abb.getAttribute("CTNM")===null&&_abb.getAttribute("CC")===null){
var _abc=false;
for(var _abd=0;_abd<_abb.childNodes.length;_abd++){
var _abe=_abb.childNodes[_abd];
if(_abe.nodeName.toLowerCase()=="img"){
if(_abe.id&&_abe.id.indexOf("sortimg")===0){
_abc=true;
break;
}
var sLid=_abe.getAttribute("lid");
if(sLid&&sLid.indexOf("SortIcon")!==-1){
_abb.removeChild(_abe);
break;
}
}
}
if(!_abc&&this.canInsertSortIcon(_abb)){
this.insertSortIconToColumnHeader(_abb);
}
}
}
};
CCognosViewer.prototype.isDrillBlackListed=function(){
if(typeof this.m_bDrillBlacklisted=="undefined"){
this.m_bDrillBlacklisted=this.isBlacklisted("DrillDown")||this.isBlacklisted("DrillUp");
}
return this.m_bDrillBlacklisted;
};
CCognosViewer.prototype.isBlacklisted=function(item){
return this.UIBlacklist&&this.UIBlacklist.indexOf(" "+item+" ")>0;
};
CCognosViewer.prototype.canInsertSortIcon=function(_ac1){
var _ac2=_ac1.getAttribute("rp_sort");
return ((!this.isLimitedInteractiveMode()&&!this.isBlacklisted("Sort"))||(_ac2!==undefined&&_ac2!==null&&_ac2.length>0));
};
CCognosViewer.prototype.insertSortIconToColumnHeader=function(_ac3){
if(!_ac3.style.whiteSpace){
_ac3.style.whiteSpace="nowrap";
}
var _ac4=document.createElement("img");
_ac4.setAttribute("id","sortimg"+Math.random());
if((!this.isLimitedInteractiveMode()&&!this.isBlacklisted("Sort"))){
_ac4.onmouseover=function(){
this.setAttribute("oldClassName",this.className);
this.className+=" sortIconOver";
};
_ac4.onmouseout=function(){
this.className=this.getAttribute("oldClassName");
this.removeAttribute("oldClassName");
};
}
_ac4.src=this.getImgSrc(_ac3);
var _ac5=this.getSortInfo(_ac3);
var _ac6=this.getSortOrder(_ac5);
_ac4.setAttribute("alt",this.getSortAltText(_ac6));
_ac4.setAttribute("title",this.getSortAltText(_ac6));
_ac4.className=this.getSortClass(_ac5);
_ac4.setAttribute("sortOrder",_ac6);
_ac3.appendChild(_ac4);
};
CCognosViewer.prototype.canInsertShowExpandCollapseIconForNode=function(_ac7,_ac8){
var _ac9=this.getSelectionController();
var _aca=_ac9.hasCalculationMetadata(_ac8,[_ac8],"crosstab");
return ((_ac9.canDrillDown(_ac8)||_ac7.alwaysCanExpandCollapse)&&!_ac9.isCalculationOrMeasure(_ac8,_aca));
};
CCognosViewer.prototype.insertExpandIconsForAllCrosstabs=function(){
var _acb=this._getContainers("crosstab");
var _acc=this;
var _acd=this.getRAPReportInfo();
var _ace=this.getReportContextHelper();
for(var i=0;i<_acb.length;i++){
var _ad0=_acb[i];
var _ad1=_ad0.getAttribute("lid");
_ad1=_ad1.substring(0,_ad1.length-this.getId().length);
var _ad2=getElementsByAttribute(_ad0,["td","th"],"ctnm","true");
for(var j=0;j<_ad2.length;j++){
var _ad4=_ad2[j];
var sCtx=this.findCtx(_ad4);
var _ad6=_ace.getDataItemName(sCtx);
if(_ad6){
var _ad7=_acd.getItemInfo(_ad1,_ad6);
var _ad8=_ace.processCtx(sCtx);
if(this.canInsertShowExpandCollapseIconForNode(_ad7,_ad8[0][0])){
var sMun=_ace.getMun(sCtx);
var _ada=sMun&&_ad7.expandedMembers&&_ad7.expandedMembers[sMun]===true;
var _adb=document.createElement("div");
_adb.setAttribute("skipSelection","true");
_adb.className="expandButton "+(_ada?"collapse":"expand");
_ad4.insertBefore(_adb,_ad4.firstChild);
var _adc=document.createElement("span");
_adc.className="expandButtonCaption";
_adc.innerHTML=(_ada?"[-]":"[+]");
_adb.appendChild(_adc);
}
}
}
}
};
CCognosViewer.prototype.removeExpandIconsForAllCrosstabs=function(){
var _add=this._getContainers("crosstab");
for(var i=0;i<_add.length;i++){
var _adf=_add[i];
var _ae0=_adf.getAttribute("lid");
_ae0=_ae0.substring(0,_ae0.length-this.getId().length);
var _ae1=getElementsByAttribute(_adf,"td","ctnm","true");
for(var j=0;j<_ae1.length;j++){
var _ae3=_ae1[j];
if(_ae3.firstChild.className==="expandButton collapse"||_ae3.firstChild.className==="expandButton expand"){
_ae3.removeChild(_ae3.firstChild);
}
}
}
};
CCognosViewer.prototype.fillInContextData=function(){
if(!this.isLimitedInteractiveMode()){
var _ae4=document.getElementById("CVReport"+this.getId());
var _ae5=getElementsByClassName(_ae4,"table","ls");
for(var i=0;i<_ae5.length;++i){
var _ae7=getElementsByAttribute(_ae5[i],"*","type","columnTitle");
for(var j=0;j<_ae7.length;++j){
this.getSelectionController().getSelectionObjectFactory().getSelectionObject(_ae7[j]);
}
}
}
};
CCognosViewer.prototype.getSortAltText=function(_ae9){
if(_ae9==="ascending"){
return RV_RES.IDS_JS_SORT_ASCENDING;
}else{
if(_ae9==="descending"){
return RV_RES.IDS_JS_SORT_DESCENDING;
}else{
if(_ae9==="nosort"){
return RV_RES.IDS_JS_NOT_SORTED;
}
}
}
};
CCognosViewer.prototype.getSortInfo=function(_aea){
var _aeb=_aea.getAttribute("rp_sort");
if(_aeb){
_aeb=_aeb.split(".");
}
return _aeb;
};
CCognosViewer.prototype.getSortClass=function(_aec){
var _aed="sortIconHidden";
if(_aec){
if(_aec[0]==="d"||_aec[0]==="a"){
_aed="sortIconVisible";
}
}
return _aed;
};
CCognosViewer.prototype.getSortOrder=function(_aee){
var _aef="nosort";
if(_aee){
if(_aee[0]==="d"){
_aef="descending";
}else{
if(_aee[0]==="a"){
_aef="ascending";
}
}
}
return _aef;
};
CCognosViewer.prototype.getImgSrc=function(_af0){
var _af1=_af0.getAttribute("rp_sort");
var src=this.getWebContentRoot()+"/rv/images/"+this.getSortIconName(_af1);
return src;
};
CCognosViewer.prototype.getSortIconName=function(_af3){
var _af4="sort_no.gif";
if(_af3){
_af3=_af3.split(".");
if(_af3[0]==="d"){
_af4="sort_descending.gif";
}else{
if(_af3[0]==="a"){
_af4="sort_ascending.gif";
}
}
}
return _af4;
};
CCognosViewer.prototype.shouldWriteNavLinks=function(){
if(this.envParams["cv.navlinks"]=="false"){
return false;
}else{
if(!this.getUIConfig()||this.getUIConfig().getShowPageNavigation()){
if(this.rvMainWnd||(this.isBux&&!this.isActiveReport())){
return true;
}
}
}
return false;
};
CCognosViewer.prototype.isActiveReport=function(){
if(this.envParams["cv.responseFormat"]==="activeReport"){
return true;
}
return false;
};
CCognosViewer.prototype.resetRaiseSharePromptEventFlag=function(){
this.m_raiseSharePromptEvent=true;
};
CCognosViewer.prototype.resetbHasPromptFlag=function(){
this.m_bHasPrompt=null;
};
CCognosViewer.prototype.disableRaiseSharePromptEvent=function(){
this.m_raiseSharePromptEvent=false;
};
CCognosViewer.prototype.widgetHasPromptParameters=function(){
var _af5=this.getViewerWidget();
return (_af5&&_af5.promptParametersRetrieved==true&&this.envParams&&typeof this.envParams["reportPrompts"]!="undefined"&&this.envParams["reportPrompts"]!=null&&this.envParams["reportPrompts"].length>0);
};
CCognosViewer.prototype.getPromptParametersInfo=function(){
var _af6=null;
if(this.widgetHasPromptParameters()){
_af6="<widget><parameterValues>"+sXmlEncode(this.getExecutionParameters())+"</parameterValues>"+this.envParams["reportPrompts"]+"</widget>";
}
return _af6;
};
CCognosViewer.prototype.raisePromptEvent=function(_af7,_af8,_af9){
try{
var _afa=this.getViewerWidget();
_afa.getWidgetContextManager().raisePromptEvent(_af7,_af8,_af8.get("ui.action"),this.getModelPath(),_af9);
}
catch(e){
}
};
CCognosViewer.prototype.getModelPath=function(){
var _afb=this.getSelectionController().getModelPathForCurrentSelection();
if(_afb){
return _afb;
}else{
if(this.envParams.modelPath){
return this.envParams.modelPath;
}else{
if(typeof document.forms["formWarpRequest"+this.getId()].modelPath!=="undefined"){
return document.forms["formWarpRequest"+this.getId()].modelPath.value;
}
}
}
return "";
};
CCognosViewer.prototype.setKeepFocus=function(_afc){
this._keepFocus=_afc;
};
CCognosViewer.prototype.getKeepFocus=function(){
if(typeof this._keepFocus!="undefined"){
return this._keepFocus;
}
return false;
};
CCognosViewer.prototype.onFocus=function(evt){
var _afe=this.getA11YHelper();
if(_afe){
_afe.onFocus(evt);
}
};
CCognosViewer.prototype.getA11YHelper=function(){
if(!this.a11yHelper){
this.loadExtra();
if(typeof ViewerA11YHelper=="function"){
this.a11yHelper=new ViewerA11YHelper(this);
}else{
if(typeof console!=="undefined"&&console.log){
console.log("CCognosViewer: Could not create ViewerA11YHelper object.");
}
return null;
}
}
return this.a11yHelper;
};
CCognosViewer.prototype.onKeyDown=function(evt){
if(this.getA11YHelper()){
this.getA11YHelper().onKeyDown(evt);
}
};
CCognosViewer.prototype.updateSkipToReportLink=function(){
var _b00=this.getStatus();
var _b01=document.getElementById("cvSkipToReport"+this.getId());
if(_b01){
_b01.style.display=_b00=="prompting"?"none":"";
}
};
CCognosViewer.prototype.updateSkipToNavigationLink=function(_b02){
var _b03=document.getElementById("cvSkipToNavigation"+this.getId());
if(_b03){
_b03.style.display=_b02?"none":"";
}
};
CCognosViewer.prototype.pageAction=function(_b04){
this.setKeepFocus("CVNavLinks"+this.getId());
var _b05=new ViewerDispatcherEntry(this);
_b05.addFormField("ui.action",_b04);
if(this.getCurrentlySelectedTab()){
_b05.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",this.getCurrentlySelectedTab());
}
this.dispatchRequest(_b05);
};
CCognosViewer.prototype.writeNavLink=function(_b06,_b07,_b08,_b09){
var _b0a="";
if(_b08){
_b0a="<td nowrap=\"nowrap\">"+"<img src=\"LINK_IMG\" width=\"15\" height=\"15\" alt=\"\" style=\"vertical-align:middle;\">"+"</td>"+"<td nowrap=\"nowrap\">";
if(_b09){
_b0a+="<a href=\"#\" tabindex=\"0\" onclick=\""+getCognosViewerObjectRefAsString(this.getId())+".getViewerWidget().getSavedOutput().pageAction('LINK_REQUEST');return false;\"";
}else{
_b0a+="<a href=\"#\" tabindex=\"0\" onclick=\""+getCognosViewerObjectRefAsString(this.getId())+".pageAction('LINK_REQUEST');return false;\"";
}
_b0a+=">LINK_TEXT</a>&#160;"+"</td>";
}else{
_b0a="<td nowrap=\"nowrap\">"+"<img src=\"LINK_IMG\" width=\"15\" height=\"15\" alt=\"\" style=\"vertical-align:middle;\">"+"</td>"+"<td nowrap=\"nowrap\">LINK_TEXT&#160;</td>";
}
var sImg=this.sSkin+(!_b08&&_b06.sImgDisabled?_b06.sImgDisabled:_b06.sImg);
return _b0a.replace(/LINK_REQUEST/g,_b07).replace(/LINK_TEXT/g,_b06.sText).replace(/LINK_IMG/g,sImg);
};
CCognosViewer.prototype.loadNavLinks=function(){
var _b0c=window.gScriptLoader.loadFile(this.getGateway(),"b_action=xts.run&m=portal/report-viewer-navlinks.xts");
if(_b0c){
this.init(eval("("+_b0c+")"));
}
};
CCognosViewer.prototype.writeNavLinks=function(sSR,_b0e){
var _b0f=document.getElementById("CVNavLinks"+this.getId());
if(_b0f){
var _b10=document.getElementById("CVNavLinks_Container"+this.getId());
if(typeof this.oNavLinks!="object"||typeof sSR!="string"||!sSR.match(/\bfirstPage\b|\bpreviousPage\b|\bnextPage\b|\blastPage\b|\bplayback\b/i)){
_b0f.style.display="none";
if(_b10){
_b10.style.display="none";
}
this.updateSkipToNavigationLink(true);
return;
}
this.updateSkipToNavigationLink(false);
if(_b10){
_b10.style.display="";
}
_b0f.style.display=(isIE()?"block":"table-cell");
var _b11="";
_b11+="<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"pageControls BUXNoPrint\" role=\"presentation\"><tbody><tr>";
_b11+=this.writeNavLink(this.oNavLinks.oFirst,"firstPage",sSR.match(/\bfirstPage\b/gi),_b0e);
_b11+=this.writeNavLink(this.oNavLinks.oPrevious,"previousPage",sSR.match(/\bpreviousPage\b/gi),_b0e);
_b11+=this.writeNavLink(this.oNavLinks.oNext,"nextPage",sSR.match(/\bnextPage\b/gi),_b0e);
_b11+=this.writeNavLink(this.oNavLinks.oLast,"lastPage",sSR.match(/\blastPage\b/gi),_b0e);
_b11+="</tr></tbody></table>";
var _b12=document.getElementById("CVNavLinks_label"+this.getId());
var _b13="";
if(_b12){
_b13+="<span id=\"CVNavLinks_label"+this.getId()+"\" style=\"visibilty:hidden; display:none;\">"+_b12.innerHTML+"</span>";
}
_b0f.innerHTML=_b13+_b11;
}else{
if(this.shouldWriteNavLinks()){
setTimeout(getCognosViewerObjectRefAsString(this.getId())+".writeNavLinks(\""+sSR+"\",\""+_b0e+"\");",100);
}
}
};
function CVBackgroundLayer_ignoreMouseClick(e){
if(e.returnValue){
e.returnValue=false;
}else{
if(e.preventDefault){
e.preventDefault();
}else{
return false;
}
}
};
CCognosViewer.prototype.createTransparentBackgroundLayer=function(){
this.removeTransparentBackgroundLayer();
var oBL=document.createElement("div");
oBL.id=CV_BACKGROUND_LAYER_ID;
oBL.style.display="none";
oBL.style.position="absolute";
oBL.setAttribute("role","region");
oBL.setAttribute("aria-label",RV_RES.IDS_JS_A11Y_BACKGROUND_TINT);
oBL.style.top="0px";
oBL.style.left="0px";
oBL.style.zIndex=98;
oBL.style.width="100%";
oBL.style.height="100%";
oBL.style.backgroundColor="rgb(238, 238, 238)";
oBL.style.opacity="0";
oBL.style.filter="alpha(opacity:0)";
oBL.innerHTML="<table tabindex=\"1\" width=\"100%\" height=\"100%\"><tr><td role=\"presentation\" onclick=\"CVBackgroundLayer_ignoreMouseClick(event)\"></td></tr></table>";
oBL.style.display="inline";
document.body.appendChild(oBL);
};
CCognosViewer.prototype.removeTransparentBackgroundLayer=function(){
var oBL=document.getElementById(CV_BACKGROUND_LAYER_ID);
if(oBL){
oBL.parentNode.removeChild(oBL);
}
};
CCognosViewer.prototype.closeActiveHTTPConnection=function(){
var _b17=this.getActiveRequest();
if(_b17){
_b17.abortHttpRequest();
}
};
CCognosViewer.prototype.canCancel=function(){
var _b18=this.getTracking();
var _b19=this.getStatus();
return _b18!=""&&_b19!="complete";
};
CCognosViewer.prototype.cancel=function(_b1a){
if(this.getWorkingDialog()&&this.getWorkingDialog().disableCancelButton){
this.getWorkingDialog().disableCancelButton(_b1a);
}
this.removeTransparentBackgroundLayer();
this.clearPrompts();
if(this.m_viewerFragment&&this.envParams["fragment.fireEventWhenComplete"]){
this.envParams["fragment.fireEventWhenComplete"]="";
}
var _b1b=null;
if(this.m_undoStack.length>0){
_b1b=this.m_undoStack.pop();
}
var _b1c=this.getActiveRequest();
if(this.canCancel()===true||_b1c){
if(_b1c){
_b1c.cancelRequest(true);
}else{
var _b1d=null;
var _b1e=_b1b!=null&&_b1b.m_bRefreshPage;
if(typeof this.getCancelDispatcherEntry=="function"){
_b1d=this.getCancelDispatcherEntry();
}else{
if(_b1e||this.m_viewerFragment){
_b1d=new ViewerDispatcherEntry(this);
}else{
if(this.getId()=="RS"){
_b1d=new ViewerDispatcherEntry(this);
_b1d.addFormField("cv.responseFormat","rs");
}else{
_b1d=new DispatcherEntry(this);
_b1d.addFormField("cv.responseFormat","successfulRequest");
}
}
}
_b1d.forceSynchronous();
_b1d.addFormField("ui.action","cancel");
_b1d.addFormField("m_tracking",this.getTracking());
this.setTracking("");
if(_b1e){
var _b1f="<CognosViewerUndo><conversation>";
_b1f+=_b1b.m_sConversation;
_b1f+="</conversation></CognosViewerUndo>";
_b1d.addFormField("cv.previousSession",_b1f);
}
this.dispatchRequest(_b1d);
if(!this.isBux&&!this.m_viewerFragment&&(this.getUsePageRequest()||!this.isReportRenderingDone())){
this.executeCallback("cancel");
}
}
this.setStatus("complete");
var _b20=this.envParams["ui.action"];
var _b21=this.getUsePageRequest();
var _b22=this.m_undoStack.length;
if(_b1b!=null){
this.m_sConversation=_b1b.m_sConversation;
this.m_sParameters=_b1b.m_sParameters;
this.envParams={};
applyJSONProperties(this.envParams,_b1b.m_envParams);
this.m_undoStack.push(_b1b);
}
this.setTracking("");
if(this.previouslySelectedTab){
this.cancelTabSwitch();
}else{
if(_b20!="view"&&_b22<=0&&this.rvMainWnd){
this.rvMainWnd.executePreviousReport(-1);
}
}
return true;
}else{
if(this.rvMainWnd&&typeof this.envParams!="undefined"&&(this.envParams["ui.primaryAction"]=="authoredDrillThrough"||this.envParams["ui.primaryAction"]=="authoredDrillThrough2")){
this.rvMainWnd.executePreviousReport(-1);
return true;
}else{
if(!this.isBux){
executeBackURL(this.getId());
}
return true;
}
}
return false;
};
CCognosViewer.prototype.clearPrompts=function(){
if(this.preProcessControlArray){
var _b23=this.preProcessControlArray.length;
var k=0;
for(k=0;k<_b23;k++){
var _b25=eval(this.preProcessControlArray[k]);
if(_b25){
if(_b25.clearSubmit){
_b25.clearSubmit();
}
}
}
}
};
CCognosViewer.prototype.wait=function(){
if(this.isWorking()){
this.JAWSTalk(RV_RES.IDS_JS_WAIT_PAGE_LOADING);
var _b26=new ViewerDispatcherEntry(this);
_b26.addFormField("ui.action","wait");
_b26.addFormField("ui.primaryAction",this.envParams["ui.primaryAction"]);
_b26.addFormField("cv.actionState",this.envParams["cv.actionState"]);
_b26.addNonEmptyStringFormField("bux",this.envParams["bux"]);
_b26.addNonEmptyStringFormField("ui.preserveRapTags",this.envParams["ui.preserveRapTags"]);
this.dispatchRequest(_b26);
return true;
}
return false;
};
CCognosViewer.prototype.setCAFContext=function(_b27){
this.m_sCAFContext=_b27;
};
CCognosViewer.prototype.setContextInfo=function(sXML){
this.m_sContextInfoXML=sXML;
};
CCognosViewer.prototype.setConversation=function(_b29){
this.m_sConversation=_b29;
};
CCognosViewer.prototype.setActionState=function(_b2a){
this.m_sActionState=_b2a;
};
CCognosViewer.prototype.setStatus=function(_b2b){
this.m_sStatus=_b2b;
};
CCognosViewer.prototype.setDebug=function(_b2c){
this.m_bDebug=_b2c;
};
CCognosViewer.prototype.setExecutionParameters=function(_b2d){
this.m_sParameters=_b2d;
};
CCognosViewer.prototype.setMetadataInfo=function(sXML){
this.m_sMetadataInfoXML=sXML;
};
CCognosViewer.prototype.setSecondaryRequests=function(_b2f){
if(_b2f){
this.m_aSecRequests=_b2f;
}else{
this.m_aSecRequests=[];
}
};
CCognosViewer.prototype.setTracking=function(_b30){
this.m_sTracking=_b30;
};
CCognosViewer.prototype.setSoapFault=function(_b31){
this.m_sSoapFault=_b31;
};
CCognosViewer.prototype.showOutputInNewWindow=function(sURL){
var _b33=document.getElementById("formWarpRequest"+this.getId());
var _b34=_b33.elements["ui.postBack"];
var _b35=_b33.elements["ui.backURL"];
if(this.isAccessibleMode()&&this.envParams["run.outputFormat"]=="PDF"&&window.detachLeavingRV){
window.detachLeavingRV();
}
if(window.opener||_b34||(_b35&&_b35.value!=="javascript:window.close();")){
window.open(sURL,"","");
this.updateNewBrowserWindow();
}else{
window.location=sURL;
}
};
CCognosViewer.prototype.hideToolbar=function(_b36){
this.m_bHideToolbar=_b36;
};
CCognosViewer.prototype.showExcel=function(sURL){
var _b38=true;
var _b39=document.getElementById("formWarpRequest"+this.getId());
var _b3a=_b39.elements["ui.backURL"];
if(_b3a&&_b3a.value.indexOf("javascript:window.close()")!==0&&_b3a.value.indexOf("close.html")===-1){
_b38=false;
}
if(window.detachLeavingRV){
window.detachLeavingRV();
}
var _b3b=window;
if(window.opener&&(isIE()||isFF())&&_b38){
_b3b=window.opener?window.opener:window;
}else{
if(!window.opener&&_b38){
window.location=sURL;
return;
}
}
var _b3c=null;
var _b3d="";
try{
if(this.envParams["cv.excelWindowOpenProperties"]){
_b3d=this.envParams["cv.excelWindowOpenProperties"];
}
_b3c=_b3b.open(sURL,"",_b3d);
}
catch(e){
_b3b=window;
_b3c=_b3b.open(sURL,"",_b3d);
}
if(!_b3c||_b3c.closed||typeof _b3c.closed=="undefined"){
alert(RV_RES.RV_BROWSER_POPUP_IS_ENABLED);
}
this.updateNewBrowserWindow();
};
CCognosViewer.prototype.updateNewBrowserWindow=function(){
var id=this.getId();
var _b3f=document.forms["formWarpRequest"+id].elements["ui.postBack"];
var _b40=document.forms["formWarpRequest"+id].elements["ui.backURL"];
if(_b3f&&_b3f.value){
setTimeout(getCognosViewerObjectRefAsString(id)+".getRV().doPostBack();",100);
}else{
if(_b40&&_b40.value){
if(_b40.value.length<2048){
setTimeout("location.replace(\""+_b40.value+"\");",100);
}else{
_b40=decodeURIComponent(_b40.value);
var _b41=_b40.split("?");
var _b42=document.createElement("form");
_b42.style.display="none";
_b42.setAttribute("target","_self");
_b42.setAttribute("method","post");
_b42.setAttribute("action",_b41[0]);
var _b43=_b41[1].split("&");
for(var _b44=0;_b44<_b43.length;_b44++){
var _b45=_b43[_b44].indexOf("=");
var _b46=_b43[_b44].substr(0,_b45);
var _b47=_b43[_b44].substr(_b45+1);
var _b48=document.createElement("img");
_b48.setAttribute("type","hidden");
_b48.setAttribute("name",decodeURIComponent(_b46));
_b48.setAttribute("value",decodeURIComponent(_b47));
_b42.appendChild(_b48);
}
document.body.appendChild(_b42);
_b42.submit();
}
}else{
window.close();
}
}
};
CCognosViewer.prototype.showWaitPage=function(){
};
CCognosViewer.prototype.sendRequest=function(_b49){
var _b4a=new ViewerDispatcherEntry(this);
_b4a.addFormField("ui.action",_b49.getAction());
if(_b49.getCallback()!=null){
_b4a.setCallbacks({"complete":{"object":null,"method":_b49.getCallback()}});
}
var _b4b=_b49.getFormFields().keys();
for(var _b4c=0;_b4c<_b4b.length;_b4c++){
_b4a.addFormField(_b4b[_b4c],_b49.getFormFields().get(_b4b[_b4c]));
}
var _b4d=_b49.m_oOptions.keys();
for(var _b4e=0;_b4e<_b4d.length;_b4e++){
_b4a.addFormField(_b4d[_b4e],_b49.getOption(_b4d[_b4e]));
}
var _b4f=_b49.m_oParams.keys();
for(var _b50=0;_b50<_b4f.length;_b50++){
_b4a.addFormField(_b4f[_b50],_b49.getParameter(_b4f[_b50]));
}
this.dispatchRequest(_b4a);
};
CCognosViewer.prototype.promptAction=function(_b51,sUrl){
this.setKeepFocus(true);
if(typeof datePickerObserverNotify=="function"){
datePickerObserverNotify();
}
var _b53=this.getViewerWidget();
if(_b51=="cancel"){
this.cancelPrompt(sUrl);
if(_b53){
if(!this.isReportRenderingDone()){
var _b54={action:"deleteWidget"};
_b53.fireEvent("com.ibm.bux.widget.action",null,_b54);
}
}
}else{
var oReq=new ViewerDispatcherEntry(this);
oReq.addFormField("ui.action",_b51=="back"?"back":"forward");
if(_b51=="finish"){
oReq.addFormField("run.prompt",false);
}else{
if(_b51=="back"||_b51=="next"){
oReq.addFormField("run.prompt",true);
}
}
if(_b51=="reprompt"){
if(typeof repromptObserverNotify=="function"){
repromptObserverNotify(this);
}
oReq.addFormField("_promptControl",_b51);
}else{
oReq.addFormField("_promptControl","prompt");
}
if(_b53){
_b53.fireEvent("com.ibm.bux.widget.modified",null,{"modified":true});
if(_b53.isSelectionFilterEnabled){
_b53.clearSelectionFilter();
}
}
this.submitPromptValues(oReq);
}
};
CCognosViewer.prototype.cancelPrompt=function(sUrl){
this.cancel();
};
CCognosViewer.prototype.notify=function(_b57,_b58){
var _b59=0,k=0;
var _b5b=null;
if(this.rangeObserverArray&&this.rangeObserverArray instanceof Array){
_b59=this.rangeObserverArray.length;
for(k=0;k<_b59;k++){
_b5b=eval(this.rangeObserverArray[k]);
if(_b5b&&typeof _b5b=="object"&&typeof _b5b.update=="function"){
_b5b.update();
}
}
}
var _b5c=true;
if(this.preProcessControlArray&&this.preProcessControlArray instanceof Array){
_b59=this.preProcessControlArray.length;
for(k=0;k<_b59;k++){
_b5b=eval(this.preProcessControlArray[k]);
if((typeof _b5b.getValid=="function")&&!_b5b.getValid()){
_b5c=false;
break;
}
}
}
this.notifyPageNavEnabled(_b5c);
if(this.multipleObserverArray&&this.multipleObserverArray instanceof Array){
_b59=this.multipleObserverArray.length;
for(k=0;k<_b59;k++){
_b5b=eval(this.multipleObserverArray[k]);
if(_b5b&&typeof _b5b=="object"&&typeof _b5b.checkInsertRemove=="function"){
_b5b.checkInsertRemove();
}
}
}
for(var _b5d=0;_b5d<gaNotifyTargets.length;_b5d++){
var _b5e=gaNotifyTargets[_b5d];
if(typeof _b5e!="undefined"&&typeof _b5e.notify=="function"){
_b5e.notify(_b57,_b58);
}
}
};
CCognosViewer.prototype.notifyPageNavEnabled=function(_b5f){
if(this.pageNavigationObserverArray&&this.pageNavigationObserverArray instanceof Array){
var _b60=this.pageNavigationObserverArray.length;
var _b61=false;
var _b62=null;
var _b63=null;
var k=0;
for(k=0;k<_b60;k++){
try{
_b62=eval(this.pageNavigationObserverArray[k]);
_b63=_b62.getType();
if(_b63==PROMPTBUTTON_FINISH){
_b61=true;
break;
}
}
catch(e){
}
}
for(k=0;k<_b60;k++){
try{
_b62=eval(this.pageNavigationObserverArray[k]);
_b63=_b62.getType();
if(!_b5f){
if((_b63==PROMPTBUTTON_NEXT)||(_b63==PROMPTBUTTON_OK)||(_b63==PROMPTBUTTON_FINISH)){
_b62.setEnabled(false);
}
}else{
if(_b63==PROMPTBUTTON_FINISH){
_b62.setEnabled(this.bCanFinish);
}else{
if(_b63==PROMPTBUTTON_NEXT){
_b62.setEnabled(this.bNextPage||!_b61);
}else{
if(_b63==PROMPTBUTTON_OK){
_b62.setEnabled(true);
}
}
}
}
}
catch(e2){
}
}
}
};
CCognosViewer.prototype.getDrillResetHUNs=function(_b65){
var _b66=null;
if(this.getRAPReportInfo()){
_b66=this.getRAPReportInfo().getDrilledOnHUNs();
}
if(!_b66){
return null;
}
var _b67=this.getExecutionParameters();
if(!_b67){
return null;
}
var _b68=this._getListOfChangedPromptParameters(_b65);
if(!_b68||_b68.length===0){
return null;
}
var _b69=[];
for(var i=0;i<_b66.length;i++){
for(var j=0;j<_b68.length;j++){
if(_b68[j].indexOf(_b66[i])!==-1){
_b69.push(_b66[i]);
}
}
}
return _b69;
};
CCognosViewer.prototype.getOldParameters=function(){
var _b6c=new CParameterValues();
var _b6d=XMLBuilderLoadXMLFromString(this.getExecutionParameters());
if(_b6d.childNodes.length==1){
_b6c.loadWithOptions(_b6d.childNodes[0],false);
}
if(!_b6c||!_b6c.m_parameterValues||!_b6c.m_parameterValues.m_aValues){
return null;
}
return _b6c.m_parameterValues.m_aValues;
};
CCognosViewer.prototype._createDummyRequest=function(){
var _b6e=new ViewerDispatcherEntry(this);
return this.preparePromptValues(_b6e);
};
CCognosViewer.prototype._getChangedPromptParametersValues=function(_b6f,_b70,_b71){
var _b72=XMLBuilderLoadXMLFromString(_b70);
if(!_b72){
for(var j=0;j<_b6f.length;j++){
var _b74=_b6f[j].m_useValue;
if(_b70.indexOf(sXmlEncode(_b74))<0){
_b71.push(_b74);
}
}
return;
}
var _b75=_b72.getElementsByTagName("selectOption");
if(!_b75){
return;
}
var _b76=_b6f.length;
var _b77=_b75.length;
for(var i=0;i<_b77;i++){
var _b70=_b75[i].attributes.getNamedItem("useValue").nodeValue;
bMatchOldParam=false;
for(var j=0;j<_b76;j++){
var _b74=_b6f[j].m_useValue;
if(_b70.indexOf(_b74)===0){
bMatchOldParam=true;
break;
}
}
if(!bMatchOldParam){
_b71.push(_b70);
}
}
};
CCognosViewer.prototype._getListOfChangedPromptParameters=function(_b79){
var _b7a=this.getOldParameters();
if(!_b7a){
return null;
}
var _b7b=[];
if(!_b79){
var _b7c=this._createDummyRequest();
for(var _b7d in _b7a){
var _b7e=_b7a[_b7d].m_parmValueItems;
var _b7f=_b7c.getRequest().getFormFields().get("p_"+_b7d);
if(!_b7f){
continue;
}
this._getChangedPromptParametersValues(_b7e,_b7f,_b7b);
}
}else{
if(!_b79.parameters){
return null;
}
var _b80=_b79.parameters;
for(var i=0;i<_b80.length;i++){
var _b82=_b80[i].parmName;
if(!_b82||!_b7a[_b82]){
continue;
}
var _b7e=_b7a[_b82].m_parmValueItems;
if(!_b7e||_b7e.length==0){
continue;
}
this._getChangedPromptParametersValues(_b7e,_b80[i].parmValue,_b7b);
}
}
return _b7b;
};
CCognosViewer.prototype.submitPromptValues=function(oReq){
if(this.gbPromptRequestSubmitted===true){
return false;
}
this.gbPromptRequestSubmitted=true;
if(this.isBux){
var _b84=this.getDrillResetHUNs(null);
if(_b84&&_b84.length!==0){
var _b85={"drilledResetHUNs":_b84};
this.executeAction("DrillReset",_b85);
return;
}
}
oReq=this.preparePromptValues(oReq);
if(window.portletSharePrompt){
var _b86=this.portletPromptParams(oReq);
if(_b86.length>0){
portletSharePrompt(_b86);
}
}
this.dispatchRequest(oReq);
};
CCognosViewer.prototype.portletPromptParams=function(oReq){
var _b88=[];
var _b89=null;
var _b8a=true;
var _b8b=oReq.getFormFields().keys();
for(var _b8c=0;_b8c<_b8b.length;_b8c++){
_b89=_b8b[_b8c];
if(_b89=="_promptControl"&&oReq.getFormField(_b89)=="search"){
_b8a=false;
break;
}else{
if(_b89.indexOf("p_")===0){
if(_b89.indexOf("p_credential")===0){
_b8a=false;
break;
}else{
_b88.push([_b89,oReq.getFormField(_b89)]);
}
}
}
}
if(_b88&&!_b8a){
_b88=[];
}
return _b88;
};
CCognosViewer.prototype.preparePromptValues=function(oReq){
var _b8e=[];
if(this.preProcessControlArray){
var _b8f=this.preProcessControlArray.length;
var k=0;
for(k=0;k<_b8f;k++){
var _b91=eval(this.preProcessControlArray[k]);
var _b92=(typeof _b91.isEnabled=="function"?_b91.isEnabled():true);
if(_b91&&typeof _b91.preProcess=="function"&&_b92){
_b91.preProcess();
if(_b91.m_oSubmit){
if(oReq.addParameter){
oReq.addParameter(_b91.m_oSubmit.name,_b91.m_oSubmit.value);
}else{
oReq.addFormField(_b91.m_oSubmit.name,_b91.m_oSubmit.value);
}
_b8e.push(_b91.m_oSubmit);
if(_b91.m_sPromptId&&_b91.m_oForm&&_b91.m_oForm.elements&&typeof _b91.m_oForm.elements["p_"+_b91.m_sRef]=="object"){
if(oReq.addParameter){
oReq.addParameter("p_"+_b91.m_sPromptId,_b91.m_oForm.elements["p_"+_b91.m_sRef].value);
}else{
oReq.addFormField("p_"+_b91.m_sPromptId,_b91.m_oForm.elements["p_"+_b91.m_sRef].value);
}
}
}
}
}
}
var _b93=document.getElementById("formWarpRequest"+this.getId());
if(_b93){
var _b94=_b93.elements;
for(var _b95=0;_b95<_b94.length;_b95++){
var _b96=_b94[_b95];
if(!_b96.name||!_b96.name.match(/^p_/)){
continue;
}
var _b97=true;
for(var _b98=0;_b98<_b8e.length;_b98++){
if(_b8e[_b98]==_b96){
_b97=false;
break;
}
}
if(_b97){
oReq.addFormField(_b96.name,_b96.value);
_b8e.push(_b96);
}
}
}
var oRM=this["CognosReport"];
if(oRM){
var _b9a=oRM.prompt.getParameters();
for(var i=0;i<_b9a.length;i++){
var _b9c="p_"+_b9a[i].getName();
if(!oReq.getFormField(_b9c)){
oReq.addFormField(_b9c,_b9a[i].getXML());
}
}
}
return oReq;
};
CCognosViewer.prototype.setViewerWidget=function(_b9d){
this.m_viewerWidget=_b9d;
};
CCognosViewer.prototype.getViewerWidget=function(){
return this.m_viewerWidget;
};
CCognosViewer.prototype.getFlashChartOption=function(){
var _b9e=this.getViewerWidget();
var _b9f=null;
if(_b9e){
var _ba0=_b9e.getProperties();
if(_ba0){
_b9f=_ba0.getFlashCharts();
}
}
return _b9f;
};
CCognosViewer.prototype.fireWidgetEvent=function(evt,_ba2){
var _ba3=this.getViewerWidget();
if(_ba3!=null){
_ba3.fireEvent(evt,null,_ba2);
}
};
CCognosViewer.prototype.isMobile=function(){
return false;
};
CCognosViewer.prototype.setVisibleDialog=function(_ba4){
this.m_visibleDialog=_ba4;
};
CCognosViewer.prototype.getVisibleDialog=function(){
if(typeof this.m_visibleDialog!="undefined"){
return this.m_visibleDialog;
}
return null;
};
CCognosViewer.prototype.getContentLocale=function(){
var _ba5=document.getElementById("formWarpRequest"+this.getId());
if(_ba5&&_ba5["ui.contentLocale"]&&_ba5["reRunObj"]&&_ba5["reRunObj"].value.length>0){
return _ba5["ui.contentLocale"].value;
}
return null;
};
CCognosViewer.prototype.updateLayout=function(_ba6){
var cvid=this.getId();
var _ba8=document.getElementById("CVHeader"+cvid);
var _ba9=document.getElementById("CVToolbar"+cvid);
if(!_ba8&&!_ba9){
setTimeout(getCognosViewerObjectRefAsString(cvid)+".updateLayout(\""+_ba6+"\");",100);
return;
}
if(_ba8){
var _baa=this.getUIConfig()&&!this.getUIConfig().getShowBanner();
if((_ba6=="prompting"&&!this.bShowHeaderWithPrompts)||_baa){
_ba8.parentNode.style.display="none";
}else{
_ba8.parentNode.style.display="";
}
}
if(_ba9){
if(_ba6=="prompting"||this.m_bHideToolbar==true){
_ba9.parentNode.style.display="none";
}else{
_ba9.parentNode.style.display="";
}
}
};
CCognosViewer.prototype.updateResponseSpecification=function(_bab){
this.sResponseSpecification=_bab;
};
CCognosViewer.prototype.getResponseSpecification=function(){
return this.sResponseSpecification;
};
CCognosViewer.prototype.release=function(_bac){
if(this.getStatus()!="fault"){
this._release(_bac);
}
};
CCognosViewer.prototype._release=function(_bad){
var form=document.getElementById("formWarpRequest"+this.getId());
var _baf=this.getTracking();
if(!_baf&&form&&form["m_tracking"]&&form["m_tracking"].value){
_baf=form["m_tracking"].value;
form["m_tracking"].value="";
}
this.setTracking("");
if(_baf){
var _bb0=new DispatcherEntry(this);
if(this.isWorkingOrPrompting()){
_bb0.addFormField("ui.action","cancel");
}else{
_bb0.addFormField("ui.action","release");
}
_bb0.addFormField("cv.responseFormat","successfulRequest");
_bb0.addNonEmptyStringFormField("ui.primaryAction",this.envParams["ui.primaryAction"]);
_bb0.addNonEmptyStringFormField("ui.objectClass",this.envParams["ui.objectClass"]);
_bb0.addFormField("m_tracking",_baf);
if(_bad!=true){
_bb0.forceSynchronous();
}
var _bb1=this.getActiveRequest()?this.getActiveRequest():this.getFaultDispatcherEntry();
if(_bb1&&_bb1.getFormField("cv.outputKey")){
_bb0.addFormField("b_action","cvx.high");
_bb0.addFormField("cv.outputKey",_bb1.getFormField("cv.outputKey"));
_bb0.addFormField("cv.waitForResponse","false");
_bb0.setHeaders(_bb1.getHeaders());
}
_bb0.sendRequest();
return true;
}
return false;
};
CCognosViewer.prototype.cleanupStyles=function(){
if(this.getViewerWidget()){
this.getViewerWidget().cleanupStyles();
}
};
CCognosViewer.prototype.destroy=function(_bb2){
this.release(_bb2);
if(!this.m_destroyed){
if(typeof window.gaRV_INSTANCES!="undefined"){
for(var _bb3=0;_bb3<window.gaRV_INSTANCES.length;_bb3++){
if(window.gaRV_INSTANCES[_bb3].m_sId==this.getId()){
window.gaRV_INSTANCES.splice(_bb3,1);
this.m_destroyed=true;
break;
}
}
}
if(this.m_layoutElements){
for(var i=0;i<this.m_layoutElements.length;i++){
var e=this.m_layoutElements[i];
var j=e.getAttribute("lid");
this.m_layoutElements.splice(i,1);
delete this.m_lidToElement[j];
var _bb7=e.parentNode;
if(_bb7){
_bb7.removeChild(e);
}
}
delete this.m_layoutElements;
delete this.m_lidToElement;
}
if(this.m_oDrillMgr){
this.m_oDrillMgr.setCV(null);
}
var _bb8=this.getSelectionController();
if(_bb8){
GUtil.destroyProperties(_bb8);
}
var cvId=this.getId();
this.m_viewerDispatcher=null;
GUtil.destroyProperties(this,true);
cleanupGlobalObjects(cvId);
}
};
CCognosViewer.prototype.exit=function(){
this.release();
};
CCognosViewer.prototype.executeAction=function(_bba,_bbb){
var _bbc=this.getAction(_bba);
_bbc.setRequestParms(_bbb);
return _bbc.execute();
};
CCognosViewer.prototype.getCalculation=function(_bbd){
var calc=null;
var _bbf=this.getCalculationCache();
if(_bbf[_bbd]){
calc=_bbf[_bbd];
}else{
calc=eval("new "+_bbd+"();");
calc.setCognosViewer(this);
_bbf[_bbd]=calc;
}
return calc;
};
CCognosViewer.prototype.findBlueDotMenu=function(_bc0){
var root=null;
var _bc2=(_bc0)?_bc0:this.getToolbar();
for(var idx=0;idx<_bc2.length;++idx){
if(typeof _bc2[idx]._root!="undefined"){
root=_bc2[idx]._root;
break;
}
}
return root;
};
CCognosViewer.prototype.findToolbarItem=function(_bc4,_bc5){
var spec=typeof _bc5=="undefined"||_bc5==null?this.getToolbar():_bc5;
var _bc7=null;
for(var _bc8=0;_bc8<spec.length;++_bc8){
var name=spec[_bc8]["name"];
if(typeof name!="undefined"&&name==_bc4){
_bc7=spec[_bc8];
break;
}
}
return _bc7;
};
CCognosViewer.prototype.findToolbarItemIndex=function(_bca,_bcb){
var spec=typeof _bcb=="undefined"||_bcb==null?this.getToolbar():_bcb;
var _bcd=null;
for(var _bce=0;_bce<spec.length;++_bce){
var name=spec[_bce]["name"];
if(typeof name!="undefined"&&name==_bca){
_bcd=_bce;
break;
}
}
return _bcd;
};
CCognosViewer.prototype.addedButtonToToolbar=function(_bd0,_bd1,_bd2,_bd3){
if(typeof _bd1!="undefined"&&_bd1!=null){
if(this.findToolbarItem(_bd1.name,_bd0)==null){
_bd2=this.findToolbarItemIndex(_bd2,_bd0);
if(typeof _bd2!="undefined"&&_bd2!=null){
_bd0.splice(++_bd2,0,_bd1);
return true;
}else{
if(typeof _bd3!="undefined"&&_bd3!=null){
_bd0.splice(_bd3,0,_bd1);
return true;
}
}
}
}
return false;
};
CCognosViewer.prototype.addDrillTargets=function(_bd4){
this.m_drillTargets=_bd4;
};
CCognosViewer.prototype.getDrillTargets=function(){
return this.m_drillTargets;
};
CCognosViewer.prototype.getDrillTarget=function(idx){
if(idx>=this.m_drillTargets.length){
return null;
}
return this.m_drillTargets[idx];
};
CCognosViewer.prototype.getNumberOfDrillTargets=function(){
return this.m_drillTargets.length;
};
CCognosViewer.prototype.isReportRenderingDone=function(){
return this.m_reportRenderingDone;
};
CCognosViewer.prototype.setReportRenderingDone=function(flag){
this.m_reportRenderingDone=flag;
};
CCognosViewer.prototype.hasAVSChart=function(){
var _bd7=this.getRAPReportInfo();
if(_bd7){
var _bd8=_bd7.getDisplayTypes();
return _bd8.match("_v2")!=null||_bd8.match("v2_")!=null;
}
return false;
};
CCognosViewer.prototype.getPinFreezeManager=function(){
return this.m_pinFreezeManager;
};
CCognosViewer.prototype.getReportContextHelper=function(){
if(!this.m_reportContextHelper){
this.m_reportContextHelper=new ReportContextHelper(this.getSelectionController().getCCDManager());
}
return this.m_reportContextHelper;
};
CCognosViewer.prototype.getRAPReportInfo=function(){
return this.m_RAPReportInfo;
};
CCognosViewer.prototype.setRAPReportInfo=function(_bd9){
this.m_RAPReportInfo=_bd9;
};
CCognosViewer.prototype.isNodeVisible=function(node){
if(this.m_pinFreezeManager){
return this.m_pinFreezeManager.isNodeVisible(node);
}
return true;
};
CCognosViewer.prototype.getWarpRequestForm=function(){
return document.getElementById("formWarpRequest"+this.getId());
};
CCognosViewer.prototype.getBrowser=function(){
return this.sBrowser;
};
CCognosViewer.prototype.repaintDiv=function(oDiv){
var _bdc=oDiv.style.display;
oDiv.style.display="none";
oDiv.style.display=_bdc;
};
CCognosViewer.prototype.isMetadataEmpty=function(){
var oSC=this.getSelectionController();
if(oSC){
var _bde=oSC.getCCDManager();
if(_bde){
return _bde.isMetadataEmpty();
}
}
return true;
};
CCognosViewer.prototype.setContextMenu=function(_bdf){
this.m_contextMenu=_bdf;
};
CCognosViewer.prototype.getContextMenu=function(){
return this.m_contextMenu;
};
CCognosViewer.prototype.setToolbar=function(_be0){
this.m_toolbar=_be0;
};
CCognosViewer.prototype.getToolbar=function(){
return this.m_toolbar;
};
CCognosViewer.prototype.getAdvancedServerProperty=function(_be1){
if(this.m_advancedProperties&&this.m_advancedProperties[_be1]!==undefined&&this.m_advancedProperties[_be1]!==null){
return this.m_advancedProperties[_be1];
}else{
return null;
}
};
CCognosViewer.prototype.hasPrompt=function(){
if(typeof this.m_bHasPrompt==="undefined"||this.m_bHasPrompt===null){
var _be2=false;
if(this.getAdvancedServerProperty("VIEWER_JS_PROMPT_AGAIN_SHOW_ALWAYS")==="true"||(this.envParams.reportPrompts&&this.envParams.reportPrompts.length>0)){
_be2=true;
}else{
var _be3=new CParameterValues();
var _be4=XMLBuilderLoadXMLFromString(this.getExecutionParameters());
if(_be4.childNodes.length==1){
_be3.loadWithOptions(_be4.childNodes[0],true);
var _be5=_be3.length();
for(var _be6=0;_be6<_be5;++_be6){
var _be7=_be3.getAt(_be6);
if(_be7!==null&&_be7.length()>0&&_be7.name().indexOf("credential:")!=-1){
_be2=true;
break;
}
}
}
}
this.m_bHasPrompt=_be2;
}
return this.m_bHasPrompt;
};
CCognosViewer.prototype.getDrillState=function(){
return this.m_sStateData?this.m_sStateData:"";
};
CCognosViewer.prototype.isSelectionFilterEnabled=function(){
if(typeof this.m_bSelectionFilterSwitch=="undefined"){
this.m_bSelectionFilterSwitch=false;
}
return this.m_bSelectionFilterSwitch;
};
CCognosViewer.prototype.broadcastContextChange=function(evt,_be9){
if(this.getViewerWidget()){
this.getViewerWidget().broadcastContextChange(_be9);
}
stopEventBubble(evt);
};
CCognosViewer.prototype.broadcastParameterChange=function(evt,_beb){
if(this.getViewerWidget()){
this.getViewerWidget().broadcastParameterChange(_beb);
}
stopEventBubble(evt);
};
CCognosViewer.prototype.getReportDiv=function(){
if(!this.m_nReportDiv){
this.m_nReportDiv=document.getElementById("CVReport"+this.m_sId);
}
return this.m_nReportDiv;
};
function CDocumentWriter(sId,_bed){
this.m_sId=sId;
this.m_sText="";
this.m_sScript=_bed;
};
CDocumentWriter.prototype.isValid=function(){
if(typeof this.m_sScript!="undefined"&&this.m_sScript&&window.gScriptLoader){
return true;
}
return false;
};
CDocumentWriter.prototype.execute=function(){
if(this.isValid()&&window.gScriptLoader){
var _bee=/document\.write(ln)?\s*\(/gi;
var _bef=this.m_sScript.replace(_bee,"this.write(").replace(window.gScriptLoader.m_reScriptTagOpen,"").replace(window.gScriptLoader.m_reScriptTagClose,"");
try{
eval(_bef);
var _bf0=document.getElementById(this.m_sId);
if(_bf0){
_bf0.innerHTML=this.m_sText;
return true;
}
}
catch(e){
}
}
return false;
};
CDocumentWriter.prototype.write=function(_bf1){
var _bf2="";
if(typeof _bf1=="function"){
_bf2=eval(_bf1);
}else{
if(typeof _bf1=="string"){
_bf2=_bf1;
}
}
this.m_sText+=_bf2;
};
function setFocusToFirstTabItem(_bf3){
if(!window.dojo){
return;
}
var _bf4=dojo.query("*",_bf3);
var _bf5=_bf4.length;
for(var i=0;i<_bf5;i++){
var node=_bf4[i];
if(!node.style||(node.style.display!="none"&&node.style.visibility!="hidden")){
if(node.getAttribute("tabIndex")==0){
try{
node.focus();
}
catch(e){
}
break;
}
}
}
};
function ReportContextHelper(_bf8){
this.m_oCDManager=_bf8;
};
ReportContextHelper.prototype.destroy=function(){
if(this.m_oCDManager&&this.m_oCDManager.destroy){
this.m_oCDManager.destroy();
}
delete this.m_oCDManager;
};
ReportContextHelper.prototype.processCtx=function(sCtx){
var _bfa=sCtx.split("::");
var _bfb=[];
for(var i=0;i<_bfa.length;++i){
_bfb[i]=_bfa[i].split(":");
}
if(_bfb&&_bfb.length&&_bfb[0].length){
return _bfb;
}else{
return null;
}
};
ReportContextHelper.prototype.getDataItemName=function(sCtx){
var _bfe=this.processCtx(sCtx);
if(_bfe){
return this.getRefDataItem(_bfe[0][0]);
}
return null;
};
ReportContextHelper.prototype.getRefDataItem=function(_bff){
var _c00=this.m_oCDManager.GetRDIValue(_bff);
return (_c00==null)?"":_c00;
};
ReportContextHelper.prototype.getMun=function(_c01){
var aCtx=null;
if(typeof _c01==="string"){
aCtx=this.processCtx(_c01);
}else{
if(typeof _c01==="number"){
aCtx=this.processCtx(_c01.toString());
}else{
aCtx=_c01;
}
}
if(aCtx){
var sMun=this.m_oCDManager.GetMUN(aCtx[0][0]);
return (sMun==null)?"":sMun;
}
return "";
};
function ViewerConfig(){
this.uiConfig=new ViewerUIConfig();
this.findConfig=typeof ViewerFindActionConfig=="function"?new ViewerFindActionConfig():null;
this.httpRequestConfig=typeof ViewerHttpRequestConfig=="function"?new ViewerHttpRequestConfig():null;
this.eventsConfig=typeof ViewerEventsConfig=="function"?new ViewerEventsConfig():null;
};
ViewerConfig.prototype.configure=function(_c04){
if(!_c04){
return;
}
if(_c04.findAction&&this.findConfig){
this.findConfig.configure(_c04.findAction);
}
if(_c04.UI){
this.uiConfig.configure(_c04.UI);
}
if(_c04.httpRequestCallbacks&&this.httpRequestConfig){
this.httpRequestConfig.configure(_c04.httpRequestCallbacks);
}
if(_c04.events&&this.eventsConfig){
this.eventsConfig.configure(_c04.events);
}
};
ViewerConfig.prototype.getUIConfig=function(){
return this.uiConfig;
};
ViewerConfig.prototype.getFindActionConfig=function(){
return this.findConfig;
};
ViewerConfig.prototype.getHttpRequestConfig=function(){
return this.httpRequestConfig;
};
ViewerConfig.prototype.getEventsConfig=function(){
return this.eventsConfig;
};
function ViewerUIConfig(){
this.showBanner=true;
this.showToolbar=true;
this.showContextMenu=true;
this.showPageNavigation=true;
this.primarySelectionColor=null;
this.secondarySelectionColor=null;
this.showSecondarySelection=true;
};
ViewerUIConfig.prototype.configure=function(_c05){
applyJSONProperties(this,_c05);
};
ViewerUIConfig.prototype.getShowBanner=function(){
return this.showBanner;
};
ViewerUIConfig.prototype.getShowToolbar=function(){
return this.showToolbar;
};
ViewerUIConfig.prototype.getShowContextMenu=function(){
return this.showContextMenu;
};
ViewerUIConfig.prototype.getShowPageNavigation=function(){
return this.showPageNavigation;
};
ViewerUIConfig.prototype.getPrimarySelectionColor=function(){
return this.primarySelectionColor;
};
ViewerUIConfig.prototype.getSeondarySelectionColor=function(){
return this.secondarySelectionColor;
};
ViewerUIConfig.prototype.getShowSecondarySelection=function(){
return this.showSecondarySelection;
};
function ViewerHttpRequestConfig(){
this.reportStatus={};
this.UI={};
};
ViewerHttpRequestConfig.prototype.configure=function(_c06){
applyJSONProperties(this,_c06);
};
ViewerHttpRequestConfig.prototype.getRequestIndicator=function(){
if(this.UI){
return this.UI.requestIndicator?this.UI.requestIndicator:null;
}
};
ViewerHttpRequestConfig.prototype.getWorkingDialog=function(){
if(this.UI){
return this.UI.workingDialog?this.UI.workingDialog:null;
}
};
ViewerHttpRequestConfig.prototype.getReportStatusCallback=function(_c07){
if(this.reportStatus){
var _c08=this.reportStatus[_c07];
if(_c08){
return _c08;
}
if(_c07=="complete"&&this.reportStatus["initialComplete"]){
var _c09=this.reportStatus["initialComplete"];
this.reportStatus["initialComplete"]=null;
return _c09;
}
}
return null;
};
function ViewerEventsConfig(){
this.showContextMenuOnClick=false;
};
ViewerEventsConfig.prototype.configure=function(_c0a){
applyJSONProperties(this,_c0a);
};
ViewerEventsConfig.prototype.getShowContextMenuOnClick=function(){
return this.showContextMenuOnClick;
};
function ViewerState(){
this.findState=null;
this.pageState=null;
};
ViewerState.prototype.setFindState=function(_c0b){
if(typeof ViewerFindState!="function"){
return;
}
if(!this.findState){
this.findState=new ViewerFindState();
}
this.findState.setState(_c0b);
};
ViewerState.prototype.clearFindState=function(){
this.findState=null;
};
ViewerState.prototype.getFindState=function(){
return this.findState;
};
ViewerState.prototype.setPageState=function(_c0c){
if(typeof ViewerPageState!="function"){
return;
}
if(!this.pageState){
this.pageState=new ViewerPageState();
}
this.pageState.setState(_c0c);
};
ViewerState.prototype.clearPageState=function(){
this.pageState=null;
};
ViewerState.prototype.getPageState=function(){
return this.pageState;
};
function CCDManager(cv){
this.m_cd=null;
this.m_md=null;
this.m_oCV=null;
this.m_dataItemInfo=null;
};
CCDManager.prototype.SetContextData=function(CD){
if(this.m_cd){
this.m_cd=null;
}
this.m_cd=CD;
};
CCDManager.prototype.SetMetadata=function(MD){
if(this.m_md){
this.m_md=null;
}
this.m_md=MD;
};
CCDManager.prototype.AddContextData=function(CD){
if(!this.m_cd){
this.m_cd=CD;
}else{
for(var i in CD){
this.m_cd[i]=CD[i];
}
}
};
CCDManager.prototype.AddMetadata=function(MD){
if(!this.m_md){
this.m_md=MD;
}else{
for(var j in MD){
this.m_md[j]=MD[j];
}
}
};
CCDManager.prototype.getClonedMetadataArray=function(){
var _c14={};
applyJSONProperties(_c14,this.m_md);
return _c14;
};
CCDManager.prototype.getClonedContextdataArray=function(){
var _c15={};
applyJSONProperties(_c15,this.m_cd);
return _c15;
};
CCDManager.prototype.SetCognosViewer=function(_c16){
if(_c16){
this.m_oCV=_c16;
}
};
CCDManager.prototype.onComplete_GetCDRequest=function(_c17,_c18){
if(_c17){
var _c19=_c17.getResult();
var _c1a=XMLBuilderLoadXMLFromString(_c19);
if(_c1a){
var _c1b=_c1a.getElementsByTagName("Block");
for(var i=0;i<_c1b.length;i++){
var _c1d="";
var _c1e=_c1b[i].firstChild;
while(_c1e){
_c1d+=_c1e.nodeValue;
_c1e=_c1e.nextSibling;
}
var cd=eval("("+_c1d+")");
this.AddContextData(cd);
}
}
}
if(_c18&&typeof _c18=="function"){
_c18();
}
};
CCDManager.prototype.FetchContextData=function(_c20,_c21){
var _c22=[];
var c=null,_c24=_c20.length;
for(var i=0;i<_c24;++i){
c=_c20[i];
if(c!=""&&!this.ContextIdExists(c)){
_c22.push(c);
}
}
if(_c22.length){
if(this.m_oCV){
this.getContextData(_c22,_c21);
}
}
return _c22.length;
};
CCDManager.prototype.getContextData=function(_c26,_c27){
var oCV=this.m_oCV;
var _c29=new AsynchDataDispatcherEntry(oCV);
_c29.setCanBeQueued(false);
if(!oCV.isBux){
_c29.forceSynchronous();
}
var form=document["formWarpRequest"+oCV.getId()];
var _c2b=oCV.getConversation();
var _c2c=oCV.getTracking();
if(!_c2c&&form&&form["m_tracking"]&&form["m_tracking"].value){
_c2c=form["m_tracking"].value;
}
if(oCV.m_viewerFragment){
var _c2d=oCV.getActiveRequest();
if(_c2d&&_c2d.getFormField("m_tracking")==_c2c){
return;
}
}
var _c2e={customArguments:[_c27],"complete":{"object":this,"method":this.onComplete_GetCDRequest}};
if(oCV.getStatus()=="prompting"){
_c2e["prompting"]={"object":this,"method":this.onComplete_GetCDRequest};
}
_c29.setCallbacks(_c2e);
if(_c2b&&oCV.envParams["ui.action"]!="view"){
_c29.addFormField("ui.action","getContext");
_c29.addFormField("ui.conversation",_c2b);
}else{
var _c2f=form["ui.object"];
if(typeof _c2f.length!="undefined"&&_c2f.length>1){
_c29.addFormField("ui.object",form["ui.object"][0].value);
}else{
_c29.addFormField("ui.object",form["ui.object"].value);
}
_c29.addFormField("ui.action","getObjectContext");
}
_c29.addFormField("cv.responseFormat","asynchDetailContext");
_c29.addFormField("context.format","initializer");
_c29.addFormField("context.type","reportService");
_c29.addFormField("context.selection",_c26.join(","));
_c29.addNonEmptyStringFormField("m_tracking",_c2c);
oCV.dispatchRequest(_c29);
};
CCDManager.prototype.ContextIdExists=function(_c30){
return (this.m_cd&&this.m_cd[_c30]?true:false);
};
CCDManager.prototype.HasContextData=function(){
return (this.m_cd?true:false);
};
CCDManager.prototype.HasMetadata=function(){
return (this.m_md?true:false);
};
CCDManager.prototype._getMDPropertyFromCD=function(_c31,_c32,_c33){
var p=null;
this.FetchContextData([_c31]);
var cd=this.m_cd&&this.m_cd[_c31];
if(cd){
var md=this.m_md[cd[_c32]];
if(md){
p=md[_c33];
}
}
return p;
};
CCDManager.prototype.GetDrillFlag=function(_c37){
return this._getMDPropertyFromCD(_c37,"r","drill");
};
CCDManager.prototype.getModelPathFromBookletItem=function(_c38){
var mp=null;
var md=this.m_md[_c38];
if(md){
mp=md.mp;
if(mp&&this.m_md[mp]){
mp=this.m_md[mp].mp;
}
}
return mp?mp:null;
};
CCDManager.prototype.GetBookletModelBasedDrillThru=function(_c3b){
var p=null;
var md=this.m_md[_c3b];
if(md){
p=md.modelBasedDrillThru;
}
return p?p:0;
};
CCDManager.prototype.GetDrillFlagForMember=function(_c3e){
var _c3f=null;
var d=this._getMDPropertyFromCD(_c3e,"r","drill");
if(d!==null&&this.m_cd[_c3e].m){
_c3f=d;
}
return _c3f;
};
CCDManager.prototype.GetDataType=function(_c41){
return this._getMDPropertyFromCD(_c41,"r","dtype");
};
CCDManager.prototype.GetUsage=function(_c42){
return this._getMDPropertyFromCD(_c42,"r","usage");
};
CCDManager.prototype.GetHUN=function(_c43){
var hun=this._getMDPropertyFromCD(_c43,"h","h");
if(!hun){
var h=this._getMDPropertyFromCD(_c43,"r","h");
if(h){
hun=this.m_md[h].h;
}
}
if(hun!=null&&hun.indexOf("[__ns_")==0){
hun=null;
}
return hun;
};
CCDManager.prototype.GetQuery=function(_c46){
var qry=null;
var q=this._getMDPropertyFromCD(_c46,"r","q");
if(q){
qry=this.m_md[q].q;
}
return qry;
};
CCDManager.prototype.GetDepth=function(_c49){
return this._getMDPropertyFromCD(_c49,"r","level");
};
CCDManager.prototype.GetDisplayValue=function(_c4a){
var _c4b=null;
this.FetchContextData([_c4a]);
if(this.ContextIdExists(_c4a)&&this.m_cd[_c4a]){
_c4b=this.m_cd[_c4a].u;
}
return _c4b;
};
CCDManager.prototype.GetPUN=function(_c4c){
return this._getMDPropertyFromCD(_c4c,"p","p");
};
CCDManager.prototype.GetLUN=function(_c4d){
return this._getMDPropertyFromCD(_c4d,"l","l");
};
CCDManager.prototype.GetMUN=function(_c4e){
return this._getMDPropertyFromCD(_c4e,"m","m");
};
CCDManager.prototype.GetDUN=function(_c4f){
return this._getMDPropertyFromCD(_c4f,"d","d");
};
CCDManager.prototype.GetQMID=function(_c50){
return this._getMDPropertyFromCD(_c50,"i","i");
};
CCDManager.prototype.GetRDIValue=function(_c51){
return this._getMDPropertyFromCD(_c51,"r","r");
};
CCDManager.prototype.GetBIValue=function(_c52){
return this._getMDPropertyFromCD(_c52,"r","bi");
};
CCDManager.prototype.getContextIdForMetaData=function(lun,hun,_c55){
var _c56=[{"expression":lun,"type":"l"},{"expression":hun,"type":"h"}];
for(var _c57=0;_c57<_c56.length;++_c57){
var _c58=_c56[_c57].expression;
var _c59=_c56[_c57].type;
if(_c58==""){
continue;
}
for(var _c5a in this.m_md){
if(this.m_md[_c5a][_c59]==_c58){
for(var _c5b in this.m_md){
if(this.m_md[_c5b].r&&this.m_md[_c5b][_c59]==_c5a){
if(this.m_md[_c5b].drill!=0||_c55==true){
for(var ctx in this.m_cd){
if(this.m_cd[ctx].r==_c5b&&this.m_cd[ctx].m){
return ctx;
}
}
}
}
}
}
}
}
return "";
};
CCDManager.prototype.GetContextIdForMUN=function(mun){
var _c5e=null;
var _c5f=null;
for(var i in this.m_md){
if(this.m_md[i].m==mun){
_c5e=i;
break;
}
}
if(_c5e!=null){
for(var j in this.m_cd){
if(this.m_cd[j].m==_c5e){
_c5f=j;
break;
}
}
}
return _c5f;
};
CCDManager.prototype.GetContextIdsForRDI=function(rdi){
var _c63=[];
for(var i in this.m_md){
if(this.m_md[i].r==rdi){
_c63.push(i);
}
}
return _c63;
};
CCDManager.prototype.getMUNForRDIAndUseValue=function(rdi,_c66){
var _c67=this.GetContextIdsForRDI(rdi);
for(var i in this.m_cd){
for(var j in _c67){
if(this.m_cd[i].r==_c67[j]&&this.m_cd[i].u==_c66){
var _c6a=this.m_cd[i].m;
if(_c6a){
return this.m_md[_c6a].m;
}
}
}
}
return null;
};
CCDManager.prototype.GetPageMinMaxForRDI=function(rdi){
var _c6c=null;
var _c6d=null;
var _c6e=this.GetContextIdsForRDI(rdi);
this.FetchContextData([0]);
for(var i in this.m_cd){
for(var j in _c6e){
if(this.m_cd[i].r==_c6e[j]){
var _c71=parseFloat(this.m_cd[i].u);
if(_c71==this.m_cd[i].u){
if(_c6c==null||_c71<_c6c){
_c6c=_c71;
}
if(_c6d==null||_c71>_c6d){
_c6d=_c71;
}
}
}
}
}
if(_c6c!=null&&_c6d!=null){
return eval("({ pageMin: "+_c6c+", pageMax: "+_c6d+"})");
}
};
CCDManager.prototype.GetContextIdForDisplayValue=function(_c72){
var _c73=null;
for(var i in this.m_cd){
if(this.m_cd[i].u==_c72){
_c73=i;
break;
}
}
return _c73;
};
CCDManager.prototype.GetContextIdForUseValue=function(_c75){
var _c76=null;
var _c77=null;
var _c78=null;
for(var i in this.m_md){
var md=this.m_md[i];
for(var j in md){
if(md[j]==_c75){
_c76=i;
_c77=j;
break;
}
}
}
if(_c76!=null){
for(var k in this.m_cd){
if(this.m_cd[k][_c77]==_c76){
_c78=k;
break;
}
}
}
return _c78;
};
CCDManager.prototype.getDataItemInfo=function(){
if(this.m_cd){
var _c7d={};
this.m_dataItemInfo={};
for(var i in this.m_cd){
var _c7f=this.m_cd[i].r;
if(typeof _c7f!="undefined"){
var _c80=this.m_md[_c7f].r;
if(this.m_dataItemInfo[_c80]==null){
this.m_dataItemInfo[_c80]=1;
}else{
this.m_dataItemInfo[_c80]++;
}
}
}
return CViewerCommon.toJSON(this.m_dataItemInfo);
}
return "";
};
CCDManager.prototype.DataItemInfoToJSON=function(){
return this.getDataItemInfo();
};
CCDManager.prototype.MetadataToJSON=function(){
if(this.m_md){
return CViewerCommon.toJSON(this.m_md);
}
return "";
};
CCDManager.prototype.ContextDataToJSON=function(){
if(this.m_cd){
return CViewerCommon.toJSON(this.m_cd);
}
return "";
};
CCDManager.prototype.ContextDataSubsetToJSON=function(_c81){
if(_c81<=0){
return this.ContextDataToJSON();
}
if(this.m_cd){
var _c82={};
var _c83={};
for(var i in this.m_cd){
var _c85=this.m_cd[i].r;
if(typeof _c85!="undefined"){
if(_c82[_c85]==null){
_c82[_c85]=0;
}else{
_c82[_c85]++;
}
if(_c82[_c85]<_c81){
_c83[i]=this.m_cd[i];
}
}
}
return CViewerCommon.toJSON(_c83);
}
return "";
};
CCDManager.prototype.GetHUNForRDI=function(rdi,_c87){
for(var i in this.m_md){
if(this.m_md[i].r==rdi&&this.m_md[i].q==_c87){
var _c89=this.m_md[i].h;
if(_c89){
return this.m_md[_c89].h;
}
}
}
return null;
};
CCDManager.prototype.GetMetadataIdForQueryName=function(_c8a){
for(var i in this.m_md){
if(this.m_md[i].q===_c8a){
return i;
}
}
return null;
};
CCDManager.prototype._isEmptyObject=function(obj){
for(var _c8d in obj){
return false;
}
return true;
};
CCDManager.prototype.isMetadataEmpty=function(){
if(this.m_md){
return this._isEmptyObject(this.m_md);
}
return true;
};
CCDManager.prototype.GetBestPossibleItemName=function(_c8e){
var item=this.m_cd[_c8e];
if(!item){
return null;
}
if(item.l&&this.m_md[item.l].l){
return this._getStringInLastBracket(this.m_md[item.l].l);
}
if(item.r&&this.m_md[item.r].r){
return this._getStringInLastBracket(this.m_md[item.r].r);
}
if(item.h&&this.m_md[item.h].h){
return this._getStringInLastBracket(this.m_md[item.h].h);
}
if(item.i&&this.m_md[item.i].i){
return this._getStringInLastBracket(this.m_md[item.i].i);
}
return null;
};
CCDManager.prototype.GetBestPossibleDimensionMeasureName=function(_c90){
var item=this.m_cd[_c90];
if(item&&item.m&&this.m_md[item.m]&&this.m_md[item.m].m){
return this._getStringInLastBracket(this.m_md[item.m].m);
}
return null;
};
CCDManager.prototype._getStringInLastBracket=function(str){
if(str&&str.indexOf("].[")>0){
var _c93=str.split("].[");
var _c94=_c93[_c93.length-1];
return _c94.substring(0,_c94.length-1);
}
return str;
};
CCDManager.prototype._replaceNamespaceForSharedTM1DimensionOnly=function(_c95){
var _c96=this._getNamespaceAndDimensionFromUniqueName(_c95);
if(_c96&&this.m_md){
for(var _c97 in this.m_md){
var sMun=this.m_md[_c97].m;
if(sMun&&sMun.length>0){
if(sMun.indexOf("->:[TM].")>0){
var oObj=this._getNamespaceAndDimensionFromUniqueName(sMun);
if(oObj.dimension&&oObj.dimension===_c96.dimension&&oObj.namespace!==_c96.namespace){
var _c9a=_c95.indexOf(".");
return oObj.namespace+_c95.substr(_c9a,_c95.length);
}
}else{
var _c9b=sMun.indexOf("->:[");
if(_c9b>0){
if(sMun.substr(_c9b+4,4)!=="TM]."){
return _c95;
}
}
}
}
}
}
return _c95;
};
CCDManager.prototype._getNamespaceAndDimensionFromUniqueName=function(_c9c){
if(_c9c&&_c9c.length>0&&_c9c.indexOf("].[")>0){
var _c9d=_c9c.split("].[");
if(_c9d.length>1){
return {"namespace":_c9d[0]+"]","dimension":"["+_c9d[1]+"]"};
}
}
return null;
};
CCDManager.prototype.destroy=function(){
delete this.m_cd;
delete this.m_md;
delete this.m_oCV;
delete this.m_dataItemInfo;
};
function CSelectionXml(_c9e,_c9f,_ca0){
this.queries={};
this.burstContext=_c9e||"";
this.expressionLocale=_c9f||"";
this.contentLocale=_ca0||"";
};
function SC_SingleSelection(){
this.rows=[];
this.cols=[];
this.sections=[];
this.measures=[];
this.layoutElementId="";
};
function SC_SingleQuery(){
this.selections=[];
this.slicers=[];
this.filters=[];
};
function SC_SingleSlicer(){
};
function SC_SingleDetailFilter(){
};
function SC_SingleSummaryFilter(){
};
CSelectionXml.prototype.BuildSelectionFromController=function(sc){
if(sc){
var _ca2=sc.getAllSelectedObjects();
for(var s=0;s<_ca2.length;++s){
var _ca4=_ca2[s];
var _ca5=_ca4.getSelectedContextIds();
var muns=_ca4.getMuns();
var _ca7=muns.length;
var _ca8=new SC_SingleSelection();
_ca8.layoutElementId=_ca4.getLayoutElementId();
var _ca9=null;
for(var i=0;i<_ca7;++i){
var j,_cac,_cad;
if(i===0&&_ca7===1){
for(j=0;j<muns[i].length;++j){
_cac=_ca5[i][j];
if(_cac!=0){
if(j===0){
_ca9=sc.getRefQuery(_cac);
_cad=_ca4.getDisplayValues()[j];
this._buildMeasureSelection(sc,_cac,_ca8.measures,_cad,j,_ca4.getLayoutType());
}else{
if(sc.getUsageInfo(_cac)!=2){
this._buildEdgeSelection(sc,_cac,_ca8.cols,j);
}
}
}
}
}else{
for(j=0;j<muns[i].length;++j){
_cac=_ca5[i][j];
if(_cac!=0){
if(i===0){
_cad=_ca4.getDisplayValues()[j];
_ca9=sc.getRefQuery(_cac);
this._buildMeasureSelection(sc,_cac,_ca8.measures,_cad,j,_ca4.getLayoutType());
}else{
if(i===1){
this._buildEdgeSelection(sc,_cac,_ca8.rows,j);
}else{
if(i===2){
this._buildEdgeSelection(sc,_cac,_ca8.cols,j);
}else{
this._buildSectionSelection(sc,_cac,_ca8.sections,j);
}
}
}
}
}
}
}
this.AddSelection(_ca9,_ca8);
}
}
};
CSelectionXml.prototype.AddSelection=function(_cae,_caf){
if(!this.queries[_cae]){
this.queries[_cae]=new SC_SingleQuery();
}
this.queries[_cae].selections.push(_caf);
};
CSelectionXml.prototype._buildMeasureSelection=function(sc,_cb1,_cb2,_cb3,idx,_cb5){
if(_cb5==""||_cb5==null){
_cb5="datavalue";
}
if(_cb1){
_cb2.push({name:sc.getRefDataItem(_cb1),values:[{use:sc.getUseValue(_cb1),display:_cb3}],order:idx,hun:sc.getHun(_cb1),dataType:_cb5,usage:sc.getUsageInfo(_cb1),dtype:sc.getDataType(_cb1),selection:"true"});
}
};
CSelectionXml.prototype._buildEdgeSelection=function(sc,_cb7,_cb8,idx){
if(_cb7){
_cb8.push({name:sc.getRefDataItem(_cb7),values:[{use:this.getUseValue(sc,_cb7),display:sc.getDisplayValue(_cb7)}],order:idx,lun:sc.getLun(_cb7),hun:sc.getHun(_cb7),dataType:"columnTitle",usage:sc.getUsageInfo(_cb7),dtype:sc.getDataType(_cb7)});
}
};
CSelectionXml.prototype._buildSectionSelection=function(sc,_cbb,_cbc,idx){
if(_cbb){
_cbc.push({name:sc.getRefDataItem(_cbb),values:[{use:this.getUseValue(sc,_cbb),display:sc.getDisplayValue(_cbb)}],order:idx,lun:sc.getLun(_cbb),hun:sc.getHun(_cbb),dataType:"section",usage:sc.getUsageInfo(_cbb),dtype:sc.getDataType(_cbb),queryRef:sc.getRefQuery(_cbb)});
}
};
CSelectionXml.prototype.getUseValue=function(sc,_cbf){
var _cc0=sc.getMun(_cbf);
if(_cc0==""){
_cc0=sc.getUseValue(_cbf);
}
return _cc0;
};
CSelectionXml.prototype.toXml=function(){
var _cc1=XMLBuilderCreateXMLDocument("selections");
var _cc2=_cc1.documentElement;
XMLBuilderSetAttributeNodeNS(_cc2,"xmlns:xs","http://www.w3.org/2001/XMLSchema");
XMLBuilderSetAttributeNodeNS(_cc2,"xmlns:bus","http://developer.cognos.com/schemas/bibus/3/");
XMLBuilderSetAttributeNodeNS(_cc2,"SOAP-ENC:arrayType","bus:parameterValue[]","http://schemas.xmlsoap.org/soap/encoding/");
XMLBuilderSetAttributeNodeNS(_cc2,"xmlns:xsd","http://www.w3.org/2001/XMLSchema");
XMLBuilderSetAttributeNodeNS(_cc2,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_cc2.setAttribute("contentLocale",this.contentLocale);
_cc2.setAttribute("expressionLocale",this.expressionLocale);
for(var q in this.queries){
this._queryToXml(_cc2,q,this.queries[q]);
}
this._burstToXml(_cc2);
return XMLBuilderSerializeNode(_cc1);
};
CSelectionXml.prototype._queryToXml=function(_cc4,name,obj){
var _cc7=_cc4.ownerDocument.createElement("query");
_cc7.setAttribute("name",name);
for(var _cc8=0;_cc8<obj.selections.length;++_cc8){
this._selectionToXml(_cc7,obj.selections[_cc8]);
}
for(var _cc9=0;_cc9<obj.slicers.length;++_cc9){
this._slicersToXml(_cc7,obj.slicers[_cc9]);
}
for(var _cca=0;_cca<obj.selections.length;++_cca){
this._filtersToXml(_cc7,obj.selections[_cca]);
}
_cc4.appendChild(_cc7);
};
CSelectionXml.prototype._selectionToXml=function(_ccb,_ccc){
var doc=_ccb.ownerDocument;
var _cce=doc.createElement("selection");
_ccb.appendChild(_cce);
this._edgeToXml(_cce,"row",_ccc.rows);
this._edgeToXml(_cce,"column",_ccc.cols);
this._edgeToXml(_cce,"measure",_ccc.measures);
this._edgeToXml(_cce,"section",_ccc.sections);
var _ccf=doc.createElement("layoutElementId");
_ccf.appendChild(doc.createTextNode(_ccc.layoutElementId));
_cce.appendChild(_ccf);
};
CSelectionXml.prototype._edgeToXml=function(_cd0,_cd1,_cd2){
var doc=_cd0.ownerDocument;
var _cd4=doc.createElement(_cd1+"s");
_cd0.appendChild(_cd4);
for(var i=0;i<_cd2.length;++i){
var _cd6=doc.createElement(_cd1);
_cd4.appendChild(_cd6);
var edge=_cd2[i];
for(var j in edge){
if(j!=="name"&&j!=="values"){
_cd6.setAttribute(j,edge[j]!==null?edge[j]:"");
}
}
this._itemToXml(_cd6,edge.name,edge.values);
}
};
CSelectionXml.prototype._itemToXml=function(_cd9,name,_cdb){
var doc=_cd9.ownerDocument;
var _cdd=doc.createElement("item");
XMLBuilderSetAttributeNodeNS(_cdd,"xsi:type","bus:parameterValue","http://www.w3.org/2001/XMLSchema-instance");
var _cde=XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:name",doc);
XMLBuilderSetAttributeNodeNS(_cde,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_cde.appendChild(doc.createTextNode(name));
_cdd.appendChild(_cde);
var _cdf=XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:value",doc);
XMLBuilderSetAttributeNodeNS(_cdf,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
XMLBuilderSetAttributeNodeNS(_cdf,"SOAP-ENC:arrayType","bus:parmValueItem[]","http://schemas.xmlsoap.org/soap/encoding/");
_cdd.appendChild(_cdf);
for(var j=0;j<_cdb.length;j++){
var _ce1=doc.createElement("item");
XMLBuilderSetAttributeNodeNS(_ce1,"xsi:type","bus:simpleParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
var _ce2=XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:use",doc);
XMLBuilderSetAttributeNodeNS(_ce2,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
if(_cdb[j].use){
_ce2.appendChild(doc.createTextNode(_cdb[j].use));
}else{
if(_cdb[j].display){
_ce2.appendChild(doc.createTextNode(_cdb[j].display));
}else{
_ce2.appendChild(doc.createTextNode(""));
}
}
var _ce3=XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:display",doc);
XMLBuilderSetAttributeNodeNS(_ce3,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
if(_cdb[j].display){
_ce3.appendChild(doc.createTextNode(_cdb[j].display));
}else{
_ce3.appendChild(doc.createTextNode(""));
}
_ce1.appendChild(_ce2);
_ce1.appendChild(_ce3);
_cdf.appendChild(_ce1);
}
_cd9.appendChild(_cdd);
};
CSelectionXml.prototype._burstToXml=function(_ce4){
var doc=_ce4.ownerDocument;
var _ce6=doc.createElement("burst-context");
_ce6.appendChild(doc.createTextNode(this.burstContext));
_ce4.appendChild(_ce6);
};
CSelectionXml.prototype._slicersToXml=function(_ce7,_ce8){
};
CSelectionXml.prototype._filtersToXml=function(_ce9,_cea){
};
CSubscriptionManager.k_SubscriptionWizardName="subscriptionWizard";
function CSubscriptionManager(cv){
this.m_cv=cv;
this.m_bInitialized=false;
this.m_aWatchRules=null;
this.m_sEmail="";
this.m_sAlertNewVersionConfirm="";
this.m_sQueryNotificationResponse="";
this.m_bAllowNotification=false;
this.m_bAllowSubscription=false;
this.m_bCanCreateNewWatchRule=false;
this.m_bCanGetNotified=false;
this.m_bAllowAnnotations=false;
this.m_bCanCreateAnnotations=false;
this.m_windowOptions="width=450,height=350,toolbar=0,location=0,status=0,menubar=0,resizable,scrollbars=1";
};
CSubscriptionManager.prototype.getViewer=function(){
return this.m_cv;
};
CSubscriptionManager.prototype.Initialize=function(_cec){
try{
var _ced=_cec.getJSONResponseObject();
var _cee=document.forms["formWarpRequest"+this.m_cv.getId()];
if(_ced["annotationInfo"]){
var _cef=_ced["annotationInfo"];
this.m_AnnotationsCount=_cef.annotations.length;
this.m_annotations=_cef.annotations;
this.m_bAllowAnnotations=_cef.allowAnnotations;
this.m_bCanCreateAnnotations=_cef.traverse=="true";
return true;
}
if(_ced["subscriptionInfo"]){
var _cf0=_ced["subscriptionInfo"];
if(!this.m_bInitialized){
this.m_sEmail=_cf0.sEmail;
this.m_bAllowNotification=_cf0.bAllowNotification;
this.m_bAllowSubscription=_cf0.bAllowSubscription;
this.m_sAlertNewVersionConfirm=_cf0.sAlertNewVersionConfirm;
if(_cee["ui.action"]&&_cee["ui.action"].value=="view"){
if(_cee["ui.format"]){
this.m_bCanCreateNewWatchRule=(_cee["ui.format"].value=="HTML")&&this.m_cv.bCanUseCognosViewerConditionalSubscriptions&&this.m_bAllowSubscription;
}
this.m_bCanGetNotified=(!_cee["ui.burstKey"]||(_cee["ui.burstKey"]&&_cee["ui.burstKey"].value==""))&&this.m_bAllowNotification;
}
}
if(_cf0.sQueryNotificationResponse){
this.m_sQueryNotificationResponse=_cf0.sQueryNotificationResponse;
}
if(_cf0.aWatchRules){
var _cf1=_cf0.aWatchRules;
this.m_aWatchRules=[];
for(var i=0;i<_cf1.length;i++){
this.m_aWatchRules.push(_cf1[i]);
}
}
this.m_bInitialized=true;
return true;
}
}
catch(exception){
return false;
}
return false;
};
CSubscriptionManager.prototype.IsValidSelectionForNewRule=function(){
var _cf3=this.m_cv.getSelectionController();
if(_cf3&&!_cf3.hasSelectedChartNodes()){
var _cf4=_cf3.getAllSelectedObjects();
if(_cf4.length===1){
if(_cf4[0]!=null&&_cf4[0].getLayoutType()!="columnTitle"){
return true;
}
}
}
return false;
};
CSubscriptionManager.prototype.CanCreateNewWatchRule=function(){
if(typeof this.m_cv.UIBlacklist!="undefined"&&this.m_cv.UIBlacklist.indexOf(" RV_TOOLBAR_BUTTONS_ALERT_USING_NEW_WATCH_RULE ")!=-1){
return false;
}
if(!this.m_bInitialized&&this.getViewer().envParams["ui.action"]=="view"){
var oCV=this.getViewer();
var _cf6=new JSONDispatcherEntry(oCV);
_cf6.setKey("subscriptionManager");
_cf6.forceSynchronous();
_cf6.addFormField("ui.action","getSubscriptionInfo");
_cf6.addFormField("cv.responseFormat","subscriptionManager");
_cf6.addFormField("contextMenu","true");
this.addCommonFormFields(_cf6);
_cf6.setCallbacks({"complete":{"object":this,"method":this.Initialize}});
oCV.dispatchRequest(_cf6);
}
return this.m_bCanCreateNewWatchRule;
};
CSubscriptionManager.prototype.CanModifyWatchRule=function(){
return this.m_cv.bCanUseCognosViewerConditionalSubscriptions&&this.m_bAllowSubscription;
};
CSubscriptionManager.prototype.CanGetNotified=function(){
if(typeof this.m_cv.UIBlacklist!="undefined"&&this.m_cv.UIBlacklist.indexOf(" RV_TOOLBAR_BUTTONS_ALERT_ABOUT_NEW_VERSIONS ")!=-1){
return false;
}
return this.m_bCanGetNotified;
};
CSubscriptionManager.prototype.UpdateSubscribeMenu=function(){
var _cf7=this.getStandaloneViewerToolbarControl();
var _cf8=_cf7?_cf7.getItem("watchNewVersions"):null;
var _cf9=this.m_cv.getWebContentRoot();
var _cfa=this.m_cv.getSkin();
if(_cf8){
var _cfb=_cf8.getMenu();
this.ClearSubscriptionMenu();
var _cfc=false;
if(this.CanGetNotified()){
if(this.m_sQueryNotificationResponse=="on"){
new CMenuItem(_cfb,RV_RES.RV_DO_NOT_ALERT_NEW_VERSION,"javascript:"+this.m_cv.getObjectId()+".getSubscriptionManager().DeleteNotification();",_cf9+"/rv/images/action_remove_from_list.gif",gMenuItemStyle,_cf9,_cfa);
_cfc=true;
}else{
if(this.m_sQueryNotificationResponse=="off"&&this.m_sEmail!=""){
new CMenuItem(_cfb,RV_RES.RV_ALERT_NEW_VERSION,"javascript:"+this.m_cv.getObjectId()+".getSubscriptionManager().AddNotification();",_cf9+"/rv/images/action_add_to_list.gif",gMenuItemStyle,_cf9,_cfa);
_cfc=true;
}
}
}
if(this.CanCreateNewWatchRule()){
if(_cfc){
_cfb.add(gMenuSeperator);
}
var _cfd=new CMenuItem(_cfb,RV_RES.RV_NEW_WATCH_RULE,"javascript:"+this.m_cv.getObjectId()+".getSubscriptionManager().NewSubscription();",_cf9+"/rv/images/action_new_subscription.gif",gMenuItemStyle,_cf9,_cfa);
if(!this.IsValidSelectionForNewRule()){
_cfd.disable();
}
_cfc=true;
}
var _cfe="";
if(typeof this.m_cv.UIBlacklist!="undefined"){
_cfe=this.m_cv.UIBlacklist;
}
var _cff;
if(_cfe.indexOf(" RV_TOOLBAR_BUTTONS_RULES ")==-1){
if(_cfc){
_cfb.add(gMenuSeperator);
}
if(this.m_aWatchRules&&this.m_aWatchRules.length>0){
var _d00=this.CanModifyWatchRule();
for(var sub=0;sub<this.m_aWatchRules.length;++sub){
var menu=new CMenuItem(_cfb,this.m_aWatchRules[sub].name,"",_cf9+"/rv/images/icon_subscription.gif",gMenuItemStyle,_cf9,_cfa);
var _d03=menu.createCascadedMenu(gMenuStyle);
_d03.m_oCV=this.m_cv;
if(_d00&&_cfe.indexOf(" RV_TOOLBAR_BUTTONS_RULES_MODIFY ")==-1){
new CMenuItem(_d03,RV_RES.RV_MODIFY_WATCH_RULE,this.m_cv.getObjectId()+".getSubscriptionManager().ModifySubscription("+sub+");",_cf9+"/rv/images/action_edit.gif",gMenuItemStyle,_cf9,_cfa);
}
if(_cfe.indexOf(" RV_TOOLBAR_BUTTONS_RULES_DELETE ")==-1){
new CMenuItem(_d03,RV_RES.RV_DELETE_WATCH_RULE,this.m_cv.getObjectId()+".getSubscriptionManager().DeleteSubscription("+sub+");",_cf9+"/rv/images/action_delete.gif",gMenuItemStyle,_cf9,_cfa);
}
}
}else{
_cff=new CMenuItem(_cfb,RV_RES.RV_NO_WATCH_RULES,"","",gMenuItemStyle,_cf9,_cfa);
_cff.disable();
}
}
if(_cfb.getNumItems()==0){
_cff=new CMenuItem(_cfb,RV_RES.RV_NO_WATCH_RULES,"","",gMenuItemStyle,_cf9,_cfa);
_cff.disable();
}
_cfb.setForceCallback(false);
_cfb.draw();
if(_cfb.isVisible()){
_cfb.show();
}
_cfb.setForceCallback(true);
}
};
CSubscriptionManager.prototype.UpdateAnnotationMenu=function(){
var _d04=this.getStandaloneViewerToolbarControl();
var _d05=_d04?_d04.getItem("addAnnotations"):null;
var _d06=this.m_cv.getWebContentRoot();
var _d07=this.m_cv.getSkin();
var _d08=_d05.getMenu();
this.ClearAnnotationMenu();
var menu=new CMenuItem(_d08,RV_RES.RV_NEW_COMMENT,"javascript:"+this.m_cv.getObjectId()+".getSubscriptionManager().NewAnnotation();",_d06+"/rv/images/action_comment_add.gif",gMenuItemStyle,_d06,_d07);
var _d0a=this.m_annotations.length;
if(_d0a>0){
_d08.add(gMenuSeperator);
}
if(!this.m_bAllowAnnotations||!this.m_bCanCreateAnnotations){
menu.disable();
}
var _d0b;
var bidi=isViewerBidiEnabled()?BidiUtils.getInstance():null;
for(var i=0;i<_d0a;i++){
var _d0e=this.m_annotations[i].defaultName;
_d0b=_d0e.length>60?_d0e.substring(0,60)+"...":_d0e;
if(isViewerBidiEnabled()){
_d0b=bidi.btdInjectUCCIntoStr(_d0b,getViewerBaseTextDirection());
}
var _d0f=Boolean(this.m_annotations[i].permissions.read);
var _d10=Boolean(this.m_annotations[i].permissions.write);
var _d11=Boolean(this.m_annotations[i].permissions.traverse)&&Boolean(this.m_annotations[i].permissions.write);
var _d12="javascript:"+this.m_cv.getObjectId()+".getSubscriptionManager().ViewAnnotation("+i+");";
var _d13="javascript:alert('Permission denied')";
_d12=_d0f?_d12:_d13;
if(i>0&&this.m_annotations[i].layoutElementId!=this.m_annotations[i-1].layoutElementId){
_d08.add(gMenuSeperator);
}
var _d14="/rv/images/action_comment.gif";
if(this.m_annotations[i].layoutElementId!=""){
_d14="/rv/images/action_subscribe.gif";
}
menu=new CMenuItem(_d08,_d0b,_d12,_d06+_d14,gMenuItemStyle,_d06,_d07);
var _d15=menu.createCascadedMenu(gMenuStyle);
var _d16=new CInfoPanel("300px",_d06,_d15.getId()+"_comments");
_d16.setParent(_d15);
_d0e=this.m_annotations[i].defaultName;
var _d17=_d0e.length>60?_d0e.substring(0,60)+"...":_d0e;
if(isViewerBidiEnabled()){
_d17=bidi.btdInjectUCCIntoStr(_d17,getViewerBaseTextDirection());
}
_d16.addProperty(RV_RES.RV_VIEW_COMMENT_NAME,html_encode(_d17));
_d16.addSpacer(4);
var cmnt=this.m_annotations[i].description;
var _d19=cmnt.length>590?cmnt.substring(0,590)+"...":cmnt;
if(isViewerBidiEnabled()){
_d19=bidi.btdInjectUCCIntoStr(_d19,getViewerBaseTextDirection());
}
_d16.addProperty(RV_RES.RV_VIEW_COMMENT_CONTENTS,replaceNewLine(html_encode(_d19)));
_d16.addSpacer(4);
var _d1a=this.m_annotations[i].modificationTime;
if(isViewerBidiEnabled()){
_d1a=bidi.btdInjectUCCIntoStr(_d1a,getViewerBaseTextDirection());
}
_d16.addProperty(RV_RES.RV_VIEW_COMMENT_MODTIME,_d1a);
var _d1b=this.m_annotations[i].owner.defaultName;
if(isViewerBidiEnabled()){
_d1b=bidi.btdInjectUCCIntoStr(_d1b,getViewerBaseTextDirection());
}
_d16.addProperty(RV_RES.RV_VIEW_COMMENT_OWNER,_d1b);
_d15.add(_d16);
if(_d10||_d11){
_d15.add(gMenuSeperator);
}
new CMenuItem(_d15,RV_RES.RV_VIEW_COMMENT,this.m_cv.getObjectId()+".getSubscriptionManager().ViewAnnotation("+i+");",_d06+"/rv/images/action_comment_view.gif",gMenuItemStyle,_d06,_d07);
if(_d10){
new CMenuItem(_d15,RV_RES.RV_MODIFY_WATCH_RULE,this.m_cv.getObjectId()+".getSubscriptionManager().ModifyAnnotation("+i+");",_d06+"/rv/images/action_comment_modify.gif",gMenuItemStyle,_d06,_d07);
}
if(_d11){
new CMenuItem(_d15,RV_RES.RV_DELETE_WATCH_RULE,this.m_cv.getObjectId()+".getSubscriptionManager().DeleteAnnotation("+i+");",_d06+"/rv/images/action_comment_delete.gif",gMenuItemStyle,_d06,_d07);
}
}
_d08.setForceCallback(false);
_d08.draw();
if(_d08.isVisible()){
_d08.show();
}
_d08.setForceCallback(true);
};
CSubscriptionManager.prototype.AddNotification=function(){
alert(this.m_sAlertNewVersionConfirm);
var oCV=this.getViewer();
var _d1d=new DataDispatcherEntry(oCV);
_d1d.setKey("subscriptionManager");
_d1d.addFormField("ui.action","addNotification");
_d1d.addFormField("cv.responseFormat","data");
this.addCommonFormFields(_d1d);
oCV.dispatchRequest(_d1d);
};
CSubscriptionManager.prototype.DeleteNotification=function(){
alert(RV_RES.RV_DO_NOT_ALERT_NEW_VERSION_CONFIRM);
var oCV=this.getViewer();
var _d1f=new DataDispatcherEntry(oCV);
_d1f.setKey("subscriptionManager");
_d1f.addFormField("ui.action","deleteNotification");
_d1f.addFormField("cv.responseFormat","data");
this.addCommonFormFields(_d1f);
oCV.dispatchRequest(_d1f);
};
CSubscriptionManager.prototype.NewAnnotation=function(){
var oFWR=document.forms["formWarpRequest"+this.m_cv.getId()];
var _d21=oFWR["ui.object"].value;
var form=GUtil.createHiddenForm("subscriptionForm","post",this.m_cv.getId(),CSubscriptionManager.k_SubscriptionWizardName);
GUtil.createFormField(form,"ui.object",_d21);
GUtil.createFormField(form,"b_action","xts.run");
GUtil.createFormField(form,"m","rv/annotation1.xts");
GUtil.createFormField(form,"backURL","javascript:window.close();");
GUtil.createFormField(form,"action_hint","create");
var _d23=this.m_cv.getWebContentRoot()+"/rv/blankSubscriptionWin.html?cv.id="+this.m_cv.getId();
window.open(_d23,form.target,this.m_windowOptions);
};
CSubscriptionManager.prototype.ViewAnnotation=function(idx){
var sub=this.m_annotations[idx];
var _d26=sub.searchPath;
var form=GUtil.createHiddenForm("subscriptionForm","post",this.m_cv.getId(),CSubscriptionManager.k_SubscriptionWizardName);
GUtil.createFormField(form,"ui.object",_d26);
GUtil.createFormField(form,"b_action","xts.run");
GUtil.createFormField(form,"m","rv/annotation1.xts");
GUtil.createFormField(form,"backURL","javascript:window.close();");
var _d28=this.m_cv.getWebContentRoot()+"/rv/blankSubscriptionWin.html?cv.id="+this.m_cv.getId();
window.open(_d28,form.target,this.m_windowOptions);
};
CSubscriptionManager.prototype.ModifyAnnotation=function(idx){
var sub=this.m_annotations[idx];
var _d2b=this.m_annotations[idx].searchPath;
if(sub&&_d2b){
var form=GUtil.createHiddenForm("subscriptionForm","post",this.m_cv.getId(),CSubscriptionManager.k_SubscriptionWizardName);
GUtil.createFormField(form,"ui.object",_d2b);
GUtil.createFormField(form,"b_action","xts.run");
GUtil.createFormField(form,"m","rv/annotation1.xts");
GUtil.createFormField(form,"backURL","javascript:window.close();");
GUtil.createFormField(form,"action_hint","save");
var _d2d=this.m_cv.getWebContentRoot()+"/rv/blankSubscriptionWin.html?cv.id="+this.m_cv.getId();
window.open(_d2d,form.target,this.m_windowOptions);
}
};
CSubscriptionManager.prototype.DeleteAnnotation=function(idx){
var sub=this.m_annotations[idx];
if(sub&&sub.searchPath&&confirm(RV_RES.RV_CONFIRM_DELETE_WATCH_RULE)){
var oCV=this.getViewer();
var _d31=new DataDispatcherEntry(oCV);
_d31.setKey("subscriptionManager");
_d31.addFormField("ui.action","deleteAnnotation");
_d31.addFormField("cv.responseFormat","data");
this.addCommonFormFields(_d31,sub.searchPath);
oCV.dispatchRequest(_d31);
}
};
CSubscriptionManager.prototype.NewSubscription=function(){
var sc=this.m_cv.getSelectionController();
var oFWR=document.forms["formWarpRequest"+this.m_cv.getId()];
var _d34=oFWR.reRunObj.value;
if(_d34&&sc&&sc.getAllSelectedObjects().length===1){
var form=GUtil.createHiddenForm("subscriptionForm","post",this.m_cv.getId(),CSubscriptionManager.k_SubscriptionWizardName);
var fWR=document.getElementById("formWarpRequest"+this.m_cv.getId());
var _d37=new CSelectionXml(fWR["ui.burstID"].value,fWR["ui.contentLocale"].value,fWR["ui.outputLocale"].value);
_d37.BuildSelectionFromController(sc);
GUtil.createFormField(form,"rv.selectionSpecXML",_d37.toXml());
GUtil.createFormField(form,"rv.periodicalProducer",_d34);
GUtil.createFormField(form,"b_action","xts.run");
GUtil.createFormField(form,"m","subscribe/conditional_subscribe1.xts");
GUtil.createFormField(form,"backURL","javascript:window.close();");
var _d38=this.m_cv.getWebContentRoot()+"/rv/blankSubscriptionWin.html?cv.id="+this.m_cv.getId();
window.open(_d38,form.target,"toolbar,location,status,menubar,resizable,scrollbars=1");
}else{
}
};
CSubscriptionManager.prototype.DeleteSubscription=function(idx){
var sub=this.m_aWatchRules[idx];
if(sub&&sub.searchPath&&confirm(RV_RES.RV_CONFIRM_DELETE_WATCH_RULE)){
var oCV=this.getViewer();
var _d3c=new DataDispatcherEntry(oCV);
_d3c.setKey("subscriptionManager");
_d3c.addFormField("ui.action","deleteSubscription");
_d3c.addFormField("cv.responseFormat","data");
this.addCommonFormFields(_d3c,sub.searchPath);
oCV.dispatchRequest(_d3c);
}
};
CSubscriptionManager.prototype.ModifySubscription=function(idx){
var sub=this.m_aWatchRules[idx];
if(sub&&sub.searchPath){
var form=GUtil.createHiddenForm("subscriptionForm","post",this.m_cv.getId(),CSubscriptionManager.k_SubscriptionWizardName);
GUtil.createFormField(form,"m_obj",sub.searchPath);
GUtil.createFormField(form,"m_name",sub.name);
GUtil.createFormField(form,"b_action","xts.run");
GUtil.createFormField(form,"m_class","reportDataServiceAgentDefinition");
GUtil.createFormField(form,"m","portal/properties_subscription.xts");
GUtil.createFormField(form,"backURL","javascript:window.close();");
var _d40=this.m_cv.getWebContentRoot()+"/rv/blankSubscriptionWin.html?cv.id="+this.m_cv.getId();
window.open(_d40,form.target,"toolbar,location,status,menubar,resizable,scrollbars=1");
}
};
CSubscriptionManager.prototype.OpenSubscriptionMenu=function(){
var oCV=this.getViewer();
var _d42=new JSONDispatcherEntry(oCV);
_d42.setKey("subscriptionManager");
_d42.addFormField("ui.action","getSubscriptionInfo");
_d42.addFormField("cv.responseFormat","subscriptionManager");
this.addCommonFormFields(_d42);
_d42.setCallbacks({"complete":{"object":this,"method":this.OpenSubscriptionMenuResponse}});
oCV.dispatchRequest(_d42);
};
CSubscriptionManager.prototype.OpenAnnotationMenu=function(){
var oCV=this.getViewer();
var _d44=new JSONDispatcherEntry(oCV);
_d44.setKey("subscriptionManager");
_d44.addFormField("ui.action","getAnnotationInfo");
_d44.addFormField("cv.responseFormat","getAnnotations");
var _d45=oCV.envParams["ui.object"];
this.addCommonFormFields(_d44,_d45?_d45:"");
_d44.setCallbacks({"complete":{"object":this,"method":this.OpenAnnotationMenuResponse}});
oCV.dispatchRequest(_d44);
};
CSubscriptionManager.prototype.OpenAnnotationMenuResponse=function(_d46){
if(this.Initialize(_d46)){
this.UpdateAnnotationMenu();
}else{
this.ClearAnnotationMenu();
}
};
CSubscriptionManager.prototype.OpenSubscriptionMenuResponse=function(_d47){
if(this.Initialize(_d47)){
this.UpdateSubscribeMenu();
}else{
this.AddEmptySubscriptionMenuItem();
}
};
CSubscriptionManager.prototype.addCommonFormFields=function(_d48,_d49){
if(_d49&&_d49!=""){
_d48.addFormField("ui.object",_d49);
}else{
var _d4a=document["formWarpRequest"+this.getViewer().getId()];
if(_d4a&&_d4a["reRunObj"]){
_d48.addFormField("ui.object",_d4a["reRunObj"].value);
}
}
if(_d48.getFormField("ui.action")=="getSubscriptionInfo"){
_d48.addFormField("initialized",this.m_bInitialized?"true":"false");
}
_d48.addFormField("cv.id",this.getViewer().getId());
};
CSubscriptionManager.prototype.AddEmptySubscriptionMenuItem=function(){
var _d4b=this.getStandaloneViewerToolbarControl();
if(_d4b){
var _d4c=_d4b.getItem("watchNewVersions");
if(_d4c){
_d4c.getMenu().clear();
}
var _d4d=this.m_cv.getWebContentRoot();
var _d4e=this.m_cv.getSkin();
var _d4f=_d4c.getMenu();
var _d50=new CMenuItem(_d4f,RV_RES.RV_NO_WATCH_RULES,"","",gMenuItemStyle,_d4d,_d4e);
_d50.disable();
_d4f.setForceCallback(false);
_d4f.draw();
if(_d4f.isVisible()){
_d4f.show();
}
_d4f.setForceCallback(true);
}
};
CSubscriptionManager.prototype.ClearSubscriptionMenu=function(){
var _d51=this.getStandaloneViewerToolbarControl();
if(_d51){
var _d52=_d51.getItem("watchNewVersions");
if(_d52){
_d52.getMenu().clear();
}
}
};
CSubscriptionManager.prototype.ClearAnnotationMenu=function(){
var _d53=this.getStandaloneViewerToolbarControl();
if(_d53){
var _d54=_d53.getItem("addAnnotations");
if(_d54){
_d54.getMenu().clear();
}
}
};
CSubscriptionManager.prototype.ClearContextAnnotationMenu=function(){
var _d55=this.getStandaloneViewerContextMenu();
if(_d55){
var _d56=_d55.getFindCommentMenuItem();
if(_d56){
_d56.getMenu().clear();
}
}
};
CSubscriptionManager.prototype.getStandaloneViewerToolbarControl=function(){
if(typeof this.m_cv.rvMainWnd!="undefined"&&this.m_cv.rvMainWnd!=null&&typeof this.m_cv.rvMainWnd.getToolbarControl=="function"){
return this.m_cv.rvMainWnd.getToolbarControl();
}else{
return null;
}
};
CSubscriptionManager.prototype.getStandaloneViewerContextMenu=function(){
if(typeof this.m_cv.rvMainWnd!="undefined"&&this.m_cv.rvMainWnd!=null&&typeof this.m_cv.rvMainWnd.getContextMenu=="function"){
return this.m_cv.rvMainWnd.getContextMenu();
}else{
return null;
}
};
var GUtil={};
GUtil.createHiddenForm=function(name,_d58,_d59,_d5a){
var form=document.getElementById(name);
if(form){
document.body.removeChild(form);
}
form=document.createElement("form");
form.id=name;
form.name=name;
form.method=_d58;
form.style.display="none";
form.action=document.forms["formWarpRequest"+_d59].action;
form.target=_d5a+(new Date()).getTime();
document.body.appendChild(form);
return form;
};
GUtil.createFormField=function(el,name,_d5e){
var _d5f=document.createElement("input");
_d5f.type="hidden";
_d5f.name=name;
_d5f.value=_d5e;
el.appendChild(_d5f);
};
GUtil.generateCallback=function(func,_d61,_d62){
if(func){
var _d63=_d62||this;
_d61=(_d61 instanceof Array)?_d61:[];
return (function(_d64){
if(typeof _d64!="undefined"&&_d61.length==0){
_d61.push(_d64);
}
return func.apply(_d63,_d61);
});
}else{
return (function(){
});
}
};
GUtil.destroyProperties=function(_d65,_d66){
var _d67;
if(_d65 instanceof Array){
for(var i=0;i<_d65.length;i++){
_d67=_d65[i];
if(_d67 instanceof String){
_d67=null;
}else{
if(_d67&&_d67.destroy&&!_d67._beingDestroyed){
_d67.destroy();
}
GUtil.destroyProperties(_d67);
}
}
}else{
if(_d65 instanceof Object){
if(_d65._beingDestroyed){
return;
}
var obj=_d65;
obj._beingDestroyed=true;
for(var _d6a in obj){
_d67=obj[_d6a];
if(_d6a==="_beingDestroyed"||_d6a==="m_destroyed"||_d6a==="_destroyed"||typeof _d67=="function"){
continue;
}
if(_d67 instanceof Array){
GUtil.destroyProperties(_d67);
}else{
if(_d67 instanceof Object){
if(typeof _d67.destroy=="function"&&!_d67._destroyed&&(_d67!==CCognosViewer||_d66)){
_d67.destroy();
}
}
}
delete obj[_d6a];
}
}
}
};
cvLoadDialog=function(_d6b,_d6c,_d6d,_d6e,_d6f,_d70){
_d70=((_d70===undefined)?true:_d70);
var _d71=document.getElementById("formWarpRequest"+_d6b.getId());
if(_d71&&_d6b){
_d6b.getWorkingDialog().hide();
var _d72="";
var _d73="";
var _d74=null;
if(_d6b.isAccessibleMode()){
_d72="winNAT_"+(new Date()).getTime();
_d73=_d6b.getWebContentRoot()+"/"+"rv/blankNewWin.html?cv.id="+this.getCVId();
}else{
var _d75=document.body;
_d74=new CModal("","",_d75,null,null,_d6e,_d6d,true,true,false,true,_d6b.getWebContentRoot());
if(typeof _d6f=="string"){
document.getElementById(CMODAL_CONTENT_ID).setAttribute("title",_d6f);
}
document.getElementById(CMODAL_BACK_IFRAME_ID).setAttribute("title",RV_RES.IDS_JS_MODAL_BACK_IFRAME);
_d72=CMODAL_CONTENT_ID;
}
var _d76=document.createElement("FORM");
_d76.method="POST";
_d76.action=_d6b.getGateway();
_d76.target=_d72;
_d76.style.margin="0px";
document.body.appendChild(_d76);
for(var _d77 in _d6c){
_d76.appendChild(createHiddenFormField(_d77,_d6c[_d77]));
}
if(_d70){
_d76.appendChild(createHiddenFormField("cv.id",_d6b.getId()));
_d76.appendChild(createHiddenFormField("b_action","xts.run"));
_d76.appendChild(createHiddenFormField("ui.action",_d71["ui.action"].value));
_d76.appendChild(createHiddenFormField("ui.object",_d71["ui.object"].value));
if(typeof _d6b.rvMainWnd!="undefined"){
_d76.appendChild(createHiddenFormField("run.outputFormat",_d6b.rvMainWnd.getCurrentFormat()));
}
if(typeof _d71["run.outputLocale"]!="undefined"){
_d76.appendChild(createHiddenFormField("run.outputLocale",_d71["run.outputLocale"].value));
}
if(typeof _d76["backURL"]=="undefined"&&typeof _d76["ui.backURL"]=="undefined"&&typeof _d71["ui.backURL"]!="undefined"){
_d76.appendChild(createHiddenFormField("ui.backURL",_d71["ui.backURL"].value));
}
if(typeof _d6b!="undefined"&&typeof _d6b.getConversation!="undefined"&&typeof _d6b.getTracking!="undefined"){
_d76.appendChild(createHiddenFormField("ui.conversation",_d6b.getConversation()));
_d76.appendChild(createHiddenFormField("m_tracking",_d6b.getTracking()));
if(_d6b.envParams["ui.name"]!="undefined"){
_d76.appendChild(createHiddenFormField("ui.name",_d6b.envParams["ui.name"]));
}
}
}
var _d78=window.onbeforeunload;
window.onbeforeunload=null;
if(_d6b.isAccessibleMode()){
window.open(_d73,_d72,"rv");
_d76.submit();
}else{
_d76.submit();
_d74.show();
}
window.onbeforeunload=_d78;
document.body.removeChild(_d76);
_d6b.modalShown=true;
}
};
function createHiddenFormField(name,_d7a){
var _d7b=document.createElement("input");
_d7b.setAttribute("type","hidden");
_d7b.setAttribute("name",name);
_d7b.setAttribute("id",name);
_d7b.setAttribute("value",_d7a);
return (_d7b);
};
function isAuthenticationFault(_d7c){
if(_d7c!=null){
var _d7d=XMLHelper_FindChildByTagName(_d7c,"CAM",true);
return (_d7d!=null&&XMLHelper_FindChildByTagName(_d7d,"promptInfo",true)!=null);
}
};
function processAuthenticationFault(_d7e,_d7f){
if(isAuthenticationFault(_d7e)){
launchLogOnDialog(_d7f,_d7e);
return true;
}
return false;
};
function isObjectEmpty(_d80){
for(var _d81 in _d80){
if(_d80.hasOwnProperty(_d81)){
return false;
}
}
return true;
};
function launchLogOnDialog(cvID,_d83){
try{
var oCV=getCognosViewerObjectRef(cvID);
var _d85={"b_action":"xts.run","m":"portal/close.xts","h_CAM_action":"logonAs"};
if(_d83!=null){
var _d86=XMLHelper_FindChildrenByTagName(_d83,"namespace",true);
if(_d86!=null){
for(var _d87=0;_d87<_d86.length;++_d87){
var _d88=_d86[_d87];
if(_d88!=null){
var _d89=XMLHelper_FindChildByTagName(_d88,"name",false);
var _d8a=XMLHelper_FindChildByTagName(_d88,"value",false);
if(_d89!=null&&_d8a!=null){
var _d8b=XMLHelper_GetText(_d89);
var _d8c=XMLHelper_GetText(_d8a);
if(_d8b!=null&&_d8b.length>0){
_d85[_d8b]=_d8c;
}
}
}
}
}
}
cvLoadDialog(oCV,_d85,540,460,null,false);
}
catch(exception){
}
};
function getCVWaitingOnFault(){
var oCV=null;
for(var _d8e=0;_d8e<window.gaRV_INSTANCES.length;_d8e++){
if(window.gaRV_INSTANCES[_d8e].getRetryDispatcherEntry()!=null){
oCV=window.gaRV_INSTANCES[_d8e];
break;
}
}
return oCV;
};
function ccModalCallBack(_d8f,data){
var oCV=getCVWaitingOnFault();
destroyCModal();
if(typeof HiddenIframeDispatcherEntry=="function"&&HiddenIframeDispatcherEntry.hideIframe){
var oCV=window.gaRV_INSTANCES[0];
if(oCV){
HiddenIframeDispatcherEntry.hideIframe(oCV.getId());
}
}
if(oCV!=null){
if(typeof _d8f!="undefined"&&_d8f=="ok"){
var _d92=oCV.getRetryDispatcherEntry();
if(_d92){
_d92.retryRequest();
}
if(oCV.getRV()!=null){
oCV.getRV().updateUserName();
}
}else{
oCV.rvMainWnd.hideOpenMenus();
}
}
};
function closeErrorPage(){
var oCV=getCVWaitingOnFault();
destroyCModal();
if(oCV!=null){
oCV.setRetryDispatcherEntry(null);
oCV.rvMainWnd.hideOpenMenus();
}
};
function getCrossBrowserNode(evt,_d95){
var node=null;
if(_d95&&evt.explicitOriginalTarget){
node=evt.explicitOriginalTarget;
}else{
if(evt.originalTarget){
node=evt.originalTarget;
}else{
if(evt.target){
node=evt.target;
}else{
if(evt.srcElement){
node=evt.srcElement;
}
}
}
}
try{
if(node&&node.nodeType==3){
node=node.parentNode;
}
}
catch(ex){
}
return node;
};
function getNodeFromEvent(evt,_d98){
var node=getCrossBrowserNode(evt,true);
if(node&&node.getAttribute&&node.getAttribute("name")=="primarySelectionDiv"){
node=node.parentNode.firstChild;
}
if(node&&node.getAttribute&&node.getAttribute("flashChartContainer")=="true"){
node=node.firstChild;
}
if(node&&node.getAttribute&&node.getAttribute("chartContainer")=="true"&&node.childNodes){
for(var i=0;i<node.childNodes.length;i++){
if(node.childNodes[i].nodeName.toLowerCase()=="img"){
node=node.childNodes[i];
break;
}
}
}else{
if(!_d98&&node&&node.nodeName&&node.nodeName.toLowerCase()=="img"&&node.getAttribute("rsvpChart")!="true"){
node=node.parentNode;
}
}
return node;
};
function getCtxNodeFromEvent(evt){
try{
var node=getCrossBrowserNode(evt);
var _d9d=node.nodeName.toUpperCase();
if((_d9d=="SPAN"||_d9d=="AREA"||_d9d=="IMG")&&node.getAttribute("ctx")!=null){
return node;
}else{
if(_d9d=="SPAN"&&(node.parentNode.getAttribute("ctx")!=null)){
return node.parentNode;
}
}
}
catch(exception){
}
return null;
};
function getDocumentFromEvent(evt){
var node=getCrossBrowserNode(evt,true);
var _da0=node.document?node.document:node.ownerDocument;
return _da0;
};
function stopEventBubble(evt){
evt.returnValue=false;
evt.cancelBubble=true;
if(typeof evt.stopPropagation!="undefined"){
evt.stopPropagation();
}
if(typeof evt.preventDefault!="undefined"){
evt.preventDefault();
}
return false;
};
function setNodeFocus(evt){
evt=(evt)?evt:((event)?event:null);
var _da3=getNodeFromEvent(evt);
if(_da3&&_da3.nodeName){
var _da4=_da3.nodeName.toLowerCase();
if((_da4=="td"||_da4=="span")&&_da3.childNodes&&_da3.childNodes.length>0&&_da3.childNodes[0].className=="textItem"){
try{
_da3.childNodes[0].focus();
}
catch(e){
if(typeof console!=="undefined"&&console.log){
console.log("CCognosViewer: Could not set focus to node. setNodeFocus method common.js");
}
}
}
}
};
function html_encode(str){
return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
};
function replaceNewLine(_da6){
var regX=/\r\n|\r|\n/g;
var _da8="<br/>";
return _da6.replace(regX,_da8);
};
function xml_encode(_da9){
var _daa=""+_da9;
if((_daa=="0")||((_da9!=null)&&(_da9!=false))){
_daa=_daa.replace(/&/g,"&amp;");
_daa=_daa.replace(/</g,"&lt;");
_daa=_daa.replace(/>/g,"&gt;");
_daa=_daa.replace(/"/g,"&quot;");
_daa=_daa.replace(/'/g,"&apos;");
}else{
if(_da9==null){
_daa="";
}
}
return _daa;
};
function xml_decodeParser(sAll,_dac){
var _dad=sAll;
switch(_dac){
case "amp":
_dad="&";
break;
case "lt":
_dad="<";
break;
case "gt":
_dad=">";
break;
case "quot":
_dad="\"";
break;
case "apos":
_dad="'";
break;
}
return _dad;
};
function xml_decode(_dae){
var _daf=""+_dae;
if((_daf=="0")||((_dae!=null)&&(_dae!=false))){
_daf=_daf.replace(/&(amp|lt|gt|quot|apos);/g,xml_decodeParser);
}else{
if(_dae==null){
_daf="";
}
}
return _daf;
};
function xpath_attr_encode(_db0){
var _db1=null;
if(_db0.indexOf("'")>=0&&_db0.indexOf("\"")>=0){
var _db2=_db0.split("\"");
_db1="concat(";
for(var i=0;i<_db2.length;++i){
if(i>0){
_db1+=",";
}
if(_db2[i].length>0){
_db1+=("\""+_db2[i]+"\"");
}else{
_db1+="'\"'";
}
}
_db1+=")";
}else{
if(_db0.indexOf("'")>=0){
_db1="\""+_db0+"\"";
}else{
_db1="'"+_db0+"'";
}
}
return _db1;
};
function getCognosViewerObjectString(sId){
return "oCV"+sId;
};
function getCognosViewerObjectRefAsString(sId){
return "window."+getCognosViewerObjectString(sId);
};
function getCognosViewerObjectRef(sId){
return window[getCognosViewerObjectString(sId)];
};
function getCognosViewerSCObjectString(sId){
return "oCVSC"+sId;
};
function getCognosViewerSCObjectRefAsString(sId){
return "window."+getCognosViewerSCObjectString(sId);
};
function getCognosViewerSCObjectRef(sId){
return window[getCognosViewerSCObjectString(sId)];
};
function cleanupGlobalObjects(sId){
cleanupVariable(getCognosViewerObjectString(sId));
cleanupVariable(getCognosViewerSCObjectString(sId));
};
function cleanupVariable(_dbb){
if(typeof window[_dbb]!="undefined"&&window[_dbb]){
if(isIE()){
eval("delete "+_dbb);
}else{
delete window[_dbb];
}
}
};
function loadClass(_dbc){
try{
var _dbd=eval("new "+_dbc+"();");
return _dbd;
}
catch(e){
return null;
}
};
function getElementsByClassName(oElm,_dbf,_dc0){
var _dc1=(_dbf=="*"&&oElm.all)?oElm.all:oElm.getElementsByTagName(_dbf);
var _dc2=[];
var _dc3=new RegExp("(^|\\s)"+_dc0+"(\\s|$)");
var _dc4=_dc1.length;
for(var i=0;i<_dc4;i++){
var _dc6=_dc1[i];
if(_dc3.test(_dc6.className)){
_dc2.push(_dc6);
}
}
return _dc2;
};
function getImmediateLayoutContainerId(node){
var _dc8=node;
while(_dc8!=null){
if(_dc8.getAttribute&&_dc8.getAttribute("lid")!=null){
return _dc8.getAttribute("lid");
}
_dc8=_dc8.parentNode;
}
return null;
};
function getChildElementsByAttribute(oElm,_dca,_dcb,_dcc){
return getDescendantElementsByAttribute(oElm,_dca,_dcb,_dcc,true);
};
function getElementsByAttribute(oElm,_dce,_dcf,_dd0,_dd1,_dd2){
return getDescendantElementsByAttribute(oElm,_dce,_dcf,_dd0,false,_dd1,_dd2);
};
function getDescendantElementsByAttribute(oElm,_dd4,_dd5,_dd6,_dd7,_dd8,_dd9){
var _dda=[];
var _ddb=null;
if(typeof _dd9==="undefined"){
_ddb=(typeof _dd6!="undefined")?new RegExp("(^|\\s)"+_dd6+"(\\s|$)","i"):null;
}else{
_ddb=_dd9;
}
if(typeof _dd4=="string"){
_dd4=[_dd4];
}
var _ddc=(oElm?_dd4.length:0);
for(var _ddd=0;_ddd<_ddc;_ddd++){
var _dde=null;
if(_dd7){
if(_dd4[_ddd]=="*"&&oElm.all){
_dde=oElm.childNodes;
}else{
_dde=[];
var _ddf=oElm.childNodes;
for(var i=0;i<_ddf.length;++i){
if(_ddf[i].nodeName.toLowerCase()==_dd4[_ddd].toLowerCase()){
_dde.push(_ddf[i]);
}
}
}
}else{
_dde=(_dd4[_ddd]=="*"&&oElm.all)?oElm.all:oElm.getElementsByTagName(_dd4[_ddd]);
}
var _de1=_dde.length;
for(var idx=0;idx<_de1;idx++){
var _de3=_dde[idx];
var _de4=_de3.getAttribute&&_de3.getAttribute(_dd5);
if(_de4!==null){
var _de5=null;
if(typeof _de4==="number"){
_de5=String(_de4);
}else{
if(typeof _de4==="string"&&_de4.length>0){
_de5=_de4;
}
}
if(_de5!==null){
if(typeof _dd6=="undefined"||(_ddb&&_ddb.test(_de5))){
_dda.push(_de3);
if(_dd8!=-1&&_dda.length>_dd8){
return [];
}else{
if(_dd8==1&&_dda.length==1){
return _dda;
}
}
}
}
}
}
}
return _dda;
};
function savedOutputDoneLoading(cvId,_de7){
var oCV=window["oCV"+cvId];
var _de9=(oCV&&oCV.getViewerWidget?oCV.getViewerWidget():null);
var _dea=(_de9?_de9.getSavedOutput():null);
if(_dea){
_dea.outputDoneLoading();
}else{
if(_de7<5){
_de7++;
var _deb=function(){
savedOutputDoneLoading(cvId,_de7);
};
setTimeout(_deb,100);
}
}
};
function getNavVer(){
var temp;
if(isIE()){
return getIEVersion();
}else{
temp=navigator.userAgent.split("/");
return parseFloat(temp[temp.length-1]);
}
};
function isSafari(){
return (navigator.userAgent.toLowerCase().indexOf("safari")!=-1&&navigator.userAgent.toLowerCase().indexOf("chrome")==-1);
};
function isIE(){
return (navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1);
};
function getIEVersion(){
var _ded=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);
return _ded?parseFloat(_ded[1]):null;
};
function isFF(){
return (navigator.userAgent.indexOf("Firefox")!=-1);
};
function isIOS(){
return navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("iPhone")!=-1;
};
function displayChart(_dee,_def,_df0,_df1){
if(_def.length>1){
document.images[_dee].src=_def;
}
};
function isFlashChartNode(evt){
var node=getNodeFromEvent(evt);
if(node!=null&&typeof node.getAttribute=="function"){
return node.getAttribute("flashChart")!=null;
}
return false;
};
function onFlashChartRightClick(evt){
if(evt&&evt.button&&evt.button!=0&&isFlashChartNode(evt)){
return onViewerChartFocus(evt);
}
};
function onViewerChartFocus(evt){
if(evt.stopPropagation){
evt.stopPropagation();
}
if(evt.preventDefault){
evt.preventDefault();
}
if(evt.preventCapture){
evt.preventCapture();
}
if(evt.preventBubble){
evt.preventBubble();
}
var node=getNodeFromEvent(evt);
var _df7=node.getAttribute("viewerId");
if(!_df7){
_df7=node.parentNode.getAttribute("viewerId");
}
if(!_df7){
return;
}
var oCV=window["oCV"+_df7];
var _df9=oCV.getAction("Selection");
_df9.pageClicked(evt);
return stopEventBubble(evt);
};
function clientToScreenCoords(_dfa,_dfb){
var _dfc=_dfa;
var _dfd={topCoord:0,leftCoord:0};
while(_dfc!=null&&_dfc!=_dfb){
_dfd.topCoord+=_dfc.offsetTop;
_dfd.leftCoord+=_dfc.offsetLeft;
_dfc=_dfc.offsetParent;
}
return _dfd;
};
function getCurrentPosistionString(oCV,_dff,_e00){
var _e01=RV_RES.IDS_JS_INFOBAR_ITEM_COUNT;
var _e02=/\{0\}/;
var _e03=/\{1\}/;
_e01=_e01.replace(_e02,_dff);
_e01=" "+_e01.replace(_e03,_e00)+" ";
return _e01;
};
function applyJSONProperties(obj,_e05){
for(property in _e05){
if(typeof _e05[property]=="object"&&!(_e05[property] instanceof Array)){
if(typeof obj[property]=="undefined"){
obj[property]={};
}
applyJSONProperties(obj[property],_e05[property]);
}else{
obj[property]=_e05[property];
}
}
};
function CViewerCommon(){
};
CViewerCommon.openNewWindowOrTab=function(sURL,_e07){
return window.open(sURL,_e07);
};
CViewerCommon.toJSON=function(obj){
var type=typeof (obj);
if(type!="object"||type===null){
if(type==="string"){
obj="\""+obj+"\"";
}
return String(obj);
}else{
var _e0a;
var prop;
var json=[];
var _e0d=(obj&&obj.constructor==Array);
for(_e0a in obj){
prop=obj[_e0a];
type=typeof (prop);
if(type==="string"){
prop="\""+prop+"\"";
}else{
if(type=="object"&&prop!==null){
prop=CViewerCommon.toJSON(prop);
}
}
json.push((_e0d?"":"\""+_e0a+"\":")+String(prop));
}
return (_e0d?"[":"{")+String(json)+(_e0d?"]":"}");
}
};
function resizePinnedContainers(){
var oCV=window.gaRV_INSTANCES[0];
if(oCV&&!oCV.m_viewerFragment){
var _e0f=oCV.getPinFreezeManager();
if(_e0f&&_e0f.hasFrozenContainers()){
var _e10=document.getElementById("RVContent"+oCV.getId());
var _e11=document.getElementById("mainViewerTable"+oCV.getId());
var _e12=_e10.clientWidth;
var _e13=_e11.clientHeight;
_e0f.resize(_e12,_e13);
if(isIE()){
oCV.repaintDiv(_e10);
}
}
}
};
function setWindowHref(url){
var _e15=window.onbeforeunload;
window.onbeforeunload=null;
window.location.href=url;
window.onbeforeunload=_e15;
};
CViewerCommon.getMessage=function(msg,args){
if(typeof args=="undefined"){
return msg;
}else{
if(typeof args=="string"){
msg=msg.replace("{0}",args);
}else{
if(args.length){
for(var i=0;i<args.length;++i){
msg=msg.replace("{"+i+"}",args[i]);
}
}else{
msg=msg.replace("{0}",args);
}
}
}
return msg;
};
function getViewerDirection(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
return gaRV_INSTANCES[0].getDirection();
}
return "ltr";
};
function isViewerBidiEnabled(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
var _e19=gaRV_INSTANCES[0].isBidiEnabled();
if(_e19){
return true;
}
}
return false;
};
function getViewerBaseTextDirection(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
return gaRV_INSTANCES[0].getBaseTextDirection();
}
return "";
};
function enforceTextDir(_e1a){
if(isViewerBidiEnabled()&&_e1a){
var sDir=getViewerBaseTextDirection();
var _e1c=BidiUtils.getInstance();
if(sDir=="auto"){
sDir=_e1c.resolveStrBtd(_e1a);
}
var _e1d=(!dojo._isBodyLtr())?_e1c.RLM:_e1c.LRM;
return _e1d+((sDir==="rtl")?_e1c.RLE:_e1c.LRE)+_e1a+_e1c.PDF+_e1d;
}
return _e1a;
};
function getElementDirection(_e1e){
var dir=null;
if(_e1e.currentStyle){
dir=_e1e.currentStyle.direction;
}else{
if(window.getComputedStyle){
var _e20=window.getComputedStyle(_e1e,null);
if(_e20){
dir=_e20.getPropertyValue("direction");
}
}
}
if(dir){
dir=dir.toLowerCase();
}
return dir;
};
function getScrollLeft(_e21){
if(getElementDirection(_e21)==="rtl"&&isFF()){
return _e21.scrollWidth-_e21.offsetWidth+_e21.scrollLeft;
}
return _e21.scrollLeft;
};
function setScrollLeft(_e22,_e23){
if(getElementDirection(_e22)==="rtl"&&isFF()){
_e22.scrollLeft=_e22.offsetWidth+_e23-_e22.scrollWidth;
}else{
_e22.scrollLeft=_e23;
}
};
function setScrollRight(_e24,_e25){
if(getElementDirection(_e24)==="rtl"&&isFF()){
_e24.scrollLeft=-_e25;
}else{
_e24.scrollLeft=_e24.scrollWidth-_e24.offsetWidth-_e25;
}
};
function getBoxInfo(el,_e27){
if(!getBoxInfo.aStyles){
getBoxInfo.aStyles=[{name:"marginLeft",ie:"marginLeft",ff:"margin-left"},{name:"marginRight",ie:"marginRight",ff:"margin-right"},{name:"marginTop",ie:"marginTop",ff:"margin-top"},{name:"marginBottom",ie:"marginBottom",ff:"margin-bottom"},{name:"borderLeftWidth",ie:"borderLeftWidth",ff:"border-left-width"},{name:"borderRightWidth",ie:"borderRightWidth",ff:"border-right-width"},{name:"borderTopWidth",ie:"borderTopWidth",ff:"border-top-width"},{name:"borderBottomWidth",ie:"borderBottomWidth",ff:"border-bottom-width"},{name:"paddingLeft",ie:"paddingLeft",ff:"padding-left"},{name:"paddingRight",ie:"paddingRight",ff:"padding-right"},{name:"paddingTop",ie:"paddingTop",ff:"padding-top"},{name:"paddingBottom",ie:"paddingBottom",ff:"padding-bottom"}];
}
var _e28={};
var _e29=null;
if(el.currentStyle){
_e29=el.currentStyle;
}else{
if(window.getComputedStyle){
_e29=window.getComputedStyle(el,null);
}
}
if(!_e29){
return null;
}
for(i in getBoxInfo.aStyles){
var _e2a=getBoxInfo.aStyles[i];
var size=null;
if(_e29.getPropertyValue){
size=_e29.getPropertyValue(_e2a.ff);
}else{
size=_e29[_e2a.ie];
}
if(size&&_e27){
size=Number(size.replace("px",""));
}
_e28[_e2a.name]=size;
}
return _e28;
};
function CSelectionMetadata(){
this.m_sContextId="";
this.m_sDataItem="";
this.m_sMetadataModelItem="";
this.m_sUseValue="";
this.m_sUseValueType="";
this.m_sType=null;
this.m_sDisplayValue="";
this.m_sUsage=null;
this.m_refQuery=null;
this.m_sHun=null;
this.m_sDun=null;
};
CSelectionMetadata.prototype.setContextId=function(_e2c){
this.m_sContextId=_e2c;
};
CSelectionMetadata.prototype.getContextId=function(){
return this.m_sContextId;
};
CSelectionMetadata.prototype.setRefQuery=function(_e2d){
this.m_refQuery=_e2d;
};
CSelectionMetadata.prototype.getRefQuery=function(){
return this.m_refQuery;
};
CSelectionMetadata.prototype.setDataItem=function(_e2e){
this.m_sDataItem=_e2e;
};
CSelectionMetadata.prototype.getDataItem=function(){
return this.m_sDataItem;
};
CSelectionMetadata.prototype.setMetadataModelItem=function(_e2f){
this.m_sMetadataModelItem=_e2f;
};
CSelectionMetadata.prototype.getMetadataModelItem=function(){
return this.m_sMetadataModelItem;
};
CSelectionMetadata.prototype.setUseValue=function(_e30){
this.m_sUseValue=_e30;
};
CSelectionMetadata.prototype.getUseValue=function(){
return this.m_sUseValue;
};
CSelectionMetadata.prototype.setUseValueType=function(_e31){
this.m_sUseValueType=_e31;
};
CSelectionMetadata.prototype.setType=function(_e32){
this.m_sType=_e32;
};
CSelectionMetadata.prototype.getType=function(){
var _e33=null;
switch(this.m_sUseValueType){
case 25:
case 27:
case 30:
case 32:
_e33="memberUniqueName";
break;
case 26:
_e33="memberCaption";
break;
case 1:
case 55:
case 56:
_e33="string";
break;
case 2:
case 3:
case 4:
case 5:
case 6:
case 7:
case 8:
case 9:
case 10:
case 11:
case 12:
case 16:
case 17:
case 18:
case 19:
case 20:
case 22:
case 21:
case 23:
case 24:
case 54:
_e33=parseInt(this.m_sUseValueType,10);
break;
}
return _e33;
};
CSelectionMetadata.prototype.getUseValueType=function(){
if(this.m_sType==null){
this.m_sType=this.getType();
}
return this.m_sType;
};
CSelectionMetadata.prototype.setDisplayValue=function(_e34){
this.m_sDisplayValue=_e34;
};
CSelectionMetadata.prototype.getDisplayValue=function(){
return this.m_sDisplayValue;
};
CSelectionMetadata.prototype.setUsage=function(_e35){
this.m_sUsage=_e35;
};
CSelectionMetadata.prototype.getUsage=function(){
if(this.m_sUsage=="2"){
return "measure";
}else{
return "nonMeasure";
}
};
CSelectionMetadata.prototype.setHun=function(sHun){
this.m_sHun=sHun;
};
CSelectionMetadata.prototype.getHun=function(){
return this.m_sHun;
};
CSelectionMetadata.prototype.setDun=function(sDun){
this.m_sDun=sDun;
};
CSelectionMetadata.prototype.getDun=function(){
return this.m_sDun;
};
function CSelectionMetadataIterator(_e38,_e39){
this.m_axisIndex=_e39;
this.m_index=0;
this.m_selectionObject=_e38;
};
CSelectionMetadataIterator.prototype.getSelectionAxis=function(){
var _e3a=null;
if(typeof this.m_selectionObject=="object"&&this.m_axisIndex<this.m_selectionObject.getSelectedContextIds().length){
_e3a=this.m_selectionObject.getSelectedContextIds()[this.m_axisIndex];
}
return _e3a;
};
CSelectionMetadataIterator.prototype.hasNext=function(){
var _e3b=this.getSelectionAxis();
if(_e3b!=null){
return (this.m_index<_e3b.length);
}else{
return false;
}
};
CSelectionMetadataIterator.prototype.next=function(){
var _e3c=null;
if(this.hasNext()){
_e3c=new CSelectionMetadata();
_e3c.setContextId(this.m_selectionObject.m_contextIds[this.m_axisIndex][this.m_index]);
_e3c.setDataItem(this.m_selectionObject.getDataItems()[this.m_axisIndex][this.m_index]);
_e3c.setMetadataModelItem(this.m_selectionObject.getMetadataItems()[this.m_axisIndex][this.m_index]);
if(this.m_selectionObject.getMuns()[this.m_axisIndex][this.m_index]!=null&&this.m_selectionObject.getMuns()[this.m_axisIndex][this.m_index]!=""){
_e3c.setUseValue(this.m_selectionObject.getMuns()[this.m_axisIndex][this.m_index]);
_e3c.setType("memberUniqueName");
}else{
_e3c.setUseValue(this.m_selectionObject.getUseValues()[this.m_axisIndex][this.m_index]);
}
if(typeof this.m_selectionObject.m_selectionController=="object"){
var _e3d=this.m_selectionObject.getSelectedContextIds()[this.m_axisIndex][this.m_index];
if(this.m_selectionObject.useDisplayValueFromObject){
_e3c.setDisplayValue(this.m_selectionObject.getDisplayValues()[this.m_axisIndex]);
}else{
var _e3e=null;
var _e3f=null;
if(this.m_axisIndex===0){
var _e40=this.m_selectionObject.getCellRef();
if(_e40&&_e40.nodeName&&_e40.nodeName.toLowerCase()==="td"){
_e3f=this.m_selectionObject.m_selectionController.getDisplayValueFromDOM(_e3d,_e40.parentNode);
}
}
if(_e3f==null){
_e3f=this.m_selectionObject.m_selectionController.getDisplayValue(_e3d);
}
if(_e3f===""){
_e3f=this.m_selectionObject.m_selectionController.getUseValue(_e3d);
}
_e3c.setDisplayValue(_e3f);
}
_e3c.setUseValueType(this.m_selectionObject.m_selectionController.getDataType(_e3d));
_e3c.setUsage(this.m_selectionObject.m_selectionController.getUsageInfo(_e3d));
_e3c.setRefQuery(this.m_selectionObject.m_selectionController.getRefQuery(_e3d));
_e3c.setHun(this.m_selectionObject.m_selectionController.getHun(_e3d));
_e3c.setDun(this.m_selectionObject.m_selectionController.getDun(_e3d));
}
++this.m_index;
}
return _e3c;
};
function CAxisSelectionIterator(_e41){
this.m_index=0;
this.m_selectionObject=_e41;
};
CAxisSelectionIterator.prototype.hasNext=function(){
return ((typeof this.m_selectionObject=="object")&&(this.m_index<this.m_selectionObject.getSelectedContextIds().length));
};
CAxisSelectionIterator.prototype.next=function(){
var _e42=null;
if(this.hasNext()){
_e42=new CSelectionMetadataIterator(this.m_selectionObject,this.m_index);
++this.m_index;
}
return _e42;
};
function getSelectionContextIds(_e43){
var _e44=[];
var _e45=_e43.getAllSelectedObjects();
if(_e45!=null&&_e45.length>0){
for(var _e46=0;_e46<_e45.length;++_e46){
var _e47=_e45[_e46];
var _e48=_e47.getSelectedContextIds();
var _e49=[];
for(var item=0;item<_e48.length;++item){
var _e4b=_e48[item].join(":");
_e49.push(_e4b);
}
_e44.push(_e49.join("::"));
}
}
return _e44;
};
function getViewerSelectionContext(_e4c,_e4d,_e4e){
var _e4f=_e4e==true?_e4c.getAllSelectedObjectsWithUniqueCTXIDs():_e4c.getAllSelectedObjects();
if(_e4f!=null&&_e4f.length>0){
for(var _e50=0;_e50<_e4f.length;++_e50){
var _e51={};
var _e52=new CAxisSelectionIterator(_e4f[_e50]);
if(_e52.hasNext()){
var _e53=_e52.next();
if(_e53.hasNext()){
var _e54=_e53.next();
var _e55=_e54.getContextId();
_e51[_e55]=true;
var _e56=_e4d.addSelectedCell(_e54.getDataItem(),_e54.getMetadataModelItem(),_e54.getUseValue(),_e54.getUseValueType(),_e54.getDisplayValue(),_e54.getUsage(),{"queryName":_e54.getRefQuery()});
if(_e54.getHun()!=null){
_e56.addProperty("HierarchyUniqueName",_e54.getHun());
}
if(_e54.getDun()!=null){
_e56.addProperty("DimensionUniqueName",_e54.getDun());
}
while(_e53.hasNext()){
_e54=_e53.next();
_e55=_e54.getContextId();
if(typeof _e51[_e55]=="undefined"||_e55===""){
_e51[_e55]=true;
var _e57=_e56.addDefiningCell(_e54.getDataItem(),_e54.getMetadataModelItem(),_e54.getUseValue(),_e54.getUseValueType(),_e54.getDisplayValue(),_e54.getUsage(),{"queryName":_e54.getRefQuery()});
if(_e54.getHun()!=null){
_e57.addProperty("HierarchyUniqueName",_e54.getHun());
}
if(_e54.getDun()!=null){
_e57.addProperty("DimensionUniqueName",_e54.getDun());
}
}
}
while(_e52.hasNext()){
_e53=_e52.next();
var _e58=_e56;
while(_e53.hasNext()){
_e54=_e53.next();
_e55=_e54.getContextId();
if(typeof _e51[_e55]=="undefined"||_e55===""){
_e51[_e55]=true;
_e58=_e58.addDefiningCell(_e54.getDataItem(),_e54.getMetadataModelItem(),_e54.getUseValue(),_e54.getUseValueType(),_e54.getDisplayValue(),_e54.getUsage(),{"queryName":_e54.getRefQuery()});
if(_e54.getHun()!=null){
_e58.addProperty("HierarchyUniqueName",_e54.getHun());
}
if(_e54.getDun()!=null){
_e58.addProperty("DimensionUniqueName",_e54.getDun());
}
}
}
}
}
}
}
}
var _e59=_e4d.toString();
if(window.gViewerLogger){
window.gViewerLogger.log("Selection context",_e59,"xml");
}
return _e59;
};
function PinFreezeContainer(_e5a,lid,_e5c,_e5d,_e5e,_e5f,_e60){
this.m_pinFreezeManager=_e5a;
this.m_lid=lid;
this.m_lidNS=lid+_e5c+_e60;
this.m_viewerId=_e5c;
this.m_freezeTop=_e5d;
this.m_freezeSide=_e5e;
this.m_cachedReportDiv=null;
this.m_cachedPFContainer=null;
this.m_cachedBaseContainer=_e5f;
this.m_containerMargin={"top":0,"left":0};
if(this.m_cachedBaseContainer&&this.m_cachedBaseContainer.style){
if(this.m_cachedBaseContainer.style.marginTop){
this.m_containerMargin.top=Number(this.m_cachedBaseContainer.style.marginTop.replace("px",""));
}
if(this.m_cachedBaseContainer.style.marginLeft){
this.m_containerMargin.left=Number(this.m_cachedBaseContainer.style.marginLeft.replace("px",""));
}
}
this.m_cachedContainerIndex=_e60;
this.m_sectionCache=null;
this.m_homeCellNodes={};
this.m_fixedWidth=null;
this.m_clientWidth=700;
this.m_scrollableClientWidth=700;
this.m_fixedHeight=null;
this.m_clientHeight=300;
this.m_scrollableClientHeight=300;
this.m_wrapFlag=false;
this.c_pageMargin=(this.m_freezeTop&&this.m_freezeSide)?50:20;
this.touchScrollSections=false;
this.touchPreviousX=-1;
this.touchPreviousY=-1;
};
PinFreezeContainer.prototype.toJSONString=function(){
var _e61="{";
_e61+="\"m_clientWidth\":"+this.m_clientWidth+"";
_e61+=",\"m_scrollableClientWidth\":"+this.m_scrollableClientWidth+"";
_e61+=",\"m_clientHeight\":"+this.m_clientHeight+"";
_e61+=",\"m_scrollableClientHeight\":"+this.m_scrollableClientHeight+"";
_e61+="}";
return _e61;
};
PinFreezeContainer.prototype.copyProperties=function(_e62){
this.m_clientWidth=_e62.m_clientWidth;
this.m_scrollableClientWidth=_e62.m_scrollableClientWidth;
this.m_clientHeight=_e62.m_clientHeight;
this.m_scrollableClientHeight=_e62.m_scrollableClientHeight;
};
PinFreezeContainer.prototype.setViewerId=function(id){
this.m_viewerId=id;
};
PinFreezeContainer.prototype.getLid=function(){
return this.m_lid;
};
PinFreezeContainer.prototype.createPFContainer=function(_e64,_e65){
var _e66=document.createElement("temp");
if(this.m_cachedBaseContainer){
this.applyAuthoredFixedSizes(this.m_cachedBaseContainer);
this.m_cachedReportDiv=_e64;
var _e67=this.m_cachedBaseContainer.parentNode;
var _e68=this.loadTemplateHTML();
if(_e68){
_e66.innerHTML=_e68;
var _e69=this.getContainerByLID(_e66);
var _e6a=this.getSectionByLID(_e66.firstChild,"pfMainOutput");
if(_e6a){
var i=this.getChildPosition(_e67,this.m_cachedBaseContainer);
if(i!=-1){
var _e6c=this.m_pinFreezeManager.m_oCV;
if(_e6c&&_e6c.envParams["freezeDefaultWrap"]){
if(this.m_cachedBaseContainer.style.whiteSpace===""&&_e6c.envParams["freezeDefaultWrap"].toLowerCase()==="true"){
var _e6d=this.m_cachedBaseContainer.getElementsByTagName("span");
if(_e6d){
for(var k=0;k<_e6d.length;k++){
_e6d[k].style.whiteSpace="nowrap";
}
}
this.m_wrapFlag=true;
}
}
if(!_e65){
if(!this._getFixedWidth()){
this.m_cachedBaseContainer.setAttribute("authoredFixedWidth","false");
this.m_addedFixedWidth=this.m_cachedBaseContainer.clientWidth+1;
this.m_cachedBaseContainer.style.width=this.m_addedFixedWidth+"px";
}
if(!this._getFixedHeight()){
this.m_cachedBaseContainer.setAttribute("authoredFixedHeight","false");
this.m_addedFixedHeight=this.m_cachedBaseContainer.clientHeight;
this.m_cachedBaseContainer.style.height=this.m_addedFixedHeight+"px";
}
_e6a.style.width=this.m_cachedBaseContainer.clientWidth+2+"px";
_e6a.style.height=this.m_cachedBaseContainer.clientHeight+2+"px";
}
_e6a.appendChild(this.m_cachedBaseContainer);
this.insertAt(_e67,_e69,i);
}
if(this.m_cachedBaseContainer.style.border!==""){
_e69.style.border=this.m_cachedBaseContainer.style.border;
this.m_cachedBaseContainer.style.border="";
}
}
}
}
};
PinFreezeContainer.prototype._getFixedWidth=function(_e6f){
if(_e6f&&_e6f.style.width&&!_e6f.getAttribute("authoredFixedWidth")){
var _e70=Number(_e6f.style.width.split("px")[0]);
return isNaN(_e70)?null:_e70;
}
return null;
};
PinFreezeContainer.prototype._getFixedHeight=function(_e71){
if(_e71&&_e71.style.height&&!_e71.getAttribute("authoredFixedHeight")){
var _e72=Number(_e71.style.height.split("px")[0]);
return isNaN(_e72)?null:_e72;
}
return null;
};
PinFreezeContainer.prototype.applyAuthoredFixedSizes=function(_e73){
var _e74=this._getFixedWidth(_e73);
if(_e74){
this.m_fixedWidth=_e74;
this.m_clientWidth=this.m_fixedWidth;
this.m_scrollableClientWidth=this.m_fixedWidth;
}
var _e75=this._getFixedHeight(_e73);
if(_e75){
this.m_fixedHeight=_e75;
this.m_clientHeight=this.m_fixedHeight;
this.m_scrollableClientHeight=this.m_fixedHeight;
}
};
PinFreezeContainer.prototype.loadFreezeBothTemplateHTML=function(){
var _e76="<table pflid=\""+this.m_lidNS+"\" pfclid=\"pfContainer_"+this.m_lidNS+"\" cellpadding=\"0\" style=\"white-space:nowrap; width:0px; height:0px;\" cellspacing=\"0\">"+"<tr class=\"BUXNoPrint\" templatePart=\"freezeTop\"><td align=\"center\" templatePart=\"freezeSide\"><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfHomeCell_"+this.m_lidNS+"\" style=\"overflow-x:hidden; overflow-y:hidden; width:100%; height:100%\"/></td>"+"<td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfTopHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td><td templatePart=\"freezeTop\"></td></tr>"+"<tr><td class=\"BUXNoPrint\" valign=top templatePart=\"freezeSide\"><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfSideHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td>"+"<td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfMainOutput_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\">"+"</div></td>"+"<td class=\"BUXNoPrint\" templatePart=\"freezeTop\">"+"<div style=\"padding-right:1px;overflow-x:hidden; overflow-y:scroll;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfVerticalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchVScroll()\">"+"<div style=\"padding-right:1px;\"/>"+"</div>"+"</td>"+"</tr>"+"<tr class=\"BUXNoPrint\" templatePart=\"freezeSide\"><td></td><td>"+"<div style=\"overflow-x:scroll; overflow-y:hidden;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfHorizontalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchScroll()\">"+"<div style=\"height:2px;\">&nbsp;</div>"+"</div>"+"</td><td></td></tr></table>";
return _e76;
};
PinFreezeContainer.prototype.loadFreezeSideTemplateHTML=function(){
var _e77="<table pflid=\""+this.m_lidNS+"\" pfclid=\"pfContainer_"+this.m_lidNS+"\" cellpadding=\"0\" style=\"white-space:nowrap; width:0px; height:0px;\" cellspacing=\"0\"><tr>"+"<td class=\"BUXNoPrint\" valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfSideHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td>"+"<td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfMainOutput_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\">"+"</div></td>"+"</tr>"+"<tr class=\"BUXNoPrint\"><td></td><td>"+"<div style=\"overflow-x:scroll; overflow-y:hidden;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfHorizontalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchScroll()\">"+"<div style=\"height:2px;\">&nbsp;</div>"+"</div>"+"</td></tr></table>";
return _e77;
};
PinFreezeContainer.prototype.loadFreezeTopTemplateHTML=function(){
var _e78="<table pflid=\""+this.m_lidNS+"\" pfclid=\"pfContainer_"+this.m_lidNS+"\" cellpadding=\"0\" style=\"white-space:nowrap; width:0px; height:0px;\" cellspacing=\"0\">"+"<tr class=\"BUXNoPrint\"><td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfTopHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td><td></td></tr>"+"<tr><td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfMainOutput_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"></div></td>"+"<td class=\"BUXNoPrint\">"+"<div style=\"padding-right:1px;overflow-x:hidden; overflow-y:scroll;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfVerticalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchVScroll()\">"+"<div style=\"padding-right:1px;\"/>"+"</div>"+"</td>"+"</tr></table>";
return _e78;
};
PinFreezeContainer.prototype.loadTemplateHTML=function(){
if(this.m_freezeSide&&this.m_freezeTop){
return this.loadFreezeBothTemplateHTML();
}else{
if(this.m_freezeSide){
return this.loadFreezeSideTemplateHTML();
}else{
if(this.m_freezeTop){
return this.loadFreezeTopTemplateHTML();
}
}
}
return null;
};
PinFreezeContainer.prototype.createSideHeadings=function(_e79){
var _e7a=this.getSection("pfMainOutput");
var _e7b=_e7a.getAttribute("pfslid");
var _e7c=this.getSection("pfSideHeadings");
var _e7d=_e7c.getAttribute("pfslid");
var _e7e=this.getMainOutputHomeCell();
if(!_e7e){
return;
}
var _e7f=_e79;
var _e80=_e7c;
var _e81=this.isA11yEnabled(_e7f);
var _e82=this.m_pinFreezeManager.deepCloneNode(_e7f);
_e80.appendChild(_e82);
var _e83=this.getSectionHomeCell(_e7c);
if(!_e83){
return;
}
var _e84=_e7f.getElementsByTagName("tbody");
var _e85=_e82.getElementsByTagName("tbody");
if(_e84.length>0&&_e85.length>0){
var _e86=_e84[0];
var _e87=_e85[0];
var _e88=_e86.firstChild;
var _e89=_e87.firstChild;
var _e8a=_e7e.rowSpan;
this.markAsCopy(_e7e,_e83,_e7b,_e7d);
for(var r=0;r<_e8a;++r){
var _e8c=_e87.rows[r];
this.removeCTX(_e8c);
}
for(var r=_e8a;r<_e87.rows.length;++r){
var _e8d=_e86.rows[r];
var _e8c=_e87.rows[r];
_e8c.style.visibility="hidden";
for(var c=0;c<_e8c.cells.length;++c){
var _e8f=_e8c.cells[c];
if(_e81){
_e8f=this.m_pinFreezeManager.removeIdAttribute(_e8f);
}
if(_e8f.getAttribute("type")=="datavalue"){
_e8f.removeAttribute("ctx");
_e8f.removeAttribute("uid");
_e8f.removeAttribute("name");
}else{
var _e90=_e8d.cells[c];
this.markAsCopy(_e90,_e8f,_e7b,_e7d);
}
}
_e8c.style.visibility="visible";
}
}
};
PinFreezeContainer.prototype.applyNeighbouringBorderStylesToHomeCell=function(_e91,_e92){
if(isFF()||isIE()){
if(_e91&&_e91.length&&_e91[0].cells&&_e91[0].cells.length>1){
if(this.m_freezeSide){
var _e93=this.getBorderInfo(_e91[0].cells[1],"right");
if(_e93){
_e92.style.borderRightWidth=_e93.borderRightWidth;
_e92.style.borderRightStyle=_e93.borderRightStyle;
_e92.style.borderRightColor=_e93.borderRightColor;
}
}
if(this.m_freezeTop){
var _e93=this.getBorderInfo(_e91[0].cells[1],"bottom");
if(_e93){
_e92.style.borderBottomWidth=_e93.borderBottomWidth;
_e92.style.borderBottomStyle=_e93.borderBottomStyle;
_e92.style.borderBottomColor=_e93.borderBottomColor;
}
}
}
}
};
PinFreezeContainer.prototype.createTopHeadings=function(_e94){
var _e95=this.getSection("pfMainOutput");
var _e96=_e95.getAttribute("pfslid");
var _e97=this.getSection("pfTopHeadings");
var _e98=_e97.getAttribute("pfslid");
var _e99=this.getMainOutputHomeCell();
if(!_e99){
return;
}
var _e9a=_e94;
var _e9b=_e97;
var _e9c=this.isA11yEnabled(_e9a);
var _e9d=this.m_pinFreezeManager.deepCloneNode(_e9a);
_e9d.setAttribute("clonednode","true");
_e9b.appendChild(_e9d);
var _e9e=_e9a.getElementsByTagName("tbody");
var _e9f=_e9d.getElementsByTagName("tbody");
if(_e9e.length>0&&_e9f.length>0){
var _ea0=_e9e[0];
var _ea1=_e9f[0];
var _ea2=_e99.rowSpan;
for(var r=0;r<_ea1.rows.length;++r){
var _ea4=_ea0.rows[r];
var _ea5=_ea1.rows[r];
if(_e9c){
_ea5=this.m_pinFreezeManager.removeIdAttribute(_ea5);
}
_ea5.style.visibility="hidden";
for(var c=0;c<_ea5.cells.length;++c){
var _ea7=_ea5.cells[c];
if(r>_ea2||_ea7.getAttribute("type")=="datavalue"){
_ea7.removeAttribute("ctx");
_ea7.removeAttribute("uid");
_ea7.removeAttribute("name");
}else{
var _ea8=_ea4.cells[c];
this.markAsCopy(_ea8,_ea7,_e96,_e98);
if(_ea8===_e99){
this.initializeHomeCellTabIndex(_ea7);
this.applyNeighbouringBorderStylesToHomeCell(_ea0.rows,_ea7);
}
}
}
_ea5.style.visibility="visible";
}
}
};
PinFreezeContainer.prototype.createHomeCellHeading=function(){
var _ea9=this.getSection("pfMainOutput");
var _eaa=_ea9.getAttribute("pfslid");
var _eab=this.getSection("pfHomeCell");
var _eac=_eab.parentNode;
var _ead=_eab.getAttribute("pfslid");
var _eae=this.getMainOutputHomeCell();
if(!_eae){
return;
}
_eac.style.height="100%";
var _eaf=this.getTopHeadingSectionHeight(_eae);
_eab.style.height=_eaf-this.m_containerMargin.top+"px";
_eab.style.width=this.getSideHeadingSectionWidth(_eae)-this.m_containerMargin.left+"px";
_eab.style.marginTop=this.m_containerMargin.top+"px";
_eab.style.marginLeft=this.m_containerMargin.left+"px";
var _eb0=_eae.parentNode;
var _eb1=_eb0.cloneNode(false);
var _eb2=this._findBestGuessHomeCell(_eae);
var _eb3=document.createElement("div");
_eb3.style.width="100%";
_eb3.style.height="100%";
while(_eae.offsetLeft<=_eb2.offsetLeft){
oTargetHomeCell=this.m_pinFreezeManager.deepCloneNode(_eae);
if(isFF()||isIE()){
_eae.appendChild(_eb3);
oTargetHomeCell.style.width=_eb3.clientWidth+"px";
_eae.removeChild(_eb3);
}else{
oTargetHomeCell.style.width=_eae.clientWidth+1+"px";
}
oTargetHomeCell.style.borderBottomWidth="0px";
_eb1.appendChild(oTargetHomeCell);
this.markAsCopy(_eae,oTargetHomeCell,_eaa,_ead);
if(_eae.nextSibling){
_eae=_eae.nextSibling;
}else{
break;
}
}
if(oTargetHomeCell){
oTargetHomeCell.style.borderRightWidth="0px";
}
var _eb4=_eb0.parentNode;
var _eb5=_eb4.cloneNode(false);
_eb5.appendChild(_eb1);
var _eb6=_eb4.parentNode;
var _eb7=_eb6.cloneNode(false);
_eb7.appendChild(_eb5);
_eb7.style.width="100%";
_eb7.style.height="100%";
_eb7.style.marginLeft="";
_eb7.style.marginTop="";
_eab.appendChild(_eb7);
this.initializeHomeCellTabIndex(oTargetHomeCell);
this.applyNeighbouringBorderStylesToHomeCell(_ea9.firstChild.rows,_eab);
};
PinFreezeContainer.prototype.markAsCopy=function(main,copy,_eba,_ebb){
if(!main.pfCopy){
main.setAttribute("pfslid",_eba);
main.pfCopy=[];
}
main.pfCopy.push(copy);
copy.pfMain=main;
copy.setAttribute("pfslid",_ebb);
};
PinFreezeContainer.prototype.getCopy=function(_ebc){
if(_ebc.pfCopy){
var _ebd={};
for(var i in _ebc.pfCopy){
var copy=_ebc.pfCopy[i];
if(copy.getAttribute){
var _ec0=copy.getAttribute("pfslid");
if(_ec0){
var _ec1=PinFreezeContainer.getSectionNameFromSlid(_ec0);
var _ec2=this.getSection(_ec1);
if(_ec2&&PinFreezeContainer.isSectionVisible(_ec2)){
_ebd[_ec1]=copy;
}
}
}
}
if(_ebd["pfHomeCell"]){
return _ebd["pfHomeCell"];
}
for(i in _ebd){
return _ebd[i];
}
}
return null;
};
PinFreezeContainer.prototype.getMain=function(_ec3){
if(_ec3.pfMain){
return _ec3.pfMain;
}
return null;
};
PinFreezeContainer.isSectionVisible=function(_ec4){
var node=_ec4;
if(!node){
return false;
}
while(node.parentNode&&!node.getAttribute("pfclid")){
if(node.style&&node.style.display==="none"){
return false;
}
node=node.parentNode;
}
return (!node.style||node.style.display!=="none");
};
PinFreezeContainer.prototype.getSectionStructure=function(){
var _ec6={isSideFrozen:false,isTopFrozen:false};
if(this.m_freezeSide){
var side=this.getSection("pfSideHeadings");
if(side){
_ec6.isSideFrozen=PinFreezeContainer.isSectionVisible(side);
}
}
if(this.m_freezeTop){
var top=this.getSection("pfTopHeadings");
if(top){
_ec6.isTopFrozen=PinFreezeContainer.isSectionVisible(top);
}
}
return _ec6;
};
PinFreezeContainer.prototype.checkSectionStructureChange=function(_ec9,_eca){
if(_ec9.isSideFrozen!==_eca.isSideFrozen||_ec9.isTopFrozen!==_eca.isTopFrozen){
this.m_pinFreezeManager.sectionStructureChange();
}
};
PinFreezeContainer.prototype.freezeContainerInReport=function(_ecb){
this.cacheContainerAndSections(this.getContainerByLID(_ecb));
this.m_homeCellNodes={};
this.updateContainer();
};
PinFreezeContainer.prototype.frozenSectionsRequired=function(){
return (this.frozenSideHeadingsRequired()||this.frozenTopHeadingsRequired());
};
PinFreezeContainer.prototype.frozenSideHeadingsRequired=function(){
var _ecc=this.getSection("pfMainOutput");
if(_ecc){
if(this.m_freezeSide){
var _ecd=_ecc.scrollWidth;
return ((this.m_clientWidth<_ecd)||_ecd==0);
}
}
return false;
};
PinFreezeContainer.prototype.frozenTopHeadingsRequired=function(){
var _ece=this.getSection("pfMainOutput");
if(_ece){
if(this.m_freezeTop){
var _ecf=_ece.scrollHeight;
return ((this.m_clientHeight<_ecf)||_ecf==0);
}
}
return false;
};
PinFreezeContainer.prototype.showTemplatePart=function(_ed0,_ed1){
var _ed2=this.getContainer().rows;
for(var r=0;r<_ed2.length;++r){
if(_ed2[r].getAttribute("templatePart")===_ed0){
_ed2[r].style.display=((_ed1)?"":"none");
}else{
var _ed4=_ed2[r].cells;
for(var c=0;c<_ed4.length;++c){
if(_ed4[c].getAttribute("templatePart")===_ed0){
_ed4[c].style.display=((_ed1)?"":"none");
}
}
}
}
};
PinFreezeContainer.prototype.showFreezeTopOnly=function(_ed6){
if(!(this.m_freezeTop&&this.m_freezeSide)){
return;
}
var _ed7=(_ed6.scrollWidth==0)?_ed6.clientWidth:_ed6.scrollWidth;
this.updateMainOutputWidth(_ed7);
this.setScrollX(_ed6,0);
if(this.getSection("pfTopHeadings")){
this.getSection("pfTopHeadings").style.width=_ed7+"px";
this.setScrollX(this.getSection("pfTopHeadings"),0);
}
this.showTemplatePart("freezeSide",false);
};
PinFreezeContainer.prototype.showFreezeSideOnly=function(_ed8){
if(!(this.m_freezeTop&&this.m_freezeSide)){
return;
}
var _ed9=(_ed8.scrollHeight==0)?_ed8.clientHeight:_ed8.scrollHeight;
this.updateMainOutputHeight(_ed9);
this.setScrollY(_ed8,0);
if(this.getSection("pfSideHeadings")){
this.getSection("pfSideHeadings").style.height=_ed9+"px";
this.setScrollY(this.getSection("pfSideHeadings"),0);
}
this.showTemplatePart("freezeTop",false);
};
PinFreezeContainer.prototype.showAll=function(){
if(!(this.m_freezeTop&&this.m_freezeSide)){
return;
}
this.showTemplatePart("freezeTop",true);
this.showTemplatePart("freezeSide",true);
};
PinFreezeContainer.prototype.showMainOutputOnly=function(_eda){
this.updateMainOutputWidth((_eda.scrollWidth==0)?_eda.clientWidth:_eda.scrollWidth);
this.updateMainOutputHeight((_eda.scrollHeight==0)?_eda.clientHeight:_eda.scrollHeight);
this.setInitialScrollPosition(_eda,0,0);
if(this.m_freezeSide&&this.m_freezeTop){
this.getSection("pfHomeCell").style.display="none";
}
if(this.m_freezeSide){
this.getSection("pfSideHeadings").style.display="none";
this.getSection("pfHorizontalScrollBar").style.display="none";
}
if(this.m_freezeTop){
this.getSection("pfTopHeadings").style.display="none";
this.getSection("pfVerticalScrollBar").style.display="none";
}
};
PinFreezeContainer.prototype.getWrap=function(el){
if(el.currentStyle){
return el.currentStyle.whiteSpace;
}else{
if(window.getComputedStyle){
return window.getComputedStyle(el,null).getPropertyValue("white-space");
}else{
return el.style.whiteSpace;
}
}
};
PinFreezeContainer.prototype.getStyleDisplay=function(el){
if(el.currentStyle){
return el.currentStyle.display;
}else{
if(window.getComputedStyle){
return window.getComputedStyle(el,null).getPropertyValue("display");
}else{
return el.style.display;
}
}
};
PinFreezeContainer.prototype.headingsCreated=function(_edd){
return _edd.firstChild?true:false;
};
PinFreezeContainer.prototype.updateContainer=function(){
var _ede=this.getSection("pfMainOutput");
var _edf=this.getMainOutputHomeCell();
if(_edf){
if(this.m_scrollableClientHeight===this.m_clientHeight||!this.m_scrollableClientHeight){
this.m_scrollableClientHeight-=_edf.offsetHeight;
var _ee0=this.calculateMinCrossTabScrollableClientHeight();
if(_ee0>this.m_scrollableClientHeight){
this.m_scrollableClientHeight=_ee0;
}
}
if(this.m_scrollableClientWidth===this.m_clientWidth||!this.m_scrollableClientWidth){
this.m_scrollableClientWidth-=this.getHomeCellOffsetWidth(_edf);
}
}
if(_ede&&_edf){
this.showAll();
if(this.frozenSectionsRequired()){
this.updateMainOutputSize();
this.initializeHomeCellTabIndex(_edf);
if(this.m_freezeSide){
var _ee1=this.getSection("pfSideHeadings");
if(!this.headingsCreated(_ee1)){
this.createSideHeadings(this.m_cachedBaseContainer);
if(this.m_freezeTop){
this.initializeTouchScrolling(_ee1);
}
}
var _ee2=this.getSection("pfHorizontalScrollBar");
_ee2.scrollLeft="0px";
}
if(this.m_freezeTop){
var _ee3=this.getSection("pfTopHeadings");
if(!this.headingsCreated(_ee3)){
this.createTopHeadings(this.m_cachedBaseContainer);
if(this.m_freezeSide){
this.initializeTouchScrolling(_ee3);
}
}
var _ee4=this.getSection("pfVerticalScrollBar");
_ee4.scrollTop="0px";
}
if(this.m_freezeSide&&this.m_freezeTop){
var _ee5=this.getSection("pfHomeCell");
if(!this.headingsCreated(_ee5)){
this.createHomeCellHeading();
}
_ee5.style.display="";
}
var _ee6=this.updateSideHeadingSize(_edf);
var _ee7=this.updateTopHeadingSize(_edf);
if(!this.frozenSectionsRequired()){
this.showMainOutputOnly(_ede);
}
this.setInitialScrollPosition(_ede,_ee6,_ee7);
if(this.m_freezeTop&&this.m_freezeSide){
this.setInitialScrollPosition(this.getSection("pfSideHeadings"),0,_ee7);
this.setInitialScrollPosition(this.getSection("pfTopHeadings"),_ee6,0);
}
this.initializeTouchScrolling(_ede);
}else{
this.showMainOutputOnly(_ede);
this.removeTouchScrolling();
}
this.updateTabIndexValues();
}
};
PinFreezeContainer.prototype.calculateMinCrossTabScrollableClientHeight=function(){
var _ee8=0;
if(this.m_cachedPFContainer){
var _ee9=this.getElementByLID(this.m_cachedPFContainer,"table",this.m_lid+this.m_viewerId);
if(_ee9){
var _eea=0;
for(var r=0;r<_ee9.rows.length;r++){
var row=_ee9.rows[r];
for(var c=0;c<row.cells.length;c++){
var cell=row.cells[c];
if(cell.getAttribute("type")=="datavalue"){
_eea++;
if(cell.childNodes.length===1&&cell.childNodes[0].getAttribute&&cell.childNodes[0].getAttribute("class")==="textItem"){
_ee8=_ee8+cell.offsetHeight;
}else{
_eea++;
var _eef=this.getSection("pfVerticalScrollBar");
if(_eef){
_ee8=_eef.offsetWidth*2;
}
}
break;
}
}
if(_eea>=2){
break;
}
}
}
}
return _ee8;
};
PinFreezeContainer.prototype.updateSideHeadingSize=function(_ef0){
var _ef1=0;
if(this.m_freezeSide){
var _ef2=this.getSection("pfMainOutput");
if(!_ef2){
return 0;
}
if(!this.frozenSideHeadingsRequired()){
this.showFreezeTopOnly(_ef2);
return 0;
}
var _ef3=this.getSection("pfSideHeadings");
_ef1=this.getSideHeadingSectionWidth(_ef0);
var _ef4=this.getSection("pfHorizontalScrollBar");
var _ef5=this.getSectionHomeCell(_ef3);
if(_ef3.style.display=="none"){
_ef3.style.display="";
_ef4.style.display="";
}
_ef3.style.width=_ef1+"px";
_ef3.style.height=_ef2.clientHeight+"px";
}
return _ef1;
};
PinFreezeContainer.prototype.updateTopHeadingSize=function(_ef6){
var _ef7=0;
if(this.m_freezeTop){
var _ef8=this.getSection("pfMainOutput");
if(!_ef8){
return 0;
}
if(!this.frozenTopHeadingsRequired()){
this.showFreezeSideOnly(_ef8);
return 0;
}
var _ef9=this.getSection("pfTopHeadings");
_ef7=this.getTopHeadingSectionHeight(_ef6);
var _efa=this.getSection("pfVerticalScrollBar");
var _efb=this.getSectionHomeCell(_ef9);
if(_ef9.style.display=="none"){
_ef9.style.display="";
_efa.style.display="";
}
_ef9.style.height=_ef7+"px";
_ef9.style.width=_ef8.clientWidth+"px";
}
return _ef7;
};
PinFreezeContainer.prototype.setScrollX=function(_efc,_efd){
if(getElementDirection(_efc)==="rtl"){
setScrollRight(_efc,_efd);
}else{
setScrollLeft(_efc,_efd);
}
};
PinFreezeContainer.prototype.setScrollY=function(_efe,_eff){
_efe.scrollTop=_eff;
};
PinFreezeContainer.prototype.setInitialScrollPosition=function(_f00,_f01,_f02){
if(getElementDirection(_f00)==="rtl"){
setScrollRight(_f00,_f01);
}else{
setScrollLeft(_f00,_f01);
}
_f00.scrollTop=_f02;
};
PinFreezeContainer.prototype.getScrollableClientWidth=function(){
return this.m_scrollableClientWidth;
};
PinFreezeContainer.prototype.setScrollableClientWidth=function(_f03){
this.m_scrollableClientWidth=_f03;
};
PinFreezeContainer.prototype.getContainerWidth=function(){
return this.m_addedFixedWidth?this.m_addedFixedWidth:this.m_clientWidth;
};
PinFreezeContainer.prototype.getClientWidth=function(){
return this.m_clientWidth;
};
PinFreezeContainer.prototype.getScrollableClientHeight=function(){
return this.m_scrollableClientHeight;
};
PinFreezeContainer.prototype.setScrollableClientHeight=function(_f04){
this.m_scrollableClientHeight=_f04;
};
PinFreezeContainer.prototype.getClientHeight=function(){
return this.m_clientHeight;
};
PinFreezeContainer.prototype.clientHeight=function(_f05){
return _f05.clientHeight;
};
PinFreezeContainer.prototype.findBestContainerHeight=function(_f06){
if(this.m_freezeTop&&this.m_cachedReportDiv){
var _f07=this.m_cachedReportDiv.parentNode;
if(_f07){
var _f08=this._findRestOfPageHeight(this.getContainer());
return _f06-_f08-(this.c_pageMargin/2)-this.m_containerMargin.top;
}
}
return _f06-this.c_pageMargin;
};
PinFreezeContainer.prototype.findBestContainerWidth=function(_f09){
var node=this.getContainer();
while(node&&node.nodeName.toLowerCase()!="td"&&node.getAttribute("id")!=("mainViewerTable"+this.m_viewerId)){
node=node.parentNode;
}
if(!node){
return -1;
}
if(node.nodeName.toLowerCase()=="td"){
var _f0b=0;
var _f0c=node.parentNode.childNodes;
for(var i=0;i<_f0c.length;i++){
if(_f0c[i]!==node){
_f0b+=_f0c[i].clientWidth;
}
}
return _f09-_f0b-(this.c_pageMargin/2);
}
return _f09;
};
PinFreezeContainer.prototype._findRestOfPageHeight=function(node){
var _f0f=0;
var _f10=node.parentNode;
if(!_f10){
return _f0f;
}
if(_f10.childNodes.length>1){
for(var i=0;i<_f10.childNodes.length;i++){
var _f12=_f10.childNodes[i];
if(_f12.nodeType==1){
var _f13=this.getStyleDisplay(_f12);
if(_f12!=node&&!isNaN(_f12.clientHeight)&&_f13!="none"&&_f13!="table-cell"){
_f0f+=this.clientHeight(_f12);
}
}
}
}
if(node.getAttribute("id")!=("mainViewerTable"+this.m_viewerId)){
_f0f+=this._findRestOfPageHeight(_f10);
}
return _f0f;
};
PinFreezeContainer.prototype.resize=function(_f14,_f15,_f16,_f17){
if(this.m_fixedWidth&&this.m_fixedHeight){
return;
}
_f14=(this.m_fixedWidth)?this.m_fixedWidth:_f14;
_f15=(this.m_fixedHeight)?this.m_fixedHeight:_f15;
var _f18=this.getSectionStructure();
if(this.m_sectionCache&&this.m_cachedPFContainer){
var _f19=0;
if(_f15!==0){
_f19=this.findBestContainerHeight(_f15);
if(_f16&&_f19<300){
_f19=300;
}else{
if(_f19<100){
_f19=100;
}
}
}
this.m_clientHeight=_f19>0?_f19:this.m_clientHeight;
var _f1a=0;
if(_f14!==0){
_f1a=this.findBestContainerWidth(_f14);
}
this.m_clientWidth=(_f1a>0)?_f1a-5-(this.c_pageMargin/2):this.m_clientWidth;
var _f1b=this.getSection("pfMainOutput");
var _f1c=this.getSectionHomeCell(_f1b);
if(_f1c){
this.m_scrollableClientWidth=this.m_clientWidth-this.getSideHeadingSectionWidth(_f1c);
this.m_scrollableClientHeight=this.m_clientHeight-_f1c.offsetHeight;
}
if(_f17){
var _f1d=getElementsByAttribute(this.m_cachedPFContainer,"div","pflid",_f17.lid);
if(_f1d){
var node=_f1d[0];
while(node.nodeName.toLowerCase()!="table"){
node=node.parentNode;
}
node.style.width=_f17.width+"px";
}
}
this.updateContainer();
}else{
this.m_clientWidth=_f14-this.c_pageMargin;
this.m_clientHeight=_f15-this.c_pageMargin;
}
var _f1f=this.getSectionStructure();
this.checkSectionStructureChange(_f18,_f1f);
};
PinFreezeContainer.prototype.updateMainOutputSize=function(){
if(this.m_freezeSide&&this.m_freezeTop){
if(this.frozenSideHeadingsRequired()){
this.updateMainOutputWidth(this.getScrollableClientWidth());
}
if(this.frozenTopHeadingsRequired()){
this.updateMainOutputHeight(this.getScrollableClientHeight());
}
}else{
if(this.m_freezeSide){
this.updateMainOutputWidth(this.getScrollableClientWidth());
}else{
if(this.m_freezeTop){
this.updateMainOutputHeight(this.getScrollableClientHeight());
}
}
}
};
PinFreezeContainer.prototype.updateMainOutputWidth=function(_f20){
var _f21=this.getSection("pfMainOutput");
if(!_f21){
return;
}
if(this.m_freezeSide==true){
_f21.style.width=(_f20+"px");
if(this.m_freezeTop==false||!this.frozenTopHeadingsRequired()){
_f21.style.height=_f21.firstChild.clientHeight+"px";
}
var _f22=this.getSection("pfHorizontalScrollBar");
if(_f22){
_f22.style.width=(_f20+"px");
var _f23=_f22.firstChild;
if(_f23){
var _f24=this.getSectionHomeCell(_f21);
var _f25=_f21.scrollWidth-this.getHomeCellOffsetWidth(_f24);
_f23.style.width=_f25+"px";
}
}
}
};
PinFreezeContainer.prototype.updateMainOutputHeight=function(_f26){
var _f27=this.getSection("pfMainOutput");
if(!_f27){
return;
}
_f27.style.height=(_f26+"px");
if(!this.m_freezeSide||!this.frozenSideHeadingsRequired()){
_f27.style.width=_f27.firstChild.clientWidth+2+"px";
}
var _f28=this.getSection("pfVerticalScrollBar");
if(_f28){
_f28.style.height=(_f26+"px");
var _f29=_f28.firstChild;
if(_f29){
var _f2a=this.getSectionHomeCell(_f27);
var _f2b=_f27.scrollHeight-_f2a.offsetHeight;
_f29.style.height=_f2b+"px";
}
}
};
PinFreezeContainer.prototype.getElementByLID=function(_f2c,tag,lid){
var _f2f=getElementsByAttribute(_f2c,tag,"lid",lid);
if(_f2f.length>0){
return _f2f[0];
}
return null;
};
PinFreezeContainer.prototype.getContainerByLID=function(_f30){
var _f31=getElementsByAttribute(_f30,"table","pfclid","pfContainer_"+this.m_lidNS);
if(_f31.length>0){
return _f31[0];
}
return null;
};
PinFreezeContainer.prototype.getSectionByLID=function(_f32,_f33){
var _f34=getElementsByAttribute(_f32,"div","pfslid",_f33+"_"+this.m_lidNS);
if(_f34.length>0){
return _f34[0];
}
return null;
};
PinFreezeContainer.getSectionNameFromSlid=function(slid){
return slid?slid.split("_")[0]:null;
};
PinFreezeContainer.getLidFromSlid=function(slid){
return slid.split("_")[1];
};
PinFreezeContainer.nodeToSlid=function(_f37){
while(_f37.parentNode&&!_f37.getAttribute("pfslid")){
_f37=_f37.parentNode;
}
if(_f37.getAttribute){
return _f37.getAttribute("pfslid");
}
return null;
};
PinFreezeContainer.prototype.cacheContainerAndSections=function(_f38){
if(!_f38){
return _f38;
}
this.m_cachedPFContainer=_f38;
var _f39=getElementsByAttribute(this.m_cachedPFContainer,"div","pflid",this.m_lidNS);
this.m_sectionCache={};
for(var i=0;i<_f39.length;++i){
var key=_f39[i].getAttribute("pfslid");
key=key.split("_",1);
this.m_sectionCache[key]=_f39[i];
}
return _f38;
};
PinFreezeContainer.prototype.getContainer=function(){
return this.m_cachedPFContainer;
};
PinFreezeContainer.prototype.getSection=function(key){
if(!this.m_sectionCache){
return null;
}
if(!this.m_sectionCache[key]){
this.m_sectionCache[key]=this.getSectionByLID(this.m_cachedPFContainer,key);
}
return this.m_sectionCache[key];
};
PinFreezeContainer.prototype.initializeHomeCellTabIndex=function(_f3d){
var slid=PinFreezeContainer.nodeToSlid(_f3d);
if(!this.m_homeCellNodes[slid]){
var _f3f=getElementsByAttribute(_f3d,"*","tabIndex","*");
for(var i in _f3f){
if(!_f3f[i].getAttribute("widgetid")){
this.m_homeCellNodes[slid]=_f3f[i];
break;
}
}
}
};
PinFreezeContainer.prototype.updateTabIndexValues=function(){
if(this.isContainerFrozen()){
for(var slid in this.m_homeCellNodes){
var _f42=this.m_pinFreezeManager.isNodeVisible(this.m_homeCellNodes[slid])?"0":"-1";
this.m_homeCellNodes[slid].setAttribute("tabIndex",_f42);
}
}else{
for(var slid in this.m_homeCellNodes){
var _f42=(PinFreezeContainer.getSectionNameFromSlid(slid)==="pfMainOutput")?"0":"-1";
this.m_homeCellNodes[slid].setAttribute("tabIndex",_f42);
}
}
};
PinFreezeContainer.prototype.getSectionHomeCell=function(_f43){
if(_f43){
var _f44=this.getElementByLID(_f43,"table",this.m_lid+this.m_viewerId);
if(_f44&&_f44.rows.length&&_f44.rows[0].cells.length){
return _f44.rows[0].cells[0];
}
}
return null;
};
PinFreezeContainer.prototype.getMainOutputHomeCell=function(){
var _f45=this.getSection("pfMainOutput");
if(!_f45){
_f45=this.getSectionByLID(this.m_cachedPFContainer,"pfMainOutput");
}
return this.getSectionHomeCell(_f45);
};
PinFreezeContainer.prototype.getChildPosition=function(_f46,_f47){
for(var i=0;i<_f46.childNodes.length;++i){
if(_f46.childNodes[i]==_f47){
return i;
}
}
return -1;
};
PinFreezeContainer.prototype.insertAt=function(_f49,_f4a,_f4b){
if(_f4b==_f49.childNodes.length){
_f49.appendChild(_f4a);
}else{
_f49.insertBefore(_f4a,_f49.childNodes[_f4b]);
}
};
PinFreezeContainer.prototype.synchScroll=function(){
if(!this.m_cachedPFContainer){
return;
}
var _f4c=this.getMainOutputHomeCell();
var _f4d=this.getSection("pfMainOutput");
var _f4e=this.getSection("pfSideHeadings");
if(_f4e!=null){
var _f4f=this.getSection("pfHorizontalScrollBar");
if(_f4f){
var _f50=this.getSideHeadingSectionWidth(_f4c);
if(getElementDirection(_f4d)==="rtl"){
_f50=0;
}
setScrollLeft(_f4d,getScrollLeft(_f4f)+_f50);
if(this.m_freezeTop){
setScrollLeft(this.getSection("pfTopHeadings"),getScrollLeft(_f4f)+_f50);
}
}
}
};
PinFreezeContainer.prototype.updateScroll=function(_f51){
var slid=PinFreezeContainer.nodeToSlid(_f51);
if(!slid){
return;
}
var _f53=PinFreezeContainer.getSectionNameFromSlid(slid);
if(!_f53){
return;
}
var _f54=document.getElementById("CVReport"+this.m_viewerId);
if(!_f54){
return;
}
if(!this.m_cachedPFContainer){
return;
}
var _f55=_f51.parentNode;
if(_f55){
var _f56=_f55.tagName.toLowerCase();
if(_f56==="td"||_f56==="th"){
var _f57=this.getMainOutputHomeCell();
var _f58=this.getSection("pfMainOutput");
if(_f53==="pfMainOutput"||_f53==="pfTopHeadings"){
var _f59=this.getSection("pfHorizontalScrollBar");
if(_f59){
var _f5a=PinFreezeContainer.calculateNewPosition(_f55.offsetLeft,_f55.offsetWidth,getScrollLeft(_f58),_f58.offsetWidth);
var _f5b=this.getHomeCellOffsetWidth(_f57);
if(getElementDirection(_f58)==="rtl"){
_f5b=0;
}
setScrollLeft(_f59,_f5a-_f5b);
setScrollLeft(_f58,_f5a);
}
}
if(_f53==="pfMainOutput"||_f53==="pfSideHeadings"){
var _f5c=this.getSection("pfVerticalScrollBar");
if(_f5c){
var _f5d=PinFreezeContainer.calculateNewPosition(_f55.offsetTop,_f55.offsetHeight,_f58.scrollTop,_f58.offsetHeight);
_f5c.scrollTop=_f5d-_f57.offsetHeight;
_f58.scrollTop=_f5d;
}
}
}
}
};
PinFreezeContainer.calculateNewPosition=function(_f5e,_f5f,_f60,_f61){
var _f62=_f5e+_f5f;
var _f63=_f60+_f61;
if(_f60>_f5e){
return _f5e;
}else{
if(_f63<_f62){
if(_f5f>_f61){
return _f5e;
}
return _f62-_f61;
}
}
return _f60;
};
PinFreezeContainer.prototype.synchVScroll=function(){
if(!this.m_cachedPFContainer){
return;
}
var _f64=this.getMainOutputHomeCell();
var _f65=this.getSection("pfMainOutput");
var _f66=this.getSection("pfTopHeadings");
if(_f66!=null){
var _f67=this.getSection("pfVerticalScrollBar");
if(_f67){
_f65.scrollTop=_f67.scrollTop+this.getTopHeadingSectionHeight(_f64);
if(this.m_freezeSide){
this.getSection("pfSideHeadings").scrollTop=_f67.scrollTop+this.getTopHeadingSectionHeight(_f64);
}
}
}
};
PinFreezeContainer.prototype.getTopHeadingSectionHeight=function(_f68){
return _f68.offsetHeight+_f68.offsetTop+this.m_containerMargin.top;
};
PinFreezeContainer.prototype._findBestGuessHomeCell=function(_f69){
if(this.m_bestGuessHomeCell){
return this.m_bestGuessHomeCell;
}
if(_f69){
var _f6a=_f69.parentNode.parentNode;
var _f6b=_f69.rowSpan?(_f69.rowSpan):1;
var tr=_f6a.childNodes[_f6b];
if(tr){
var _f6d=tr.childNodes.length;
var _f6e=null;
var td=null;
for(var i=0;i<_f6d;i++){
td=tr.childNodes[i];
if(td.getAttribute("type")=="datavalue"){
break;
}
_f6e=td;
}
if(_f6e){
this.m_bestGuessHomeCell=_f6e;
return this.m_bestGuessHomeCell;
}
}else{
return _f69;
}
}
return null;
};
PinFreezeContainer.prototype.getHomeCellOffsetWidth=function(_f71){
var _f72=this._findBestGuessHomeCell(_f71);
return _f72?_f72.offsetWidth:0;
};
PinFreezeContainer.prototype.getSideHeadingSectionWidth=function(_f73){
var _f74=this._findBestGuessHomeCell(_f73);
if(_f74){
return _f74.offsetWidth+_f74.offsetLeft+this.m_containerMargin.left;
}else{
return _f73.offsetWidth+_f73.offsetLeft;
}
};
PinFreezeContainer.prototype.isContainerFrozen=function(){
return (this.m_freezeTop||this.m_freezeSide);
};
PinFreezeContainer.prototype.unfreeze=function(_f75){
var _f76=this.getContainerByLID(_f75);
this.m_freezeTop=false;
this.m_freezeSide=false;
if(_f76){
var _f77=_f76.parentNode;
pfMainOutput=this.getSectionByLID(_f76,"pfMainOutput");
if(pfMainOutput&&_f77){
if(_f76.style.border!==""){
pfMainOutput.firstChild.style.border=_f76.style.border;
_f76.style.border="";
}
if(this.m_wrapFlag){
var _f78=pfMainOutput.firstChild.getElementsByTagName("span");
if(_f78){
for(var k=0;k<_f78.length;k++){
_f78[k].style.whiteSpace="";
}
}
this.m_wrapFlag=false;
}
this.updateTabIndexValues();
if(this.m_cachedBaseContainer.getAttribute("authoredFixedWidth")){
this.m_cachedBaseContainer.removeAttribute("authoredFixedWidth");
this.m_cachedBaseContainer.style.width="auto";
this.m_addedFixedWidth=null;
}
if(this.m_cachedBaseContainer.getAttribute("authoredFixedHeight")){
this.m_cachedBaseContainer.removeAttribute("authoredFixedHeight");
this.m_cachedBaseContainer.style.height="auto";
this.m_addedFixedHeight=null;
}
_f77.replaceChild(this.m_pinFreezeManager.deepCloneNode(pfMainOutput.firstChild),_f76);
}
}
};
PinFreezeContainer.prototype.getBorderInfo=function(el,_f7b){
var _f7c={};
var _f7d="border-"+_f7b+"-";
var _f7e="border"+_f7b.charAt(0).toUpperCase()+_f7b.substring(1);
if(el.currentStyle){
_f7c[_f7e+"Width"]=el.currentStyle[_f7e+"Width"];
_f7c[_f7e+"Style"]=el.currentStyle[_f7e+"Style"];
_f7c[_f7e+"Color"]=el.currentStyle[_f7e+"Color"];
}else{
if(window.getComputedStyle){
_f7c[_f7e+"Width"]=window.getComputedStyle(el,null).getPropertyValue(_f7d+"width");
_f7c[_f7e+"Style"]=window.getComputedStyle(el,null).getPropertyValue(_f7d+"style");
_f7c[_f7e+"Color"]=window.getComputedStyle(el,null).getPropertyValue(_f7d+"color");
}else{
return null;
}
}
return _f7c;
};
PinFreezeContainer.prototype.isA11yEnabled=function(_f7f){
return (_f7f.getAttribute("role")==="grid");
};
PinFreezeContainer.isElementInMainOutput=function(_f80){
var _f81=PinFreezeContainer.nodeToSlid(_f80);
if(_f81){
return (_f81.indexOf("pfMainOutput_")===0);
}
return false;
};
PinFreezeContainer.prototype.removeCTX=function(_f82){
_f82.removeAttribute("ctx");
var _f83=getElementsByAttribute(_f82,"*","ctx","*");
if(_f83&&_f83.length){
for(var i=0;i<_f83.length;i++){
_f83[i].removeAttribute("ctx");
}
}
};
PinFreezeContainer.prototype.initializeTouchScrolling=function(_f85){
if(!this.m_pinFreezeManager.isIWidgetMobile()){
return;
}
if(_f85){
_f85.m_pinFreezeContainer=this;
if(document.attachEvent){
_f85.attachEvent("touchstart",this.touchStart);
_f85.attachEvent("touchmove",this.touchMove);
_f85.attachEvent("touchend",this.touchEnd);
}else{
_f85.addEventListener("touchstart",this.touchStart,false);
_f85.addEventListener("touchmove",this.touchMove,false);
_f85.addEventListener("touchend",this.touchEnd,false);
}
}
};
PinFreezeContainer.prototype.removeTouchScrolling=function(){
if(!this.m_pinFreezeManager.isIWidgetMobile()){
return;
}
this.removeTouchScrollingEvents(this.getSection("pfMainOutput"));
this.removeTouchScrollingEvents(this.getSection("pfSideHeadings"));
this.removeTouchScrollingEvents(this.getSection("pfTopHeadings"));
};
PinFreezeContainer.prototype.removeTouchScrollingEvents=function(_f86){
if(!this.m_pinFreezeManager.isIWidgetMobile()){
return;
}
if(_f86){
if(document.detachEvent){
_f86.detachEvent("touchstart",this.touchStart);
_f86.detachEvent("touchmove",this.touchMove);
_f86.detachEvent("touchend",this.touchEnd);
}else{
_f86.removeEventListener("touchstart",this.touchStart,false);
_f86.removeEventListener("touchmove",this.touchMove,false);
_f86.removeEventListener("touchend",this.touchEnd,false);
}
}
};
PinFreezeContainer.prototype.touchMove=function(e){
if(this.m_pinFreezeContainer&&e&&e.changedTouches&&e.touches&&e.touches.length==1){
var _f88=e.changedTouches[0];
if(_f88&&_f88.clientX&&_f88.clientY){
var _f89=parseInt(_f88.clientX);
var _f8a=parseInt(_f88.clientY);
if(this.m_pinFreezeContainer.touchMoveHandler(_f89,_f8a)){
return stopEventBubble(e);
}
}
}
};
PinFreezeContainer.prototype.touchStart=function(e){
if(this.m_pinFreezeContainer&&e&&e.changedTouches&&e.touches&&e.touches.length==1){
var _f8c=e.changedTouches[0];
if(_f8c&&_f8c.clientX&&_f8c.clientY){
var _f8d=parseInt(_f8c.clientX);
var _f8e=parseInt(_f8c.clientY);
this.m_pinFreezeContainer.touchStartHandler(_f8d,_f8e);
}
}
};
PinFreezeContainer.prototype.touchStartHandler=function(_f8f,_f90){
this.touchScrollSections=false;
this.touchPreviousX=_f8f;
this.touchPreviousY=_f90;
};
PinFreezeContainer.prototype.touchEnd=function(e){
if(this.m_pinFreezeContainer&&this.m_pinFreezeContainer.touchEndHandler()){
stopEventBubble(e);
}
};
PinFreezeContainer.prototype.touchEndHandler=function(){
var _f92=this.touchScrollSections;
this.touchScrollSections=false;
this.touchPreviousX=-1;
this.touchPreviousY=-1;
return _f92;
};
PinFreezeContainer.prototype.touchMoveHandler=function(_f93,_f94){
var _f95=this.getSection("pfMainOutput");
if(!_f95){
return;
}
var _f96=this.getSectionHomeCell(_f95);
var _f97=this.getTopHeadingSectionHeight(_f96);
var _f98=this.getSideHeadingSectionWidth(_f96);
var _f99=_f94-this.touchPreviousY;
var _f9a=_f93-this.touchPreviousX;
if(this.touchScrollSections){
if(_f99!=0){
var _f9b=_f95.scrollTop-_f99;
_f9b=(_f9b>_f97)?_f9b:_f97;
_f95.scrollTop=_f9b;
var _f9c=this.getSection("pfSideHeadings");
if(_f9c){
_f9c.scrollTop=_f9b;
}
}
if(_f9a!=0){
var _f9d=_f95.scrollLeft-_f9a;
_f9d=(_f9d>_f98)?_f9d:_f98;
_f95.scrollLeft=_f9d;
var _f9e=this.getSection("pfTopHeadings");
if(_f9e){
_f9e.scrollLeft=_f9d;
}
}
}else{
this.firstTouchMove(_f95,_f9a,_f99,_f98,_f97);
}
this.touchPreviousX=_f93;
this.touchPreviousY=_f94;
return this.touchScrollSections;
};
PinFreezeContainer.prototype.firstTouchMove=function(_f9f,_fa0,_fa1,_fa2,_fa3){
var _fa4=this.mostlyVerticalTouchMove(_fa0,_fa1);
var _fa5=PinFreezeContainer.isSectionVisible(this.getSection("pfTopHeadings"));
var _fa6=PinFreezeContainer.isSectionVisible(this.getSection("pfSideHeadings"));
if(_fa4&&(!_fa5||(_fa1>0&&_f9f.scrollTop<=_fa3)||(_fa1<0&&_f9f.scrollTop+_f9f.clientHeight>=_f9f.scrollHeight))){
this.touchScrollSections=false;
}else{
if(!_fa4&&(!_fa6||(_fa0>0&&_f9f.scrollLeft<=_fa2)||(_fa0<0&&_f9f.scrollLeft+_f9f.clientWidth>=_f9f.scrollWidth))){
this.touchScrollSections=false;
}else{
this.touchScrollSections=true;
}
}
};
PinFreezeContainer.prototype.mostlyVerticalTouchMove=function(_fa7,_fa8){
var _fa9=(_fa7>0)?_fa7:0-_fa7;
var _faa=(_fa8>0)?_fa8:0-_fa8;
return (_faa>_fa9);
};
PinFreezeContainer.prototype.destroy=function(){
this.removeTouchScrolling();
GUtil.destroyProperties(this);
};
function PinFreezeManager(oCV){
this.m_oCV=oCV;
this.m_viewerId=oCV.getId();
this.m_frozenInfo=null;
this.m_lastWidthProcessed=0;
this.m_lastHeightProcessed=0;
this.c_resizeTweekLimit=5;
this.m_repaintOnVisible=false;
};
PinFreezeManager.prototype.addContainerObject=function(lid,_fad,_fae,_faf,_fb0){
if(_fad||_fae){
if(!this.m_frozenInfo){
this.m_frozenInfo={};
}
if(!this.m_frozenInfo[lid]){
this._createDefaultFrozenInfo(lid);
}
this.m_frozenInfo[lid].freezeTop=_fad;
this.m_frozenInfo[lid].freezeSide=_fae;
var _fb1=this.newContainer(lid,_fad,_fae,_faf,_fb0);
this.m_frozenInfo[lid].pinFreezeContainers.push(_fb1);
return _fb1;
}
return null;
};
PinFreezeManager.prototype.newContainer=function(lid,_fb3,_fb4,_fb5,_fb6){
return new PinFreezeContainer(this,lid,this.m_viewerId,_fb3,_fb4,_fb5,_fb6);
};
PinFreezeManager.prototype.clearPinInfo=function(lid){
if(!this.m_frozenInfo){
return;
}
if(lid){
if(this.m_frozenInfo[lid]){
delete this.m_frozenInfo[lid];
}
}else{
delete this.m_frozenInfo;
this.m_frozenInfo=null;
}
};
PinFreezeManager.prototype._createDefaultFrozenInfo=function(lid){
this.m_frozenInfo[lid]={"lid":lid,"freezeTop":false,"freezeSide":false,"pinFreezeContainers":[],"childContainers":{}};
};
PinFreezeManager.prototype._resetFrozenInfo=function(lid){
var _fba=this.m_frozenInfo[lid];
if(_fba){
delete _fba.pinFreezeContainers;
_fba.pinFreezeContainers=[];
_fba.freezeTop=false;
_fba.freezeSide=false;
}
};
PinFreezeManager.prototype.prepopulateFrozenInfo=function(_fbb){
var _fbc=getDescendantElementsByAttribute(_fbb,"table","lid","",false,-1,new RegExp("[\\s\\S]*"));
if(_fbc){
if(!this.m_frozenInfo){
this.m_frozenInfo={};
}
for(var i=0;i<_fbc.length;i++){
var _fbe=_fbc[i];
if(_fbe.getAttribute("id")=="rt"+this.m_viewerId){
continue;
}
var lid=this.removeNamespace(_fbe.getAttribute("lid"));
if(this.m_frozenInfo[lid]&&this.m_frozenInfo[lid].childContainers){
continue;
}
if(!this.m_frozenInfo[lid]){
this._createDefaultFrozenInfo(lid);
}
if(!this.m_frozenInfo[lid].childContainers){
this.m_frozenInfo[lid].childContainers={};
}
var _fc0=getDescendantElementsByAttribute(_fbe,"table","lid","",false,-1,new RegExp("[\\s\\S]*"));
if(_fc0){
for(var _fc1=0;_fc1<_fc0.length;_fc1++){
var _fc2=_fc0[_fc1];
var _fc3=this.removeNamespace(_fc2.getAttribute("lid"));
if(!this.m_frozenInfo[lid].childContainers[_fc3]){
var _fc4=_fc2.parentNode;
while(_fc4&&!_fc4.getAttribute("lid")){
_fc4=_fc4.parentNode;
}
if(_fc4&&this.removeNamespace(_fc4.getAttribute("lid"))==lid){
this.m_frozenInfo[lid].childContainers[_fc3]=true;
}
}
}
}
}
this._updateParentContainerInfo();
}
};
PinFreezeManager.prototype._updateParentContainerInfo=function(){
for(var _fc5 in this.m_frozenInfo){
var _fc6=this.m_frozenInfo[_fc5].childContainers;
if(_fc6){
for(var _fc7 in _fc6){
if(this.m_frozenInfo[_fc7]){
this.m_frozenInfo[_fc7].parentContainer=_fc5;
break;
}
}
}
}
};
PinFreezeManager.prototype.getTopLevelContainerLID=function(lid){
if(this.m_frozenInfo[lid]){
while(this.m_frozenInfo[lid].parentContainer){
lid=this.m_frozenInfo[lid].parentContainer;
}
}
return lid;
};
PinFreezeManager.prototype.freezeContainer=function(lid,_fca,_fcb){
var _fcc=document.getElementById("CVReport"+this.m_viewerId);
this.prepopulateFrozenInfo(_fcc);
var _fcd=this.getTopLevelContainerLID(lid);
this.unfreezeAllNestedContainers(_fcd,_fcc);
this.m_frozenInfo[lid].freezeTop=_fca;
this.m_frozenInfo[lid].freezeSide=_fcb;
var _fce=this._createPinAndFreezeObject(_fcc,_fcd);
this.m_lastWidthProcessed=0;
this.m_lastHeightProcessed=0;
this._resizePinFreezeObjects(_fce);
this.sectionStructureChange();
if(isIE()){
var obj=this;
setTimeout(function(){
obj.refresh();
},1);
var _fd0=document.getElementById("RVContent"+this.m_viewerId);
this.m_oCV.repaintDiv(_fd0);
}
return _fce;
};
PinFreezeManager.prototype.getInitialWidthThreshold=function(){
return document.body.clientWidth*3/4;
};
PinFreezeManager.prototype.getInitialHeightThreshold=function(){
return document.body.clientWidth*9/10;
};
PinFreezeManager.prototype.hasFrozenContainers=function(){
return ((this.m_frozenInfo)?true:false);
};
PinFreezeManager.prototype.hasFrozenRowHeadings=function(lid){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]){
return this.m_frozenInfo[lid].freezeSide?this.m_frozenInfo[lid].freezeSide:false;
}
return false;
};
PinFreezeManager.prototype.hasFrozenColumnHeadings=function(lid){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]){
return this.m_frozenInfo[lid].freezeTop?this.m_frozenInfo[lid].freezeTop:false;
}
return false;
};
PinFreezeManager.prototype.removeNamespace=function(idNS){
if(idNS.length>this.m_viewerId.length){
if(idNS.indexOf(this.m_viewerId)>0){
return idNS.substring(0,idNS.indexOf(this.m_viewerId));
}
}
return idNS;
};
PinFreezeManager.prototype.getContainer=function(lid,_fd5){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]&&this.m_frozenInfo[lid].pinFreezeContainers[0]){
_fd5=_fd5?_fd5:0;
return this.m_frozenInfo[lid].pinFreezeContainers[_fd5];
}
return null;
};
PinFreezeManager.prototype.nodeToContainer=function(node){
var slid=PinFreezeContainer.nodeToSlid(node);
var _fd8=null;
if(slid){
var lid=this.removeNamespace(PinFreezeContainer.getLidFromSlid(slid));
_fd8=this.getContainer(lid);
}
return _fd8;
};
PinFreezeManager.prototype.getContainerElement=function(_fda){
var lid=this.removeNamespace(_fda.getAttribute("lid"));
if(lid){
var _fdc=this.getContainer(lid);
if(_fdc){
return _fdc.getContainer();
}
}
return null;
};
PinFreezeManager.prototype._createPinAndFreezeObject=function(_fdd,lid){
var _fdf=null;
if(this.m_frozenInfo){
var _fe0=this.m_frozenInfo[lid];
var _fe1=_fe0.initialLoad;
if(_fe1){
delete _fe0.initialLoad;
}
var _fe2=_fe0.freezeTop;
var _fe3=_fe0.freezeSide;
var _fe4=null;
if(_fe1&&_fe0.pinFreezeContainers&&(_fe2||_fe3)){
_fe4=_fe0.pinFreezeContainers.slice(0);
}
var _fe5=_fdd;
if(_fe0&&_fe0.parentContainer){
var _fe6=getElementsByAttribute(_fdd,"table","lid",_fe0.parentContainer+this.m_viewerId);
if(_fe6){
for(parentIndex=0;parentIndex<_fe6.length;parentIndex++){
if(!_fe6[parentIndex].getAttribute("clonednode")){
_fe5=_fe6[parentIndex];
break;
}
}
}
}
if(_fe0.childContainers){
for(var _fe7 in _fe0.childContainers){
var _fe8=this._createPinAndFreezeObject(_fe5,_fe7);
_fdf=_fdf?_fdf:_fe8;
}
}
var _fe9=getElementsByAttribute(_fe5,"table","lid",lid+this.m_viewerId);
if(_fe9&&_fe9.length>0){
delete _fe0.pinFreezeContainers;
_fe0.pinFreezeContainers=[];
}else{
return null;
}
if(_fe9&&(_fe2||_fe3)){
var _fea=(_fdf!==null);
for(var i=0;i<_fe9.length;i++){
var _fec=_fe9[i];
if(_fec.getAttribute("clonednode")=="true"){
continue;
}
_fdf=this.addContainerObject(lid,_fe2,_fe3,_fec,i);
if(_fdf){
_fdf.createPFContainer(_fe5,_fea);
if(_fe1){
_fdf.copyProperties(_fe4[0]);
}
_fdf.freezeContainerInReport(_fdd);
}
}
}
}
return _fdf;
};
PinFreezeManager.prototype.renderReportWithFrozenContainers=function(_fed){
if(this.m_frozenInfo){
var _fee=false;
var _fef=null;
for(var _ff0 in this.m_frozenInfo){
var _ff1=this.m_frozenInfo[_ff0];
if(!_fee){
_fee=_ff1.initialLoad;
}
if(!_ff1.parentContainer){
var temp=this._createPinAndFreezeObject(_fed,_ff1.lid);
_fef=_fef?_fef:temp;
}
}
if(!_fee&&_fef){
this._resizePinFreezeObjects(_fef);
}
this.refresh();
}
};
PinFreezeManager.prototype._resizePinFreezeObjects=function(_ff3){
var _ff4,_ff5;
var _ff6=this.m_oCV.getViewerWidget();
if(_ff6){
var size=_ff6.getWidgetSize();
_ff5=(size&&size.w&&(size.w<this.getInitialWidthThreshold()))?size.w:_ff3.getClientWidth();
_ff4=(size&&size.h&&(size.h<this.getInitialHeightThreshold()))?size.h:_ff3.getClientHeight();
}else{
var _ff8=document.getElementById("RVContent"+this.m_viewerId);
var _ff9=document.getElementById("mainViewerTable"+this.m_viewerId);
_ff5=_ff8.clientWidth;
_ff4=_ff9.clientHeight;
}
this.m_lastWidthProcessed=0;
this.m_lastHeightProcessed=0;
this.resize(_ff5,_ff4);
};
PinFreezeManager.prototype.resize=function(_ffa,_ffb){
var _ffc=(Math.abs(_ffa-this.m_lastWidthProcessed)<this.c_resizeTweekLimit);
var _ffd=(Math.abs(_ffb-this.m_lastHeightProcessed)<this.c_resizeTweekLimit);
if(_ffc&&_ffd){
return;
}
var _ffe=(Math.abs(_ffa-this.m_lastWidthProcessed)>2)?_ffa:0;
var _fff=(Math.abs(_ffb-this.m_lastHeightProcessed)>2)?_ffb:0;
for(var lid in this.m_frozenInfo){
if(!this.m_frozenInfo[lid].parentContainer){
this.resizeContainer(lid,_ffe,_fff);
}
}
this.m_lastWidthProcessed=_ffa;
this.m_lastHeightProcessed=_ffb;
};
PinFreezeManager.prototype.resizeContainer=function(lid,width,_1003){
var _1004=this.m_frozenInfo[lid];
if(_1004){
var _1005=null;
if(_1004.childContainers){
var _1006=width>10?width-10:width;
var _1007=_1003>10?_1003-10:_1003;
for(var _1008 in _1004.childContainers){
_1005=this.resizeContainer(_1008,_1006,_1007);
}
}
var _1009=_1004.pinFreezeContainers;
var _100a=null;
var _100b=null;
if(_1009){
for(var i=0;i<_1009.length;i++){
_100a=_1009[i];
_100a.resize(width,_1003,_1004.parentContainer,_1005);
var _100d=_100a.getContainer();
if(_100d&&(!_100b||(_100b.width<_100d.clientWidth))){
_100b={"width":_100d.clientWidth,"lid":_100a.m_lidNS};
}
}
}
return _100b;
}
};
PinFreezeManager.prototype.processAutoResize=function(width,_100f){
this.m_lastWidthProcessed=width;
this.m_lastHeightProcessed=_100f;
};
PinFreezeManager.prototype.onSetVisible=function(){
this.refresh();
if(this.m_repaintOnVisible){
this.rePaint();
this.m_repaintOnVisible=false;
}
};
PinFreezeManager.prototype.onResizeCanvas=function(_1010){
if(_1010){
this.rePaint();
}else{
this.m_repaintOnVisible=true;
}
};
PinFreezeManager.prototype.rePaint=function(){
for(var lid in this.m_frozenInfo){
if(!this.m_frozenInfo[lid].parentContainer){
this.resizeContainer(lid,this.m_lastWidthProcessed,this.m_lastHeightProcessed);
}
}
};
PinFreezeManager.prototype.refresh=function(){
for(var _1012 in this.m_frozenInfo){
var _1013=this.m_frozenInfo[_1012].pinFreezeContainers;
if(_1013){
for(var i=0;i<_1013.length;i++){
var _1015=_1013[i];
_1015.synchScroll();
_1015.synchVScroll();
}
}
}
};
PinFreezeManager.prototype.freezeContainerRowHeadings=function(lid){
return this.freezeContainer(lid,this.hasFrozenColumnHeadings(lid),true);
};
PinFreezeManager.prototype.freezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
return this.freezeContainerRowHeadings(lid);
}
return null;
};
PinFreezeManager.prototype.canFreezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
return (!this.hasFrozenRowHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.unfreezeContainerRowHeadings=function(lid){
this.freezeContainer(lid,this.hasFrozenColumnHeadings(lid),false);
};
PinFreezeManager.prototype.unfreezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
this.unfreezeContainerRowHeadings(lid);
}
};
PinFreezeManager.prototype.canUnfreezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
return (this.hasFrozenRowHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.freezeContainerColumnHeadings=function(lid){
return this.freezeContainer(lid,true,this.hasFrozenRowHeadings(lid));
};
PinFreezeManager.prototype.freezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
return this.freezeContainerColumnHeadings(lid);
}
return null;
};
PinFreezeManager.prototype.canFreezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
return (!this.hasFrozenColumnHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.unfreezeContainerColumnHeadings=function(lid){
this.freezeContainer(lid,false,this.hasFrozenRowHeadings(lid));
};
PinFreezeManager.prototype.unfreezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
this.unfreezeContainerColumnHeadings(lid);
}
};
PinFreezeManager.prototype.canUnfreezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
return (this.hasFrozenColumnHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.getValidSelectedContainerId=function(_1022){
var _1023=this.m_oCV.getSelectionController().getAllSelectedObjects();
if(_1023&&_1023.length&&(_1023[0].getDataContainerType()==="crosstab"||(_1022&&_1023[0].getDataContainerType()==="list"))){
var lid=(_1023[0].getLayoutElementId());
if(lid){
if(!this.hasPromptControlsInFreezableCells(lid)){
return this.removeNamespace(lid);
}
}
}
return null;
};
PinFreezeManager.prototype.hasPromptControlsInFreezableCells=function(lid){
var _1026=this.m_oCV.getLayoutElementFromLid(lid);
var _1027=getElementsByAttribute(_1026,["td","th"],"type","columnTitle");
var _1028=new RegExp("(^|[W])clsPromptComponent($|[W])");
var _1029=isIE()?"className":"class";
for(var j in _1027){
if(_1027.hasOwnProperty(j)){
var _102b=getElementsByAttribute(_1027[j],"*",_1029,null,1,_1028);
if(_102b.length>0){
return true;
}
}
}
return false;
};
PinFreezeManager.prototype.unfreeze=function(lid,_102d,reset){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]){
var _102f=this.m_frozenInfo[lid].pinFreezeContainers;
if(_102f){
for(var i=0;i<_102f.length;i++){
var _1031=_102f[i];
_1031.unfreeze(_102d);
}
if(reset){
this._resetFrozenInfo(lid);
}
}
}
};
PinFreezeManager.prototype.unfreezeAllNestedContainers=function(lid,_1033){
var _1034=this.m_frozenInfo[lid];
if(_1034){
if(_1034.freezeTop||_1034.freezeSide){
this.unfreeze(lid,_1033,false);
}
if(_1034.childContainers){
for(var _1035 in _1034.childContainers){
this.unfreezeAllNestedContainers(_1035,_1033);
}
}
}
};
PinFreezeManager.prototype.isNodeVisible=function(node){
var slid=PinFreezeContainer.nodeToSlid(node);
if(!slid){
return true;
}
var lid=this.removeNamespace(PinFreezeContainer.getLidFromSlid(slid));
var _1039=this.getContainer(lid);
if(!_1039){
return true;
}
var _103a=PinFreezeContainer.getSectionNameFromSlid(slid);
var _103b=_1039.getSection(_103a);
var _103c=null,_103d=null;
var nodeI=node;
var _103f=null;
while(nodeI&&nodeI!==_103b&&!_103c&&!_103d){
_103c=_1039.getMain(nodeI);
_103d=_1039.getCopy(nodeI);
_103f=nodeI;
nodeI=nodeI.parentNode;
}
var _1040=_103c?true:false;
var _1041=_103d?true:false;
if(_1040){
return _1039.getCopy(_103c)===_103f;
}else{
if(_1041){
return _1039.getCopy(_103f)?false:true;
}else{
return true;
}
}
};
PinFreezeManager.prototype.sectionStructureChange=function(){
var _1042=this.m_oCV.getViewerWidget();
if(_1042&&_1042.getAnnotationHelper()){
_1042.getAnnotationHelper().repositionCommentIndicators();
}
};
PinFreezeManager.prototype.deepCloneNode=function(_1043){
var copy=_1043.cloneNode(true);
var _1045=this.m_oCV.getViewerWidget();
if(_1045){
if(_1045.reportContainsDijits()){
var _1046=getElementsByAttribute(copy,"*","widgetid","*");
if(_1046&&_1046.length){
for(var i=0;i<_1046.length;i++){
_1046[i].parentNode.removeChild(_1046[i]);
}
}
}
}
return copy;
};
PinFreezeManager.prototype.toJSONString=function(){
var _1048="";
var _1049="";
for(var _104a in this.m_frozenInfo){
if(_1048.length>0){
_1048+=",";
}
var _104b=this.m_frozenInfo[_104a];
_1048+="{";
_1048+="\"lid\":\""+_104b.lid.replace("\"","\\\"")+"\",";
_1048+="\"freezeTop\":"+_104b.freezeTop+",";
_1048+="\"freezeSide\":"+_104b.freezeSide+",";
if(_104b.parentContainer){
_1048+="\"parentContainer\":\""+_104b.parentContainer+"\",";
}
if(_104b.pinFreezeContainers&&_104b.pinFreezeContainers.length>0){
_1048+="\"properties\":"+_104b.pinFreezeContainers[0].toJSONString()+",";
}
_1048+="\"childContainers\": {";
if(_104b.childContainers){
var first=true;
for(var _104d in _104b.childContainers){
if(!first){
_1048+=",";
}
_1048+="\""+_104d+"\":true";
first=false;
}
}
_1048+="}}";
}
if(_1048.length>0){
_1049="{\"version\":1, \"containers\":["+_1048+"]}";
}
return _1049;
};
PinFreezeManager.prototype.fromJSONString=function(sJSON){
if(!sJSON||sJSON.length===0){
return;
}
var oJSON=null;
try{
oJSON=eval("("+sJSON+")");
}
catch(e){
if(typeof console!="undefined"){
console.log("PinFreezeManager.prototype.fromJSON could not parse JSON - "+sJSON);
console.log(e);
}
}
if(!oJSON){
return;
}
var _1050=oJSON.containers;
var _1051=oJSON.version;
if(_1050.length>0){
this.m_frozenInfo={};
}
for(var _1052=0;_1052<_1050.length;_1052++){
var _1053=_1050[_1052];
var lid=_1053.lid;
var _1055=_1053.freezeTop;
var _1056=_1053.freezeSide;
var _1057=document.getElementById("CVReport"+this.m_viewerId);
var _1058=getElementsByAttribute(_1057,"table","lid",lid+this.m_viewerId);
var _1059=[];
if(_1058&&(_1055||_1056)){
for(var i=0;i<_1058.length;i++){
var _105b=_1058[i];
var _105c=new PinFreezeContainer(this,lid,this.m_viewerId,_1053.freezeTop,_1053.freezeSide,_105b,i);
if(_1053.properties){
applyJSONProperties(_105c,_1053.properties);
}
_1059.push(_105c);
}
}
this.m_frozenInfo[lid]={"lid":lid,"freezeTop":_1055,"freezeSide":_1056,"pinFreezeContainers":_1059,"initialLoad":true};
if(_1051>=1){
if(_1053.childContainers){
this.m_frozenInfo[lid].childContainers=_1053.childContainers;
}
if(_1053.parentContainer){
this.m_frozenInfo[lid].parentContainer=_1053.parentContainer;
}
}
}
};
PinFreezeManager.prototype.removeIdAttribute=function(_105d){
var _105e=_105d.getAttribute("id");
if(_105e!==null&&_105e!==""){
_105d.removeAttribute("id");
}
var _105f=getElementsByAttribute(_105d,"*","id","*");
if(_105f&&_105f.length){
for(var i=0;i<_105f.length;i++){
_105f[i].removeAttribute("id");
}
}
return _105d;
};
PinFreezeManager.prototype.isElementInMainOutput=function(_1061){
return PinFreezeContainer.isElementInMainOutput(_1061);
};
PinFreezeManager.prototype.isIWidgetMobile=function(){
return (this.m_oCV&&this.m_oCV.isIWidgetMobile());
};
PinFreezeManager.prototype.destroy=function(){
GUtil.destroyProperties(this);
};
function CViewerToolbar(){
this.m_specification=null;
this.m_oCBar=null;
this.m_sWebContentRoot=null;
this.m_sSkin=null;
};
CViewerToolbar.prototype.getNamespace=function(){
if(this.m_specification&&typeof this.m_specification.namespace!="undefined"){
return this.m_specification.namespace;
}
return "";
};
CViewerToolbar.prototype.getSkin=function(){
if(this.m_sSkin==null){
var oCV=null;
try{
oCV=getCognosViewerObjectRef(this.getNamespace());
}
catch(exception){
}
if(oCV){
this.m_sSkin=oCV.getSkin();
}else{
this.m_sSkin=this.getWebContentRoot()+"/skins/corporate";
}
}
return this.m_sSkin;
};
CViewerToolbar.prototype.getWebContentRoot=function(){
if(this.m_sWebContentRoot==null){
var oCV=null;
try{
oCV=getCognosViewerObjectRef(this.getNamespace());
}
catch(exception){
}
if(oCV){
this.m_sWebContentRoot=oCV.getWebContentRoot();
}else{
this.m_sWebContentRoot="..";
}
}
return this.m_sWebContentRoot;
};
CViewerToolbar.prototype.getDivId=function(){
if(this.m_specification&&typeof this.m_specification.divId!="undefined"){
return this.m_specification.divId;
}
return "";
};
CViewerToolbar.prototype.getStyle=function(){
if(this.m_specification&&typeof this.m_specification.style!="undefined"){
return this.m_specification.style;
}
return "";
};
CViewerToolbar.prototype.getToolbarSpecification=function(){
if(this.m_specification&&typeof this.m_specification.S!="undefined"){
return new CViewerToolbarSpecification(this,this.m_specification.S);
}
return null;
};
CViewerToolbar.prototype.getItem=function(sId){
if(this.m_oCBar){
var _1065=this.m_oCBar.getNumItems();
sId=this.getNamespace()+sId;
for(var index=0;index<_1065;++index){
var _1067=this.m_oCBar.get(index);
if(typeof _1067.getId=="function"&&_1067.getId()==sId){
return _1067;
}
}
}
return null;
};
CViewerToolbar.prototype.init=function(_1068){
if(typeof _1068!="undefined"&&typeof _1068=="object"&&_1068!=null){
this.m_specification=_1068;
}
};
CViewerToolbar.prototype.getCBar=function(){
if(!this.m_oCBar&&this.m_specification){
this.load();
}
return this.m_oCBar;
};
CViewerToolbar.prototype.load=function(){
var _1069=null;
if(this.m_specification!=null){
var divId=this.getDivId();
var _106b=document.getElementById(divId);
var _106c=this.getToolbarSpecification();
if(_106b&&_106c){
_1069=_106c.draw();
}
}
this.m_oCBar=_1069;
return _1069;
};
CViewerToolbar.prototype.draw=function(){
if(this.m_oCBar){
this.m_oCBar.draw();
}
};
function CViewerToolbarSpecification(_106d,_106e){
this.m_viewerToolbar=_106d;
this.m_toolbarSpecification=_106e;
};
CViewerToolbarSpecification.prototype.draw=function(){
if(this.m_toolbarSpecification){
var _106f=gToolbarStyle;
if(this.m_viewerToolbar.getStyle()==="banner"){
_106f=gBannerToolbarStyle;
}
var _1070=new CBar(this.m_viewerToolbar.getDivId(),_106f,null,this.m_viewerToolbar.getWebContentRoot());
_1070.setMenuType(cHorizonalBar);
_1070.style=this.m_viewerToolbar.getStyle();
_1070.setAlign("right");
var _1071=false;
var _1072=null;
var _1073=null;
for(var _1074=0;_1074<this.m_toolbarSpecification.length;_1074++){
for(var _1075 in this.m_toolbarSpecification[_1074]){
try{
var _1076=eval("new "+_1075+"();");
if(_1075=="P"){
if(_1071&&_1073==null){
_1072=_1076;
_1073=this.m_toolbarSpecification[_1074][_1075];
}
}else{
var _1077=this.m_toolbarSpecification[_1074][_1075];
if(_1077.N!=="openWith"||!window.isIOS()){
_1071=true;
if(_1073!=null&&_1072!=null){
_1072.load(_1070,_1073,this.m_viewerToolbar);
_1072=null;
_1073=null;
}
_1076.load(_1070,_1077,this.m_viewerToolbar);
}
}
}
catch(exception){
}
}
}
return _1070;
}
return null;
};
function B(){
};
B.prototype.isValid=function(_1078){
if(_1078!=null){
return true;
}
return false;
};
B.prototype.load=function(_1079,_107a,_107b){
if(this.isValid(_107a)){
var _107c="";
var _107d="";
var _107e="";
var sName=_107a.N;
var _1080=null;
if(typeof _107a.M!="undefined"&&_107a.M.IS!="undefined"){
_1080=_107a.M.IS;
}
if(typeof _107a.C=="undefined"){
if(_1080){
var _1081=_1080[0]["I"];
if(_1081!=null&&this.isValid(_1081)){
_107c=_1081.O;
if(typeof _107c=="undefined"||_107c==""){
_107c=_1081.E;
}
_107d=_1081.C;
_107e=_1081.A;
}
}
}else{
_107c=_107a.O;
_107d=_107a.C;
_107e=_107a.A;
}
var _1082=null;
if(_107b.getStyle()==="banner"){
_1082=new CMenuItem(_1079,"",_107e,_107d,gBannerButtonStyle,_107b.getWebContentRoot(),_107b.getSkin());
_1082.setDropDownArrow("dropdown_arrow_banner.gif");
}else{
_1082=new CMenuItem(_1079,"",_107e,_107d,gMenuItemStyle,_107b.getWebContentRoot(),_107b.getSkin());
_1082.setDropDownArrow("dropdown_arrow_narrow.gif");
}
_1082.setId(_107b.getNamespace()+sName);
_1082.setToolTip(_107c);
if(typeof _107a.ALT!="undefined"){
_1082.setAltText(_107a.ALT);
}
if(typeof _107a.D!="undefined"&&_107a.D=="true"){
_1082.disable();
}
if(typeof _107a.M!="undefined"){
var _1083=_107a.M;
if(typeof _1083.Y!="undefined"&&(typeof _1083.A!="undefined"||(_1080&&_1080.length>1)||(typeof _1083.H=="undefined"||_1083.H=="false"))){
var menu=new M();
_1082.m_menu=menu.load(_1079,_1083,_107b);
_1082.m_menu.setParent(_1082);
_1082.m_menuType=_1083.Y;
}
}
return _1082;
}
return null;
};
function I(){
};
I.prototype.isValid=function(_1085){
if(typeof _1085!="undefined"&&_1085!=null){
return true;
}
return false;
};
I.prototype.load=function(_1086,_1087,_1088){
if(this.isValid(_1087)){
var sText=_1087.E;
var _108a=_1087.C;
var _108b=_1087.A;
var sName=_1087.N;
var _108d=null;
if(typeof _1087.M!="undefined"&&_1087.M.IS!="undefined"){
_108d=_1087.M.IS;
}
if(typeof _1087.E=="undefined"){
if(_108d&&_108d[0]){
var _108e=_108d[0]["I"];
if(_108e!=null&&this.isValid(_108e)){
sText=_108e.E;
if(typeof sText=="undefined"||sText==""){
sText=_108e.O;
}
_108b=_108e.A;
}
}else{
return null;
}
}else{
sText=_1087.E;
_108a=_1087.C;
_108b=_1087.A;
}
var _108f=null;
if(_1086.style&&_1086.style==="banner"){
_108f=gBannerItemStyle;
}else{
_108f=gMenuItemStyle;
}
var _1090=new CMenuItem(_1086,sText,_108b,_108a,_108f,_1088.getWebContentRoot(),_1088.getSkin());
if(typeof _1087.ALT!="undefined"){
_1090.setAltText(_1087.ALT);
}
if(_1086.style&&_1086.style==="banner"){
_1090.setDropDownArrow("dropdown_arrow_banner.gif");
}else{
_1090.setDropDownArrow("dropdown_arrow_narrow.gif");
}
_1090.setId(_1088.getNamespace()+sName);
if(typeof _1087.D!="undefined"&&_1087.D=="true"){
_1090.disable();
}
if(typeof _1087.M!="undefined"){
var _1091=_1087.M;
if(typeof _1091.Y!="undefined"&&(typeof _1091.A!="undefined"||(_108d&&_108d.length>1)||(typeof _1091.H=="undefined"||_1091.H=="false"))){
var menu=new M();
_1090.m_menu=menu.load(_1086,_1091,_1088);
_1090.m_menu.setParent(_1090);
_1090.m_menuType=_1087.M.Y;
}
}
return _1090;
}
return null;
};
function M(){
};
M.prototype.isValid=function(_1093){
return (typeof _1093!="undefined"&&_1093!=null&&typeof _1093.id!="undefined");
};
M.prototype.load=function(_1094,_1095,_1096){
if(this.isValid(_1095)){
var menu=new CMenu(_1095.id,gMenuStyle,_1096.getWebContentRoot());
menu.setParent(_1094);
if(typeof _1095.ALT!="undefined"){
menu.setAltText(_1095.ALT);
}
try{
menu.m_oCV=getCognosViewerObjectRef(_1096.getNamespace());
}
catch(e){
}
if(typeof _1095.A!="undefined"){
menu.registerCallback(_1095.A);
}
var _1098=_1095.IS;
if(_1098){
for(var _1099=0;_1099<_1098.length;_1099++){
for(var _109a in _1098[_1099]){
try{
var _109b=new I();
_109b.load(menu,_1098[_1099][_109a],_1096);
}
catch(exception){
}
}
}
}
return menu;
}
return null;
};
function T(){
};
T.prototype.isValid=function(_109c){
return (typeof _109c!="undefined"&&_109c!=null&&typeof _109c.E!="undefined");
};
T.prototype.load=function(_109d,_109e,_109f){
if(this.isValid(_109e)){
var _10a0=null;
if(_109f.getStyle()==="banner"){
_10a0=gBannerStaticText;
}else{
}
if(_109e.E&&_109e.E.length>0){
var _10a1=new CStaticText(_109e.E,_10a0);
if(_109e.N=="userName"){
_10a1.setId("userNameTD"+_109f.getNamespace());
}
if(_109e.ALT){
_10a1.setLabelledBy(_109e.ALT+" "+_109e.E);
}
_109d.add(_10a1);
}
}
return null;
};
function L(){
};
L.prototype.isValid=function(_10a2){
return (typeof _10a2!="undefined"&&_10a2!=null&&typeof _10a2.E!="undefined");
};
L.prototype.load=function(_10a3,_10a4,_10a5){
if(this.isValid(_10a4)){
var _10a6=null;
if(_10a5.getStyle()==="banner"){
_10a6=gBannerLink;
}else{
}
var _10a7=_10a4.A;
var _10a8=new CMenuItem(_10a3,_10a4.E,_10a7,"",_10a6,_10a5.getWebContentRoot(),_10a5.getSkin());
_10a8.iconPlaceholder=false;
if(_10a4.ALT!="undefined"){
_10a8.setAltText(_10a4.ALT);
}
return _10a8;
}
return null;
};
function P(){
};
P.prototype.isValid=function(_10a9){
return (typeof _10a9!="undefined"&&_10a9!=null&&typeof _10a9.Y!="undefined");
};
P.prototype.load=function(_10aa,_10ab,_10ac){
if(this.isValid(_10ab)){
var _10ad=new CSeperator(_10ab.Y,"","",_10ac.getWebContentRoot());
if(_10ac.getStyle()==="banner"){
_10ad.setToolbarSeperatorClass("bannerDivider");
}else{
_10ad.setToolbarSeperatorClass("toolbarDivider");
}
_10aa.add(_10ad);
return _10ad;
}
return null;
};
function GlossaryAction(){
};
GlossaryAction.prototype=new CognosViewerAction();
GlossaryAction.prototype.execute=function(){
var _10ae=this.getCognosViewer();
_10ae.loadExtra();
var _10af=_10ae.getSelectionController();
var _10b0=_10af.getAllSelectedObjects();
if(_10b0.length>0){
var _10b1=null;
if(typeof MDSRV_CognosConfiguration!="undefined"){
_10b1=new MDSRV_CognosConfiguration();
var _10b2="";
if(_10ae.envParams["glossaryURI"]){
_10b2=_10ae.envParams["glossaryURI"];
}
_10b1.addProperty("glossaryURI",_10b2);
_10b1.addProperty("gatewayURI",_10ae.getGateway());
}
var _10b3=_10ae.envParams["ui.object"];
var _10b4=getViewerSelectionContext(_10af,new CSelectionContext(_10b3));
var _10b5=new MDSRV_BusinessGlossary(_10b1,_10b4);
_10b5.open();
}
};
GlossaryAction.prototype.updateMenu=function(_10b6){
if(!this.getCognosViewer().bCanUseGlossary){
return "";
}
var _10b7=this.selectionHasContext();
if(!_10b7||this.getCognosViewer().envParams["glossaryURI"]==null||this.getCognosViewer().envParams["glossaryURI"]==""){
_10b6.disabled=true;
}else{
_10b6.disabled=false;
}
return _10b6;
};
function AuthoredDrillAction(){
this.m_drillTargetSpecification="";
};
AuthoredDrillAction.prototype=new CognosViewerAction();
AuthoredDrillAction.prototype.setRequestParms=function(_10b8){
this.m_drillTargetSpecification=_10b8;
};
AuthoredDrillAction.prototype.executeDrillTarget=function(_10b9){
var _10ba=XMLHelper_GetFirstChildElement(XMLBuilderLoadXMLFromString(_10b9));
var _10bb=encodeURIComponent(_10ba.getAttribute("bookmarkRef"));
var _10bc=_10ba.getAttribute("path");
var _10bd=this._shouldShowInNewWindow(_10ba);
var oCV=this.getCognosViewer();
if((_10bb!==null&&_10bb!=="")&&(_10bc===null||_10bc==="")){
var _10bf=_10ba.getAttribute("bookmarkPage");
if(_10bf&&_10bf!==""){
oCV.executeAction("GotoPage",{"pageNumber":_10bf,"anchorName":_10bb});
}else{
document.location="#"+_10bb;
}
}else{
var _10c0="";
if(_10bd){
_10c0="_blank";
}
var _10c1=[];
var _10c2=[];
_10c2.push("obj");
_10c2.push(_10bc);
_10c1[_10c1.length]=_10c2;
var _10c3=false;
var _10c4,_10c5,_10c6,sName,sNil;
var _10c9=XMLHelper_FindChildrenByTagName(_10ba,"drillParameter",false);
for(var index=0;index<_10c9.length;++index){
_10c4=[];
_10c5=_10c9[index];
_10c6=_10c5.getAttribute("value");
sName=_10c5.getAttribute("name");
if(_10c6!==null&&_10c6!==""){
_10c4.push("p_"+sName);
_10c4.push(this.buildSelectionChoicesSpecification(_10c5));
}
sNil=_10c5.getAttribute("nil");
if(sNil!==null&&sNil!==""){
_10c4.push("p_"+sName);
_10c4.push(this.buildSelectionChoicesNilSpecification());
}
if(_10c4.length>0){
_10c1[_10c1.length]=_10c4;
}
if(!_10c3){
var _10cb=_10c5.getAttribute("propertyToPass");
_10c3=(_10cb&&_10cb.length>0)?true:false;
}
}
var _10cc=_10ba.getAttribute("method");
var _10cd=_10ba.getAttribute("outputFormat");
var _10ce=_10ba.getAttribute("outputLocale");
var _10cf=_10ba.getAttribute("prompt");
var _10d0=_10ba.getAttribute("dynamicDrill");
var _10d1=this.getXMLNodeAsString(_10ba,"parameters");
var _10d2=this.getXMLNodeAsString(_10ba,"objectPaths");
var oCVId=oCV.getId();
var _10d4=document.forms["formWarpRequest"+oCVId];
var _10d5=oCV.getAdvancedServerProperty("VIEWER_JS_CALL_FORWARD_DRILLTHROUGH_TO_SELF");
if((!_10d5||_10d5.toLowerCase()!=="false")&&_10cf!="true"&&this.isSameReport(_10d4,_10bc)&&this.isSameReportFormat(_10cd)&&!_10bd&&!_10c3){
var _10d6=new ViewerDispatcherEntry(oCV);
_10d6.addFormField("ui.action","forward");
if(oCV!==null&&typeof oCV.rvMainWnd!="undefined"){
oCV.rvMainWnd.addCurrentReportToReportHistory();
var _10d7=oCV.rvMainWnd.saveReportHistoryAsXML();
_10d6.addFormField("cv.previousReports",_10d7);
}
for(index=0;index<_10c9.length;++index){
_10c4=[];
_10c5=_10c9[index];
_10c6=_10c5.getAttribute("value");
sName=_10c5.getAttribute("name");
sNil=_10c5.getAttribute("nil");
if((sNil===null||sNil==="")&&(_10c6===null||_10c6==="")){
_10c4.push("p_"+sName);
_10c4.push(this.buildSelectionChoicesNilSpecification());
}
if(_10c4.length>0){
_10c1[_10c1.length]=_10c4;
}
}
for(index=1;index<_10c1.length;index++){
_10d6.addFormField(_10c1[index][0],_10c1[index][1]);
}
_10d6.addFormField("_drillThroughToSelf","true");
if(oCV.m_tabsPayload&&oCV.m_tabsPayload.tabs){
_10d6.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",oCV.m_tabsPayload.tabs[0].id);
}
oCV.setUsePageRequest(true);
oCV.dispatchRequest(_10d6);
if(typeof oCV.m_viewerFragment=="undefined"){
var _10d8=getCognosViewerObjectRefAsString(oCVId);
setTimeout(_10d8+".getRequestIndicator().show()",10);
}
}else{
doSingleDrill(_10c0,_10c1,_10cc,_10cd,_10ce,_10bb,_10d1,_10d2,this.getCognosViewer().getId(),_10cf,_10d0);
}
}
};
AuthoredDrillAction.prototype._shouldShowInNewWindow=function(_10d9){
return _10d9.getAttribute("showInNewWindow")=="true";
};
AuthoredDrillAction.prototype.isSameReport=function(_10da,_10db){
if(_10da["ui.object"]&&_10db==_10da["ui.object"].value){
return true;
}
return false;
};
AuthoredDrillAction.prototype.isSameReportFormat=function(_10dc){
var _10dd=this.getCognosViewer().envParams["run.outputFormat"];
if(_10dd){
if(_10dc==_10dd){
return true;
}else{
if(_10dd=="HTML"&&_10dc=="HTMLFragment"){
return true;
}
}
}
return false;
};
AuthoredDrillAction.prototype.getXMLNodeAsString=function(_10de,_10df){
var sXML="";
if(_10de!=null){
var node=XMLHelper_FindChildByTagName(_10de,_10df,false);
if(node!=null){
sXML=XMLBuilderSerializeNode(node);
}
}
return sXML;
};
AuthoredDrillAction.prototype.execute=function(_10e2){
if(this.m_drillTargetSpecification!=""){
this.executeDrillTarget(this.m_drillTargetSpecification);
}else{
if(typeof _10e2!="undefined"){
var _10e3=this.getCognosViewer().getDrillTargets();
var _10e4=this.getAuthoredDrillThroughContext(_10e2,_10e3);
var _10e5=_10e4.childNodes;
if(_10e5.length==1){
this.executeDrillTarget(XMLBuilderSerializeNode(_10e5[0]));
}else{
doMultipleDrills(XMLBuilderSerializeNode(_10e4),this.getCognosViewer().getId());
}
}
}
};
AuthoredDrillAction.prototype.showDrillTargets=function(_10e6){
var _10e7="<context>";
for(var index=0;index<_10e6.length;++index){
var _10e9=_10e6[index];
_10e7+="<member>";
var sName=_10e9.getAttribute("label");
_10e7+="<name>";
_10e7+=sXmlEncode(sName);
_10e7+="</name>";
var _10eb=_10e9.getAttribute("path");
_10e7+="<drillThroughSearchPath>";
_10e7+=sXmlEncode(_10eb);
_10e7+="</drillThroughSearchPath>";
var _10ec=_10e9.getAttribute("method");
_10e7+="<drillThroughAction>";
_10e7+=sXmlEncode(_10ec);
_10e7+="</drillThroughAction>";
var _10ed=_10e9.getAttribute("outputFormat");
_10e7+="<drillThroughFormat>";
_10e7+=sXmlEncode(_10ed);
_10e7+="</drillThroughFormat>";
var sData="parent."+this.getTargetReportRequestString(_10e9);
_10e7+="<data>";
_10e7+=sXmlEncode(sData);
_10e7+="</data>";
_10e7+="</member>";
}
_10e7+="</context>";
};
AuthoredDrillAction.prototype.populateContextMenu=function(_10ef){
var _10f0=this.getCognosViewer();
var _10f1=_10f0.rvMainWnd.getToolbarControl();
var _10f2=null;
if(typeof _10f1!="undefined"&&_10f1!=null){
var _10f3=_10f1.getItem("goto");
if(_10f3){
_10f2=_10f3.getMenu();
}
}
var _10f4=_10f0.rvMainWnd.getContextMenu();
var _10f5=null;
if(typeof _10f4!="undefined"&&_10f4!=null){
_10f5=_10f4.getGoToMenuItem().getMenu();
}
if(_10f2!=null||_10f5!=null){
var _10f6=this.getCognosViewer().getDrillTargets();
var _10f7=this.getAuthoredDrillThroughContext(_10ef,_10f6);
var _10f8=_10f7.childNodes;
if(_10f8.length>0){
for(var index=0;index<_10f8.length;++index){
var _10fa=_10f8[index];
var _10fb=getCognosViewerObjectRefAsString(this.getCognosViewer().getId())+".m_oDrillMgr.executeAuthoredDrill(\""+encodeURIComponent(XMLBuilderSerializeNode(_10fa))+"\");";
var _10fc=this.getTargetReportIconPath(_10fa);
var _10fd=_10fa.getAttribute("label");
if(isViewerBidiEnabled()){
var bidi=BidiUtils.getInstance();
_10fd=bidi.btdInjectUCCIntoStr(_10fd,getViewerBaseTextDirection());
}
if(_10f2!=null){
new CMenuItem(_10f2,_10fd,_10fb,_10fc,gMenuItemStyle,_10f0.getWebContentRoot(),_10f0.getSkin());
}
if(_10f5!=null){
new CMenuItem(_10f5,_10fd,_10fb,_10fc,gMenuItemStyle,_10f0.getWebContentRoot(),_10f0.getSkin());
}
}
}
}
};
AuthoredDrillAction.prototype.buildSelectionChoicesNilSpecification=function(){
return "<selectChoices/>";
};
AuthoredDrillAction.prototype.buildSelectionChoicesSpecification=function(_10ff){
var _1100="";
var _1101=_10ff.getAttribute("value");
if(_1101!=null){
var _1102=_10ff.getAttribute("propertyToPass");
_1100+="<selectChoices";
if(_1102!=null&&_1102!=""){
_1100+=" propertyToPass=\"";
_1100+=sXmlEncode(_1102);
_1100+="\"";
}
_1100+=">";
if(_1101.indexOf("<selectChoices>")!=-1){
_1100+=_1101.substring(_1101.indexOf("<selectChoices>")+15);
}else{
if(_1101!=""){
_1100+="<selectOption ";
var sMun=_10ff.getAttribute("mun");
if(sMun!=null&&sMun!=""){
var _1104=sXmlEncode(sMun);
_1100+="useValue=\"";
_1100+=_1104;
_1100+="\" ";
_1100+="mun=\"";
_1100+=_1104;
_1100+="\" ";
_1100+="displayValue=\"";
_1100+=sXmlEncode(_1101);
_1100+="\"";
}else{
_1100+="useValue=\"";
_1100+=sXmlEncode(_1101);
_1100+="\" ";
var _1105=_10ff.getAttribute("displayValue");
if(_1105==null||_1105==""){
_1105=_1101;
}
_1100+="displayValue=\"";
_1100+=sXmlEncode(_1105);
_1100+="\"";
}
_1100+="/>";
_1100+="</selectChoices>";
}
}
}
return _1100;
};
AuthoredDrillAction.prototype.getPropertyToPass=function(_1106,_1107){
if(_1106!=null&&_1106!=""&&_1107!=null){
var _1108=_1107.childNodes;
if(_1108!=null){
for(var index=0;index<_1108.length;++index){
var _110a=_1108[index];
var sName="";
if(_110a.getAttribute("name")!=null){
sName=_110a.getAttribute("name");
}
if(sName==_1106){
return _110a.getAttribute("propertyToPass");
}
}
}
}
return "";
};
AuthoredDrillAction.prototype.getTargetReportRequestString=function(_110c){
var _110d="";
var _110e=_110c.getAttribute("bookmarkRef");
var _110f=_110c.getAttribute("path");
var _1110=_110c.getAttribute("showInNewWindow");
if((_110e!=null&&_110e!="")&&(_110f==null||_110f=="")){
_110d+="document.location=\"#";
_110d+=_110e;
_110d+="\";";
}else{
_110d+="doSingleDrill(";
if(_1110=="true"){
_110d+="\"_blank\",";
}else{
_110d+="\"\",";
}
_110d+="[[\"obj\",\"";
_110d+=encodeURIComponent(_110f);
_110d+="\"]";
var _1111=XMLHelper_FindChildrenByTagName(_110c,"drillParameter",false);
for(var index=0;index<_1111.length;++index){
var _1113=_1111[index];
var _1114=_1113.getAttribute("value");
var sName=_1113.getAttribute("name");
if(_1114!=null&&_1114!=""){
_110d+=", [\"p_"+sName+"\",\""+encodeURIComponent(this.buildSelectionChoicesSpecification(_1113))+"\"]";
}
var sNil=_1113.getAttribute("nil");
if(sNil!=null&&sNil!=""){
_110d+="\", [\"p_"+sName+"\",\""+encodeURIComponent(this.buildSelectionChoicesNilSpecification())+"\"]";
}
}
_110d+="],";
var _1117=_110c.getAttribute("method");
_110d+="\""+encodeURIComponent(_1117)+"\",";
var _1118=_110c.getAttribute("outputFormat");
_110d+="\""+encodeURIComponent(_1118)+"\",";
var _1119=_110c.getAttribute("outputLocale");
_110d+="\""+encodeURIComponent(_1119)+"\",";
_110d+="\""+encodeURIComponent(_110e)+"\",";
var _111a=XMLBuilderSerializeNode(XMLHelper_FindChildByTagName(_110c,"parameters",false));
_110d+="\""+encodeURIComponent(_111a)+"\",";
var _111b=XMLBuilderSerializeNode(XMLHelper_FindChildByTagName(_110c,"objectPaths",false));
_110d+="\""+encodeURIComponent(_111b)+"\",";
_110d+="\""+encodeURIComponent(this.getCognosViewer().getId())+"\",";
var _111c=_110c.getAttribute("prompt");
_110d+="\""+encodeURIComponent(_111c)+"\",";
var _111d=_110c.getAttribute("dynamicDrill");
_110d+=" "+encodeURIComponent(_111d);
_110d+=");";
}
return _110d;
};
AuthoredDrillAction.prototype.getTargetReportIconPath=function(_111e){
var _111f="";
var _1120=_111e.getAttribute("bookmarkRef");
var _1121=XMLHelper_FindChildByTagName(_111e,"drillParameter",false);
if((_1120!=null&&_1120!="")&&_1121==null){
_111f="/common/images/spacer.gif";
}else{
var _1122=_111e.getAttribute("method");
switch(_1122){
case "editAnalysis":
_111f="/ps/portal/images/icon_ps_analysis.gif";
break;
case "editQuery":
_111f="/ps/portal/images/icon_qs_query.gif";
break;
case "execute":
_111f="/ps/portal/images/action_run.gif";
break;
case "view":
var _1123=_111e.getAttribute("outputFormat");
switch(_1123){
case "HTML":
case "XHTML":
case "HTMLFragment":
_111f="/ps/portal/images/icon_result_html.gif";
break;
case "PDF":
_111f="/ps/portal/images/icon_result_pdf.gif";
break;
case "XML":
_111f="/ps/portal/images/icon_result_xml.gif";
break;
case "CSV":
_111f="/ps/portal/images/icon_result_csv.gif";
break;
case "XLS":
_111f="/ps/portal/images/icon_result_excel.gif";
break;
case "SingleXLS":
_111f="/ps/portal/images/icon_result_excel_single.gif";
break;
case "XLWA":
_111f="/ps/portal/images/icon_result_excel_web_arch.gif";
break;
default:
_111f="/common/images/spacer.gif";
}
break;
default:
_111f="/common/images/spacer.gif";
}
}
return this.getCognosViewer().getWebContentRoot()+_111f;
};
AuthoredDrillAction.prototype.getAuthoredDrillThroughContext=function(_1124,_1125){
if(typeof _1124!="string"||typeof _1125!="object"){
return null;
}
var _1126=XMLBuilderLoadXMLFromString(_1124);
if(_1126==null||_1126.firstChild==null){
return null;
}
var _1127=XMLHelper_GetFirstChildElement(_1126);
if(XMLHelper_GetLocalName(_1127)!="AuthoredDrillTargets"){
return null;
}
var _1128=XMLHelper_GetFirstChildElement(_1127);
if(XMLHelper_GetLocalName(_1128)!="rvDrillTargets"){
return null;
}
var _1129=_1128.childNodes;
if(_1129===null||_1129.length===0){
return null;
}
var _112a=self.XMLBuilderCreateXMLDocument("rvDrillTargets");
for(var _112b=0;_112b<_1129.length;++_112b){
if(typeof _1129[_112b].getAttribute=="undefined"){
continue;
}
var _112c=_112a.createElement("drillTarget");
_112a.documentElement.appendChild(_112c);
var _112d=_1129[_112b].getAttribute("bookmarkRef");
if(_112d===null){
_112c.setAttribute("bookmarkRef","");
}else{
_112c.setAttribute("bookmarkRef",_112d);
}
var _112e=_1129[_112b].getAttribute("bookmarkPage");
if(_112e===null){
_112c.setAttribute("bookmarkPage","");
}else{
_112c.setAttribute("bookmarkPage",_112e);
}
var _112f=_1129[_112b].getAttribute("drillIdx");
if(_112f==null){
continue;
}
if(_112f>=_1125.length){
continue;
}
var _1130=_1125[_112f];
if(typeof _1130!="object"){
continue;
}
_112c.setAttribute("outputFormat",_1130.getOutputFormat());
_112c.setAttribute("outputLocale",_1130.getOutputLocale());
_112c.setAttribute("prompt",_1130.getPrompt());
_112c.setAttribute("dynamicDrill",_1130.isDynamicDrillThrough()?"true":"false");
var _1131=_1129[_112b].getAttribute("label");
if(_1131===null||_1131===""){
_1131=_1130.getLabel();
}
_112c.setAttribute("label",_1131);
_112c.setAttribute("path",_1130.getPath());
_112c.setAttribute("showInNewWindow",_1130.getShowInNewWindow());
_112c.setAttribute("method",_1130.getMethod());
var _1132=_1128;
var _1133="";
var _1134=_1130.getParameterProperties();
if(typeof _1134!="undefined"&&_1134!=null&&_1134!=""){
_1133=XMLHelper_GetFirstChildElement(XMLBuilderLoadXMLFromString(_1130.getParameterProperties()));
}
while(_1132){
var _1135=_1132.childNodes[_112b].childNodes;
for(var _1136=0;_1136<_1135.length;++_1136){
var _1137=_1135[_1136].cloneNode(true);
if(_1133){
var _1138=this.getPropertyToPass(_1137.getAttribute("name"),_1133);
if(_1138!=null&&_1138!=""){
_1137.setAttribute("propertyToPass",_1138);
}
}
_112c.appendChild(_1137);
}
_1132=_1132.nextSibling;
}
var _1139="<root xmlns:bus=\"http://developer.cognos.com/schemas/bibus/3/\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">";
var _113a="</root>";
var _113b=_1139+_1130.getParameters()+_113a;
var _113c=XMLBuilderLoadXMLFromString(_113b);
var _113d=XMLHelper_GetFirstChildElement(XMLHelper_GetFirstChildElement(_113c));
if(_113d){
_112c.appendChild(_113d.cloneNode(true));
}
var _113e=_1139+_1130.getObjectPaths()+_113a;
var _113f=XMLBuilderLoadXMLFromString(_113e);
_113d=XMLHelper_GetFirstChildElement(XMLHelper_GetFirstChildElement(_113f));
if(_113d){
_112c.appendChild(_113d.cloneNode(true));
}
}
return XMLHelper_GetFirstChildElement(_112a);
};
function DrillContextMenuHelper(){
};
DrillContextMenuHelper.updateDrillMenuItems=function(_1140,oCV,_1142){
var _1143=[];
if(DrillContextMenuHelper.needsDrillSubMenu(oCV)){
var _1144=oCV.getSelectionController();
var _1145=_1144.getAllSelectedObjects();
var _1146=_1145[0];
if(_1146.getUseValues().length>1&&typeof RV_RES!="undefined"){
var _1147={name:_1142,label:RV_RES.RV_DRILL_DEFAULT,action:{name:_1142,payload:{}}};
_1143.push(_1147);
}
var _1148=(_1146.getUseValues().length>1)?1:0;
var _1149=_1146.getUseValues().length-1;
_1149=(_1149>2)?2:_1149;
for(var iDim=_1148;iDim<=_1149;++iDim){
DrillContextMenuHelper.addSubMenuItem(_1142,_1143,_1146,iDim,0);
}
var _114b=false;
for(var iDim=_1148;iDim<=_1149;++iDim){
for(var _114c=1;_114c<_1146.getUseValues()[iDim].length;++_114c){
if(_114b==false){
_1143.push({separator:true});
_114b=true;
}
DrillContextMenuHelper.addSubMenuItem(_1142,_1143,_1146,iDim,_114c);
}
}
}
DrillContextMenuHelper.completeDrillMenu(_1142,_1143,_1140);
};
DrillContextMenuHelper.needsDrillSubMenu=function(oCV){
var _114e=(oCV&&oCV.getSelectionController());
if(_114e){
var _114f=_114e.getAllSelectedObjects();
if(_114f.length==1&&_114f[0].isHomeCell&&_114f[0].isHomeCell()==false){
var _1150=_114f[0].isSelectionOnVizChart();
if(!_1150){
var _1151=oCV.getAdvancedServerProperty("VIEWER_JS_ENABLE_DRILL_SUBMENU");
_1150=(_1151=="charts"&&_114e.hasSelectedChartNodes());
}
if(_1150){
var _1152=_114f[0];
return (_1150&&_1152.getUseValues()&&(_1152.getUseValues().length>1||_1152.getUseValues()[0].length>1));
}
}
}
return false;
};
DrillContextMenuHelper.addSubMenuItem=function(_1153,_1154,_1155,iDim,_1157){
var _1158=_1155.getDrillOptions()[iDim][_1157];
if(DrillContextMenuHelper.isOptionDrillable(_1153,_1158)){
var _1159=DrillContextMenuHelper.getItemValue(_1155,iDim,_1157);
if(_1159){
var _115a=_1155.getDataItems()[iDim][_1157];
var _115b={name:_1153,label:_1159,action:{name:_1153,payload:{userSelectedDrillItem:_115a}}};
_1154.push(_115b);
}
}
};
DrillContextMenuHelper.completeDrillMenu=function(_115c,_115d,_115e){
if(_115d.length>0){
_115e.items=_115d;
}else{
_115e.items=null;
if(_115e.action==null){
_115e.action={name:_115c,action:{name:_115c}};
}
}
};
DrillContextMenuHelper.isOptionDrillable=function(_115f,_1160){
return (_1160>=3||(_115f=="DrillDown"&&_1160==2)||(_115f=="DrillUp"&&_1160==1));
};
DrillContextMenuHelper.getItemValue=function(_1161,iDim,_1163){
var _1164=(_1163==0)?_1161.getDisplayValues()[iDim]:null;
return ((_1164)?_1164:_1161.getUseValues()[iDim][_1163]);
};
function DrillAction(){
};
DrillAction.prototype=new CognosViewerAction();
DrillAction.prototype.setRequestParms=function(parms){
if(parms&&parms.userSelectedDrillItem){
this.m_userSelectedDrillItem=parms.userSelectedDrillItem;
}
};
DrillAction.prototype.submitDrillRequest=function(_1166,_1167,_1168){
var oCV=this.getCognosViewer();
var oReq=new ViewerDispatcherEntry(oCV);
oReq.addFormField("ui.action","drill");
oReq.addFormField("rv_drillOption",_1167);
oReq.addFormField("rv_drillparams",_1166);
oReq.addFormField("rv_drillRefQuery",_1168);
oCV.dispatchRequest(oReq);
};
function DrillDownAction(){
this.m_sAction="DrillDown";
};
DrillDownAction.prototype=new DrillAction();
DrillDownAction.prototype.updateMenu=function(_116b){
return _116b;
};
DrillDownAction.prototype.execute=function(){
var oCV=this.getCognosViewer();
var _116d=oCV.getDrillMgr();
if(_116d.canDrillDown()==false){
return;
}
var _116e=_116d.rvBuildXMLDrillParameters("drillDown",this.m_userSelectedDrillItem);
var _116f=_116d.getRefQuery();
if(oCV.envParams["cv.id"]=="AA"){
oCV.m_viewerFragment.raiseAADrillDownEvent();
}
this.submitDrillRequest(_116e,"down",_116f);
};
function DrillUpAction(){
this.m_sAction="DrillUp";
};
DrillUpAction.prototype=new DrillAction();
DrillUpAction.prototype.updateMenu=function(_1170){
return _1170;
};
DrillUpAction.prototype.execute=function(){
var oCV=this.getCognosViewer();
var _1172=oCV.getDrillMgr();
if(_1172.canDrillUp()==false){
return;
}
var _1173=_1172.rvBuildXMLDrillParameters("drillUp",this.m_userSelectedDrillItem);
var _1174=_1172.getRefQuery();
if(oCV.envParams["cv.containerApp"]=="AA"){
oCV.m_viewerFragment.raiseAADrillUpEvent();
}
this.submitDrillRequest(_1173,"up",_1174);
};
function ResizeChartAction(){
this.m_width=0;
this.m_height=0;
this.m_actionContext=null;
};
ResizeChartAction.prototype=new CognosViewerAction();
ResizeChartAction.prototype.setRequestParms=function(_1175){
if(_1175&&_1175.resize){
this.m_width=_1175.resize.w;
this.m_height=_1175.resize.h;
this.m_actionContext=_1175.resize.actionContext;
}
};
ResizeChartAction.prototype.execute=function(){
var oCV=this.getCognosViewer();
var oReq=new ViewerDispatcherEntry(oCV);
oReq.addFormField("ui.action","modifyReport");
if(!this.m_actionContext){
this.m_actionContext="<reportActions><ChangeDataContainerSize><idSelectAll/><height>"+this.m_height+"</height><width>"+this.m_width+"</width></ChangeDataContainerSize></reportActions>";
}
oReq.addFormField("cv.actionContext",this.m_actionContext);
oReq.addFormField("keepIterators","true");
oReq.addFormField("cv.reuseConversation","true");
oReq.addFormField("reuseResults","true");
oReq.addDefinedFormField("ui.spec",oCV.envParams["ui.spec"]);
oReq.addDefinedFormField("modelPath",oCV.getModelPath());
oReq.addDefinedFormField("packageBase",oCV.envParams["packageBase"]);
oReq.setCanBeQueued(true);
oCV.dispatchRequest(oReq);
};
function CCognosViewerSaveReport(_1178,_1179){
this.m_cognosViewer=_1178;
this.m_params=null;
this.dashboardToSaveIn=_1179.cm$storeID;
this.m_doSaveAsOnFault=false;
};
CCognosViewerSaveReport.prototype.canSave=function(_117a){
return (this.doSaveAs()||_117a&&_117a.indexOf("write")!==-1);
};
CCognosViewerSaveReport.prototype.isSavedOutput=function(){
var _117b=this.m_cognosViewer.envParams["ui.action"];
return (typeof _117b!=="undefined"&&_117b==="view");
};
CCognosViewerSaveReport.prototype.doSaveAs=function(){
var _117c=(this.m_doSaveAsOnFault||!this.m_cognosViewer.envParams["savedReportName"]||!this.isSameDashboard());
return _117c;
};
CCognosViewerSaveReport.prototype.isSameDashboard=function(){
var _117d=(this.m_cognosViewer.envParams["ui.object"].indexOf(this.dashboardToSaveIn)!==-1);
return _117d;
};
CCognosViewerSaveReport.prototype.getUIAction=function(){
return (this.doSaveAs()?"saveInDashboard":"updateSavedReport");
};
CCognosViewerSaveReport.prototype.populateRequestParams=function(_117e){
_117e.addFormField("ui.action",this.getUIAction());
_117e.addFormField("cv.ignoreState","true");
_117e.addFormField("dashboard-id",this.dashboardToSaveIn);
_117e.addNonEmptyStringFormField("executionParameters",this.m_cognosViewer.m_sParameters);
for(var param in this.m_cognosViewer.envParams){
if(param.indexOf("frag-")==0||param=="cv.actionState"||param=="ui.primaryAction"||param=="dashboard"||param=="ui.action"||param=="cv.responseFormat"||param=="b_action"){
continue;
}
_117e.addFormField(param,this.m_cognosViewer.envParams[param]);
}
};
CCognosViewerSaveReport.prototype.getCognosViewer=function(){
return this.m_cognosViewer;
};
CCognosViewerSaveReport.prototype.getViewerWidget=function(){
return this.getCognosViewer().getViewerWidget();
};
CCognosViewerSaveReport.prototype.dispatchRequest=function(){
var _1180=this.m_cognosViewer;
var _1181=this.getViewerWidget();
var _1182={"complete":{"object":_1181,"method":_1181.handleWidgetSaveDone},"fault":{"object":this,"method":this.onFault}};
var _1183=new AsynchJSONDispatcherEntry(_1180);
_1183.setCallbacks(_1182);
this.populateRequestParams(_1183);
_1180.dispatchRequest(_1183);
};
CCognosViewerSaveReport.prototype.onFault=function(_1184,arg1){
var _1186=this.m_cognosViewer;
var _1187=this.getViewerWidget();
var _1188=_1184.getSoapFault();
var _1189=XMLHelper_FindChildByTagName(_1188,"Fault",true);
if(this.ifIsEmptySelectionFault(_1189)){
this.handleEmptySelectionFault();
return;
}
var _118a=_1188.createElement("allowRetry");
_118a.appendChild(_1188.createTextNode("false"));
_1189.appendChild(_118a);
var _118b=XMLBuilderSerializeNode(_1189);
_1186.setSoapFault(_118b);
_1187.handleFault();
var _118c={"status":false};
_1187.iContext.iEvents.fireEvent("com.ibm.bux.widget.save.done",null,_118c);
};
CCognosViewerSaveReport.prototype.ifIsEmptySelectionFault=function(_118d){
if(_118d){
var _118e=XMLHelper_FindChildByTagName(_118d,"errorCode",true);
if(_118e){
var _118f=XMLHelper_GetText(_118e,false);
return (_118f==="cmEmptySelection");
}
}
return false;
};
CCognosViewerSaveReport.prototype.handleEmptySelectionFault=function(){
delete (this.m_cognosViewer.envParams["savedReportName"]);
this.m_doSaveAsOnFault=true;
this.dispatchRequest();
};
function XmlHttpObject(){
this.m_formFields=new CDictionary();
this.xmlHttp=XmlHttpObject.createRequestObject();
this.m_requestIndicator=null;
this.m_httpCallbacks={};
this.m_asynch=true;
this.m_headers=null;
};
XmlHttpObject.prototype.setHeaders=function(_1190){
this.m_headers=_1190;
};
XmlHttpObject.prototype.getHeaders=function(){
return this.m_headers;
};
XmlHttpObject.prototype.newRequest=function(){
var _1191=new XmlHttpObject();
_1191.init(this.m_action,this.m_gateway,this.m_url,this.m_asynch);
this.executeHttpCallback("newRequest");
return _1191;
};
XmlHttpObject.prototype.abortHttpRequest=function(){
if(this.xmlHttp!=null){
this.xmlHttp.abort();
this.xmlHttp=null;
this.executeHttpCallback("cancel");
this.m_httpCallbacks={};
}
};
XmlHttpObject.prototype.cancel=function(){
this.abortHttpRequest();
};
XmlHttpObject.prototype.executeHttpCallback=function(_1192){
if(this.m_httpCallbacks&&this.m_httpCallbacks[_1192]){
var _1193=this.concatResponseArguments(this.m_httpCallbacks.customArguments);
var _1194=GUtil.generateCallback(this.m_httpCallbacks[_1192].method,_1193,this.m_httpCallbacks[_1192].object);
_1194();
return true;
}
return false;
};
XmlHttpObject.prototype.setCallbacks=function(_1195){
if(!this.m_httpCallbacks){
this.m_httpCallbacks={};
}
for(callback in _1195){
this.m_httpCallbacks[callback]=_1195[callback];
}
};
XmlHttpObject.prototype.getCallbacks=function(){
return this.m_httpCallbacks;
};
XmlHttpObject.createRequestObject=function(){
var _1196=null;
if(window.XMLHttpRequest){
_1196=new XMLHttpRequest();
}else{
if(window.ActiveXObject){
_1196=new ActiveXObject("Msxml2.XMLHTTP");
}else{
}
}
return _1196;
};
XmlHttpObject.prototype.waitForXmlHttpResponse=function(){
var _1197=this.xmlHttp;
if(_1197&&_1197.readyState===4){
if(_1197.status===200){
this.httpSuccess();
}else{
this.httpError();
}
}else{
}
};
XmlHttpObject.prototype.init=function(_1198,_1199,url,_119b){
this.m_action=_1198;
this.m_gateway=_1199;
this.m_url=url;
this.m_asynch=_119b;
};
XmlHttpObject.prototype.httpSuccess=function(){
this.executeHttpCallback("postHttpRequest");
this.executeHttpCallback("entryComplete");
this.executeHttpCallback("complete");
this.m_httpCallbacks=null;
};
XmlHttpObject.prototype.httpError=function(){
this.executeHttpCallback("entryFault");
this.executeHttpCallback("fault");
this.m_httpCallbacks=null;
};
XmlHttpObject.prototype.forceSynchronous=function(){
this.m_asynch=false;
};
XmlHttpObject.prototype.sendRequest=function(){
this.sendHtmlRequest(this.m_action,this.m_gateway,this.m_url,this.m_asynch);
};
XmlHttpObject.prototype.sendHtmlRequest=function(_119c,_119d,url,async){
var _11a0=this.xmlHttp;
if(_11a0){
_11a0.open(_119c,_119d,async);
if(async){
_11a0.onreadystatechange=GUtil.generateCallback(this.waitForXmlHttpResponse,[],this);
}else{
_11a0.onreadystatechange=GUtil.generateCallback(this.waitForXmlHttpResponse,[],this);
if(!isIE()){
_11a0.onload=GUtil.generateCallback(this.httpSuccess,[],this);
_11a0.onerror=GUtil.generateCallback(this.httpError,[],this);
}
}
_11a0.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
if(this.m_headers){
for(header in this.m_headers){
_11a0.setRequestHeader(header,this.m_headers[header]);
}
}
this.executeHttpCallback("preHttpRequest");
var _11a1=this.convertFormFieldsToUrl();
if(url){
_11a1+=url;
}
_11a0.send(_11a1);
}
};
XmlHttpObject.prototype.getResponseXml=function(){
return (this.xmlHttp)?this.xmlHttp.responseXML:null;
};
XmlHttpObject.prototype.getResponseText=function(){
return (this.xmlHttp)?this.xmlHttp.responseText:"";
};
XmlHttpObject.prototype.getResponseHeader=function(item){
return (this.xmlHttp)?this.xmlHttp.getResponseHeader(item):null;
};
XmlHttpObject.prototype.getStatus=function(){
return this.xmlHttp.status;
};
XmlHttpObject.prototype.addFormField=function(name,value){
this.m_formFields.add(name,value);
};
XmlHttpObject.prototype.getFormFields=function(){
return this.m_formFields;
};
XmlHttpObject.prototype.getFormField=function(_11a5){
return this.m_formFields.get(_11a5);
};
XmlHttpObject.prototype.clearFormFields=function(){
this.m_formFields=new CDictionary();
};
XmlHttpObject.prototype.convertFormFieldsToUrl=function(){
var url="";
var _11a7=this.m_formFields.keys();
for(var index=0;index<_11a7.length;index++){
if(index>0){
url+="&";
}
url+=encodeURIComponent(_11a7[index])+"="+encodeURIComponent(this.m_formFields.get(_11a7[index]));
}
return url;
};
XmlHttpObject.prototype.concatResponseArguments=function(_11a9){
var _11aa=[this];
if(_11a9){
_11aa=_11aa.concat(_11a9);
}
return _11aa;
};
function AsynchRequest(_11ab,_11ac){
AsynchRequest.baseConstructor.call(this);
this.m_gateway=_11ab;
this.m_webContentRoot=_11ac;
this.m_callbacks={};
this.m_soapFault=null;
this.m_faultDialog=null;
this.m_promptDialog=null;
this.m_logonDialog=null;
};
AsynchRequest.prototype=new XmlHttpObject();
AsynchRequest.baseConstructor=XmlHttpObject;
AsynchRequest.prototype.parent=XmlHttpObject.prototype;
AsynchRequest.prototype.getTracking=function(){
return "";
};
AsynchRequest.prototype.getConversation=function(){
return "";
};
AsynchRequest.prototype.getPrimaryAction=function(){
return "";
};
AsynchRequest.prototype.getActionState=function(){
return "";
};
AsynchRequest.prototype.getAsynchStatus=function(){
return "";
};
AsynchRequest.prototype.getResult=function(){
return null;
};
AsynchRequest.prototype.getSoapFault=function(){
return this.m_soapFault;
};
AsynchRequest.prototype.constructFaultEnvelope=function(){
return null;
};
AsynchRequest.prototype.getPromptHTMLFragment=function(){
return "";
};
AsynchRequest.prototype.isRAPWaitTrue=function(){
return false;
};
AsynchRequest.prototype.getRAPRequestCache=function(){
return null;
};
AsynchRequest.prototype.getMainConversation=function(){
return null;
};
AsynchRequest.prototype.getMainTracking=function(){
return null;
};
AsynchRequest.prototype.construct=function(){
};
AsynchRequest.prototype.executeCallback=function(_11ad){
if(this.m_callbacks[_11ad]){
var _11ae=this.concatResponseArguments(this.m_callbacks.customArguments);
var _11af=GUtil.generateCallback(this.m_callbacks[_11ad].method,_11ae,this.m_callbacks[_11ad].object);
_11af();
return true;
}
return false;
};
AsynchRequest.prototype.setCallbacks=function(_11b0){
if(!this.m_callbacks){
this.m_callbacks={};
}
for(callback in _11b0){
this.m_callbacks[callback]=_11b0[callback];
}
};
AsynchRequest.prototype.getCallbacks=function(){
return this.m_callbacks;
};
AsynchRequest.prototype.newRequest=function(){
var _11b1=this.construct();
_11b1.setHeaders(this.getHeaders());
if(this.getFormFields().exists("b_action")){
_11b1.addFormField("b_action",this.getFormField("b_action"));
}
if(this.getFormFields().exists("cv.catchLogOnFault")){
_11b1.addFormField("cv.catchLogOnFault",this.getFormField("cv.catchLogOnFault"));
}
_11b1.setPromptDialog(this.m_promptDialog);
_11b1.setFaultDialog(this.m_faultDialog);
_11b1.setLogonDialog(this.m_logonDialog);
_11b1.m_asynch=this.m_asynch;
if(this.m_callbacks.newRequest){
var _11b2=GUtil.generateCallback(this.m_callbacks.newRequest.method,[_11b1],this.m_callbacks.newRequest.object);
_11b2();
}
return _11b1;
};
AsynchRequest.prototype.success=function(){
var _11b3=this.getAsynchStatus();
switch(_11b3){
case "stillWorking":
case "working":
this.working();
break;
case "prompting":
this.prompting();
break;
case "fault":
case "complete":
case "conversationComplete":
this.complete();
break;
default:
this.complete();
break;
}
};
AsynchRequest.prototype.setFaultDialog=function(_11b4){
if(_11b4 instanceof IFaultDialog){
if(typeof console!="undefined"){
console.log("AsynchRequest.prototype.setFaultDialog is deprecated");
}
this.m_faultDialog=_11b4;
}else{
if(_11b4&&typeof console!="undefined"){
console.log("The parameter faultDialog must be an instance of IFaultDialog");
}
}
};
AsynchRequest.prototype.setPromptDialog=function(_11b5){
if(_11b5 instanceof IPromptDialog){
if(typeof console!="undefined"){
console.log("AsynchRequest.prototype.setPromptDialog is deprecated");
}
this.m_promptDialog=_11b5;
}else{
if(_11b5&&typeof console!="undefined"){
console.log("The parameter promptDialog must be an instance of IPromptDialog");
}
}
};
AsynchRequest.prototype.setLogonDialog=function(_11b6){
if(_11b6 instanceof ILogOnDialog){
if(typeof console!="undefined"){
console.log("AsynchRequest.prototype.setLogonDialog is deprecated");
}
this.m_logonDialog=_11b6;
}else{
if(_11b6&&typeof console!="undefined"){
console.log("The parameter logOnDialog must be an instance of ILogOnDialog");
}
}
};
AsynchRequest.prototype.resubmitRequest=function(){
var _11b7=this.newRequest();
_11b7.m_formFields=this.m_formFields;
_11b7.sendRequest();
return _11b7;
};
AsynchRequest.prototype.sendRequest=function(){
var _11b8=this;
var _11b9={"complete":{"object":_11b8,"method":_11b8.successHandler},"fault":{"object":_11b8,"method":_11b8.errorHandler}};
this.init("POST",this.m_gateway,"",this.m_asynch);
this.executeCallback("preHttpRequest");
this.parent.setCallbacks.call(this,_11b9);
this.parent.sendRequest.call(this);
};
AsynchRequest.prototype.errorHandler=function(){
this.executeCallback("postHttpRequest");
this.executeCallback("entryFault");
this.executeCallback("error");
};
AsynchRequest.prototype.successHandler=function(){
this.executeCallback("postHttpRequest");
if(typeof window["AsynchRequestPromptDialog"]!="undefined"&&window["AsynchRequestPromptDialog"]!=null){
window["AsynchRequestPromptDialog"].hide();
window["AsynchRequestPromptDialog"]=null;
}
if(this.getResponseHeader("Content-type").indexOf("text/html")!=-1){
var _11ba=this.getResponseText();
if(_11ba.indexOf("<ERROR_CODE>CAM_PASSPORT_ERROR</ERROR_CODE>")!=-1){
this.passportTimeout();
}else{
if((_11ba.indexOf("http-equiv=\"refresh\"")!=-1)||(_11ba.indexOf("http-equiv='refresh'")!=-1)){
this.passportTimeout();
}else{
this.executeCallback("entryFault");
if(!this.executeCallback("fault")){
var _11bb=window.open("","","height=400,width=500");
if(_11bb!=null){
_11bb.document.write(_11ba);
}
}
}
}
}else{
this.m_soapFault=this.constructFaultEnvelope();
if(this.m_soapFault!=null){
var _11bc=XMLHelper_FindChildByTagName(this.m_soapFault,"CAM",true);
if(_11bc!=null&&XMLHelper_FindChildByTagName(_11bc,"promptInfo",true)){
this.passportTimeout();
}else{
this.fault();
}
}else{
this.success();
}
}
};
AsynchRequest.prototype.cancel=function(){
this.parent.cancel.call(this);
var _11bd=this.getFormField("m_tracking");
if(_11bd){
var _11be=new XmlHttpObject();
_11be.init("POST",this.m_gateway,"",false);
if(this.getFormField("cv.outputKey")){
_11be.addFormField("b_action","cvx.high");
_11be.addFormField("cv.outputKey",this.getFormField("cv.outputKey"));
_11be.setHeaders(this.getHeaders());
}else{
_11be.addFormField("b_action","cognosViewer");
}
_11be.addFormField("cv.responseFormat","successfulRequest");
_11be.addFormField("ui.action","cancel");
_11be.addFormField("m_tracking",_11bd);
if(this.getFormField("cv.debugDirectory")){
_11be.addFormField("cv.debugDirectory",this.getFormField("cv.debugDirectory"));
}
_11be.sendRequest();
this.executeCallback("cancel");
}
};
AsynchRequest.prototype.working=function(){
this.executeCallback("working");
var _11bf=this.newRequest();
_11bf.addFormField("m_tracking",this.getTracking());
if(this.getFormField("cv.outputKey")){
_11bf.addFormField("cv.outputKey",this.getFormField("cv.outputKey"));
_11bf.addFormField("b_action","cvx.high");
}
if(this.isRAPWaitTrue()){
_11bf.m_formFields=this.m_formFields;
_11bf.addFormField("m_tracking",this.getTracking());
_11bf.addFormField("rapWait","true");
var _11c0=this.getRAPRequestCache();
if(_11c0!==null&&typeof _11c0!="undefined"){
_11bf.addFormField("rapRequestCache",_11c0);
}
var _11c1=this.getMainConversation();
if(_11c1){
_11bf.addFormField("mainConversation",_11c1);
}
var _11c2=this.getMainTracking();
if(_11c2){
_11bf.addFormField("mainTracking",_11c2);
}
}else{
_11bf.addFormField("ui.action","wait");
_11bf.addFormField("ui.primaryAction",this.getPrimaryAction());
_11bf.addFormField("cv.actionState",this.getActionState());
if(this.getFormField("ui.preserveRapTags")){
_11bf.addFormField("ui.preserveRapTags",this.getFormField("ui.preserveRapTags"));
}
if(this.getFormField("ui.backURL")){
_11bf.addFormField("ui.backURL",this.getFormField("ui.backURL"));
}
if(this.getFormField("errURL")){
_11bf.addFormField("errURL",this.getFormField("errURL"));
}
if(this.getFormField("cv.showFaultPage")){
_11bf.addFormField("cv.showFaultPage",this.getFormField("cv.showFaultPage"));
}
if(this.getFormField("cv.catchLogOnFault")){
_11bf.addFormField("cv.catchLogOnFault",this.getFormField("cv.catchLogOnFault"));
}
}
if(this.getFormField("bux")){
_11bf.addFormField("bux",this.getFormField("bux"));
}
if(this.getFormField("cv.debugDirectory")){
_11bf.addFormField("cv.debugDirectory",this.getFormField("cv.debugDirectory"));
}
_11bf.sendRequest();
};
AsynchRequest.prototype.prompting=function(){
this.executeCallback("entryComplete");
if(!this.executeCallback("prompting")){
if(this.m_promptDialog!=null){
this.showPromptPage();
}else{
if(typeof console!="undefined"){
console.log("An unhandled prompt response was returned: %o",this.xmlHttp);
}
}
}
this.executeCallback("postEntryComplete");
};
AsynchRequest.prototype.promptPageOkCallback=function(_11c3){
var _11c4=this.newRequest();
_11c4.addFormField("ui.action","forward");
_11c4.addFormField("m_tracking",this.getTracking());
_11c4.addFormField("ui.conversation",this.getConversation());
_11c4.addFormField("ui.primaryAction",this.getPrimaryAction());
_11c4.addFormField("cv.actionState",this.getActionState());
for(var _11c5 in _11c3){
_11c4.addFormField(_11c5,_11c3[_11c5]);
}
_11c4.sendRequest();
window["AsynchRequestObject"]=null;
};
AsynchRequest.prototype.promptPageCancelCallback=function(){
window["AsynchRequestPromptDialog"].hide();
this.complete();
};
AsynchRequest.prototype.showPromptPage=function(){
window["AsynchRequestObject"]=this;
window["AsynchRequestPromptDialog"]=this.m_promptDialog;
var _11c6=this.m_promptDialog.getViewerId()==null?"":"?cv.id="+this.m_promptDialog.getViewerId();
window["AsynchRequestPromptDialog"].initialize(this.m_webContentRoot+"/rv/showStandalonePrompts.html"+_11c6,400,400);
window["AsynchRequestPromptDialog"].show();
};
AsynchRequest.prototype.passportTimeout=function(){
this.executeCallback("entryFault");
if(!this.executeCallback("passportTimeout")){
if(this.m_logonDialog!=null){
this.m_logonDialog.show(response.getSoapFault());
}else{
if(typeof console!="undefined"){
console.log("An unhandled passport timeout fault was returned: %o",this.getSoapFault());
}
}
}
};
AsynchRequest.prototype.fault=function(){
this.executeCallback("entryFault");
if(!this.executeCallback("fault")){
if(this.m_faultDialog!=null){
this.m_faultDialog.show(this.getSoapFault());
}else{
if(typeof console!="undefined"){
console.log("An unhandled soap fault was returned: %o",this.getSoapFault());
}
}
}
};
AsynchRequest.prototype.complete=function(){
this.executeCallback("entryComplete");
this.executeCallback("complete");
this.executeCallback("postEntryComplete");
};
AsynchRequest.prototype.getSoapFaultCode=function(){
var _11c7=this.constructFaultEnvelope();
if(_11c7){
var _11c8=XMLHelper_FindChildByTagName(_11c7,"faultcode",true);
if(_11c8!=null){
return XMLHelper_GetText(_11c8);
}
}
return null;
};
AsynchRequest.prototype.getSoapFaultDetailMessageString=function(){
var _11c9=this.constructFaultEnvelope();
if(_11c9){
var entry=XMLHelper_FindChildByTagName(_11c9,"messageString",true);
if(entry!=null){
return XMLHelper_GetText(entry);
}
}
return null;
};
function AsynchDATARequest(_11cb,_11cc){
AsynchDATARequest.baseConstructor.call(this,_11cb,_11cc);
this.m_oResponseState=null;
this.m_sResponseState=null;
this.m_endOfStateIdx=-1;
this.cStatePrefix="<xml><state>";
this.cStateSuffix="</state></xml>";
};
AsynchDATARequest.prototype=new AsynchRequest();
AsynchDATARequest.baseConstructor=AsynchRequest;
AsynchDATARequest.prototype.getEndOfStateIdx=function(){
if(this.m_endOfStateIdx==-1){
var _11cd=this.getResponseText().substring(0,12);
if(_11cd==this.cStatePrefix){
this.m_endOfStateIdx=this.getResponseText().indexOf(this.cStateSuffix);
if(this.m_endOfStateIdx!=-1){
this.m_endOfStateIdx+=this.cStateSuffix.length;
}
}
}
return this.m_endOfStateIdx;
};
AsynchDATARequest.prototype.getResponseStateText=function(){
if(!this.m_sResponseState){
this.getResponseState();
}
return this.m_sResponseState;
};
AsynchDATARequest.prototype.getResponseState=function(){
if(this.m_oResponseState==null&&this.getEndOfStateIdx()!=-1){
this.m_sResponseState=this.getResponseText().substring(this.cStatePrefix.length,this.getEndOfStateIdx()-this.cStateSuffix.length);
if(this.m_sResponseState!=null){
this.m_sResponseState=xml_decode(this.m_sResponseState);
this.m_oResponseState=eval("("+this.m_sResponseState+")");
}
}
return this.m_oResponseState;
};
AsynchDATARequest.prototype.getAsynchStatus=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sStatus!="undefined"){
return this.getResponseState().m_sStatus;
}
return "unknown";
};
AsynchDATARequest.prototype.getTracking=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sTracking!="undefined"){
return this.getResponseState().m_sTracking;
}
return "";
};
AsynchDATARequest.prototype.getConversation=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sConversation!="undefined"){
return this.getResponseState().m_sConversation;
}
return "";
};
AsynchDATARequest.prototype.getPrimaryAction=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().envParams!="undefined"&&this.getResponseState().envParams["ui.primaryAction"]!="undefined"){
return this.getResponseState().envParams["ui.primaryAction"];
}
return "";
};
AsynchDATARequest.prototype.getActionState=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sActionState!="undefined"){
return this.getResponseState().m_sActionState;
}
return "";
};
AsynchDATARequest.prototype.getResult=function(){
if(this.getEndOfStateIdx()!=-1){
return this.getResponseText().substring(this.getEndOfStateIdx(),this.getResponseText().length);
}
return "";
};
AsynchDATARequest.prototype.getDebugLogs=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().debugLogs!="undefined"){
return this.getResponseState().debugLogs;
}
return "";
};
AsynchDATARequest.prototype.getPromptHTMLFragment=function(){
return this.getResult();
};
AsynchDATARequest.prototype.constructFaultEnvelope=function(){
if(this.m_soapFault==null){
var state=this.getResponseState();
if(state!=null){
if(state.m_sSoapFault){
var _11cf=state.m_sSoapFault;
this.m_soapFault=XMLBuilderLoadXMLFromString(_11cf);
}
}
}
return this.m_soapFault;
};
AsynchDATARequest.prototype.construct=function(){
var _11d0=new AsynchDATARequest(this.m_gateway,this.m_webContentRoot);
_11d0.setCallbacks(this.m_callbacks);
if(this.getFormFields().exists("cv.responseFormat")){
_11d0.addFormField("cv.responseFormat",this.getFormField("cv.responseFormat"));
}else{
_11d0.addFormField("cv.responseFormat","data");
}
return _11d0;
};
AsynchDATARequest.prototype.getEnvParam=function(param){
var _11d2=this.getResponseState();
if(_11d2&&typeof _11d2.envParams!="undefined"&&typeof _11d2.envParams[param]!="undefined"){
return _11d2.envParams[param];
}
return null;
};
AsynchDATARequest.prototype.isRAPWaitTrue=function(){
var _11d3=this.getEnvParam("rapWait");
if(_11d3!=null){
return _11d3=="true"?true:false;
}
return false;
};
AsynchDATARequest.prototype.getRAPRequestCache=function(){
return this.getEnvParam("rapRequestCache");
};
AsynchDATARequest.prototype.getMainConversation=function(){
return this.getEnvParam("mainConversation");
};
AsynchDATARequest.prototype.getMainTracking=function(){
return this.getEnvParam("mainTracking");
};
function AsynchJSONRequest(_11d4,_11d5){
AsynchJSONRequest.baseConstructor.call(this,_11d4,_11d5);
this.m_jsonResponse=null;
};
AsynchJSONRequest.prototype=new AsynchRequest();
AsynchJSONRequest.baseConstructor=AsynchRequest;
AsynchJSONRequest.prototype.getJSONResponseObject=function(){
if(this.m_jsonResponse==null){
if(this.getResponseHeader("Content-type").indexOf("application/json")!=-1){
var text=this.getResponseText();
if(text!=null){
var _11d7=this.removeInvalidCharacters(text);
this.m_jsonResponse=eval("("+_11d7+")");
}
}
}
return this.m_jsonResponse;
};
AsynchJSONRequest.prototype.getTracking=function(){
var _11d8=this.getJSONResponseObject();
if(_11d8){
return _11d8.tracking;
}
return "";
};
AsynchJSONRequest.prototype.getConversation=function(){
var _11d9=this.getJSONResponseObject();
if(_11d9){
return _11d9.conversation;
}
return "";
};
AsynchJSONRequest.prototype.getAsynchStatus=function(){
var _11da=this.getJSONResponseObject();
if(_11da){
return _11da.status;
}
return "unknown";
};
AsynchJSONRequest.prototype.getPrimaryAction=function(){
var _11db=this.getJSONResponseObject();
if(_11db){
return _11db.primaryAction;
}
return "";
};
AsynchJSONRequest.prototype.getActionState=function(){
var _11dc=this.getJSONResponseObject();
if(_11dc){
return _11dc.actionState;
}
return "";
};
AsynchJSONRequest.prototype.getDebugLogs=function(){
var _11dd=this.getJSONResponseObject();
if(_11dd){
return _11dd.debugLogs;
}
return "";
};
AsynchJSONRequest.prototype.isRAPWaitTrue=function(){
var _11de=this.getJSONResponseObject();
if(_11de){
return (_11de.rapWait==="true");
}
return false;
};
AsynchJSONRequest.prototype.getRAPRequestCache=function(){
var _11df=this.getJSONResponseObject();
if(_11df){
var _11e0=_11df.rapRequestCache;
if(_11e0!==null&&typeof _11e0!="undefined"){
return _11e0;
}
}
return null;
};
AsynchJSONRequest.prototype.getMainConversation=function(){
var _11e1=this.getJSONResponseObject();
if(_11e1){
return _11e1.mainConversation;
}
return null;
};
AsynchJSONRequest.prototype.getMainTracking=function(){
var _11e2=this.getJSONResponseObject();
if(_11e2){
return _11e2.mainTracking;
}
return null;
};
AsynchJSONRequest.prototype.getResult=function(){
var _11e3=this.getJSONResponseObject();
if(_11e3&&_11e3.json){
var _11e4=this.removeInvalidCharacters(_11e3.json);
return eval("("+_11e4+")");
}
return null;
};
AsynchJSONRequest.prototype.removeInvalidCharacters=function(text){
if(text){
text=text.replace(/(\n|\r|\t)+/g,"");
}
return text;
};
AsynchJSONRequest.prototype.getPromptHTMLFragment=function(){
var _11e6=this.getJSONResponseObject();
if(_11e6&&_11e6.promptHTMLFragment){
return _11e6.promptHTMLFragment;
}
return "";
};
AsynchJSONRequest.prototype.constructFaultEnvelope=function(){
if(this.m_soapFault==null){
var _11e7=this.getJSONResponseObject();
if(_11e7.status=="fault"){
this.m_soapFault=XMLBuilderLoadXMLFromString(_11e7.fault);
}
}
return this.m_soapFault;
};
AsynchJSONRequest.prototype.construct=function(){
var _11e8=new AsynchJSONRequest(this.m_gateway,this.m_webContentRoot);
_11e8.setCallbacks(this.m_callbacks);
if(this.getFormFields().exists("cv.responseFormat")){
_11e8.addFormField("cv.responseFormat",this.getFormField("cv.responseFormat"));
}else{
_11e8.addFormField("cv.responseFormat","asynchJSON");
}
return _11e8;
};
function IFaultDialog(){
};
IFaultDialog.prototype.show=function(){
if(typeof console!="undefined"){
console.log("Required method IFaultDialog:show not implemented.");
}
};
IFaultDialog.prototype.handleUnknownHTMLResponse=function(){
if(typeof console!="undefined"){
console.log("Required method IFaultDialog:handlerUnknownHTMLResponse not implemented.");
}
};
function ILogOnDialog(){
};
ILogOnDialog.prototype.show=function(_11e9){
if(typeof console!="undefined"){
console.log("Required method ILogOnDialog:show not implemented.");
}
};
ILogOnDialog.prototype.handleUnknownHTMLResponse=function(_11ea){
if(typeof console!="undefined"){
console.log("Required method ILogOnDialog:handleUnknownHTMLResponse not implemented.");
}
};
function IPromptDialog(){
};
IPromptDialog.prototype.initialize=function(url,width,_11ed){
if(typeof console!="undefined"){
console.log("Required method IModalDialog:initialize not implemented.");
}
};
IPromptDialog.prototype.show=function(){
if(typeof console!="undefined"){
console.log("Required method IModalDialog:show not implemented.");
}
};
IPromptDialog.prototype.hide=function(){
if(typeof console!="undefined"){
console.log("Required method IModalDialog:hide not implemented.");
}
};
function IRequestHandler(){
};
IRequestHandler.prototype.preHttpRequest=function(_11ee){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:preHttpRequest not implemented.");
}
};
IRequestHandler.prototype.postHttpRequest=function(_11ef){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:postHttpRequest not implemented.");
}
};
IRequestHandler.prototype.postComplete=function(_11f0){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:postComplete not implemented.");
}
};
IRequestHandler.prototype.onComplete=function(_11f1){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onComplete not implemented.");
}
};
IRequestHandler.prototype.onPostEntryComplete=function(_11f2){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onPostEntryComplete not implemented.");
}
};
IRequestHandler.prototype.onFault=function(_11f3){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onFault not implemented.");
}
};
IRequestHandler.prototype.onPrompting=function(_11f4){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onPrompting not implemented.");
}
};
IRequestHandler.prototype.onWorking=function(_11f5){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onWorking not implemented.");
}
};
IRequestHandler.prototype.setWorkingDialog=function(_11f6){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:setWorkingDialog not implemented.");
}
};
IRequestHandler.prototype.setRequestIndicator=function(_11f7){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:setExecutionCursor not implemented.");
}
};
function IRequestIndicator(){
};
IRequestIndicator.prototype.show=function(){
if(typeof console!="undefined"){
console.log("Required method IRequestIndicator:show not implemented.");
}
};
IRequestIndicator.prototype.hide=function(){
if(typeof console!="undefined"){
console.log("Required method IRequestIndicator:hide not implemented.");
}
};
function BaseRequestHandler(oCV){
if(oCV){
this.m_oCV=oCV;
this.m_workingDialog=null;
this.m_requestIndicator=null;
this.m_faultDialog=null;
this.m_logOnDialog=null;
this.m_promptDialog=null;
this.m_httpRequestConfig=this.m_oCV.getConfig()&&this.m_oCV.getConfig().getHttpRequestConfig()?this.m_oCV.getConfig().getHttpRequestConfig():null;
}
};
BaseRequestHandler.prototype=new IRequestHandler();
BaseRequestHandler.prototype.onError=function(_11f9){
};
BaseRequestHandler.prototype.onComplete=function(){
};
BaseRequestHandler.prototype.onPrompting=function(){
};
BaseRequestHandler.prototype.resubmitInSafeMode=function(){
};
BaseRequestHandler.prototype.massageHtmlBeforeDisplayed=function(){
};
BaseRequestHandler.prototype.onPostEntryComplete=function(){
this._processDelayedLoadingQueue();
};
BaseRequestHandler.prototype.getViewer=function(){
return this.m_oCV;
};
BaseRequestHandler.prototype.setDispatcherEntry=function(_11fa){
this.m_oDispatcherEntry=_11fa;
};
BaseRequestHandler.prototype.getDispatcherEntry=function(){
return this.m_oDispatcherEntry;
};
BaseRequestHandler.prototype.processInitialResponse=function(_11fb){
this.updateViewerState(_11fb);
};
BaseRequestHandler.prototype.setLogOnDialog=function(_11fc){
if(_11fc==null){
this.m_logOnDialog=null;
}else{
if(_11fc instanceof ILogOnDialog){
this.m_logOnDialog=_11fc;
}else{
if(_11fc&&typeof console!="undefined"){
console.log("The parameter logOnDialog must be an instance of ILogOnDialog");
}
}
}
};
BaseRequestHandler.prototype.setWorkingDialog=function(_11fd){
if(_11fd==null){
this.m_workingDialog=null;
}else{
if(this.m_httpRequestConfig&&this.m_httpRequestConfig.getWorkingDialog()){
this.m_workingDialog=this.m_httpRequestConfig.getWorkingDialog();
}else{
if(_11fd instanceof IRequestIndicator){
this.m_workingDialog=_11fd;
}else{
if(_11fd&&typeof console!="undefined"){
console.log("The parameter workingDialog must be an instance of IRequestIndicator");
}
}
}
}
};
BaseRequestHandler.prototype.getWorkingDialog=function(){
return this.m_workingDialog;
};
BaseRequestHandler.prototype.setRequestIndicator=function(_11fe){
if(_11fe==null){
this.m_requestIndicator=null;
}else{
if(this.m_httpRequestConfig&&this.m_httpRequestConfig.getRequestIndicator()){
this.m_requestIndicator=this.m_httpRequestConfig.getRequestIndicator();
}else{
if(_11fe instanceof IRequestIndicator){
this.m_requestIndicator=_11fe;
}else{
if(_11fe&&typeof console!="undefined"){
console.log("The parameter requestIndicator must be an instance of IRequestIndicator");
}
}
}
}
};
BaseRequestHandler.prototype.getRequestIndicator=function(){
return this.m_requestIndicator;
};
BaseRequestHandler.prototype.setFaultDialog=function(_11ff){
if(_11ff==null){
this.m_faultDialog=null;
}else{
if(_11ff instanceof IFaultDialog){
this.m_faultDialog=_11ff;
}else{
if(_11ff&&typeof console!="undefined"){
console.log("The parameter faultDialog must be an instance of IFaultDialog");
}
}
}
};
BaseRequestHandler.prototype.setPromptDialog=function(_1200){
if(_1200==null){
this.m_promptDialog=null;
}else{
if(_1200 instanceof IPromptDialog){
this.m_promptDialog=_1200;
}else{
if(_1200&&typeof console!="undefined"){
console.log("The parameter promptDialog must be an instance of IPromptDialog");
}
}
}
};
BaseRequestHandler.prototype.preHttpRequest=function(_1201){
if(_1201&&typeof _1201.getFormField=="function"){
if(_1201.getFormField("ui.action")!="wait"&&_1201.getFormField("rapWait")!="true"){
if(this.m_requestIndicator){
this.m_requestIndicator.show();
}
}
}
};
BaseRequestHandler.prototype.postHttpRequest=function(_1202){
if(_1202&&typeof _1202.getAsynchStatus=="function"){
var _1203=_1202.getAsynchStatus();
if(_1203!="working"&&_1203!="stillWorking"){
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
}
}else{
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
}
};
BaseRequestHandler.prototype.onFault=function(_1204){
var oCV=this.getViewer();
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
if(typeof FaultDialog=="undefined"){
if(typeof console!="undefined"){
console.log("An unhandled fault was returned: %o",_1204);
}
return;
}
if(!this.m_faultDialog){
this.m_faultDialog=new FaultDialog(this.getViewer());
}
if(_1204&&_1204.getResponseHeader&&_1204.getResponseHeader("Content-type").indexOf("text/html")!=-1){
this.m_faultDialog.handleUnknownHTMLResponse(_1204.getResponseText());
}else{
if(_1204&&_1204.getSoapFault){
this.m_faultDialog.show(_1204.getSoapFault());
}else{
if(oCV.getSoapFault()){
var _1206=XMLBuilderLoadXMLFromString(oCV.getSoapFault());
this.m_faultDialog.show(_1206);
oCV.setSoapFault("");
}else{
if(typeof console!="undefined"){
console.log("An unhandled fault was returned: %o",_1204);
}
}
}
}
};
BaseRequestHandler.prototype.isAuthenticationFault=function(_1207){
var oCV=this.getViewer();
var _1209=null;
if(_1207&&_1207.getSoapFault){
_1209=_1207.getSoapFault();
}else{
if(oCV.getSoapFault()){
_1209=XMLBuilderLoadXMLFromString(oCV.getSoapFault());
}
}
if(_1209!=null){
var _120a=XMLHelper_FindChildByTagName(_1209,"CAM",true);
return (_120a!=null&&XMLHelper_FindChildByTagName(_120a,"promptInfo",true)!=null);
}
return false;
};
BaseRequestHandler.prototype.onPassportTimeout=function(_120b){
var oCV=this.getViewer();
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
if(!this.m_logOnDialog){
this.m_logOnDialog=new LogOnDialog(this.getViewer());
}
if(_120b&&_120b.getResponseHeader&&_120b.getResponseHeader("Content-type").indexOf("text/html")!=-1){
var _120d="";
if(_120b.getResponseText){
_120d=_120b.getResponseText();
}
if((_120d.indexOf("http-equiv=\"refresh\"")!=-1)||(_120d.indexOf("http-equiv='refresh'")!=-1)){
this.m_logOnDialog.show(null);
}else{
this.m_logOnDialog.handleUnknownHTMLResponse(_120d);
}
}else{
if(_120b&&_120b.getSoapFault){
this.m_logOnDialog.show(_120b.getSoapFault());
}else{
if(oCV.getSoapFault()){
var _120e=XMLBuilderLoadXMLFromString(oCV.getSoapFault());
this.m_logOnDialog.show(_120e);
oCV.setSoapFault("");
}else{
if(typeof console!="undefined"){
console.log("BaseRequestHandler.prototype.onPassportTimeout: An unhandled authentication fault was returned: %o",_120b);
}
}
}
}
};
BaseRequestHandler.prototype.onWorking=function(_120f){
if(this.m_workingDialog){
var _1210=_120f&&typeof _120f.getAsynchStatus=="function"&&_120f.getAsynchStatus()=="stillWorking"?true:false;
if(!_1210){
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
this.m_workingDialog.show();
}
}
};
BaseRequestHandler.prototype.onCancel=function(){
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
var oCV=this.getViewer();
oCV.gbPromptRequestSubmitted=false;
this._processDelayedLoadingQueue();
};
BaseRequestHandler.prototype._processDelayedLoadingQueue=function(){
var oCV=this.getViewer();
if(oCV&&oCV.getViewerWidget()){
var _1213=oCV.getViewerWidget();
if(_1213.getLoadManager()){
_1213.getLoadManager().processQueue();
}
}
};
BaseRequestHandler.prototype.onPrompting=function(_1214){
var oCV=this.getViewer();
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
if(!this.m_promptDialog){
this.m_promptDialog=new PromptDialog(this.getViewer());
}
window["AsynchRequestObject"]=_1214;
window["AsynchRequestPromptDialog"]=this.m_promptDialog;
var _1216="?cv.id="+oCV.getId();
window["AsynchRequestPromptDialog"].initialize(oCV.getWebContentRoot()+"/rv/showStandalonePrompts.html"+_1216,400,400);
window["AsynchRequestPromptDialog"].show();
};
BaseRequestHandler.prototype.processDATAReportResponse=function(_1217){
var oCV=this.getViewer();
if(!oCV||oCV.m_destroyed){
if(console){
console.warn("Tried to process a data response on an invalid CCognosViewer",oCV);
}
return;
}
var _1219=_1217.getResponseState();
if(!_1219){
this.resubmitInSafeMode();
}
if(this.loadReportHTML(_1217.getResult())===false){
this.resubmitInSafeMode();
}
this.updateViewerState(_1219);
};
BaseRequestHandler.prototype.updateViewerState=function(_121a){
var oCV=this.getViewer();
applyJSONProperties(oCV,_121a);
var _121c=oCV.getStatus();
if(typeof oCV.envParams["ui.spec"]!="undefined"&&oCV.envParams["ui.spec"].indexOf("&lt;")===0){
oCV.envParams["ui.spec"]=xml_decode(oCV.envParams["ui.spec"]);
}
if(_121c!="fault"){
if(oCV.envParams["rapReportInfo"]){
this._processRapReportInfo(oCV);
}
if(typeof _121a.clientunencodedexecutionparameters!="undefined"){
var _121d=document.getElementById("formWarpRequest"+oCV.getId());
if(_121d!=null&&typeof _121d["clientunencodedexecutionparameters"]!="undefined"){
_121d["clientunencodedexecutionparameters"].value=_121a.clientunencodedexecutionparameters;
}
if(typeof document.forms["formWarpRequest"]!="undefined"&&typeof document.forms["formWarpRequest"]["clientunencodedexecutionparameters"]!="undefined"){
document.forms["formWarpRequest"]["clientunencodedexecutionparameters"].value=_121a.clientunencodedexecutionparameters;
}
}
}else{
oCV.setTracking("");
}
};
BaseRequestHandler.prototype._processRapReportInfo=function(oCV){
if(oCV.envParams["rapReportInfo"]){
var _121f=eval("("+oCV.envParams["rapReportInfo"]+")");
if(typeof RAPReportInfo!="undefined"){
var _1220=new RAPReportInfo(_121f,oCV);
oCV.setRAPReportInfo(_1220);
}
}
};
BaseRequestHandler.prototype.loadReportHTML=function(_1221){
if(!_1221){
return true;
}
var oCV=this.getViewer();
if(window.IBM&&window.IBM.perf){
window.IBM.perf.log("viewer_gotHtml",oCV);
}
if(oCV.m_undoStack.length>0){
oCV.m_undoStack[oCV.m_undoStack.length-1].m_bRefreshPage=true;
}
oCV.pageNavigationObserverArray=[];
oCV.m_flashChartsObjectIds=[];
var sHTML=_1221.replace(/<form[^>]*>/gi,"").replace(/<\/form[^>]*>/gi,"");
oCV.m_sHTML=sHTML;
oCV.setHasPrompts(false);
var id=oCV.getId();
var _1225=document.getElementById("RVContent"+id);
var _1226=document.getElementById("CVReport"+id);
if(sHTML.match(/prompt\/control\.js|PRMTcompiled\.js|prmt_core\.js/gi)){
oCV.setHasPrompts(true);
_1226.style.display="none";
}
if(window.gScriptLoader){
var _1227=oCV.getViewerWidget()?true:false;
var _1228=oCV.getViewerWidget()?document.getElementById("_"+oCV.getViewerWidget().iContext.widgetId+"_cv"):_1226;
sHTML=window.gScriptLoader.loadCSS(sHTML,_1228,_1227,id);
}
if(oCV.sBrowser=="ie"){
sHTML="<span style='display:none'>&nbsp;</span>"+sHTML;
}
_1226.innerHTML=sHTML;
this.massageHtmlBeforeDisplayed();
if(window.gScriptLoader){
var _1229=GUtil.generateCallback(oCV.showLoadedContent,[_1225],oCV);
oCV.m_resizeReady=false;
if(!window.gScriptLoader.loadAll(_1226,_1229,id,true)){
if(window.gScriptLoader.containsAjaxWarnings()){
return false;
}
}
}else{
_1225.style.display="block";
}
oCV.updateOutputForA11ySupport();
this._clearFindState();
return true;
};
BaseRequestHandler.prototype._clearFindState=function(){
var oCV=this.getViewer();
var _122b=oCV.getState()&&oCV.getState().getFindState()?oCV.getState().getFindState():null;
if(_122b&&!_122b.findOnServerInProgress()){
oCV.getState().clearFindState();
}
};
BaseRequestHandler.prototype.showReport=function(){
var oCV=this.getViewer();
var _122d=document.getElementById("CVReport"+oCV.getId());
if(_122d){
_122d.style.display="";
}
};
BaseRequestHandler.prototype.postComplete=function(){
var oCV=this.getViewer();
if(oCV.shouldWriteNavLinks()){
oCV.writeNavLinks(oCV.getSecondaryRequests().join(" "));
}
if(oCV.getStatus()==="complete"){
oCV.m_undoStack=[new CognosViewerSession(oCV)];
}
};
BaseRequestHandler.prototype.onAsynchStatusUpdate=function(_122f){
if(this.m_httpRequestConfig){
var _1230=this.m_httpRequestConfig.getReportStatusCallback(_122f);
if(_1230){
_1230();
}
}
};
BaseRequestHandler.prototype.addCallbackHooks=function(){
if(!this.m_httpRequestConfig){
return;
}
this._addCallback("complete","onComplete");
this._addCallback("working","onWorking");
this._addCallback("prompting","onPrompting");
};
BaseRequestHandler.prototype._addCallback=function(_1231,_1232){
var _1233=_1231;
var _1234=this[_1232];
this[_1232]=function(_1235){
_1234.apply(this,arguments);
var _1236=null;
if(_1235&&typeof _1235.getAsynchStatus=="function"){
_1236=_1235.getAsynchStatus();
}else{
_1236=_1233=="complete"?this.getViewer().getStatus():_1233;
}
if(_1236=="stillWorking"){
return;
}
var _1237=this.m_httpRequestConfig.getReportStatusCallback(_1236);
if(typeof _1237=="function"){
setTimeout(_1237,10);
}
};
};
function ViewerBaseWorkingDialog(_1238){
if(!_1238){
return;
}
this.setCognosViewer(_1238);
this.m_oCV=_1238;
this.m_sNamespace=_1238.getId();
this.m_sGateway=_1238.getGateway();
this.m_UIBlacklist=null;
this.m_bUse=true;
this.m_bCancelSubmitted=false;
};
ViewerBaseWorkingDialog.prototype=new IRequestIndicator();
ViewerBaseWorkingDialog.prototype.setCognosViewer=function(oCV){
this.m_oCV=oCV;
};
ViewerBaseWorkingDialog.prototype.getCognosViewer=function(){
return this.m_oCV;
};
ViewerBaseWorkingDialog.prototype.getGateway=function(){
return this.m_sGateway;
};
ViewerBaseWorkingDialog.prototype.getNamespace=function(){
return this.m_sNamespace;
};
ViewerBaseWorkingDialog.prototype.cancelSubmitted=function(){
return this.m_bCancelSubmitted;
};
ViewerBaseWorkingDialog.prototype.setCancelSubmitted=function(_123a){
this.m_bCancelSubmitted=_123a;
};
ViewerBaseWorkingDialog.prototype.show=function(){
var _123b=document.getElementById(this.getContainerId());
if(_123b){
_123b.style.display="block";
this.enableCancelButton();
}else{
this.create();
}
var _123c=document.getElementById("reportBlocker"+this.m_oCV.getId());
if(_123c){
_123c.style.display="block";
}
};
ViewerBaseWorkingDialog.prototype.create=function(){
if(typeof document.body!="undefined"){
if(this.isModal()){
this.createModalWaitDialog();
}else{
this.createInlineWaitDialog();
}
}
};
ViewerBaseWorkingDialog.prototype.createContainer=function(_123d){
var _123e=document.createElement("div");
_123e.setAttribute("id",this.getContainerId());
_123e.className=_123d?"modalWaitPage":"inlineWaitPage";
return _123e;
};
ViewerBaseWorkingDialog.prototype.createModalWaitDialog=function(){
this._createBlocker();
var _123f=this.createContainer(true);
_123f.innerHTML=this.renderHTML();
_123f.style.zIndex="7002";
_123f.setAttribute("role","region");
_123f.setAttribute("aria-label",RV_RES.GOTO_WORKING);
document.body.appendChild(_123f);
var _1240=this.createModalIframeBackground();
document.body.appendChild(_1240);
var _1241=0;
var iLeft=0;
if(typeof window.innerHeight!="undefined"){
_1241=Math.round((window.innerHeight/2)-(_123f.offsetHeight/2));
iLeft=Math.round((window.innerWidth/2)-(_123f.offsetWidth/2));
}else{
_1241=Math.round((document.body.clientHeight/2)-(_123f.offsetHeight/2));
iLeft=Math.round((document.body.clientWidth/2)-(_123f.offsetWidth/2));
}
_123f.style.bottom=_1241+"px";
_123f.style.left=iLeft+"px";
_1240.style.left=iLeft-1+"px";
_1240.style.bottom=_1241-1+"px";
_1240.style.width=_123f.offsetWidth+2+"px";
_1240.style.height=_123f.offsetHeight+2+"px";
};
ViewerBaseWorkingDialog.prototype._createBlocker=function(){
var _1243=document.getElementById("reportBlocker"+this.m_oCV.getId());
if(_1243){
return;
}
var _1244=document.getElementById("mainViewerTable"+this.m_oCV.getId());
if(_1244){
_1243=document.createElement("div");
_1244.parentNode.appendChild(_1243);
_1243.id="reportBlocker"+this.m_oCV.getId();
_1243.style.zIndex="6001";
_1243.style.position="absolute";
_1243.style.top="0px";
_1243.style.left="0px";
_1243.style.width="100%";
_1243.style.height="100%";
_1243.style.display="none";
_1243.style.opacity="0";
_1243.style.backgroundColor="#FFFFFF";
_1243.style.filter="alpha(opacity:0)";
}
};
ViewerBaseWorkingDialog.prototype.createInlineWaitDialog=function(){
var _1245=this.m_oCV.getId();
var _1246=document.getElementById("CVReport"+_1245);
if(_1246){
var _1247=this.createContainer(false);
_1247.innerHTML="<table width=\"100%\" height=\"100%\"><tr><td valign=\"middle\" align=\"center\" role=\"presentation\">"+this.renderHTML()+"</td></tr></table>";
_1246.appendChild(_1247);
}
};
ViewerBaseWorkingDialog.prototype.createModalIframeBackground=function(){
var _1248=document.createElement("iframe");
var _1249="..";
var oCV=this.getCognosViewer();
if(oCV!==null){
_1249=oCV.getWebContentRoot();
}
_1248.setAttribute("id",this.getContainerId()+"Iframe");
_1248.setAttribute("title","Empty iframe");
_1248.setAttribute("src",_1249+"/common/images/spacer.gif");
_1248.setAttribute("scrolling","no");
_1248.setAttribute("frameborder","0");
_1248.style.position="absolute";
_1248.style.zIndex="6002";
_1248.style.display="block";
return _1248;
};
ViewerBaseWorkingDialog.prototype.updateCoords=function(_124b,_124c){
if(this.m_container!==null&&m_iframeBackground!==null){
var _124d=0;
var iLeft=0;
if(typeof window.innerHeight!="undefined"){
_124d=Math.round((window.innerHeight/2)-(_124b.offsetHeight/2));
iLeft=Math.round((window.innerWidth/2)-(_124b.offsetWidth/2));
}else{
_124d=Math.round((document.body.clientHeight/2)-(_124b.offsetHeight/2));
iLeft=Math.round((document.body.clientWidth/2)-(_124b.offsetWidth/2));
}
_124b.style.bottom=_124d+"px";
_124b.style.left=iLeft+"px";
_124c.style.left=_124b.style.left;
_124c.style.bottom=_124b.style.bottom;
_124c.style.width=_124b.offsetWidth+"px";
_124c.style.height=_124b.offsetHeight+"px";
}
};
ViewerBaseWorkingDialog.prototype.hide=function(){
var _124f=document.getElementById(this.getContainerId());
if(_124f){
_124f.parentNode.removeChild(_124f);
}
var _1250=document.getElementById(this.getContainerId()+"Iframe");
if(_1250){
_1250.parentNode.removeChild(_1250);
}
var _1251=document.getElementById("reportBlocker"+this.m_oCV.getId());
if(_1251){
_1251.parentNode.removeChild(_1251);
}
};
ViewerBaseWorkingDialog.prototype.isModal=function(){
var _1252=this.m_oCV.getId();
var _1253=document.getElementById("CVReport"+_1252);
var _1254=true;
if(_1253&&_1253.innerHTML===""){
_1254=false;
}
return _1254;
};
ViewerBaseWorkingDialog.prototype.disableCancelButton=function(_1255){
};
ViewerBaseWorkingDialog.prototype.enableCancelButton=function(){
};
function FaultDialog(oCV){
this.m_oCV=oCV;
};
FaultDialog.prototype=new IFaultDialog();
FaultDialog.prototype.show=function(_1257){
if(typeof console!="undefined"){
console.log("FaultDialog - an unhandled soap fault was returned: %o",_1257);
}
};
FaultDialog.prototype.handleUnknownHTMLResponse=function(_1258){
this.m_oCV.setTracking("");
this.m_oCV.setConversation("");
if(_1258){
if(this.m_oCV.envParams["useAlternateErrorCodeRendering"]){
var _1259=document.getElementsByTagName("head")[0];
var _125a=_1258.match(/<body[^>]*>([\s\S]*)<\/body>/im)[1];
var _125b=/<script[^>]*>([\s\S]*?)<\/script>/igm;
var _125c=_125b.exec(_1258);
while(_125c!=null){
var _125d=document.createElement("script");
_125d.type="text/javascript";
var _125e=_125c[0].match(/src="([\s\S]*?)"/i);
if(_125e==null){
_125d.text=_125c[1];
}else{
_125d.src=_125e[1];
}
_1259.appendChild(_125d);
_125c=_125b.exec(_1258);
}
document.body.innerHTML=_125a;
}else{
document.write(_1258);
}
}
};
function LogOnDialog(oCV){
this.m_oCV=oCV;
};
LogOnDialog.prototype=new ILogOnDialog();
LogOnDialog.prototype.handleUnknownHTMLResponse=function(_1260){
if(_1260){
document.write(_1260);
}
};
LogOnDialog.prototype.show=function(_1261){
launchLogOnDialog(this.m_oCV.getId(),_1261);
};
LogOnDialog.prototype.hide=function(){
};
function PromptDialog(oCV){
this.m_oCV=oCV;
this.m_dialogImpl=null;
};
PromptDialog.prototype=new IPromptDialog();
PromptDialog.prototype.initialize=function(url,width,_1265){
this.m_dialogImpl=new CModal("","",document.body,null,null,width,_1265,true,true,false,true,this.m_oCV.getWebContentRoot());
var _1266=document.getElementById(CMODAL_CONTENT_ID);
_1266.src=url;
};
PromptDialog.prototype.show=function(){
this.m_dialogImpl.show();
};
PromptDialog.prototype.hide=function(){
this.m_dialogImpl.hide();
destroyCModal();
};
function WorkingDialog(_1267){
if(_1267){
this.m_bSimpleWorkingDialog=false;
this.m_bShowCancelButton=(_1267.getAdvancedServerProperty("VIEWER_JS_HIDE_CANCEL_BUTTON")=="true")?false:true;
WorkingDialog.baseConstructor.call(this,_1267);
this.m_secondaryRequests=_1267.getSecondaryRequests();
}
};
WorkingDialog.prototype=new ViewerBaseWorkingDialog();
WorkingDialog.baseConstructor=ViewerBaseWorkingDialog;
WorkingDialog.prototype.setSecondaryRequests=function(_1268){
this.m_secondaryRequests=_1268;
};
WorkingDialog.prototype._getSecondaryRequests=function(){
return this.m_secondaryRequests;
};
WorkingDialog.prototype.getIsSavedReport=function(){
return this.getCognosViewer().bIsSavedReport;
};
WorkingDialog.prototype.setSimpleWorkingDialogFlag=function(flag){
this.m_bSimpleWorkingDialog=flag;
};
WorkingDialog.prototype.getSimpleWorkingDialogFlag=function(){
return this.m_bSimpleWorkingDialog;
};
WorkingDialog.prototype.showDeliveryOptions=function(bShow){
var _126b=this.getNamespace();
var _126c=document.getElementById("DeliveryOptionsVisible"+_126b);
if(_126c){
_126c.style.display=(bShow===false?"none":"block");
if(bShow){
var links=_126c.getElementsByTagName("a");
for(var i=links.length;i>0;i--){
if(links[i]&&links[i].getAttribute("tabIndex")=="0"){
links[i].focus();
}
}
}
}
_126c=document.getElementById("OptionsLinkSelected"+_126b);
if(_126c){
_126c.style.display=(bShow===false?"none":"block");
}
_126c=document.getElementById("OptionsLinkUnselected"+_126b);
if(_126c){
_126c.style.display=(bShow===false?"block":"none");
}
};
WorkingDialog.prototype.renderHTML=function(){
var _126f=this.getNamespace();
var _1270=_126f+"_workingMsg "+_126f+"_workingMsg2";
var html="<table class=\"viewerWorkingDialog\" id=\"CVWaitTable"+_126f+"\""+" role=\"presentation\">";
html+=("<tr>"+"<td align=\"center\">"+"<div tabIndex=\"0\" role=\"presentation\" aria-labelledby=\""+_1270+"\""+" class=\"body_dialog_modal workingDialogDiv\">");
html+=this.renderFirstInnerTable();
html+=this.renderSecondInnerTable();
html+=("</div>"+"</td>"+"</tr>"+"</table>");
return html;
};
WorkingDialog.prototype.renderFirstInnerTable=function(){
var _1272=this.getSimpleWorkingDialogFlag();
var _1273=_1272?RV_RES.GOTO_WORKING:RV_RES.RV_RUNNING;
var _1274=this.m_sNamespace;
var _1275="<table class=\"workingDialogInnerTable\" role=\"presentation\">"+"<tr>"+"<td valign=\"middle\">";
var _1276=this.getCognosViewer().getSkin()+"/branding/";
_1275+="<img src=\""+_1276+"progress.gif\"";
if(isIE()){
_1275+=" width=\"48\" height=\"48\" border=\"0\"";
}
_1275+=" name=\"progress\"";
if(isIE()){
_1275+=" align=\"top\"";
}
_1275+=" alt=\"";
_1275+=_1273;
_1275+="\"/></td>";
_1275+="<td width=\"20\">&nbsp;</td>";
_1275+="<td style=\"padding-top: 5px;\" class=\"tableText\">";
_1275+="<span id=\""+_1274+"_workingMsg\">";
_1275+=_1273;
_1275+="</span>";
_1275+="<br/><br/>";
var _1277=this.getCognosViewer().envParams["cv.responseFormat"];
if(_1272||this.isUIBlacklisted("RV_TOOLBAR_BUTTONS")||!this.deliverySectionIsNeeded()||(_1277&&("qs"===_1277||"fragment"===_1277))){
_1275+=RV_RES.RV_PLEASE_WAIT;
}else{
var _1278=this.canShowDeliveryOptions();
if(_1278){
_1275+=this.optionLinkSelectedDiv();
_1275+=this.optionLinkUnselectedDiv();
}else{
_1275+=RV_RES.RV_PLEASE_WAIT;
}
}
_1275+="</td></tr><tr><td colspan=\"3\">&nbsp;</td></tr></table>";
return _1275;
};
WorkingDialog.prototype.optionLinkSelectedDiv=function(){
var _1279="";
_1279+="<div id=\"OptionsLinkSelected"+this.getNamespace()+"\" style=\"display: none\">";
_1279+=RV_RES.RV_BUSY_OPTIONS_SELECTED;
_1279+="</div>";
return _1279;
};
WorkingDialog.prototype.optionLinkUnselectedDiv=function(){
var _127a="";
var _127b=this.getNamespace();
var _127c="window.oCV"+_127b+".getWorkingDialog()";
_127a+="<div id=\"OptionsLinkUnselected"+_127b+"\">";
_127a+="<span id=\""+_127b+"_workingMsg2\">";
_127a+=RV_RES.RV_BUSY_OPTIONS_UNSELECTED;
_127a+="</span><br/>";
_127a+="<a href=\"#\" class=\"deliveryOptionLink\" onclick=\"javascript:"+_127c+".showDeliveryOptions(true)\">";
_127a+=RV_RES.RV_BUSY_OPTIONS_LINK;
_127a+="</a></div>";
return _127a;
};
WorkingDialog.prototype.canShowDeliveryOptions=function(){
var _127d=this.getCognosViewer().envParams["ui.primaryAction"];
if("saveAs"!==_127d&&"email"!==_127d&&this.getIsSavedReport()){
return true;
}
return false;
};
WorkingDialog.prototype.isUIBlacklisted=function(item){
var _127f=this.getUIBlacklist();
for(var index in _127f){
if(_127f[index]===item){
return true;
}
}
return false;
};
WorkingDialog.prototype.getUIBlacklist=function(){
if(!this.m_UIBlacklist&&this.getCognosViewer().UIBlacklist){
this.m_UIBlacklist=this.getCognosViewer().UIBlacklist.split(" ");
}
return this.m_UIBlacklist;
};
WorkingDialog.prototype.deliverySectionIsNeeded=function(){
return !this._isSaveBlackListed()||!this._isSaveAsBlackListed()||!this._isEmailBlackListed();
};
WorkingDialog.prototype._isSaveBlackListed=function(){
return this.isUIBlacklisted("RV_TOOLBAR_BUTTONS_SAVE")||this.isUIBlacklisted("RV_WORKING_DIALOG_SAVE")||!this._hasSecondaryRequest("save");
};
WorkingDialog.prototype._isSaveAsBlackListed=function(){
return this.isUIBlacklisted("RV_TOOLBAR_BUTTONS_SAVEAS")||this.isUIBlacklisted("RV_WORKING_DIALOG_SAVEAS")||!this._hasSecondaryRequest("saveAs");
};
WorkingDialog.prototype._isEmailBlackListed=function(){
return this.isUIBlacklisted("RV_TOOLBAR_BUTTONS_SEND")||this.isUIBlacklisted("RV_WORKING_DIALOG_SEND")||!this._hasSecondaryRequest("email");
};
WorkingDialog.prototype.showCancelButton=function(){
return this.m_bShowCancelButton;
};
WorkingDialog.prototype._hasSecondaryRequest=function(_1281){
var _1282=this._getSecondaryRequests();
if(_1282){
var _1283=_1282.length;
for(var i=0;i<_1283;i++){
if(_1282[i]==_1281){
return true;
}
}
}
return false;
};
WorkingDialog.prototype.renderSecondInnerTable=function(){
var _1285="";
var _1286=this.getCognosViewer().getWebContentRoot();
_1285+="<table width=\"300\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\">";
_1285+="<tr id=\"DeliveryOptionsVisible"+this.getNamespace()+"\" class=\"workingDialogOptions\">";
_1285+="<td align=\"left\">";
_1285+="<table class=\"workingDialogInnerTable workingDialogLinks\" role=\"presentation\">";
var _1287=this.canShowDeliveryOptions();
if(_1287&&this.deliverySectionIsNeeded()){
if(!this._isSaveBlackListed()){
_1285+=this.addDeliverOption("/rv/images/action_save_report_output.gif",RV_RES.RV_SAVE_REPORT,"SaveReport(true);");
}
if("reportView"!==this.getCognosViewer().envParams["ui.objectClass"]&&!this._isSaveAsBlackListed()){
_1285+=this.addDeliverOption("/rv/images/action_save_report_view.gif",RV_RES.RV_SAVE_AS_REPORT_VIEW,"SaveAsReportView(true);");
}
if(!this.isUIBlacklisted("CC_RUN_OPTIONS_EMAIL_ATTACHMENT")&&!this._isEmailBlackListed()){
_1285+=this.addDeliverOption("/rv/images/action_send_report.gif",RV_RES.RV_EMAIL_REPORT,"SendReport(true);");
}
}
_1285+="</table></td></tr> ";
_1285+="<tr style=\"padding-top: 5px\"> ";
_1285+="<td align=\"left\" colspan=\"3\" id=\"cancelButtonContainer"+this.getNamespace()+"\"> ";
if(this.showCancelButton()){
_1285+=this.addCancelButton();
}
_1285+="</td></tr> ";
_1285+="</table> ";
return _1285;
};
WorkingDialog.prototype.addDeliverOption=function(_1288,sText,_128a){
var _128b="";
var _128c=this.getCognosViewer().getWebContentRoot();
var _128d="javascript: window.oCV"+this.getNamespace()+".getRV().";
var _128e=_128d+_128a;
_128b+="<tr><td> ";
_128b+="<a tabIndex=\"-1\" href=\""+_128a+"\"> ";
_128b+="<img border=\"0\" src=\""+_128c+_1288+"\" alt=\" "+html_encode(sText)+"\"/></a> ";
_128b+="</td><td width=\"100%\" valign=\"middle\" class=\"tableText\"> ";
_128b+="<a tabIndex=\"0\" role=\"link\" href=\"#\" onclick=\""+_128e+"\" style=\"padding-left: 5px\" class=\"deliveryOptionLink\"> ";
_128b+=(sText+"</a></td></tr>");
return _128b;
};
WorkingDialog.prototype.addCancelButton=function(){
var _128f="";
var _1290=this.getCognosViewer().getWebContentRoot();
_128f+="<table role=\"presentation\"><tr><td> ";
_128f+="<table id=\"cvWorkingDialog"+this.getNamespace()+"\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" onmouseover=\"this.className = 'commandButtonOver'\" onmouseout=\"this.className = 'commandButton'\" onmousedown=\"this.className = 'commandButtonDown'\" class=\"commandButton\"> ";
_128f+="<tr> ";
_128f+="<td valign=\"middle\" align=\"center\" nowrap=\"nowrap\" class=\"workingDialogCancelButton\" ";
if(isIE()){
_128f+="id=\"btnAnchorIE\" ";
}else{
_128f+="id=\"btnAnchor\" ";
}
_128f+="> ";
var _1291="window.oCV"+this.m_sNamespace+".cancel(this)";
_128f+="<a href=\"#\" onclick=\""+_1291+"\"> ";
_128f+=RV_RES.CANCEL;
_128f+="</a> ";
_128f+="</td></tr></table></td> ";
_128f+="<td><img alt=\"\" height=\"1\"  ";
if(isIE()){
_128f+="width=\"10\"  ";
}
_128f+="src=\""+_1290+"/ps/images/space.gif\"/></td> ";
_128f+="</tr></table> ";
return _128f;
};
WorkingDialog.prototype.disableCancelButton=function(_1292){
this.cancelButtonDisabled=true;
var _1293=document.getElementById("cvWorkingDialog"+this.getNamespace());
if(_1293){
_1293.style.cursor="default";
_1293.className="commandButtonOver";
_1293.removeAttribute("onmouseover");
_1293.removeAttribute("onmouseout");
}
if(_1292){
_1292.removeAttribute("href");
_1292.removeAttribute("onclick");
_1292.style.cursor="default";
}
};
WorkingDialog.prototype.enableCancelButton=function(){
if(this.cancelButtonDisabled){
var _1294=document.getElementById("cancelButtonContainer"+this.getNamespace());
if(_1294){
_1294.innerHTML=this.addCancelButton();
}
this.cancelButtonDisabled=false;
}
};
WorkingDialog.prototype.getContainerId=function(){
return "CVWait"+this.getNamespace();
};
function RequestExecutedIndicator(_1295){
if(_1295){
RequestExecutedIndicator.baseConstructor.call(this,_1295);
}
};
RequestExecutedIndicator.baseConstructor=WorkingDialog;
RequestExecutedIndicator.prototype=new WorkingDialog();
RequestExecutedIndicator.prototype.renderHTML=function(){
var _1296="<table id=\"CVWaitTable"+this.getNamespace()+"\" requestExecutionIndicator=\"true\" class=\"viewerWorkingDialog\" role=\"presentation\">";
_1296+="<tr><td align=\"center\">";
_1296+="<div class=\"body_dialog_modal\">";
_1296+="<table align=\"center\" cellspacing=\"0\" cellpadding=\"0\" style=\"vertical-align:middle; text-align: left;\" role=\"presentation\">";
_1296+="<tr><td rowspan=\"2\">";
_1296+="<img alt=\""+RV_RES.GOTO_WORKING+"\" src=\""+this.getCognosViewer().getSkin()+"/branding/progress.gif\" style=\"margin:5px;\" width=\"48\" height=\"48\" name=\"progress\"/>";
_1296+="</td><td nowrap=\"nowrap\"><span class=\"busyUpdatingStr\">";
_1296+=RV_RES.GOTO_WORKING;
_1296+="</span></td></tr><tr><td nowrap=\"nowrap\"><span class=\"busyUpdatingStr\">";
_1296+=RV_RES.RV_PLEASE_WAIT;
_1296+="</span></td></tr><tr><td style=\"height:7px;\" colspan=\"2\"></td></tr></table></div></td></tr></table>";
return _1296;
};
RequestExecutedIndicator.prototype.getContainerId=function(){
return "CVWaitindicator"+this.getNamespace();
};
function RequestHandler(oCV){
if(oCV){
RequestHandler.baseConstructor.call(this,oCV);
}
};
RequestHandler.prototype=new BaseRequestHandler();
RequestHandler.baseConstructor=BaseRequestHandler;
RequestHandler.prototype.parent=BaseRequestHandler.prototype;
RequestHandler.prototype.resubmitInSafeMode=function(){
this.getViewer().resubmitInSafeMode(this.getDispatcherEntry());
};
RequestHandler.prototype.onComplete=function(_1298){
this.parent.onComplete.call(this,_1298);
this.processDATAReportResponse(_1298);
this.postComplete();
};
RequestHandler.prototype.processInitialResponse=function(_1299){
this.parent.processInitialResponse.call(this,_1299);
var oCV=this.getViewer();
var _129b=oCV.getStatus();
oCV.setMaxContentSize();
var _129c=(oCV.isWorking(_129b)||_129b=="default");
if(_129c){
if(oCV.getWorkingDialog()){
oCV.getWorkingDialog().show();
}
setTimeout(getCognosViewerObjectRefAsString(oCV.getId())+".executeCallback(\"wait\");",10);
}else{
if(_129b=="fault"){
oCV.setSoapFault(_1299.m_sSoapFault);
oCV.executeCallback("fault");
}else{
if(_1299.status=="cancel"){
oCV.executeCallback("cancel");
}else{
oCV.updateSkipToReportLink();
if(oCV.envParams&&oCV.envParams["pinFreezeInfo"]){
var _129d=oCV.getPinFreezeManager();
_129d.fromJSONString(oCV.envParams["pinFreezeInfo"]);
delete oCV.envParams["pinFreezeInfo"];
}
if(_129b!="prompting"||!oCV.executeCallback("prompt")){
this.postComplete();
}else{
oCV.updateSkipToNavigationLink(true);
}
}
}
}
this.showReport();
this.getViewer().renderTabs();
this.onAsynchStatusUpdate(_129b);
};
RequestHandler.prototype.postComplete=function(){
this.parent.postComplete.call(this);
var oCV=this.getViewer();
var _129f=document.getElementById("RVContent"+oCV.getId());
if(_129f){
_129f.scrollTop=0;
}
oCV.updateSkipToReportLink();
if(oCV.rvMainWnd){
oCV.updateLayout(oCV.getStatus());
if(!oCV.getUIConfig()||oCV.getUIConfig().getShowToolbar()){
var _12a0=oCV.rvMainWnd.getToolbar();
if(_12a0){
oCV.rvMainWnd.updateToolbar(oCV.outputFormat);
_12a0.draw();
}
}
if(!oCV.getUIConfig()||oCV.getUIConfig().getShowBanner()){
var _12a1=oCV.rvMainWnd.getBannerToolbar();
if(_12a1){
_12a1.draw();
}
}
}
if(oCV.getBrowser()=="moz"){
if(_129f){
if(oCV.outputFormat=="XML"&&oCV.getStatus()!="prompting"){
_129f.style.overflow="hidden";
}else{
_129f.style.overflow="auto";
}
}
}
oCV.gbPromptRequestSubmitted=false;
this.showReport();
if(oCV.getPinFreezeManager()&&oCV.getPinFreezeManager().hasFrozenContainers()){
var _12a2=document.getElementById("CVReport"+oCV.getId());
if(_12a2){
setTimeout(function(){
oCV.getPinFreezeManager().renderReportWithFrozenContainers(_12a2);
if(isIE()){
oCV.repaintDiv(_129f);
}
},1);
}
}
oCV.setMaxContentSize();
oCV.executeCallback("done");
oCV.doneLoading();
};
function ActionFormFields(_12a3){
this.m_dispatcherEntry=_12a3;
this.m_oCV=_12a3.getViewer();
};
ActionFormFields.prototype.addFormFields=function(){
var _12a4=this.m_dispatcherEntry;
var _12a5=_12a4.getAction();
_12a5.preProcess();
_12a4.addFormField("ui.action","modifyReport");
if(this.m_oCV.getModelPath()!==""){
_12a4.addFormField("modelPath",this.m_oCV.getModelPath());
if(typeof this.m_oCV.envParams["metaDataModelModificationTime"]!="undefined"){
_12a4.addFormField("metaDataModelModificationTime",this.m_oCV.envParams["metaDataModelModificationTime"]);
}
}
if(_12a5.doAddActionContext()===true){
var _12a6=_12a5.addActionContext();
_12a4.addFormField("cv.actionContext",_12a6);
if(window.gViewerLogger){
window.gViewerLogger.log("Action context",_12a6,"xml");
}
}
var isBux=this.m_oCV.envParams["bux"]=="true";
if(isBux){
_12a4.addFormField("cv.showFaultPage","false");
}else{
_12a4.addFormField("cv.showFaultPage","true");
}
_12a4.addFormField("ui.object",this.m_oCV.envParams["ui.object"]);
_12a4.addDefinedFormField("ui.spec",this.m_oCV.envParams["ui.spec"]);
_12a4.addDefinedFormField("modelPath",this.m_oCV.envParams["modelPath"]);
_12a4.addDefinedFormField("packageBase",this.m_oCV.envParams["packageBase"]);
_12a4.addDefinedFormField("rap.state",this.m_oCV.envParams["rap.state"]);
_12a4.addDefinedFormField("rap.reportInfo",this.m_oCV.envParams["rapReportInfo"]);
_12a4.addDefinedFormField("ui.primaryAction",this.m_oCV.envParams["ui.primaryAction"]);
_12a4.addNonNullFormField("cv.debugDirectory",this.m_oCV.envParams["cv.debugDirectory"]);
_12a4.addNonNullFormField("ui.objectClass",this.m_oCV.envParams["ui.objectClass"]);
_12a4.addNonNullFormField("bux",this.m_oCV.envParams["bux"]);
_12a4.addNonNullFormField("baseReportModificationTime",this.m_oCV.envParams["baseReportModificationTime"]);
_12a4.addNonNullFormField("originalReport",this.m_oCV.envParams["originalReport"]);
var _12a8=this.m_oCV.getFlashChartOption();
if(_12a8!=null){
_12a4.addFormField("savedFlashChartOption",_12a8);
if(_12a8&&_12a5!=null&&typeof (_12a5.m_requestParams)!="undefined"&&typeof (_12a5.m_requestParams.targetType)!="undefined"){
var _12a9=false;
var _12aa=null;
if(typeof (_12a5.m_requestParams.targetType.targetType)!="undefined"){
_12aa=_12a5.m_requestParams.targetType.targetType;
}else{
_12aa=_12a5.m_requestParams.targetType;
}
if(_12aa.match("v2_")!=null||_12aa.match("_v2")!=null){
_12a9=true;
}else{
var _12ab=this.m_oCV.getRAPReportInfo();
var _12ac=_12a5.getSelectedReportInfo();
if(_12ab&&_12ac){
var _12ad=_12ab.getDisplayTypes(_12ac.container);
if(_12ad.match("v2_")!=null||_12ad.match("_v2")!=null){
_12a9=true;
}
}
}
_12a4.addFormField("hasAVSChart",_12a9);
}else{
_12a4.addFormField("hasAVSChart",this.m_oCV.hasAVSChart());
}
}
var sEP=this.m_oCV.getExecutionParameters();
if(sEP){
_12a4.addFormField("executionParameters",encodeURIComponent(sEP));
}
_12a4.addFormField("ui.conversation",encodeURIComponent(this.m_oCV.getConversation()));
_12a4.addFormField("m_tracking",encodeURIComponent(this.m_oCV.getTracking()));
var sCAF=this.m_oCV.getCAFContext();
if(sCAF){
_12a4.addFormField("ui.cafcontextid",sCAF);
}
if(_12a5.forceRunSpecRequest()){
_12a4.addFormField("widget.forceRunSpec","true");
}
};
function ViewerDispatcher(){
this.m_activeRequest=null;
this.m_requestQueue=[];
this.m_bUsePageRequest=false;
};
ViewerDispatcher.prototype.getActiveRequest=function(){
return this.m_activeRequest;
};
ViewerDispatcher.prototype.setUsePageRequest=function(_12b0){
this.m_bUsePageRequest=_12b0;
};
ViewerDispatcher.prototype.getUsePageRequest=function(){
return this.m_bUsePageRequest;
};
ViewerDispatcher.prototype.dispatchRequest=function(_12b1){
if(this.m_activeRequest==null){
this.startRequest(_12b1);
}else{
if(_12b1.canBeQueued()==true){
this.m_requestQueue.push(_12b1);
}else{
if(window.cognosViewerDebug&&console&&console.warn){
console.warn("Warning! Dropped a dispatcher entry!");
}
}
}
};
ViewerDispatcher.prototype.startRequest=function(_12b2){
this.m_activeRequest=_12b2;
if(_12b2!=null){
_12b2.setUsePageRequest(this.m_bUsePageRequest);
_12b2.sendRequest();
}
};
ViewerDispatcher.prototype.cancelRequest=function(key){
for(var i=0;i<this.m_requestQueue.length;i++){
var _12b5=this.m_requestQueue[i];
if(_12b5.getKey()===key){
_12b5.setCallbacks({"onEntryComplete":null});
_12b5.cancelRequest(false);
this.m_requestQueue.splice(i,1);
i--;
}
}
if(this.m_activeRequest&&this.m_activeRequest.getKey()===key){
this.m_activeRequest.setCallbacks({"onEntryComplete":null});
this.m_activeRequest.cancelRequest(false);
this.requestComplete();
}
};
ViewerDispatcher.prototype.possibleUnloadEvent=function(){
if(this.m_activeRequest){
this.m_activeRequest.possibleUnloadEvent();
}
};
ViewerDispatcher.prototype.requestComplete=function(_12b6){
this.startRequest(this.nextRequest());
};
ViewerDispatcher.prototype.nextRequest=function(){
var _12b7=null;
if(this.m_requestQueue.length>0){
_12b7=this.m_requestQueue.shift();
if(_12b7.getKey()!=null){
while(this.m_requestQueue.length>0&&this.m_requestQueue[0].getKey()==_12b7.getKey()){
_12b7=this.m_requestQueue.shift();
}
}
}
return _12b7;
};
ViewerDispatcher.prototype.queueIsEmpty=function(){
return (this.m_requestQueue.length==0);
};
function DispatcherEntry(oCV){
this.m_oCV=oCV;
this.m_requestKey=null;
this.m_canBeQueued=false;
this.m_originalFormFields=null;
this.m_bUsePageRequest=false;
if(oCV){
if(!this.m_request){
this.m_request=new XmlHttpObject();
this.m_request.init("POST",this.m_oCV.getGateway(),"",true);
}
if(!this.m_requestHandler){
this.setRequestHandler(new BaseRequestHandler(oCV));
}
DispatcherEntry.prototype.setDefaultFormFields.call(this);
this.setCallbacks({"entryComplete":{"object":this,"method":this.onEntryComplete},"entryFault":{"object":this,"method":this.onEntryFault},"newRequest":{"object":this,"method":this.onNewRequest},"fault":{"object":this,"method":this.onFault},"error":{"object":this,"method":this.onError},"passportTimeout":{"object":this,"method":this.onPassportTimeout},"working":{"object":this,"method":this.onWorking},"prompting":{"object":this,"method":this.onPrompting},"preHttpRequest":{"object":this,"method":this.onPreHttpRequest},"postHttpRequest":{"object":this,"method":this.onPostHttpRequest},"postEntryComplete":{"object":this,"method":this.onPostEntryComplete}});
}
};
DispatcherEntry.prototype.setHeaders=function(_12b9){
this.m_request.setHeaders(_12b9);
};
DispatcherEntry.prototype.getHeaders=function(){
return this.m_request.getHeaders();
};
DispatcherEntry.prototype.setOriginalFormFields=function(_12ba){
this.m_originalFormFields=_12ba;
};
DispatcherEntry.prototype.getOriginalFormFields=function(){
return this.m_originalFormFields;
};
DispatcherEntry.prototype.setRequestHandler=function(_12bb){
_12bb.addCallbackHooks();
this.m_requestHandler=_12bb;
};
DispatcherEntry.prototype.getRequestHandler=function(){
return this.m_requestHandler;
};
DispatcherEntry.prototype.setWorkingDialog=function(_12bc){
if(this.getRequestHandler()){
this.m_requestHandler.setWorkingDialog(_12bc);
}
};
DispatcherEntry.prototype.setRequestIndicator=function(_12bd){
if(this.getRequestHandler()){
this.getRequestHandler().setRequestIndicator(_12bd);
}
};
DispatcherEntry.prototype.forceSynchronous=function(){
this.getRequest().forceSynchronous();
};
DispatcherEntry.prototype.setUsePageRequest=function(_12be){
this.m_bUsePageRequest=_12be;
};
DispatcherEntry.prototype.getUsePageRequest=function(){
return this.m_bUsePageRequest;
};
DispatcherEntry.prototype.setDefaultFormFields=function(){
var _12bf=this.getViewer().envParams;
this.addFormField("b_action","cognosViewer");
this.addFormField("cv.catchLogOnFault","true");
this.addDefinedNonNullFormField("protectParameters",_12bf["protectParameters"]);
this.addDefinedNonNullFormField("ui.routingServerGroup",_12bf["ui.routingServerGroup"]);
this.addDefinedNonNullFormField("cv.debugDirectory",_12bf["cv.debugDirectory"]);
this.addDefinedNonNullFormField("cv.showFaultPage",_12bf["cv.showFaultPage"]);
this.addDefinedNonNullFormField("cv.useRAPDrill",_12bf["cv.useRAPDrill"]);
this.addDefinedNonNullFormField("container",_12bf["container"]);
this.addNonEmptyStringFormField("cv.objectPermissions",_12bf["cv.objectPermissions"]);
};
DispatcherEntry.prototype.getViewer=function(){
return this.m_oCV;
};
DispatcherEntry.prototype.prepareRequest=function(){
};
DispatcherEntry.addWidgetInfoToFormFields=function(_12c0,_12c1){
if(_12c0){
var _12c2=_12c0.getBUXRTStateInfoMap();
if(_12c2){
_12c1.addFormField("cv.buxRTStateInfo",_12c2);
}
var _12c3=_12c0.getDisplayName();
if(_12c3&&_12c3.length>0){
_12c1.addFormField("displayTitle",_12c3);
}
}
};
DispatcherEntry.prototype.canBeQueued=function(){
return this.m_canBeQueued;
};
DispatcherEntry.prototype.setCanBeQueued=function(_12c4){
this.m_canBeQueued=_12c4;
};
DispatcherEntry.prototype.getKey=function(){
return this.m_requestKey;
};
DispatcherEntry.prototype.setKey=function(key){
this.m_requestKey=key;
};
DispatcherEntry.prototype.setRequest=function(_12c6){
this.m_request=_12c6;
};
DispatcherEntry.prototype.getRequest=function(){
return this.m_request;
};
DispatcherEntry.prototype.setCallbacks=function(_12c7){
this.getRequest().setCallbacks(_12c7);
};
DispatcherEntry.prototype.getCallbacks=function(){
return this.getRequest().getCallbacks();
};
DispatcherEntry.prototype.sendRequest=function(){
this.prepareRequest();
var _12c8=this.getRequest().getFormFields();
var _12c9=_12c8.keys();
if(!this.m_originalFormFields){
this.m_originalFormFields=new CDictionary();
for(var index=0;index<_12c9.length;index++){
this.m_originalFormFields.add(_12c9[index],_12c8.get(_12c9[index]));
}
}
this.getRequest().sendRequest();
};
DispatcherEntry.prototype.onNewRequest=function(_12cb){
this.setRequest(_12cb);
};
DispatcherEntry.prototype.retryRequest=function(){
var oCV=this.getViewer();
oCV.setRetryDispatcherEntry(null);
var _12cd=this.getRequest().newRequest();
_12cd.setHeaders(null);
this.setRequest(_12cd);
var _12ce=this.m_originalFormFields.keys();
for(var index=0;index<_12ce.length;index++){
var _12d0=_12ce[index];
var _12d1=this.m_originalFormFields.get(_12d0);
if(_12d0=="cv.responseFormat"&&_12d1=="iWidget"){
this.addFormField("cv.responseFormat","data");
}else{
if(_12d0=="ui.action"&&_12d1=="wait"){
this.addFormField("ui.action",this.m_originalFormFields.get("ui.primaryAction"));
}else{
if(_12d0!="m_tracking"&&_12d0!="cv.outputKey"){
this.addFormField(_12d0,_12d1);
}
}
}
}
this.addFormField("widget.reloadToolbar","true");
if(this.m_oCV.getViewerWidget()){
this.addFormField("cv.buxCurrentUserRole",this.m_oCV.getViewerWidget().getUserRole());
}
this.addNonEmptyStringFormField("cv.objectPermissions",oCV.envParams["cv.objectPermissions"]);
this.addNonEmptyStringFormField("limitedInteractiveMode",oCV.envParams["limitedInteractiveMode"]);
this.m_oCV.getViewerDispatcher().dispatchRequest(this);
};
DispatcherEntry.prototype.abortHttpRequest=function(){
if(!this.m_bCancelCalled){
if(this.getRequestHandler()){
this.getRequestHandler().onCancel();
}
this.m_bCancelCalled=true;
this.getRequest().abortHttpRequest();
this.onEntryComplete();
}
};
DispatcherEntry.prototype.cancelRequest=function(_12d2){
if(!this.m_bCancelCalled){
this.m_bCancelCalled=true;
if(this.getRequestHandler()){
this.getRequestHandler().onCancel();
}
if(_12d2){
this.getRequest().forceSynchronous();
}
this.getRequest().cancel();
this.onEntryComplete();
}
};
DispatcherEntry.prototype.getFormFields=function(){
return this.m_request.getFormFields();
};
DispatcherEntry.prototype.getFormField=function(name){
if(this.m_request){
return this.m_request.getFormField(name);
}else{
return "";
}
};
DispatcherEntry.prototype.clearFormFields=function(){
this.m_request.clearFormFields();
};
DispatcherEntry.prototype.formFieldExists=function(name){
if(this.m_request){
return this.m_request.getFormFields().exists(name);
}
return false;
};
DispatcherEntry.prototype.removeFormField=function(name){
if(this.formFieldExists(name)){
this.m_request.getFormFields().remove(name);
}
};
DispatcherEntry.prototype.addFormField=function(name,value){
this.m_request.addFormField(name,value);
};
DispatcherEntry.prototype.addDefinedNonNullFormField=function(name,value){
if(typeof value!="undefined"&&value!=null){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.addDefinedFormField=function(name,value){
if(typeof value!="undefined"){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.addNonNullFormField=function(name,value){
if(value!=null){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.addNonEmptyStringFormField=function(name,value){
if(typeof value!="undefined"&&value!=null&&value!=""){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.onWorking=function(_12e0,arg1){
if(this.getRequestHandler()){
this.getRequestHandler().onWorking(_12e0);
}
};
DispatcherEntry.prototype.onFault=function(_12e2){
if(this.getRequestHandler()){
this.getRequestHandler().onFault(_12e2);
}
};
DispatcherEntry.prototype.onError=function(_12e3){
if(this.m_bCancelCalled){
return;
}
if(this.getRequestHandler()){
this.getRequestHandler().onError(_12e3);
}
};
DispatcherEntry.prototype.possibleUnloadEvent=function(){
this.setCallbacks({"error":{}});
};
DispatcherEntry.prototype.onPreHttpRequest=function(_12e4){
if(this.getRequestHandler()){
this.getRequestHandler().preHttpRequest(_12e4);
}
};
DispatcherEntry.prototype.onPostHttpRequest=function(_12e5){
if(this.getRequestHandler()){
this.getRequestHandler().postHttpRequest(_12e5);
}
};
DispatcherEntry.prototype.onPassportTimeout=function(_12e6){
if(this.getRequestHandler()){
this.getRequestHandler().onPassportTimeout(_12e6);
}
};
DispatcherEntry.prototype.onPrompting=function(_12e7){
if(this.getRequestHandler()){
this.getRequestHandler().onPrompting(_12e7);
}
};
DispatcherEntry.prototype.onEntryComplete=function(_12e8){
if(!this.m_oCV._beingDestroyed){
this.m_oCV.getViewerDispatcher().requestComplete(this);
}
};
DispatcherEntry.prototype.onEntryFault=function(_12e9){
this.m_oCV.setFaultDispatcherEntry(this);
this.m_oCV.resetViewerDispatcher();
if(!this.m_bCancelCalled){
this.m_oCV.setRetryDispatcherEntry(this);
}
};
DispatcherEntry.prototype.onCloseErrorDlg=function(){
var _12ea=this.getCallbacks();
if(_12ea["closeErrorDlg"]){
var _12eb=GUtil.generateCallback(_12ea["closeErrorDlg"].method,[],_12ea["closeErrorDlg"].object);
_12eb();
}
};
DispatcherEntry.prototype.onPostEntryComplete=function(){
if(this.getRequestHandler()){
this.getRequestHandler().onPostEntryComplete();
}
this.executeCallback("postComplete");
};
DispatcherEntry.prototype.executeCallback=function(_12ec){
var _12ed=this.getCallbacks();
if(_12ed[_12ec]){
var _12ee=(_12ed.customArguments)?[this,_12ed.customArguments]:[this];
var _12ef=GUtil.generateCallback(_12ed[_12ec].method,_12ee,_12ed[_12ec].object);
_12ef();
return true;
}
return false;
};
function DataDispatcherEntry(oCV){
if(oCV){
this.setRequest(new AsynchDATARequest(oCV.getGateway(),oCV.getWebContentRoot()));
}
DataDispatcherEntry.baseConstructor.call(this,oCV);
};
DataDispatcherEntry.prototype=new DispatcherEntry();
DataDispatcherEntry.baseConstructor=DispatcherEntry;
function JSONDispatcherEntry(oCV){
if(oCV){
this.setRequest(new AsynchJSONRequest(oCV.getGateway(),oCV.getWebContentRoot()));
}
JSONDispatcherEntry.prototype.setDefaultFormFields.call(this);
JSONDispatcherEntry.baseConstructor.call(this,oCV);
};
JSONDispatcherEntry.prototype=new DispatcherEntry();
JSONDispatcherEntry.baseConstructor=DispatcherEntry;
JSONDispatcherEntry.prototype.setDefaultFormFields=function(){
this.addFormField("cv.responseFormat","JSON");
};
function AsynchDataDispatcherEntry(oCV){
if(oCV){
var _12f3=new AsynchDATARequest(oCV.getGateway(),oCV.getWebContentRoot());
this.setRequest(_12f3);
AsynchDataDispatcherEntry.baseConstructor.call(this,oCV);
AsynchDataDispatcherEntry.prototype.setDefaultFormFields.call(this);
}
};
AsynchDataDispatcherEntry.prototype=new DispatcherEntry();
AsynchDataDispatcherEntry.baseConstructor=DispatcherEntry;
AsynchDataDispatcherEntry.prototype.setDefaultFormFields=function(){
this.addFormField("cv.responseFormat","data");
};
function AsynchJSONDispatcherEntry(oCV){
if(oCV){
var _12f5=new AsynchJSONRequest(oCV.getGateway(),oCV.getWebContentRoot());
this.setRequest(_12f5);
AsynchJSONDispatcherEntry.baseConstructor.call(this,oCV);
AsynchJSONDispatcherEntry.prototype.setDefaultFormFields.call(this);
}
};
AsynchJSONDispatcherEntry.prototype=new DispatcherEntry();
AsynchJSONDispatcherEntry.baseConstructor=DispatcherEntry;
AsynchJSONDispatcherEntry.prototype.setDefaultFormFields=function(){
this.addFormField("cv.responseFormat","asynchJSON");
};
function ReportDispatcherEntry(oCV){
ReportDispatcherEntry.baseConstructor.call(this,oCV);
if(oCV){
ReportDispatcherEntry.prototype.setDefaultFormFields.call(this);
this.setRequestHandler(new RequestHandler(oCV));
this.setWorkingDialog(oCV.getWorkingDialog());
this.setRequestIndicator(oCV.getRequestIndicator());
this.setCallbacks({"complete":{"object":this,"method":this.onComplete},"prompting":{"object":this,"method":this.onComplete}});
}
};
ReportDispatcherEntry.prototype=new AsynchDataDispatcherEntry();
ReportDispatcherEntry.baseConstructor=AsynchDataDispatcherEntry;
ReportDispatcherEntry.prototype.parent=AsynchDataDispatcherEntry.prototype;
ReportDispatcherEntry.prototype.prepareRequest=function(){
var _12f7=this.getFormField("ui.action");
var _12f8=this.getViewer().getActionState();
if(_12f8!==""&&(_12f7=="wait"||_12f7=="forward"||_12f7=="back")){
this.addFormField("cv.actionState",_12f8);
}
var _12f9=["nextPage","previousPage","firstPage","lastPage","reportAction","cancel","wait"];
var _12fa=true;
for(var i=0;i<_12f9.length;i++){
if(_12f9[i]==_12f7){
_12fa=false;
break;
}
}
if(_12fa){
this.getViewer().clearTabs();
}
if(this.getViewer().getCurrentlySelectedTab()&&!this.formFieldExists("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup")){
this.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",this.getViewer().getCurrentlySelectedTab());
}
};
ReportDispatcherEntry.prototype.setDefaultFormFields=function(){
var oCV=this.getViewer();
var _12fd=oCV.envParams;
this.addFormField("cv.id",oCV.getId());
if(_12fd["cv.showFaultPage"]){
this.addFormField("cv.showFaultPage",_12fd["cv.showFaultPage"]);
}else{
this.addFormField("cv.showFaultPage","false");
}
this.addDefinedNonNullFormField("ui.object",_12fd["ui.object"]);
this.addDefinedNonNullFormField("ui.primaryAction",_12fd["ui.primaryAction"]);
this.addDefinedNonNullFormField("ui.objectClass",_12fd["ui.objectClass"]);
this.addNonEmptyStringFormField("specificationType",_12fd["specificationType"]);
this.addNonEmptyStringFormField("cv.promptForDownload",_12fd["cv.promptForDownload"]);
this.addNonEmptyStringFormField("ui.conversation",oCV.getConversation());
this.addNonEmptyStringFormField("m_tracking",oCV.getTracking());
var _12fe=oCV.getExecutionParameters();
this.addNonEmptyStringFormField("executionParameters",_12fe);
var sCAF=oCV.getCAFContext();
this.addDefinedNonNullFormField("ui.cafcontextid",sCAF);
};
ReportDispatcherEntry.prototype.onWorking=function(_1300,arg1){
var _1302=_1300.getResponseState();
var _1303=this.getRequestHandler();
if(_1303){
var _1304=_1303.getWorkingDialog();
if(_1304&&_1304.setSecondaryRequests&&_1302.m_aSecRequests){
_1304.setSecondaryRequests(_1302.m_aSecRequests);
}
}
DispatcherEntry.prototype.onWorking.call(this,_1300,arg1);
if(_1303){
this.getRequestHandler().updateViewerState(_1302);
}
};
ReportDispatcherEntry.prototype.onComplete=function(_1305,arg1){
if(this.getRequestHandler()){
this.getRequestHandler().onComplete(_1305);
}
};
function ViewerDispatcherEntry(oCV){
ViewerDispatcherEntry.baseConstructor.call(this,oCV);
if(oCV){
ViewerDispatcherEntry.prototype.setDefaultFormFields.call(this);
this.setCallbacks({"complete":{"object":this,"method":this.onComplete},"prompting":{"object":this,"method":this.onPrompting},"cancel":{"object":this,"method":this.onCancel}});
}
};
ViewerDispatcherEntry.prototype=new ReportDispatcherEntry();
ViewerDispatcherEntry.baseConstructor=ReportDispatcherEntry;
ViewerDispatcherEntry.prototype.parent=ReportDispatcherEntry.prototype;
ViewerDispatcherEntry.prototype.setDefaultFormFields=function(){
var oCV=this.getViewer();
var _1309=oCV.envParams;
this.addFormField("cv.showFaultPage","true");
this.addDefinedNonNullFormField("cv.header",_1309["cv.header"]);
this.addDefinedNonNullFormField("cv.toolbar",_1309["cv.toolbar"]);
this.addDefinedNonNullFormField("ui.backURL",_1309["ui.backURL"]);
this.addDefinedNonNullFormField("errURL",_1309["ui.backURL"]);
this.addDefinedNonNullFormField("errURL",_1309["ui.errURL"]);
this.addDefinedNonNullFormField("cv.catchLogOnFault","true");
this.addDefinedNonNullFormField("m_sessionConv",_1309["m_sessionConv"]);
if(_1309["m_session"]){
this.addFormField("m_session",_1309["m_session"]);
this.addFormField("cv.ignoreState","true");
}
};
ViewerDispatcherEntry.prototype.prepareRequest=function(){
this.parent.prepareRequest.call(this);
if(this.getUsePageRequest()){
this.m_oCV.setKeepSessionAlive(true);
if(typeof this.m_oCV.envParams["cv.responseFormat"]!="undefined"&&this.m_oCV.envParams["cv.responseFormat"]!=null&&this.m_oCV.envParams["cv.responseFormat"]!=""){
this.addFormField("cv.responseFormat",this.m_oCV.envParams["cv.responseFormat"]);
}else{
if(this.getFormField("cv.responseFormat")!="view"){
this.addFormField("cv.responseFormat","page");
}
}
var _130a=this.m_oCV.getPinFreezeManager();
if(_130a&&_130a.hasFrozenContainers()){
this.addFormField("pinFreezeInfo",_130a.toJSONString());
}
}
};
ViewerDispatcherEntry.prototype.sendRequest=function(){
if(this.getUsePageRequest()){
this.prepareRequest();
var _130b=this.buildRequestForm();
if(typeof document.progress!="undefined"){
setTimeout("document.progress.src=\""+this.m_oCV.getSkin()+"/branding/progress.gif"+"\";",1);
}
_130b.submit();
}else{
this.getViewer().closeContextMenuAndToolbarMenus();
this.parent.sendRequest.call(this);
}
};
ViewerDispatcherEntry.prototype.buildRequestForm=function(){
var oCV=this.getViewer();
var _130d=document.createElement("form");
_130d.setAttribute("id","requestForm");
_130d.setAttribute("name","requestForm");
_130d.setAttribute("method","post");
_130d.setAttribute("target","_self");
_130d.setAttribute("action",oCV.getGateway());
_130d.style.display="none";
document.body.appendChild(_130d);
var _130e=this.getRequest().getFormFields();
var _130f=_130e.keys();
for(var index=0;index<_130f.length;index++){
_130d.appendChild(this.createHiddenFormField(_130f[index],_130e.get(_130f[index])));
}
for(param in oCV.envParams){
if(!_130e.exists(param)&&param!="cv.actionState"){
_130d.appendChild(this.createHiddenFormField(param,oCV.envParams[param]));
}
}
return _130d;
};
ViewerDispatcherEntry.prototype.createHiddenFormField=function(name,value){
var _1313=document.createElement("input");
_1313.setAttribute("type","hidden");
_1313.setAttribute("name",name);
_1313.setAttribute("id",name);
_1313.setAttribute("value",value);
return (_1313);
};
ViewerDispatcherEntry.prototype.onCancel=function(){
var oCV=this.getViewer();
oCV.setStatus("complete");
if(this.getUsePageRequest()||!oCV.isReportRenderingDone()){
oCV.executeCallback("cancel");
}
};
ViewerDispatcherEntry.prototype.onFault=function(_1315){
if(this.getViewer().callbackExists("fault")){
this.getViewer().setSoapFault(_1315.getSoapFault());
this.getViewer().executeCallback("fault");
}else{
this.parent.onFault.call(this,_1315);
}
};
ViewerDispatcherEntry.prototype.onComplete=function(_1316){
var oCV=this.getViewer();
oCV.saveBackJaxInformation(_1316);
if(oCV.isReportRenderingDone()){
this.getViewer().getSelectionController().resetSelections();
}
this.parent.onComplete.call(this,_1316);
};
ViewerDispatcherEntry.prototype.onPrompting=function(_1318){
var oCV=this.getViewer();
oCV.updateSkipToNavigationLink(true);
if(!oCV.executeCallback("prompt")){
this.onComplete(_1318);
}
};
ViewerDispatcherEntry.prototype.onEntryComplete=function(_131a){
if(this.getRequestHandler()){
this.getRequestHandler().setDispatcherEntry(this);
}
this.parent.onEntryComplete.call(this,_131a);
};

